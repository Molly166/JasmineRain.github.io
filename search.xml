<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Cookie和Session的区别</title>
      <link href="/JasmineRain.github.io/2026/01/13/Cookie%E5%92%8CSession%E7%9A%84%E5%8C%BA%E5%88%AB/"/>
      <url>/JasmineRain.github.io/2026/01/13/Cookie%E5%92%8CSession%E7%9A%84%E5%8C%BA%E5%88%AB/</url>
      
        <content type="html"><![CDATA[<h2 id="核心概念"><a href="#核心概念" class="headerlink" title="核心概念"></a>核心概念</h2><h3 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h3><p><strong>Cookie</strong>（HTTP Cookie）是由服务器发送到用户浏览器并保存在本地的一小块数据。Cookie会在浏览器下次向同一服务器发起请求时被携带并发送到服务器。Cookie主要用于：</p><ul><li><strong>会话管理</strong>：保存用户的登录状态、会话标识等</li><li><strong>个性化设置</strong>：记住用户的偏好设置、语言选择等</li><li><strong>行为追踪</strong>：记录用户的浏览行为，用于分析和广告投放</li></ul><p>Cookie的特点：</p><ul><li>存储在客户端（浏览器）</li><li>每次HTTP请求会自动携带</li><li>有大小限制（通常4KB）</li><li>可以设置过期时间</li><li>可以被JavaScript访问（HttpOnly属性除外）</li></ul><h3 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h3><p><strong>Session</strong>（会话）是服务器端用来存储用户会话信息的机制。当用户首次访问服务器时，服务器会为该用户创建一个唯一的Session，并生成一个SessionID。这个SessionID通过Cookie返回给客户端，客户端在后续请求中携带这个SessionID，服务器据此识别用户并获取对应的会话数据。</p><p>Session的特点：</p><ul><li>存储在服务器端（内存、数据库或缓存）</li><li>数据安全性高，客户端无法直接访问</li><li>存储容量大，不受浏览器限制</li><li>生命周期由服务器控制</li><li>依赖Cookie（或其他机制）传递SessionID</li></ul><h2 id="详细对比"><a href="#详细对比" class="headerlink" title="详细对比"></a>详细对比</h2><table><thead><tr><th>对比维度</th><th>Cookie</th><th>Session</th></tr></thead><tbody><tr><td><strong>存储位置</strong></td><td>客户端（浏览器）</td><td>服务器端（内存&#x2F;数据库&#x2F;缓存）</td></tr><tr><td><strong>数据安全性</strong></td><td>较低，易被XSS攻击窃取，可被客户端修改</td><td>较高，数据存储在服务器，客户端无法直接访问</td></tr><tr><td><strong>存储内容</strong></td><td>少量字符串数据（通常只存SessionID）</td><td>完整的用户会话数据（用户信息、购物车等）</td></tr><tr><td><strong>存储容量</strong></td><td>单个Cookie约4KB，每个域名下Cookie数量有限</td><td>理论上较大，受服务器内存&#x2F;存储限制</td></tr><tr><td><strong>生命周期</strong></td><td>可设置过期时间（Expires&#x2F;Max-Age），可以是会话Cookie或持久Cookie</td><td>默认会话结束（浏览器关闭）或超时，也可设置过期时间</td></tr><tr><td><strong>传输方式</strong></td><td>自动随HTTP请求头（Cookie）发送</td><td>不直接传输，通过SessionID（通常存在Cookie中）关联</td></tr><tr><td><strong>服务器依赖</strong></td><td>否，客户端独立存储</td><td>是，必须依赖服务器存储和查询</td></tr><tr><td><strong>跨域限制</strong></td><td>受同源策略限制，可设置Domain和Path</td><td>无跨域问题（服务器端存储）</td></tr><tr><td><strong>性能影响</strong></td><td>每次请求都会携带，增加请求头大小</td><td>需要服务器查询，可能影响性能</td></tr><tr><td><strong>典型用途</strong></td><td>记住登录状态、用户偏好、追踪标识</td><td>用户登录态、购物车、临时数据存储</td></tr><tr><td><strong>可访问性</strong></td><td>可通过JavaScript访问（除非设置HttpOnly）</td><td>服务器端访问，客户端无法直接访问</td></tr></tbody></table><h2 id="Cookie和Session配合工作流程"><a href="#Cookie和Session配合工作流程" class="headerlink" title="Cookie和Session配合工作流程"></a>Cookie和Session配合工作流程</h2><h3 id="典型登录流程详解"><a href="#典型登录流程详解" class="headerlink" title="典型登录流程详解"></a>典型登录流程详解</h3><ol><li><p><strong>用户提交登录信息</strong></p><ul><li>用户在登录页面输入用户名和密码</li><li>浏览器通过POST请求将凭证发送到服务器</li></ul></li><li><p><strong>服务器验证用户身份</strong></p><ul><li>服务器验证用户名和密码</li><li>验证成功后，服务器创建Session对象</li><li>Session中存储用户信息（如用户ID、用户名、权限等）</li></ul></li><li><p><strong>生成SessionID</strong></p><ul><li>服务器生成唯一的SessionID（通常是一个随机字符串或UUID）</li><li>SessionID与Session数据建立映射关系</li><li>Session数据存储在服务器内存、数据库或缓存中</li></ul></li><li><p><strong>返回SessionID给客户端</strong></p><ul><li>服务器通过<code>Set-Cookie</code>响应头将SessionID发送给浏览器</li><li>例如：<code>Set-Cookie: JSESSIONID=abc123xyz; Path=/; HttpOnly; Secure</code></li><li>浏览器收到后自动保存Cookie</li></ul></li><li><p><strong>后续请求携带Cookie</strong></p><ul><li>用户访问其他页面时，浏览器自动在请求头中携带Cookie</li><li>例如：<code>Cookie: JSESSIONID=abc123xyz</code></li><li>服务器从Cookie中提取SessionID</li></ul></li><li><p><strong>服务器识别用户</strong></p><ul><li>服务器根据SessionID查找对应的Session</li><li>从Session中获取用户信息</li><li>根据用户信息处理业务逻辑</li></ul></li></ol><h3 id="安全设计原则"><a href="#安全设计原则" class="headerlink" title="安全设计原则"></a>安全设计原则</h3><blockquote><p><strong>重要</strong>：Cookie本身并不安全，容易被XSS攻击窃取或被客户端修改。但通过只存储SessionID而不存储敏感数据，可以降低安全风险。敏感的用户数据存储在服务器端的Session中，客户端无法直接访问。</p></blockquote><h3 id="Cookie的安全属性"><a href="#Cookie的安全属性" class="headerlink" title="Cookie的安全属性"></a>Cookie的安全属性</h3><p>为了增强安全性，Cookie可以设置以下属性：</p><ul><li><strong>HttpOnly</strong>：防止JavaScript访问Cookie，降低XSS攻击风险</li><li><strong>Secure</strong>：只在HTTPS连接下传输Cookie，防止中间人攻击</li><li><strong>SameSite</strong>：防止CSRF攻击，限制Cookie的跨站发送<ul><li><code>Strict</code>：完全禁止跨站发送</li><li><code>Lax</code>：允许GET请求的跨站发送</li><li><code>None</code>：允许所有跨站发送（需要Secure属性）</li></ul></li></ul><h2 id="Session的问题与挑战"><a href="#Session的问题与挑战" class="headerlink" title="Session的问题与挑战"></a>Session的问题与挑战</h2><h3 id="1-服务器内存压力"><a href="#1-服务器内存压力" class="headerlink" title="1. 服务器内存压力"></a>1. 服务器内存压力</h3><p><strong>问题描述</strong>：</p><ul><li>Session数据存储在服务器内存中</li><li>大量并发用户会导致内存占用急剧增加</li><li>如果Session过期时间设置过长，可能积累大量无效Session</li></ul><p><strong>影响</strong>：</p><ul><li>服务器内存不足可能导致性能下降</li><li>需要定期清理过期Session</li><li>单机服务器扩展性受限</li></ul><h3 id="2-分布式系统下的Session共享问题"><a href="#2-分布式系统下的Session共享问题" class="headerlink" title="2. 分布式系统下的Session共享问题"></a>2. 分布式系统下的Session共享问题</h3><p><strong>问题描述</strong>：</p><ul><li>在负载均衡环境下，用户请求可能被分发到不同的服务器</li><li>如果Session存储在单台服务器的内存中，用户可能被分配到没有其Session的服务器</li><li>导致用户需要重新登录，体验极差</li></ul><p><strong>场景示例</strong>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">用户A登录 → 请求被分发到服务器1 → Session存储在服务器1</span><br><span class="line">用户A再次请求 → 请求被分发到服务器2 → 服务器2找不到Session → 需要重新登录</span><br></pre></td></tr></table></figure><h3 id="3-服务器重启导致Session丢失"><a href="#3-服务器重启导致Session丢失" class="headerlink" title="3. 服务器重启导致Session丢失"></a>3. 服务器重启导致Session丢失</h3><p><strong>问题描述</strong>：</p><ul><li>如果Session存储在内存中，服务器重启会导致所有Session丢失</li><li>所有用户需要重新登录</li><li>用户体验差，可能影响业务连续性</li></ul><h3 id="4-扩展性问题"><a href="#4-扩展性问题" class="headerlink" title="4. 扩展性问题"></a>4. 扩展性问题</h3><p><strong>问题描述</strong>：</p><ul><li>单机Session存储难以水平扩展</li><li>添加新服务器需要解决Session共享问题</li><li>无法充分利用多服务器的优势</li></ul><h2 id="常见解决方案"><a href="#常见解决方案" class="headerlink" title="常见解决方案"></a>常见解决方案</h2><h3 id="方案一：Session-Sticky（会话粘性）"><a href="#方案一：Session-Sticky（会话粘性）" class="headerlink" title="方案一：Session Sticky（会话粘性）"></a>方案一：Session Sticky（会话粘性）</h3><p><strong>原理</strong>：</p><ul><li>通过负载均衡器将同一用户的请求固定路由到同一台服务器</li><li>可以使用IP哈希、Cookie路由等方式实现</li></ul><p><strong>优点</strong>：</p><ul><li>实现简单，无需修改应用代码</li><li>Session仍然存储在单机内存中，性能好</li></ul><p><strong>缺点</strong>：</p><ul><li>服务器故障时，该服务器上的所有Session丢失</li><li>负载可能不均衡（某些服务器Session多，某些少）</li><li>无法充分利用所有服务器资源</li></ul><p><strong>适用场景</strong>：</p><ul><li>小型应用或内部系统</li><li>对高可用性要求不高的场景</li></ul><h3 id="方案二：Session共享（Session-Replication）"><a href="#方案二：Session共享（Session-Replication）" class="headerlink" title="方案二：Session共享（Session Replication）"></a>方案二：Session共享（Session Replication）</h3><p><strong>原理</strong>：</p><ul><li>将Session存储在共享存储中，如Redis、Memcached等</li><li>所有服务器都可以访问这个共享存储</li></ul><p><strong>实现方式</strong>：</p><h4 id="2-1-Redis存储Session"><a href="#2-1-Redis存储Session" class="headerlink" title="2.1 Redis存储Session"></a>2.1 Redis存储Session</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 示例：使用Redis存储Session</span></span><br><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">redis_client = redis.Redis(host=<span class="string">&#x27;localhost&#x27;</span>, port=<span class="number">6379</span>, db=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建Session</span></span><br><span class="line">session_id = generate_session_id()</span><br><span class="line">session_data = &#123;</span><br><span class="line">    <span class="string">&#x27;user_id&#x27;</span>: <span class="number">123</span>,</span><br><span class="line">    <span class="string">&#x27;username&#x27;</span>: <span class="string">&#x27;john&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;login_time&#x27;</span>: <span class="string">&#x27;2026-01-13 10:00:00&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">redis_client.setex(</span><br><span class="line">    <span class="string">f&#x27;session:<span class="subst">&#123;session_id&#125;</span>&#x27;</span>, </span><br><span class="line">    <span class="number">3600</span>,  <span class="comment"># 过期时间1小时</span></span><br><span class="line">    json.dumps(session_data)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取Session</span></span><br><span class="line">session_data = redis_client.get(<span class="string">f&#x27;session:<span class="subst">&#123;session_id&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure><p><strong>优点</strong>：</p><ul><li>所有服务器共享Session，解决分布式问题</li><li>Redis性能高，支持持久化</li><li>可以设置过期时间，自动清理</li><li>支持集群模式，高可用</li></ul><p><strong>缺点</strong>：</p><ul><li>需要额外的Redis服务器，增加运维成本</li><li>网络延迟（虽然很小）</li><li>需要序列化&#x2F;反序列化Session数据</li></ul><h4 id="2-2-Memcached存储Session"><a href="#2-2-Memcached存储Session" class="headerlink" title="2.2 Memcached存储Session"></a>2.2 Memcached存储Session</h4><p><strong>优点</strong>：</p><ul><li>性能极高，纯内存存储</li><li>简单易用</li></ul><p><strong>缺点</strong>：</p><ul><li>不支持持久化，重启数据丢失</li><li>功能相对简单</li></ul><p><strong>适用场景</strong>：</p><ul><li>中大型分布式应用</li><li>对性能要求高的场景</li><li>需要高可用的系统</li></ul><h3 id="方案三：Token方案（JWT）"><a href="#方案三：Token方案（JWT）" class="headerlink" title="方案三：Token方案（JWT）"></a>方案三：Token方案（JWT）</h3><p><strong>原理</strong>：</p><ul><li>使用JWT（JSON Web Token）等无状态Token方案</li><li>将用户信息编码到Token中，客户端存储Token</li><li>服务器验证Token的有效性和签名，无需存储Session</li></ul><p><strong>JWT结构</strong>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Header.Payload.Signature</span><br></pre></td></tr></table></figure><ul><li><strong>Header</strong>：算法类型和Token类型</li><li><strong>Payload</strong>：用户信息（Claims）</li><li><strong>Signature</strong>：签名，用于验证Token完整性</li></ul><p><strong>优点</strong>：</p><ul><li><strong>无状态</strong>：服务器不需要存储Session，减轻服务器压力</li><li><strong>可扩展</strong>：天然支持分布式，无需Session共享</li><li><strong>跨域友好</strong>：可以轻松实现跨域认证</li><li><strong>移动端友好</strong>：适合移动应用和API服务</li></ul><p><strong>缺点</strong>：</p><ul><li>Token一旦签发，在过期前无法撤销（除非维护黑名单）</li><li>Token体积较大（比SessionID大）</li><li>敏感信息不应放在Token中（Payload是Base64编码，不是加密）</li></ul><p><strong>适用场景</strong>：</p><ul><li>微服务架构</li><li>移动应用后端</li><li>前后端分离的SPA应用</li><li>需要跨域认证的场景</li></ul><blockquote><p><strong>现代实践</strong>：在分布式架构下，通常会使用Redis存储Session或采用JWT等Token方案代替传统Session。选择哪种方案需要根据具体业务场景、性能要求、安全需求等因素综合考虑。</p></blockquote><h2 id="Session和JWT详细对比"><a href="#Session和JWT详细对比" class="headerlink" title="Session和JWT详细对比"></a>Session和JWT详细对比</h2><table><thead><tr><th>对比维度</th><th>Session</th><th>JWT</th></tr></thead><tbody><tr><td><strong>状态管理</strong></td><td>有状态（Stateful），服务器需要存储Session数据</td><td>无状态（Stateless），服务器不存储用户信息</td></tr><tr><td><strong>数据存储位置</strong></td><td>服务器端（内存&#x2F;Redis&#x2F;数据库）</td><td>客户端（Cookie&#x2F;LocalStorage&#x2F;内存）</td></tr><tr><td><strong>服务器压力</strong></td><td>需要存储和查询，占用服务器资源</td><td>无需存储，减轻服务器压力</td></tr><tr><td><strong>扩展性</strong></td><td>需要解决Session共享问题</td><td>天然支持分布式，易于扩展</td></tr><tr><td><strong>撤销机制</strong></td><td>可以立即删除Session，立即生效</td><td>难以撤销，需要维护Token黑名单或等待过期</td></tr><tr><td><strong>数据大小</strong></td><td>SessionID很小（通常几十字节）</td><td>Token较大（通常几百字节到几KB）</td></tr><tr><td><strong>安全性</strong></td><td>敏感数据在服务器，相对安全</td><td>Token可能被窃取，需要HTTPS保护</td></tr><tr><td><strong>跨域支持</strong></td><td>需要配置CORS和Cookie</td><td>可以轻松实现跨域认证</td></tr><tr><td><strong>性能</strong></td><td>需要查询存储，可能有网络延迟</td><td>本地验证，性能好（但需要验证签名）</td></tr><tr><td><strong>适用场景</strong></td><td>传统Web应用，需要立即撤销的场景</td><td>微服务、API、移动应用</td></tr></tbody></table><h3 id="选择建议"><a href="#选择建议" class="headerlink" title="选择建议"></a>选择建议</h3><p><strong>使用Session的场景</strong>：</p><ul><li>传统Web应用（服务端渲染）</li><li>需要立即撤销用户权限的场景</li><li>需要存储大量临时数据的场景</li><li>对Token大小敏感的场景</li></ul><p><strong>使用JWT的场景</strong>：</p><ul><li>微服务架构</li><li>前后端分离的SPA应用</li><li>移动应用后端API</li><li>需要跨域认证的场景</li><li>无状态API服务</li></ul><h2 id="实际应用最佳实践"><a href="#实际应用最佳实践" class="headerlink" title="实际应用最佳实践"></a>实际应用最佳实践</h2><h3 id="Cookie安全配置"><a href="#Cookie安全配置" class="headerlink" title="Cookie安全配置"></a>Cookie安全配置</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 安全的Cookie设置示例</span></span><br><span class="line">res.<span class="title function_">cookie</span>(<span class="string">&#x27;sessionId&#x27;</span>, sessionId, &#123;</span><br><span class="line">  <span class="attr">httpOnly</span>: <span class="literal">true</span>,        <span class="comment">// 防止XSS攻击</span></span><br><span class="line">  <span class="attr">secure</span>: <span class="literal">true</span>,          <span class="comment">// 仅HTTPS传输</span></span><br><span class="line">  <span class="attr">sameSite</span>: <span class="string">&#x27;strict&#x27;</span>,    <span class="comment">// 防止CSRF攻击</span></span><br><span class="line">  <span class="attr">maxAge</span>: <span class="number">3600000</span>,       <span class="comment">// 1小时过期</span></span><br><span class="line">  <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>              <span class="comment">// Cookie路径</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="Session存储最佳实践"><a href="#Session存储最佳实践" class="headerlink" title="Session存储最佳实践"></a>Session存储最佳实践</h3><ol><li><p><strong>选择合适的存储后端</strong></p><ul><li>小应用：内存存储</li><li>中大型应用：Redis</li><li>需要持久化：Redis + 数据库</li></ul></li><li><p><strong>设置合理的过期时间</strong></p><ul><li>根据业务需求设置</li><li>平衡用户体验和安全性</li><li>考虑自动续期机制</li></ul></li><li><p><strong>定期清理过期Session</strong></p><ul><li>使用TTL自动过期</li><li>定期扫描清理无效Session</li></ul></li><li><p><strong>Session数据最小化</strong></p><ul><li>只存储必要信息</li><li>敏感数据加密存储</li><li>避免存储大量数据</li></ul></li></ol><h3 id="混合方案"><a href="#混合方案" class="headerlink" title="混合方案"></a>混合方案</h3><p>在实际项目中，可以采用混合方案：</p><ul><li><strong>短期会话</strong>：使用Session存储临时数据（如购物车）</li><li><strong>长期认证</strong>：使用JWT存储用户身份信息</li><li><strong>敏感操作</strong>：结合Session进行二次验证</li></ul>]]></content>
      
      
      <categories>
          
          <category> 八股 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cookie </tag>
            
            <tag> session </tag>
            
            <tag> jwt </tag>
            
            <tag> 会话管理 </tag>
            
            <tag> web开发 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTTP和HTTPS的区别</title>
      <link href="/JasmineRain.github.io/2026/01/13/HTTP%E5%92%8CHTTPS%E7%9A%84%E5%8C%BA%E5%88%AB/"/>
      <url>/JasmineRain.github.io/2026/01/13/HTTP%E5%92%8CHTTPS%E7%9A%84%E5%8C%BA%E5%88%AB/</url>
      
        <content type="html"><![CDATA[<h2 id="核心概念"><a href="#核心概念" class="headerlink" title="核心概念"></a>核心概念</h2><h3 id="HTTP协议"><a href="#HTTP协议" class="headerlink" title="HTTP协议"></a>HTTP协议</h3><p>HTTP（HyperText Transfer Protocol，超文本传输协议）是一种应用层协议，用于在Web浏览器和Web服务器之间传输数据。自1991年由Tim Berners-Lee提出以来，HTTP已成为万维网数据通信的基础。HTTP协议采用<strong>明文传输</strong>方式，这意味着所有传输的数据都以可读的文本形式在网络中传递，任何人都可以在传输过程中截获并查看这些数据。</p><h3 id="HTTPS协议"><a href="#HTTPS协议" class="headerlink" title="HTTPS协议"></a>HTTPS协议</h3><p>HTTPS（HTTP Secure）是HTTP的安全版本，它在HTTP协议的基础上增加了TLS&#x2F;SSL(Transport Layer Security&#x2F;Secure Sockets Layer) 加密层。HTTPS通过加密、身份认证和数据完整性校验三大机制，为Web通信提供了端到端的安全保障。简单来说，<strong>HTTPS &#x3D; HTTP + TLS&#x2F;SSL</strong>。</p><h2 id="核心区别对比"><a href="#核心区别对比" class="headerlink" title="核心区别对比"></a>核心区别对比</h2><table><thead><tr><th>对比维度</th><th>HTTP</th><th>HTTPS</th></tr></thead><tbody><tr><td><strong>传输方式</strong></td><td>明文传输</td><td>TLS&#x2F;SSL加密传输</td></tr><tr><td><strong>安全性</strong></td><td>低，数据易被窃听、篡改</td><td>高，防窃听、防篡改、防重放攻击</td></tr><tr><td><strong>默认端口</strong></td><td>80</td><td>443</td></tr><tr><td><strong>身份认证</strong></td><td>无服务器身份验证</td><td>通过数字证书验证服务器身份</td></tr><tr><td><strong>数据完整性</strong></td><td>不保证数据完整性</td><td>通过MAC（消息认证码）保证数据完整性</td></tr><tr><td><strong>证书要求</strong></td><td>不需要证书</td><td>需要CA（证书颁发机构）签发的SSL&#x2F;TLS证书</td></tr><tr><td><strong>性能开销</strong></td><td>较低，无加密计算开销</td><td>较高，存在加密&#x2F;解密计算和握手延迟</td></tr><tr><td><strong>SEO优化</strong></td><td>一般</td><td>搜索引擎（如Google）优先索引和排名</td></tr><tr><td><strong>浏览器标识</strong></td><td>地址栏显示普通图标</td><td>地址栏显示锁形图标，部分浏览器显示绿色</td></tr><tr><td><strong>协议标识</strong></td><td><code>http://</code></td><td><code>https://</code></td></tr></tbody></table><h2 id="TLS-SSL工作原理详解"><a href="#TLS-SSL工作原理详解" class="headerlink" title="TLS&#x2F;SSL工作原理详解"></a>TLS&#x2F;SSL工作原理详解</h2><h3 id="TLS握手过程"><a href="#TLS握手过程" class="headerlink" title="TLS握手过程"></a>TLS握手过程</h3><p>TLS握手是HTTPS建立安全连接的关键步骤，整个过程可以分为以下几个阶段：</p><h4 id="1-客户端发起请求（Client-Hello）"><a href="#1-客户端发起请求（Client-Hello）" class="headerlink" title="1. 客户端发起请求（Client Hello）"></a>1. 客户端发起请求（Client Hello）</h4><p>客户端向服务器发送握手请求，包含：</p><ul><li><strong>支持的TLS版本</strong>（如TLS 1.2、TLS 1.3）</li><li><strong>支持的加密套件列表</strong>（Cipher Suites），包括：<ul><li>密钥交换算法（如RSA、ECDHE）</li><li>对称加密算法（如AES-256-GCM、ChaCha20-Poly1305）</li><li>消息认证码算法（如SHA-256）</li></ul></li><li><strong>客户端随机数</strong>（Client Random）</li><li><strong>支持的压缩算法</strong></li></ul><h4 id="2-服务器响应（Server-Hello）"><a href="#2-服务器响应（Server-Hello）" class="headerlink" title="2. 服务器响应（Server Hello）"></a>2. 服务器响应（Server Hello）</h4><p>服务器从客户端提供的加密套件中选择一个，并返回：</p><ul><li><strong>选定的TLS版本</strong></li><li><strong>选定的加密套件</strong></li><li><strong>服务器随机数</strong>（Server Random）</li><li><strong>服务器数字证书</strong>（包含服务器的公钥、域名、有效期等信息）</li><li><strong>服务器密钥交换参数</strong>（如果使用ECDHE等算法）</li></ul><h4 id="3-证书验证"><a href="#3-证书验证" class="headerlink" title="3. 证书验证"></a>3. 证书验证</h4><p>客户端收到服务器证书后，会进行严格的验证：</p><ul><li><strong>证书链验证</strong>：验证证书是否由受信任的CA签发</li><li><strong>域名验证</strong>：检查证书中的域名是否与访问的域名匹配</li><li><strong>有效期验证</strong>：确认证书未过期</li><li><strong>撤销状态检查</strong>：通过OCSP（Online Certificate Status Protocol）或CRL（Certificate Revocation List）检查证书是否被撤销</li></ul><p>如果证书验证失败，浏览器会显示安全警告，阻止用户继续访问。</p><h4 id="4-密钥交换"><a href="#4-密钥交换" class="headerlink" title="4. 密钥交换"></a>4. 密钥交换</h4><p>客户端生成一个<strong>预主密钥</strong>（Pre-Master Secret），并使用服务器的公钥进行加密后发送给服务器。服务器使用私钥解密得到预主密钥。双方根据以下信息计算<strong>主密钥</strong>（Master Secret）：</p><ul><li>客户端随机数</li><li>服务器随机数</li><li>预主密钥</li></ul><h4 id="5-会话密钥生成"><a href="#5-会话密钥生成" class="headerlink" title="5. 会话密钥生成"></a>5. 会话密钥生成</h4><p>双方使用主密钥和随机数生成<strong>会话密钥</strong>（Session Key），用于后续的对称加密通信。</p><h4 id="6-握手完成"><a href="#6-握手完成" class="headerlink" title="6. 握手完成"></a>6. 握手完成</h4><p>客户端和服务器分别发送”Change Cipher Spec”和”Finished”消息，确认握手完成，之后的所有通信都使用对称加密进行。</p><h3 id="为什么采用混合加密？"><a href="#为什么采用混合加密？" class="headerlink" title="为什么采用混合加密？"></a>为什么采用混合加密？</h3><p>TLS协议采用<strong>混合加密</strong>（Hybrid Encryption）方案，结合了非对称加密和对称加密的优势：</p><ul><li><strong>非对称加密</strong>（如RSA、ECDHE）：用于密钥交换阶段，安全性高但计算开销大</li><li><strong>对称加密</strong>（如AES、ChaCha20）：用于数据传输阶段，速度快、效率高</li></ul><p>如果全程使用非对称加密，虽然安全性更高，但会带来巨大的性能开销，严重影响用户体验。混合加密方案在保证安全性的同时，兼顾了性能需求。</p><h2 id="HTTP的安全隐患"><a href="#HTTP的安全隐患" class="headerlink" title="HTTP的安全隐患"></a>HTTP的安全隐患</h2><h3 id="1-数据窃听（Eavesdropping）"><a href="#1-数据窃听（Eavesdropping）" class="headerlink" title="1. 数据窃听（Eavesdropping）"></a>1. 数据窃听（Eavesdropping）</h3><p>HTTP采用明文传输，攻击者可以通过网络嗅探工具（如Wireshark）轻松截获和查看传输的数据，包括：</p><ul><li>用户登录凭证（用户名、密码）</li><li>个人敏感信息（身份证号、银行卡号）</li><li>Cookie和Session信息</li><li>业务数据</li></ul><h3 id="2-中间人攻击（MITM-Man-in-the-Middle）"><a href="#2-中间人攻击（MITM-Man-in-the-Middle）" class="headerlink" title="2. 中间人攻击（MITM - Man-in-the-Middle）"></a>2. 中间人攻击（MITM - Man-in-the-Middle）</h3><p>攻击者可以在客户端和服务器之间插入自己，充当”中间人”：</p><ul><li>截获客户端请求</li><li>修改请求内容</li><li>伪造服务器响应</li><li>窃取或篡改数据</li></ul><h3 id="3-数据篡改（Tampering）"><a href="#3-数据篡改（Tampering）" class="headerlink" title="3. 数据篡改（Tampering）"></a>3. 数据篡改（Tampering）</h3><p>由于没有完整性校验机制，攻击者可以：</p><ul><li>修改传输中的数据</li><li>注入恶意代码（如XSS脚本）</li><li>替换网页内容（如插入广告、钓鱼链接）</li></ul><h3 id="4-身份伪造（Impersonation）"><a href="#4-身份伪造（Impersonation）" class="headerlink" title="4. 身份伪造（Impersonation）"></a>4. 身份伪造（Impersonation）</h3><p>攻击者可以：</p><ul><li>创建与真实网站相似的钓鱼网站</li><li>通过DNS劫持将用户引导至恶意服务器</li><li>用户无法验证服务器的真实身份</li></ul><h3 id="5-重放攻击（Replay-Attack）"><a href="#5-重放攻击（Replay-Attack）" class="headerlink" title="5. 重放攻击（Replay Attack）"></a>5. 重放攻击（Replay Attack）</h3><p>攻击者可以：</p><ul><li>截获并保存有效的请求</li><li>在后续时间重复发送这些请求</li><li>可能导致重复操作（如重复支付）</li></ul><h2 id="HTTPS的安全保障机制"><a href="#HTTPS的安全保障机制" class="headerlink" title="HTTPS的安全保障机制"></a>HTTPS的安全保障机制</h2><h3 id="1-加密传输（Encryption）"><a href="#1-加密传输（Encryption）" class="headerlink" title="1. 加密传输（Encryption）"></a>1. 加密传输（Encryption）</h3><p>HTTPS使用对称加密算法对传输数据进行加密，即使数据被截获，攻击者也无法读取其内容。现代HTTPS通常使用AES-256-GCM等强加密算法，破解难度极高。</p><h3 id="2-身份认证（Authentication）"><a href="#2-身份认证（Authentication）" class="headerlink" title="2. 身份认证（Authentication）"></a>2. 身份认证（Authentication）</h3><p>通过数字证书机制，HTTPS确保用户连接的是真实的服务器，而不是钓鱼网站。证书由受信任的CA（如Let’s Encrypt、DigiCert）签发，浏览器内置了这些CA的根证书。</p><h3 id="3-数据完整性（Integrity）"><a href="#3-数据完整性（Integrity）" class="headerlink" title="3. 数据完整性（Integrity）"></a>3. 数据完整性（Integrity）</h3><p>HTTPS使用MAC（Message Authentication Code）机制，确保数据在传输过程中未被篡改。如果数据被修改，接收方能够检测到并拒绝该数据。</p><h3 id="4-防重放保护"><a href="#4-防重放保护" class="headerlink" title="4. 防重放保护"></a>4. 防重放保护</h3><p>TLS协议包含时间戳和随机数机制，可以有效防止重放攻击。</p><h2 id="HTTPS的性能考量"><a href="#HTTPS的性能考量" class="headerlink" title="HTTPS的性能考量"></a>HTTPS的性能考量</h2><h3 id="性能开销来源"><a href="#性能开销来源" class="headerlink" title="性能开销来源"></a>性能开销来源</h3><ol><li><strong>TLS握手延迟</strong>：首次连接需要额外的往返时间（RTT）完成握手</li><li><strong>加密&#x2F;解密计算</strong>：CPU需要处理加密和解密操作</li><li><strong>证书验证</strong>：需要验证证书链，可能涉及OCSP查询</li></ol><h3 id="性能优化策略"><a href="#性能优化策略" class="headerlink" title="性能优化策略"></a>性能优化策略</h3><ol><li><strong>TLS会话复用</strong>：通过Session ID或Session Ticket复用已建立的会话，避免重复握手</li><li><strong>HTTP&#x2F;2 + HTTPS</strong>：HTTP&#x2F;2的多路复用和头部压缩可以进一步提升性能</li><li><strong>TLS 1.3</strong>：简化握手过程，减少RTT次数</li><li><strong>CDN加速</strong>：使用CDN可以缩短握手距离，降低延迟</li><li><strong>硬件加速</strong>：使用支持AES-NI的CPU可以加速加密计算</li></ol><h3 id="性能对比"><a href="#性能对比" class="headerlink" title="性能对比"></a>性能对比</h3><p>虽然HTTPS存在一定的性能开销，但在现代硬件和优化技术下，这个开销已经非常小：</p><ul><li><strong>握手延迟</strong>：通常增加1-2个RTT（约50-200ms）</li><li><strong>加密开销</strong>：现代CPU的AES-NI指令集可以将加密开销降低到可忽略的程度</li><li><strong>实际影响</strong>：对于大多数应用，HTTPS的性能影响小于5%</li></ul><h2 id="HTTPS的局限性"><a href="#HTTPS的局限性" class="headerlink" title="HTTPS的局限性"></a>HTTPS的局限性</h2><h3 id="HTTPS并非万能"><a href="#HTTPS并非万能" class="headerlink" title="HTTPS并非万能"></a>HTTPS并非万能</h3><p>虽然HTTPS提供了强大的传输层安全保障，但它并不能解决所有安全问题：</p><ol><li><p><strong>传输安全 ≠ 业务安全</strong></p><ul><li>HTTPS只保护数据传输过程，不保护服务器端的数据存储</li><li>不能防止服务器被入侵</li><li>不能防止应用层的安全漏洞（如SQL注入、XSS）</li></ul></li><li><p><strong>证书管理问题</strong></p><ul><li>证书过期可能导致服务中断</li><li>私钥泄露会带来严重安全风险</li><li>证书链配置错误可能导致验证失败</li></ul></li><li><p><strong>用户安全意识</strong></p><ul><li>用户可能忽略浏览器安全警告</li><li>用户可能安装不受信任的根证书</li><li>用户可能成为社会工程学攻击的受害者</li></ul></li><li><p><strong>性能考虑</strong></p><ul><li>对于高并发场景，加密计算可能成为瓶颈</li><li>移动设备上的性能影响可能更明显</li></ul></li></ol><h2 id="实际应用"><a href="#实际应用" class="headerlink" title="实际应用"></a>实际应用</h2><h3 id="何时使用HTTPS"><a href="#何时使用HTTPS" class="headerlink" title="何时使用HTTPS"></a>何时使用HTTPS</h3><ol><li><strong>所有涉及用户隐私的网站</strong>：登录、支付、个人信息等</li><li><strong>API接口</strong>：特别是移动应用的后端API</li><li><strong>管理后台</strong>：防止管理员凭证泄露</li><li><strong>搜索引擎优化</strong>：提升SEO排名</li><li><strong>合规要求</strong>：满足GDPR、PCI DSS等法规要求</li></ol><h3 id="何时可以使用HTTP"><a href="#何时可以使用HTTP" class="headerlink" title="何时可以使用HTTP"></a>何时可以使用HTTP</h3><ol><li><strong>纯静态内容</strong>：不涉及敏感信息的公开内容</li><li><strong>内网服务</strong>：在受信任的内部网络环境中</li><li><strong>开发测试环境</strong>：本地开发调试</li></ol><h3 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h3><ol><li><strong>强制HTTPS</strong>：使用HSTS（HTTP Strict Transport Security）头强制使用HTTPS</li><li><strong>证书管理</strong>：使用自动化工具（如Certbot）管理证书续期</li><li><strong>安全配置</strong>：禁用不安全的TLS版本和加密套件</li><li><strong>监控告警</strong>：监控证书过期时间和安全事件</li><li><strong>定期更新</strong>：及时更新TLS版本和加密算法</li></ol>]]></content>
      
      
      <categories>
          
          <category> 计网 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> http </tag>
            
            <tag> https </tag>
            
            <tag> tls </tag>
            
            <tag> ssl </tag>
            
            <tag> 网络安全 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>乐观锁和悲观锁</title>
      <link href="/JasmineRain.github.io/2026/01/12/%E4%B9%90%E8%A7%82%E9%94%81%E5%92%8C%E6%82%B2%E8%A7%82%E9%94%81/"/>
      <url>/JasmineRain.github.io/2026/01/12/%E4%B9%90%E8%A7%82%E9%94%81%E5%92%8C%E6%82%B2%E8%A7%82%E9%94%81/</url>
      
        <content type="html"><![CDATA[<h2 id="核心概念总结"><a href="#核心概念总结" class="headerlink" title="核心概念总结"></a>核心概念总结</h2><p>在深入细节之前，让我们先理解两种锁的核心思想：</p><ul><li><strong>悲观锁（Pessimistic Locking）</strong>：假设并发冲突一定会发生，在操作数据前先加锁，其他线程&#x2F;事务必须等待。适合高并发冲突场景，通过加锁保证安全。</li><li><strong>乐观锁（Optimistic Locking）</strong>：假设并发冲突很少发生，不加锁直接操作，提交时检测是否被别人改过。适合读多写少场景，通过版本检验或CAS保证一致性。</li></ul><p>这两种策略的选择，本质上是在<strong>性能</strong>和<strong>安全性</strong>之间的权衡。</p><h2 id="悲观锁（Pessimistic-Locking）"><a href="#悲观锁（Pessimistic-Locking）" class="headerlink" title="悲观锁（Pessimistic Locking）"></a>悲观锁（Pessimistic Locking）</h2><h3 id="核心思想"><a href="#核心思想" class="headerlink" title="核心思想"></a>核心思想</h3><p>悲观锁采用”先下手为强”的策略：<strong>假设并发冲突一定会发生，因此在操作数据前先加锁，其他线程&#x2F;事务必须等待锁释放后才能操作</strong>。</p><p>这种策略类似于现实生活中的”先到先得”：当你需要操作某个资源时，先把它锁起来，确保在你操作完成之前，其他人无法修改它。</p><h3 id="工作原理"><a href="#工作原理" class="headerlink" title="工作原理"></a>工作原理</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">线程A: 获取锁 → 操作数据 → 提交事务 → 释放锁</span><br><span class="line">线程B: 等待... → 等待... → 获取锁 → 操作数据 → 提交事务 → 释放锁</span><br></pre></td></tr></table></figure><h3 id="常见实现方式"><a href="#常见实现方式" class="headerlink" title="常见实现方式"></a>常见实现方式</h3><h4 id="1-数据库层面的悲观锁"><a href="#1-数据库层面的悲观锁" class="headerlink" title="1. 数据库层面的悲观锁"></a>1. 数据库层面的悲观锁</h4><p><strong>MySQL&#x2F;PostgreSQL</strong>：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 行级锁（排他锁）</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> account <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">FOR</span> <span class="keyword">UPDATE</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 在事务中，这条记录会被锁定，直到事务提交</span></span><br><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> account <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">FOR</span> <span class="keyword">UPDATE</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> account <span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">-</span> <span class="number">100</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">COMMIT</span>;  <span class="comment">-- 提交后锁才释放</span></span><br></pre></td></tr></table></figure><p><strong>SQL Server</strong>：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 使用UPDLOCK提示</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> account <span class="keyword">WITH</span> (UPDLOCK) <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure><h4 id="2-Java语言层面的悲观锁"><a href="#2-Java语言层面的悲观锁" class="headerlink" title="2. Java语言层面的悲观锁"></a>2. Java语言层面的悲观锁</h4><p><strong>synchronized关键字</strong>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Account</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">balance</span> <span class="operator">=</span> <span class="number">1000</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 方法级锁</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">withdraw</span><span class="params">(<span class="type">int</span> amount)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (balance &gt;= amount) &#123;</span><br><span class="line">            balance -= amount;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 代码块锁</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transfer</span><span class="params">(Account target, <span class="type">int</span> amount)</span> &#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (<span class="built_in">this</span>) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (target) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">this</span>.balance &gt;= amount) &#123;</span><br><span class="line">                    <span class="built_in">this</span>.balance -= amount;</span><br><span class="line">                    target.balance += amount;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ReentrantLock（可重入锁）</strong>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.ReentrantLock;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Account</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">balance</span> <span class="operator">=</span> <span class="number">1000</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">ReentrantLock</span> <span class="variable">lock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantLock</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">withdraw</span><span class="params">(<span class="type">int</span> amount)</span> &#123;</span><br><span class="line">        lock.lock();  <span class="comment">// 获取锁</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (balance &gt;= amount) &#123;</span><br><span class="line">                balance -= amount;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            lock.unlock();  <span class="comment">// 确保释放锁</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-其他语言的实现"><a href="#3-其他语言的实现" class="headerlink" title="3. 其他语言的实现"></a>3. 其他语言的实现</h4><p><strong>Python</strong>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Account</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.balance = <span class="number">1000</span></span><br><span class="line">        <span class="variable language_">self</span>.lock = threading.Lock()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">withdraw</span>(<span class="params">self, amount</span>):</span><br><span class="line">        <span class="keyword">with</span> <span class="variable language_">self</span>.lock:  <span class="comment"># 自动获取和释放锁</span></span><br><span class="line">            <span class="keyword">if</span> <span class="variable language_">self</span>.balance &gt;= amount:</span><br><span class="line">                <span class="variable language_">self</span>.balance -= amount</span><br></pre></td></tr></table></figure><h3 id="详细示例：银行转账"><a href="#详细示例：银行转账" class="headerlink" title="详细示例：银行转账"></a>详细示例：银行转账</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 事务1：用户A向用户B转账100元</span></span><br><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line"><span class="comment">-- 锁定两个账户</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> account <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">FOR</span> <span class="keyword">UPDATE</span>;  <span class="comment">-- 账户A</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> account <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">2</span> <span class="keyword">FOR</span> <span class="keyword">UPDATE</span>;  <span class="comment">-- 账户B</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 检查余额并转账</span></span><br><span class="line"><span class="keyword">UPDATE</span> account <span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">-</span> <span class="number">100</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> account <span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">+</span> <span class="number">100</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 事务2：如果同时执行，必须等待事务1完成</span></span><br><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> account <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">FOR</span> <span class="keyword">UPDATE</span>;  <span class="comment">-- 等待事务1释放锁</span></span><br><span class="line"><span class="comment">-- ... 其他操作</span></span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure><h3 id="优缺点分析"><a href="#优缺点分析" class="headerlink" title="优缺点分析"></a>优缺点分析</h3><h4 id="✅-优点"><a href="#✅-优点" class="headerlink" title="✅ 优点"></a>✅ 优点</h4><ol><li><strong>简单直接</strong>：实现逻辑清晰，容易理解</li><li><strong>数据一致性强</strong>：通过锁机制保证数据不会被并发修改</li><li><strong>适合高冲突场景</strong>：当并发冲突频繁时，悲观锁能有效避免数据不一致</li><li><strong>避免重试开销</strong>：不需要像乐观锁那样可能反复重试</li></ol><h4 id="❌-缺点"><a href="#❌-缺点" class="headerlink" title="❌ 缺点"></a>❌ 缺点</h4><ol><li><strong>性能较差</strong>：线程阻塞导致吞吐量下降</li><li><strong>容易产生死锁</strong>：多个锁的获取顺序不当可能导致死锁</li><li><strong>扩展性不好</strong>：在高并发场景下，大量线程等待会严重影响性能</li><li><strong>资源占用</strong>：锁会占用系统资源，降低系统整体性能</li></ol><h3 id="死锁问题"><a href="#死锁问题" class="headerlink" title="死锁问题"></a>死锁问题</h3><p>悲观锁容易产生死锁，需要特别注意：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 死锁示例：两个线程以不同顺序获取锁</span></span><br><span class="line"><span class="comment">// 线程1: 先锁A，再锁B</span></span><br><span class="line"><span class="comment">// 线程2: 先锁B，再锁A</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 解决方案1：统一锁的获取顺序</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transfer</span><span class="params">(Account from, Account to, <span class="type">int</span> amount)</span> &#123;</span><br><span class="line">    <span class="type">Account</span> <span class="variable">first</span> <span class="operator">=</span> from.id &lt; to.id ? from : to;</span><br><span class="line">    <span class="type">Account</span> <span class="variable">second</span> <span class="operator">=</span> from.id &lt; to.id ? to : from;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">synchronized</span> (first) &#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (second) &#123;</span><br><span class="line">            <span class="comment">// 转账逻辑</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 解决方案2：使用超时锁</span></span><br><span class="line"><span class="type">ReentrantLock</span> <span class="variable">lock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantLock</span>();</span><br><span class="line"><span class="keyword">if</span> (lock.tryLock(<span class="number">5</span>, TimeUnit.SECONDS)) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 操作</span></span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        lock.unlock();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="适用场景"><a href="#适用场景" class="headerlink" title="适用场景"></a>适用场景</h3><h4 id="1-银行转账系统"><a href="#1-银行转账系统" class="headerlink" title="1. 银行转账系统"></a>1. 银行转账系统</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 必须保证账户余额的强一致性</span></span><br><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> account <span class="keyword">WHERE</span> id <span class="operator">=</span> ? <span class="keyword">FOR</span> <span class="keyword">UPDATE</span>;</span><br><span class="line"><span class="comment">-- 检查余额、转账等操作</span></span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure><h4 id="2-库存强一致性要求"><a href="#2-库存强一致性要求" class="headerlink" title="2. 库存强一致性要求"></a>2. 库存强一致性要求</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 电商系统中，库存必须准确</span></span><br><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line"><span class="keyword">SELECT</span> stock <span class="keyword">FROM</span> product <span class="keyword">WHERE</span> id <span class="operator">=</span> ? <span class="keyword">FOR</span> <span class="keyword">UPDATE</span>;</span><br><span class="line"><span class="comment">-- 检查库存是否充足</span></span><br><span class="line"><span class="keyword">UPDATE</span> product <span class="keyword">SET</span> stock <span class="operator">=</span> stock <span class="operator">-</span> <span class="number">1</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> ? <span class="keyword">AND</span> stock <span class="operator">&gt;</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure><h4 id="3-并发冲突非常频繁的场景"><a href="#3-并发冲突非常频繁的场景" class="headerlink" title="3. 并发冲突非常频繁的场景"></a>3. 并发冲突非常频繁的场景</h4><ul><li>抢票系统</li><li>秒杀系统（如果冲突率极高）</li><li>账户余额操作</li></ul><h4 id="4-数据完整性要求极高的场景"><a href="#4-数据完整性要求极高的场景" class="headerlink" title="4. 数据完整性要求极高的场景"></a>4. 数据完整性要求极高的场景</h4><ul><li>金融交易</li><li>医疗记录</li><li>法律文档</li></ul><h2 id="乐观锁（Optimistic-Locking）"><a href="#乐观锁（Optimistic-Locking）" class="headerlink" title="乐观锁（Optimistic Locking）"></a>乐观锁（Optimistic Locking）</h2><h3 id="核心思想-1"><a href="#核心思想-1" class="headerlink" title="核心思想"></a>核心思想</h3><p>乐观锁采用”先操作，后检查”的策略：<strong>假设并发冲突很少发生，因此不加锁直接操作数据，在提交时检测数据是否被别人修改过</strong>。</p><p>这种策略类似于”先到先得”的另一种理解：相信大多数情况下不会有人同时修改，先进行操作，如果发现冲突再处理。</p><h3 id="工作原理-1"><a href="#工作原理-1" class="headerlink" title="工作原理"></a>工作原理</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">线程A: 读取数据(version=1) → 修改数据 → 提交时检查version → version仍为1 → 提交成功</span><br><span class="line">线程B: 读取数据(version=1) → 修改数据 → 提交时检查version → version已变为2 → 提交失败 → 重试</span><br></pre></td></tr></table></figure><h3 id="常见实现方式-1"><a href="#常见实现方式-1" class="headerlink" title="常见实现方式"></a>常见实现方式</h3><h4 id="1-版本号机制（Version-Number）"><a href="#1-版本号机制（Version-Number）" class="headerlink" title="1. 版本号机制（Version Number）"></a>1. 版本号机制（Version Number）</h4><p>这是最常见的乐观锁实现方式，通过在数据表中增加一个版本号字段来实现。</p><p><strong>表结构设计</strong>：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> account (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">    balance <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">2</span>),</span><br><span class="line">    version <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>  <span class="comment">-- 版本号字段</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p><strong>更新操作</strong>：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 第一步：读取数据（包含版本号）</span></span><br><span class="line"><span class="keyword">SELECT</span> id, balance, version <span class="keyword">FROM</span> account <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="comment">-- 假设读取到：balance = 1000, version = 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 第二步：更新时检查版本号</span></span><br><span class="line"><span class="keyword">UPDATE</span> account</span><br><span class="line"><span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">-</span> <span class="number">100</span>,</span><br><span class="line">    version <span class="operator">=</span> version <span class="operator">+</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">AND</span> version <span class="operator">=</span> <span class="number">3</span>;  <span class="comment">-- 关键：WHERE条件包含版本号检查</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 如果受影响行数为0，说明版本号不匹配，数据已被修改</span></span><br></pre></td></tr></table></figure><p><strong>完整示例</strong>：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 事务1</span></span><br><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line"><span class="keyword">SELECT</span> balance, version <span class="keyword">FROM</span> account <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="comment">-- 读取到 balance=1000, version=1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 事务2（并发执行）</span></span><br><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line"><span class="keyword">SELECT</span> balance, version <span class="keyword">FROM</span> account <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="comment">-- 也读取到 balance=1000, version=1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 事务1先提交</span></span><br><span class="line"><span class="keyword">UPDATE</span> account </span><br><span class="line"><span class="keyword">SET</span> balance <span class="operator">=</span> <span class="number">900</span>, version <span class="operator">=</span> <span class="number">2</span> </span><br><span class="line"><span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">AND</span> version <span class="operator">=</span> <span class="number">1</span>;  <span class="comment">-- 成功，受影响1行</span></span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 事务2后提交</span></span><br><span class="line"><span class="keyword">UPDATE</span> account </span><br><span class="line"><span class="keyword">SET</span> balance <span class="operator">=</span> <span class="number">900</span>, version <span class="operator">=</span> <span class="number">2</span> </span><br><span class="line"><span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">AND</span> version <span class="operator">=</span> <span class="number">1</span>;  <span class="comment">-- 失败，受影响0行（version已经是2了）</span></span><br><span class="line"><span class="comment">-- 需要回滚并重试</span></span><br><span class="line"><span class="keyword">ROLLBACK</span>;</span><br></pre></td></tr></table></figure><h4 id="2-CAS机制（Compare-And-Swap）"><a href="#2-CAS机制（Compare-And-Swap）" class="headerlink" title="2. CAS机制（Compare And Swap）"></a>2. CAS机制（Compare And Swap）</h4><p>CAS是CPU级别的原子操作，Java的<code>Atomic</code>类就是基于CAS实现的。</p><p><strong>Java中的CAS</strong>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.atomic.AtomicInteger;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Counter</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">AtomicInteger</span> <span class="variable">count</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>(<span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">increment</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">int</span> current;</span><br><span class="line">        <span class="type">int</span> next;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            current = count.get();  <span class="comment">// 读取当前值</span></span><br><span class="line">            next = current + <span class="number">1</span>;     <span class="comment">// 计算新值</span></span><br><span class="line">            <span class="comment">// CAS操作：如果当前值仍为current，则更新为next</span></span><br><span class="line">        &#125; <span class="keyword">while</span> (!count.compareAndSet(current, next));</span><br><span class="line">        <span class="comment">// 如果CAS失败（说明值已被修改），循环重试</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">get</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> count.get();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>CAS的工作原理</strong>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// CAS操作的伪代码</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">compareAndSet</span><span class="params">(<span class="type">int</span> expected, <span class="type">int</span> update)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.value == expected) &#123;  <span class="comment">// 比较当前值是否等于期望值</span></span><br><span class="line">        <span class="built_in">this</span>.value = update;        <span class="comment">// 如果相等，更新为新值</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;  <span class="comment">// 不相等，说明已被其他线程修改</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>更多Atomic类的使用</strong>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// AtomicInteger</span></span><br><span class="line"><span class="type">AtomicInteger</span> <span class="variable">atomicInt</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>(<span class="number">0</span>);</span><br><span class="line">atomicInt.compareAndSet(<span class="number">0</span>, <span class="number">1</span>);  <span class="comment">// 如果当前值是0，则设置为1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// AtomicReference（用于对象）</span></span><br><span class="line">AtomicReference&lt;String&gt; atomicRef = <span class="keyword">new</span> <span class="title class_">AtomicReference</span>&lt;&gt;(<span class="string">&quot;initial&quot;</span>);</span><br><span class="line">atomicRef.compareAndSet(<span class="string">&quot;initial&quot;</span>, <span class="string">&quot;updated&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// AtomicStampedReference（带版本戳，解决ABA问题）</span></span><br><span class="line">AtomicStampedReference&lt;String&gt; atomicStamped = </span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">AtomicStampedReference</span>&lt;&gt;(<span class="string">&quot;value&quot;</span>, <span class="number">1</span>);</span><br><span class="line"><span class="type">int</span>[] stampHolder = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">1</span>];</span><br><span class="line"><span class="type">String</span> <span class="variable">current</span> <span class="operator">=</span> atomicStamped.get(stampHolder);</span><br><span class="line">atomicStamped.compareAndSet(current, <span class="string">&quot;new&quot;</span>, stampHolder[<span class="number">0</span>], stampHolder[<span class="number">0</span>] + <span class="number">1</span>);</span><br></pre></td></tr></table></figure><h4 id="3-时间戳机制"><a href="#3-时间戳机制" class="headerlink" title="3. 时间戳机制"></a>3. 时间戳机制</h4><p>使用时间戳代替版本号（较少使用，因为时间戳可能不准确）：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> account (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">    balance <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">2</span>),</span><br><span class="line">    update_time <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">UPDATE</span> account</span><br><span class="line"><span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">-</span> <span class="number">100</span></span><br><span class="line"><span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">AND</span> update_time <span class="operator">=</span> <span class="string">&#x27;2026-01-12 10:00:00&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="完整示例：版本号实现"><a href="#完整示例：版本号实现" class="headerlink" title="完整示例：版本号实现"></a>完整示例：版本号实现</h3><p><strong>Java + MyBatis实现</strong>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Entity类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Account</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> BigDecimal balance;</span><br><span class="line">    <span class="keyword">private</span> Integer version;  <span class="comment">// 版本号</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// getters and setters</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Mapper接口</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AccountMapper</span> &#123;</span><br><span class="line">    Account <span class="title function_">selectById</span><span class="params">(Long id)</span>;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">updateWithVersion</span><span class="params">(Account account)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Mapper XML</span></span><br><span class="line">&lt;!-- 更新时检查版本号 --&gt;</span><br><span class="line">&lt;update id=<span class="string">&quot;updateWithVersion&quot;</span>&gt;</span><br><span class="line">    UPDATE account</span><br><span class="line">    <span class="type">SET</span> <span class="variable">balance</span> <span class="operator">=</span> #&#123;balance&#125;,</span><br><span class="line">        version = version + <span class="number">1</span></span><br><span class="line">    <span class="type">WHERE</span> <span class="variable">id</span> <span class="operator">=</span> #&#123;id&#125; <span class="type">AND</span> <span class="variable">version</span> <span class="operator">=</span> #&#123;version&#125;</span><br><span class="line">&lt;/update&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Service层实现</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AccountMapper accountMapper;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">transfer</span><span class="params">(Long fromId, Long toId, BigDecimal amount)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">maxRetries</span> <span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">retries</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> (retries &lt; maxRetries) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">// 读取账户信息（包含版本号）</span></span><br><span class="line">                <span class="type">Account</span> <span class="variable">from</span> <span class="operator">=</span> accountMapper.selectById(fromId);</span><br><span class="line">                <span class="type">Account</span> <span class="variable">to</span> <span class="operator">=</span> accountMapper.selectById(toId);</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// 检查余额</span></span><br><span class="line">                <span class="keyword">if</span> (from.getBalance().compareTo(amount) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// 更新账户</span></span><br><span class="line">                from.setBalance(from.getBalance().subtract(amount));</span><br><span class="line">                to.setBalance(to.getBalance().add(amount));</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// 乐观锁更新</span></span><br><span class="line">                <span class="type">int</span> <span class="variable">rows1</span> <span class="operator">=</span> accountMapper.updateWithVersion(from);</span><br><span class="line">                <span class="type">int</span> <span class="variable">rows2</span> <span class="operator">=</span> accountMapper.updateWithVersion(to);</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// 如果更新成功（受影响行数&gt;0），说明版本号匹配</span></span><br><span class="line">                <span class="keyword">if</span> (rows1 &gt; <span class="number">0</span> &amp;&amp; rows2 &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// 更新失败，说明版本号不匹配，重试</span></span><br><span class="line">                retries++;</span><br><span class="line">                Thread.sleep(<span class="number">10</span>);  <span class="comment">// 短暂等待后重试</span></span><br><span class="line">                </span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                retries++;</span><br><span class="line">                <span class="keyword">if</span> (retries &gt;= maxRetries) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;转账失败，重试次数超限&quot;</span>, e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ABA问题及解决方案"><a href="#ABA问题及解决方案" class="headerlink" title="ABA问题及解决方案"></a>ABA问题及解决方案</h3><p><strong>ABA问题</strong>：值从A变成B，再变回A，CAS会认为值没有变化。</p><p><strong>解决方案1：版本号&#x2F;时间戳</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用AtomicStampedReference</span></span><br><span class="line">AtomicStampedReference&lt;Integer&gt; atomic = <span class="keyword">new</span> <span class="title class_">AtomicStampedReference</span>&lt;&gt;(<span class="number">100</span>, <span class="number">1</span>);</span><br><span class="line"><span class="type">int</span>[] stamp = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> <span class="variable">value</span> <span class="operator">=</span> atomic.get(stamp);  <span class="comment">// value=100, stamp[0]=1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 即使值变回100，版本号也不同</span></span><br><span class="line">atomic.compareAndSet(<span class="number">100</span>, <span class="number">200</span>, <span class="number">1</span>, <span class="number">2</span>);  <span class="comment">// 检查值和版本号</span></span><br></pre></td></tr></table></figure><p><strong>解决方案2：使用版本号字段</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 数据库中的版本号机制天然解决了ABA问题</span></span><br><span class="line"><span class="keyword">UPDATE</span> account <span class="keyword">SET</span> balance <span class="operator">=</span> <span class="number">200</span>, version <span class="operator">=</span> version <span class="operator">+</span> <span class="number">1</span> </span><br><span class="line"><span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">AND</span> version <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="comment">-- 即使balance变回原来的值，version也会递增</span></span><br></pre></td></tr></table></figure><h3 id="优缺点分析-1"><a href="#优缺点分析-1" class="headerlink" title="优缺点分析"></a>优缺点分析</h3><h4 id="✅-优点-1"><a href="#✅-优点-1" class="headerlink" title="✅ 优点"></a>✅ 优点</h4><ol><li><strong>不阻塞线程</strong>：读取和修改操作不需要加锁，提高了并发性能</li><li><strong>性能好</strong>：在低冲突场景下，性能远优于悲观锁</li><li><strong>并发能力强</strong>：多个线程可以同时读取，提高了系统吞吐量</li><li><strong>避免死锁</strong>：不需要获取锁，自然避免了死锁问题</li><li><strong>适合分布式系统</strong>：在分布式环境下更容易实现</li></ol><h4 id="❌-缺点-1"><a href="#❌-缺点-1" class="headerlink" title="❌ 缺点"></a>❌ 缺点</h4><ol><li><strong>可能反复重试</strong>：如果冲突频繁，可能需要多次重试才能成功</li><li><strong>实现复杂</strong>：需要处理重试逻辑、ABA问题等</li><li><strong>冲突高时反而更慢</strong>：在高冲突场景下，反复重试的开销可能超过悲观锁</li><li><strong>数据可能被丢弃</strong>：如果重试次数达到上限仍失败，操作可能无法完成</li></ol><h3 id="适用场景-1"><a href="#适用场景-1" class="headerlink" title="适用场景"></a>适用场景</h3><h4 id="1-读多写少的场景"><a href="#1-读多写少的场景" class="headerlink" title="1. 读多写少的场景"></a>1. 读多写少的场景</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 文章阅读量统计</span></span><br><span class="line"><span class="comment">// 读操作远多于写操作，适合乐观锁</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">incrementViewCount</span><span class="params">(Long articleId)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">maxRetries</span> <span class="operator">=</span> <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; maxRetries; i++) &#123;</span><br><span class="line">        <span class="type">Article</span> <span class="variable">article</span> <span class="operator">=</span> articleMapper.selectById(articleId);</span><br><span class="line">        article.setViewCount(article.getViewCount() + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (articleMapper.updateWithVersion(article) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;  <span class="comment">// 成功</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 失败则重试</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-秒杀库存（配合重试机制）"><a href="#2-秒杀库存（配合重试机制）" class="headerlink" title="2. 秒杀库存（配合重试机制）"></a>2. 秒杀库存（配合重试机制）</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 秒杀场景：读多写少，但写操作冲突可能较高</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">seckill</span><span class="params">(Long productId, Integer quantity)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">maxRetries</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; maxRetries; i++) &#123;</span><br><span class="line">        <span class="type">Product</span> <span class="variable">product</span> <span class="operator">=</span> productMapper.selectById(productId);</span><br><span class="line">        <span class="keyword">if</span> (product.getStock() &lt; quantity) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;  <span class="comment">// 库存不足</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        product.setStock(product.getStock() - quantity);</span><br><span class="line">        <span class="keyword">if</span> (productMapper.updateWithVersion(product) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;  <span class="comment">// 成功</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 冲突，短暂等待后重试</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">10</span> + i * <span class="number">5</span>);  <span class="comment">// 递增等待时间</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            Thread.currentThread().interrupt();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;  <span class="comment">// 重试次数超限</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-分布式系统"><a href="#3-分布式系统" class="headerlink" title="3. 分布式系统"></a>3. 分布式系统</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 分布式环境下，悲观锁需要分布式锁（如Redis），开销大</span></span><br><span class="line"><span class="comment">// 乐观锁只需要版本号，更适合分布式场景</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DistributedAccountService</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">updateBalance</span><span class="params">(String accountId, BigDecimal amount)</span> &#123;</span><br><span class="line">        <span class="comment">// 乐观锁实现，无需分布式锁</span></span><br><span class="line">        <span class="comment">// 通过版本号在数据库层面保证一致性</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-缓存更新"><a href="#4-缓存更新" class="headerlink" title="4. 缓存更新"></a>4. 缓存更新</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 缓存更新场景</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateCache</span><span class="params">(String key, Object value)</span> &#123;</span><br><span class="line">    <span class="type">CacheEntry</span> <span class="variable">entry</span> <span class="operator">=</span> cache.get(key);</span><br><span class="line">    <span class="keyword">if</span> (entry != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// 使用CAS更新缓存</span></span><br><span class="line">        <span class="keyword">while</span> (!cache.compareAndSet(key, entry, <span class="keyword">new</span> <span class="title class_">CacheEntry</span>(value, entry.version + <span class="number">1</span>))) &#123;</span><br><span class="line">            entry = cache.get(key);  <span class="comment">// 重新读取</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="乐观锁-vs-悲观锁：全面对比"><a href="#乐观锁-vs-悲观锁：全面对比" class="headerlink" title="乐观锁 vs 悲观锁：全面对比"></a>乐观锁 vs 悲观锁：全面对比</h2><h3 id="对比表格"><a href="#对比表格" class="headerlink" title="对比表格"></a>对比表格</h3><table><thead><tr><th>对比项</th><th>乐观锁</th><th>悲观锁</th></tr></thead><tbody><tr><td><strong>核心思想</strong></td><td>假设冲突少，先操作后检查</td><td>假设冲突多，先加锁后操作</td></tr><tr><td><strong>是否加锁</strong></td><td>不加锁</td><td>加锁</td></tr><tr><td><strong>冲突处理</strong></td><td>提交时校验，失败则重试</td><td>操作前阻塞，等待锁释放</td></tr><tr><td><strong>性能</strong></td><td>高（低冲突场景）</td><td>低（线程阻塞）</td></tr><tr><td><strong>并发能力</strong></td><td>强（多读并发）</td><td>弱（串行化执行）</td></tr><tr><td><strong>实现复杂度</strong></td><td>高（需处理重试、ABA问题）</td><td>低（直接加锁）</td></tr><tr><td><strong>数据一致性</strong></td><td>最终一致（可能重试）</td><td>强一致（立即保证）</td></tr><tr><td><strong>死锁风险</strong></td><td>无</td><td>有</td></tr><tr><td><strong>适用场景</strong></td><td>读多写少、冲突率低</td><td>写多冲突高、强一致性要求</td></tr><tr><td><strong>资源消耗</strong></td><td>低（无锁等待）</td><td>高（线程阻塞）</td></tr><tr><td><strong>扩展性</strong></td><td>好（适合分布式）</td><td>差（需要分布式锁）</td></tr></tbody></table><h3 id="性能对比分析"><a href="#性能对比分析" class="headerlink" title="性能对比分析"></a>性能对比分析</h3><h4 id="低冲突场景（冲突率-10-）"><a href="#低冲突场景（冲突率-10-）" class="headerlink" title="低冲突场景（冲突率 &lt; 10%）"></a>低冲突场景（冲突率 &lt; 10%）</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">乐观锁：读取 → 修改 → 检查 → 提交（通常一次成功）</span><br><span class="line">悲观锁：获取锁 → 等待 → 修改 → 提交 → 释放锁</span><br><span class="line"></span><br><span class="line">结果：乐观锁性能明显优于悲观锁</span><br></pre></td></tr></table></figure><h4 id="高冲突场景（冲突率-50-）"><a href="#高冲突场景（冲突率-50-）" class="headerlink" title="高冲突场景（冲突率 &gt; 50%）"></a>高冲突场景（冲突率 &gt; 50%）</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">乐观锁：读取 → 修改 → 检查失败 → 重试 → 检查失败 → 重试...（多次重试）</span><br><span class="line">悲观锁：获取锁 → 等待 → 修改 → 提交 → 释放锁</span><br><span class="line"></span><br><span class="line">结果：悲观锁性能可能优于乐观锁（避免重试开销）</span><br></pre></td></tr></table></figure><h3 id="选择决策树"><a href="#选择决策树" class="headerlink" title="选择决策树"></a>选择决策树</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">需要并发控制？</span><br><span class="line">    │</span><br><span class="line">    ├─ 冲突率如何？</span><br><span class="line">    │   │</span><br><span class="line">    │   ├─ 冲突率低（&lt; 20%）→ 乐观锁</span><br><span class="line">    │   │   │</span><br><span class="line">    │   │   └─ 读多写少？ → 乐观锁（推荐）</span><br><span class="line">    │   │</span><br><span class="line">    │   └─ 冲突率高（&gt; 50%）→ 悲观锁</span><br><span class="line">    │       │</span><br><span class="line">    │       └─ 强一致性要求？ → 悲观锁（推荐）</span><br><span class="line">    │</span><br><span class="line">    ├─ 性能要求？</span><br><span class="line">    │   │</span><br><span class="line">    │   ├─ 高吞吐量 → 乐观锁</span><br><span class="line">    │   │</span><br><span class="line">    │   └─ 低延迟、强一致 → 悲观锁</span><br><span class="line">    │</span><br><span class="line">    └─ 系统架构？</span><br><span class="line">        │</span><br><span class="line">        ├─ 分布式系统 → 乐观锁（更容易实现）</span><br><span class="line">        │</span><br><span class="line">        └─ 单机系统 → 根据冲突率选择</span><br></pre></td></tr></table></figure><h3 id="混合使用策略"><a href="#混合使用策略" class="headerlink" title="混合使用策略"></a>混合使用策略</h3><p>在实际项目中，可以根据不同场景混合使用两种锁：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 读多写少：使用乐观锁</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateOrderStatus</span><span class="params">(Long orderId, String status)</span> &#123;</span><br><span class="line">        <span class="comment">// 乐观锁实现</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">maxRetries</span> <span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; maxRetries; i++) &#123;</span><br><span class="line">            <span class="type">Order</span> <span class="variable">order</span> <span class="operator">=</span> orderMapper.selectById(orderId);</span><br><span class="line">            order.setStatus(status);</span><br><span class="line">            <span class="keyword">if</span> (orderMapper.updateWithVersion(order) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">OptimisticLockException</span>(<span class="string">&quot;更新失败，请重试&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 写多冲突高：使用悲观锁</span></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deductInventory</span><span class="params">(Long productId, Integer quantity)</span> &#123;</span><br><span class="line">        <span class="comment">// 悲观锁实现</span></span><br><span class="line">        <span class="type">Product</span> <span class="variable">product</span> <span class="operator">=</span> productMapper.selectByIdForUpdate(productId);</span><br><span class="line">        <span class="keyword">if</span> (product.getStock() &gt;= quantity) &#123;</span><br><span class="line">            product.setStock(product.getStock() - quantity);</span><br><span class="line">            productMapper.update(product);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">InsufficientStockException</span>(<span class="string">&quot;库存不足&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="实际应用案例"><a href="#实际应用案例" class="headerlink" title="实际应用案例"></a>实际应用案例</h2><h3 id="案例1：电商库存管理"><a href="#案例1：电商库存管理" class="headerlink" title="案例1：电商库存管理"></a>案例1：电商库存管理</h3><p><strong>场景分析</strong>：</p><ul><li>商品浏览（读操作）远多于购买（写操作）</li><li>热门商品购买时冲突率较高</li><li>需要保证库存准确性</li></ul><p><strong>解决方案</strong>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">InventoryService</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 普通商品：读多写少，使用乐观锁</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">purchaseNormalProduct</span><span class="params">(Long productId, Integer quantity)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">maxRetries</span> <span class="operator">=</span> <span class="number">5</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; maxRetries; i++) &#123;</span><br><span class="line">            <span class="type">Product</span> <span class="variable">product</span> <span class="operator">=</span> productMapper.selectById(productId);</span><br><span class="line">            <span class="keyword">if</span> (product.getStock() &lt; quantity) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            product.setStock(product.getStock() - quantity);</span><br><span class="line">            <span class="keyword">if</span> (productMapper.updateWithVersion(product) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 重试</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 秒杀商品：冲突率极高，使用悲观锁</span></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">purchaseSeckillProduct</span><span class="params">(Long productId, Integer quantity)</span> &#123;</span><br><span class="line">        <span class="type">Product</span> <span class="variable">product</span> <span class="operator">=</span> productMapper.selectByIdForUpdate(productId);</span><br><span class="line">        <span class="keyword">if</span> (product.getStock() &gt;= quantity) &#123;</span><br><span class="line">            product.setStock(product.getStock() - quantity);</span><br><span class="line">            productMapper.update(product);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="案例2：账户余额管理"><a href="#案例2：账户余额管理" class="headerlink" title="案例2：账户余额管理"></a>案例2：账户余额管理</h3><p><strong>场景分析</strong>：</p><ul><li>金融系统，强一致性要求</li><li>转账操作冲突率中等</li><li>不允许数据不一致</li></ul><p><strong>解决方案</strong>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 金融转账：使用悲观锁保证强一致性</span></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">transfer</span><span class="params">(Long fromId, Long toId, BigDecimal amount)</span> &#123;</span><br><span class="line">        <span class="comment">// 按ID顺序获取锁，避免死锁</span></span><br><span class="line">        <span class="type">Account</span> <span class="variable">from</span> <span class="operator">=</span> fromId &lt; toId ? </span><br><span class="line">            accountMapper.selectByIdForUpdate(fromId) : </span><br><span class="line">            accountMapper.selectByIdForUpdate(fromId);</span><br><span class="line">        <span class="type">Account</span> <span class="variable">to</span> <span class="operator">=</span> fromId &lt; toId ? </span><br><span class="line">            accountMapper.selectByIdForUpdate(toId) : </span><br><span class="line">            accountMapper.selectByIdForUpdate(toId);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (from.getBalance().compareTo(amount) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            from.setBalance(from.getBalance().subtract(amount));</span><br><span class="line">            to.setBalance(to.getBalance().add(amount));</span><br><span class="line">            accountMapper.update(from);</span><br><span class="line">            accountMapper.update(to);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="案例3：文章点赞系统"><a href="#案例3：文章点赞系统" class="headerlink" title="案例3：文章点赞系统"></a>案例3：文章点赞系统</h3><p><strong>场景分析</strong>：</p><ul><li>读操作（查看文章）远多于写操作（点赞）</li><li>点赞冲突率低</li><li>可以接受偶尔的点赞失败</li></ul><p><strong>解决方案</strong>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArticleService</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 点赞：使用乐观锁</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">likeArticle</span><span class="params">(Long articleId, Long userId)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">maxRetries</span> <span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; maxRetries; i++) &#123;</span><br><span class="line">            <span class="type">Article</span> <span class="variable">article</span> <span class="operator">=</span> articleMapper.selectById(articleId);</span><br><span class="line">            <span class="comment">// 检查是否已点赞</span></span><br><span class="line">            <span class="keyword">if</span> (likeMapper.exists(articleId, userId)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 更新点赞数</span></span><br><span class="line">            article.setLikeCount(article.getLikeCount() + <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span> (articleMapper.updateWithVersion(article) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                likeMapper.insert(articleId, userId);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h2><h3 id="1-选择合适的锁策略"><a href="#1-选择合适的锁策略" class="headerlink" title="1. 选择合适的锁策略"></a>1. 选择合适的锁策略</h3><ul><li><strong>读多写少</strong> → 乐观锁</li><li><strong>写多冲突高</strong> → 悲观锁</li><li><strong>强一致性要求</strong> → 悲观锁</li><li><strong>高并发、低冲突</strong> → 乐观锁</li></ul><h3 id="2-乐观锁实现建议"><a href="#2-乐观锁实现建议" class="headerlink" title="2. 乐观锁实现建议"></a>2. 乐观锁实现建议</h3><ul><li><strong>设置合理的重试次数</strong>：避免无限重试</li><li><strong>使用递增等待时间</strong>：减少冲突</li><li><strong>处理ABA问题</strong>：使用版本号或时间戳</li><li><strong>记录失败日志</strong>：监控冲突率</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">updateWithRetry</span><span class="params">(Long id, Function&lt;Entity, Entity&gt; updater)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">maxRetries</span> <span class="operator">=</span> <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; maxRetries; i++) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Entity</span> <span class="variable">entity</span> <span class="operator">=</span> mapper.selectById(id);</span><br><span class="line">            <span class="type">Entity</span> <span class="variable">updated</span> <span class="operator">=</span> updater.apply(entity);</span><br><span class="line">            <span class="keyword">if</span> (mapper.updateWithVersion(updated) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 递增等待时间</span></span><br><span class="line">            Thread.sleep(<span class="number">10</span> * (i + <span class="number">1</span>));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            logger.warn(<span class="string">&quot;更新失败，重试中...&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-悲观锁实现建议"><a href="#3-悲观锁实现建议" class="headerlink" title="3. 悲观锁实现建议"></a>3. 悲观锁实现建议</h3><ul><li><strong>统一锁的获取顺序</strong>：避免死锁</li><li><strong>使用超时锁</strong>：避免长时间等待</li><li><strong>尽快释放锁</strong>：减少锁持有时间</li><li><strong>避免嵌套锁</strong>：降低死锁风险</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 好的实践：统一锁顺序</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transfer</span><span class="params">(Account a, Account b, BigDecimal amount)</span> &#123;</span><br><span class="line">    <span class="type">Account</span> <span class="variable">first</span> <span class="operator">=</span> a.getId() &lt; b.getId() ? a : b;</span><br><span class="line">    <span class="type">Account</span> <span class="variable">second</span> <span class="operator">=</span> a.getId() &lt; b.getId() ? b : a;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">synchronized</span> (first) &#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (second) &#123;</span><br><span class="line">            <span class="comment">// 转账逻辑</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用超时锁</span></span><br><span class="line"><span class="type">ReentrantLock</span> <span class="variable">lock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantLock</span>();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (lock.tryLock(<span class="number">5</span>, TimeUnit.SECONDS)) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 操作</span></span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            lock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TimeoutException</span>(<span class="string">&quot;获取锁超时&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">    Thread.currentThread().interrupt();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-监控和优化"><a href="#4-监控和优化" class="headerlink" title="4. 监控和优化"></a>4. 监控和优化</h3><ul><li><strong>监控锁冲突率</strong>：决定是否需要调整策略</li><li><strong>监控重试次数</strong>：优化乐观锁的重试逻辑</li><li><strong>监控死锁</strong>：及时发现和解决死锁问题</li><li><strong>性能测试</strong>：在不同场景下测试两种锁的性能</li></ul>]]></content>
      
      
      <categories>
          
          <category> 八股 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 并发控制 </tag>
            
            <tag> 锁机制 </tag>
            
            <tag> 数据库 </tag>
            
            <tag> 多线程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTTP状态码</title>
      <link href="/JasmineRain.github.io/2026/01/12/HTTP%E7%8A%B6%E6%80%81%E7%A0%81/"/>
      <url>/JasmineRain.github.io/2026/01/12/HTTP%E7%8A%B6%E6%80%81%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<h2 id="HTTP状态码总体分类"><a href="#HTTP状态码总体分类" class="headerlink" title="HTTP状态码总体分类"></a>HTTP状态码总体分类</h2><p>HTTP状态码是一个3位数字，由RFC 7231等标准定义。状态码的第一位数字定义了响应的类别，共有5大类：</p><table><thead><tr><th>范围</th><th>类别</th><th>含义</th><th>一句话理解</th></tr></thead><tbody><tr><td>1xx</td><td>信息性状态码</td><td>Informational</td><td>请求已收到，继续处理</td></tr><tr><td>2xx</td><td>成功状态码</td><td>Success</td><td>请求成功处理</td></tr><tr><td>3xx</td><td>重定向状态码</td><td>Redirection</td><td>需要进一步操作以完成请求</td></tr><tr><td>4xx</td><td>客户端错误状态码</td><td>Client Error</td><td>请求有问题，客户端需要修正</td></tr><tr><td>5xx</td><td>服务器错误状态码</td><td>Server Error</td><td>服务器处理请求时出错</td></tr></tbody></table><h3 id="状态码的组成"><a href="#状态码的组成" class="headerlink" title="状态码的组成"></a>状态码的组成</h3><p>HTTP状态码由三部分组成：</p><ul><li><strong>第一位数字</strong>：定义响应类别（1-5）</li><li><strong>后两位数字</strong>：具体状态码（00-99）</li><li><strong>状态文本</strong>：可读的状态描述（如”OK”、”Not Found”）</li></ul><p>例如：<code>200 OK</code>、<code>404 Not Found</code>、<code>500 Internal Server Error</code></p><h2 id="2xx：成功状态码"><a href="#2xx：成功状态码" class="headerlink" title="2xx：成功状态码"></a>2xx：成功状态码</h2><p>2xx系列状态码表示请求已成功被服务器接收、理解并处理。这是Web开发中最常见的状态码类别。</p><h3 id="200-OK-请求成功"><a href="#200-OK-请求成功" class="headerlink" title="200 OK - 请求成功"></a>200 OK - 请求成功</h3><p><strong>含义</strong>：请求成功，服务器已成功处理请求并返回响应数据。</p><p><strong>使用场景</strong>：</p><ul><li>GET请求获取资源成功</li><li>POST&#x2F;PUT请求更新资源成功</li><li>返回正常的业务数据</li></ul><p><strong>示例</strong>：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"></span><br><span class="line"><span class="language-perl">&#123;</span></span><br><span class="line"><span class="language-perl">  <span class="string">&quot;id&quot;</span>: <span class="number">123</span>,</span></span><br><span class="line"><span class="language-perl">  <span class="string">&quot;name&quot;</span>: <span class="string">&quot;示例用户&quot;</span>,</span></span><br><span class="line"><span class="language-perl">  <span class="string">&quot;email&quot;</span>: <span class="string">&quot;user<span class="variable">@example</span>.com&quot;</span></span></span><br><span class="line"><span class="language-perl">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>注意事项</strong>：</p><ul><li>这是最常用的成功状态码</li><li>应该包含请求的资源或操作结果</li><li>对于幂等操作（如GET），200表示资源存在且可访问</li></ul><hr><h3 id="201-Created-资源已创建"><a href="#201-Created-资源已创建" class="headerlink" title="201 Created - 资源已创建"></a>201 Created - 资源已创建</h3><p><strong>含义</strong>：请求成功，并且服务器创建了新的资源。</p><p><strong>使用场景</strong>：</p><ul><li>POST请求创建新资源</li><li>注册新用户</li><li>创建新订单、文章等</li></ul><p><strong>示例</strong>：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">201</span> Created</span><br><span class="line"><span class="attribute">Location</span><span class="punctuation">: </span>/api/users/123</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"></span><br><span class="line"><span class="language-json"><span class="punctuation">&#123;</span></span></span><br><span class="line"><span class="language-json">  <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">123</span><span class="punctuation">,</span></span></span><br><span class="line"><span class="language-json">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;新用户&quot;</span><span class="punctuation">,</span></span></span><br><span class="line"><span class="language-json">  <span class="attr">&quot;created_at&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2026-01-12T10:00:00Z&quot;</span></span></span><br><span class="line"><span class="language-json"><span class="punctuation">&#125;</span></span></span><br></pre></td></tr></table></figure><p><strong>最佳实践</strong>：</p><ul><li>应该包含<code>Location</code>头，指向新创建资源的URI</li><li>响应体应包含创建的资源信息</li><li>适用于创建操作，区别于200（更新操作）</li></ul><hr><h3 id="204-No-Content-无内容"><a href="#204-No-Content-无内容" class="headerlink" title="204 No Content - 无内容"></a>204 No Content - 无内容</h3><p><strong>含义</strong>：服务器成功处理了请求，但没有返回任何内容。</p><p><strong>使用场景</strong>：</p><ul><li>DELETE请求成功删除资源</li><li>PUT请求更新资源，无需返回数据</li><li>某些POST请求（如批量操作）只需确认成功</li></ul><p><strong>示例</strong>：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">204</span> No Content</span><br></pre></td></tr></table></figure><p><strong>注意事项</strong>：</p><ul><li>响应体必须为空</li><li>常用于RESTful API的删除操作</li><li>客户端收到204后，不应更新其缓存视图（除非请求是DELETE）</li></ul><hr><h3 id="其他2xx状态码"><a href="#其他2xx状态码" class="headerlink" title="其他2xx状态码"></a>其他2xx状态码</h3><p><strong>202 Accepted</strong>：请求已接受，但尚未处理完成（异步操作）</p><p><strong>206 Partial Content</strong>：部分内容，用于范围请求（Range Request），常用于大文件下载</p><h2 id="3xx：重定向状态码"><a href="#3xx：重定向状态码" class="headerlink" title="3xx：重定向状态码"></a>3xx：重定向状态码</h2><p>3xx系列状态码表示需要客户端采取进一步的操作才能完成请求。重定向在Web开发中非常常见，特别是在网站迁移、URL规范化、缓存优化等场景。</p><h3 id="301-Moved-Permanently-永久重定向"><a href="#301-Moved-Permanently-永久重定向" class="headerlink" title="301 Moved Permanently - 永久重定向"></a>301 Moved Permanently - 永久重定向</h3><p><strong>含义</strong>：请求的资源已永久移动到新位置，客户端应该使用新的URI访问。</p><p><strong>使用场景</strong>：</p><ul><li>网站域名更换（如从http迁移到https）</li><li>URL结构重构</li><li>资源永久迁移到新地址</li></ul><p><strong>示例</strong>：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">301</span> Moved Permanently</span><br><span class="line"><span class="attribute">Location</span><span class="punctuation">: </span>https://www.example.com/new-path</span><br></pre></td></tr></table></figure><p><strong>重要特性</strong>：</p><ul><li><strong>浏览器会缓存</strong>：客户端会记住这个重定向，以后直接访问新地址</li><li><strong>SEO影响</strong>：搜索引擎会更新索引，将权重转移到新URL</li><li><strong>HTTP方法可能改变</strong>：某些客户端会将POST改为GET（虽然规范不建议）</li></ul><p><strong>最佳实践</strong>：</p><ul><li>只在资源确实永久移动时使用</li><li>确保新URL可访问且正确</li><li>考虑保留旧URL一段时间，返回301重定向</li></ul><hr><h3 id="302-Found-临时重定向"><a href="#302-Found-临时重定向" class="headerlink" title="302 Found - 临时重定向"></a>302 Found - 临时重定向</h3><p><strong>含义</strong>：请求的资源临时从不同的URI响应，客户端应继续使用原URI进行后续请求。</p><p><strong>使用场景</strong>：</p><ul><li>临时维护页面</li><li>登录后跳转</li><li>A&#x2F;B测试</li><li>临时URL变更</li></ul><p><strong>示例</strong>：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">302</span> Found</span><br><span class="line"><span class="attribute">Location</span><span class="punctuation">: </span>/login?redirect=/dashboard</span><br></pre></td></tr></table></figure><p><strong>重要特性</strong>：</p><ul><li><strong>浏览器不缓存</strong>：每次都会请求原地址，服务器决定重定向</li><li><strong>SEO友好</strong>：搜索引擎不会更新索引，原URL权重保留</li><li><strong>HTTP方法保持</strong>：重定向后的请求方法通常不变</li></ul><p><strong>与301的区别</strong>：</p><ul><li>301：永久移动，浏览器缓存，SEO权重转移</li><li>302：临时移动，浏览器不缓存，SEO权重保留</li></ul><hr><h3 id="304-Not-Modified-未修改"><a href="#304-Not-Modified-未修改" class="headerlink" title="304 Not Modified - 未修改"></a>304 Not Modified - 未修改</h3><p><strong>含义</strong>：资源自上次请求后未被修改，客户端可以使用缓存的版本。</p><p><strong>使用场景</strong>：</p><ul><li>浏览器缓存验证</li><li>CDN缓存优化</li><li>减少带宽消耗</li><li>提升页面加载速度</li></ul><p><strong>示例</strong>：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">304</span> Not Modified</span><br><span class="line"><span class="attribute">ETag</span><span class="punctuation">: </span>&quot;33a64df551425fcc55e4d42a148795d9f25f89d4&quot;</span><br><span class="line"><span class="attribute">Last-Modified</span><span class="punctuation">: </span>Wed, 21 Oct 2015 07:28:00 GMT</span><br></pre></td></tr></table></figure><p><strong>工作原理</strong>：</p><ol><li>客户端首次请求资源，服务器返回200和缓存头（ETag或Last-Modified）</li><li>客户端再次请求时，带上<code>If-None-Match</code>（ETag）或<code>If-Modified-Since</code>（Last-Modified）</li><li>服务器比较后，如果未修改，返回304；如果已修改，返回200和新内容</li></ol><p><strong>性能优化关键</strong>：</p><ul><li>减少网络传输，节省带宽</li><li>加快页面加载速度</li><li>降低服务器负载</li></ul><p><strong>实现示例</strong>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 伪代码示例</span></span><br><span class="line"><span class="keyword">if</span> request.headers.get(<span class="string">&#x27;If-None-Match&#x27;</span>) == resource.etag:</span><br><span class="line">    <span class="keyword">return</span> Response(status=<span class="number">304</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">return</span> Response(data=resource.data, headers=&#123;<span class="string">&#x27;ETag&#x27;</span>: resource.etag&#125;)</span><br></pre></td></tr></table></figure><hr><h3 id="其他3xx状态码"><a href="#其他3xx状态码" class="headerlink" title="其他3xx状态码"></a>其他3xx状态码</h3><p><strong>303 See Other</strong>：重定向到另一个URI，且客户端应使用GET方法访问（POST后重定向）</p><p><strong>307 Temporary Redirect</strong>：临时重定向，但要求客户端保持HTTP方法不变（302的严格版本）</p><p><strong>308 Permanent Redirect</strong>：永久重定向，且要求客户端保持HTTP方法不变（301的严格版本）</p><h2 id="4xx：客户端错误状态码"><a href="#4xx：客户端错误状态码" class="headerlink" title="4xx：客户端错误状态码"></a>4xx：客户端错误状态码</h2><p>4xx系列状态码表示客户端发送的请求有错误，服务器无法处理。这类错误通常需要客户端修改请求后才能成功。</p><h3 id="400-Bad-Request-请求错误"><a href="#400-Bad-Request-请求错误" class="headerlink" title="400 Bad Request - 请求错误"></a>400 Bad Request - 请求错误</h3><p><strong>含义</strong>：服务器无法理解客户端的请求，通常是因为请求格式错误。</p><p><strong>常见原因</strong>：</p><ul><li>请求参数缺失或格式错误</li><li>JSON格式不正确，解析失败</li><li>参数类型错误（如期望数字却传了字符串）</li><li>请求体格式不符合要求</li><li>URL编码错误</li></ul><p><strong>示例</strong>：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">400</span> Bad Request</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"></span><br><span class="line"><span class="language-json"><span class="punctuation">&#123;</span></span></span><br><span class="line"><span class="language-json">  <span class="attr">&quot;error&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Invalid request&quot;</span><span class="punctuation">,</span></span></span><br><span class="line"><span class="language-json">  <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Missing required parameter: &#x27;email&#x27;&quot;</span><span class="punctuation">,</span></span></span><br><span class="line"><span class="language-json">  <span class="attr">&quot;details&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span></span><br><span class="line"><span class="language-json">    <span class="attr">&quot;field&quot;</span><span class="punctuation">:</span> <span class="string">&quot;email&quot;</span><span class="punctuation">,</span></span></span><br><span class="line"><span class="language-json">    <span class="attr">&quot;reason&quot;</span><span class="punctuation">:</span> <span class="string">&quot;required&quot;</span></span></span><br><span class="line"><span class="language-json">  <span class="punctuation">&#125;</span></span></span><br><span class="line"><span class="language-json"><span class="punctuation">&#125;</span></span></span><br></pre></td></tr></table></figure><p><strong>最佳实践</strong>：</p><ul><li>返回详细的错误信息，帮助客户端定位问题</li><li>列出所有错误字段，而不是只返回第一个错误</li><li>使用统一的错误响应格式</li></ul><hr><h3 id="401-Unauthorized-未授权"><a href="#401-Unauthorized-未授权" class="headerlink" title="401 Unauthorized - 未授权"></a>401 Unauthorized - 未授权</h3><p><strong>含义</strong>：请求需要身份认证，客户端未提供有效的认证信息。</p><p><strong>使用场景</strong>：</p><ul><li>用户未登录</li><li>Token缺失或格式错误</li><li>Token已过期</li><li>认证信息无效</li></ul><p><strong>示例</strong>：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">401</span> Unauthorized</span><br><span class="line"><span class="attribute">WWW-Authenticate</span><span class="punctuation">: </span>Bearer realm=&quot;api&quot;</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"></span><br><span class="line"><span class="language-json"><span class="punctuation">&#123;</span></span></span><br><span class="line"><span class="language-json">  <span class="attr">&quot;error&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Unauthorized&quot;</span><span class="punctuation">,</span></span></span><br><span class="line"><span class="language-json">  <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Authentication required&quot;</span><span class="punctuation">,</span></span></span><br><span class="line"><span class="language-json">  <span class="attr">&quot;code&quot;</span><span class="punctuation">:</span> <span class="string">&quot;AUTH_REQUIRED&quot;</span></span></span><br><span class="line"><span class="language-json"><span class="punctuation">&#125;</span></span></span><br></pre></td></tr></table></figure><p><strong>重要特性</strong>：</p><ul><li>应该包含<code>WWW-Authenticate</code>响应头，说明认证方式</li><li>客户端收到401后，通常需要重新登录或刷新token</li><li>与403的区别：401是”未认证”，403是”已认证但无权限”</li></ul><p><strong>常见实现</strong>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 伪代码</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> request.headers.get(<span class="string">&#x27;Authorization&#x27;</span>):</span><br><span class="line">    <span class="keyword">return</span> Response(</span><br><span class="line">        status=<span class="number">401</span>,</span><br><span class="line">        headers=&#123;<span class="string">&#x27;WWW-Authenticate&#x27;</span>: <span class="string">&#x27;Bearer&#x27;</span>&#125;,</span><br><span class="line">        data=&#123;<span class="string">&#x27;error&#x27;</span>: <span class="string">&#x27;Authentication required&#x27;</span>&#125;</span><br><span class="line">    )</span><br></pre></td></tr></table></figure><hr><h3 id="403-Forbidden-禁止访问"><a href="#403-Forbidden-禁止访问" class="headerlink" title="403 Forbidden - 禁止访问"></a>403 Forbidden - 禁止访问</h3><p><strong>含义</strong>：服务器理解请求，但拒绝执行。客户端已认证，但没有权限访问该资源。</p><p><strong>使用场景</strong>：</p><ul><li>用户已登录，但权限不足</li><li>访问被管理员禁止的资源</li><li>IP地址被拉黑</li><li>资源访问受限（如付费内容）</li></ul><p><strong>示例</strong>：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">403</span> Forbidden</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"></span><br><span class="line"><span class="language-smalltalk">&#123;</span></span><br><span class="line"><span class="language-smalltalk">  <span class="comment">&quot;error&quot;</span>: <span class="comment">&quot;Forbidden&quot;</span>,</span></span><br><span class="line"><span class="language-smalltalk">  <span class="comment">&quot;message&quot;</span>: <span class="comment">&quot;You do not have permission to access this resource&quot;</span>,</span></span><br><span class="line"><span class="language-smalltalk">  <span class="comment">&quot;required_role&quot;</span>: <span class="comment">&quot;admin&quot;</span></span></span><br><span class="line"><span class="language-smalltalk">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>与401的区别</strong>：</p><ul><li><strong>401 Unauthorized</strong>：未认证，需要登录</li><li><strong>403 Forbidden</strong>：已认证，但无权限</li></ul><p><strong>最佳实践</strong>：</p><ul><li>明确说明权限要求</li><li>不要泄露敏感信息（如”用户存在但密码错误”应返回401，而非403）</li></ul><hr><h3 id="404-Not-Found-资源不存在"><a href="#404-Not-Found-资源不存在" class="headerlink" title="404 Not Found - 资源不存在"></a>404 Not Found - 资源不存在</h3><p><strong>含义</strong>：服务器无法找到请求的资源。</p><p><strong>使用场景</strong>：</p><ul><li>URL路径错误</li><li>资源已被删除</li><li>API路由未配置</li><li>文件不存在</li></ul><p><strong>示例</strong>：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">404</span> Not Found</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"></span><br><span class="line"><span class="language-smalltalk">&#123;</span></span><br><span class="line"><span class="language-smalltalk">  <span class="comment">&quot;error&quot;</span>: <span class="comment">&quot;Not Found&quot;</span>,</span></span><br><span class="line"><span class="language-smalltalk">  <span class="comment">&quot;message&quot;</span>: <span class="comment">&quot;The requested resource does not exist&quot;</span>,</span></span><br><span class="line"><span class="language-smalltalk">  <span class="comment">&quot;path&quot;</span>: <span class="comment">&quot;/api/users/999&quot;</span></span></span><br><span class="line"><span class="language-smalltalk">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>注意事项</strong>：</p><ul><li>不要返回404来隐藏资源存在性（安全考虑，某些场景应返回403）</li><li>提供友好的错误页面或错误信息</li><li>考虑返回相关资源建议（如”您要找的是不是…”）</li></ul><hr><h3 id="405-Method-Not-Allowed-方法不允许"><a href="#405-Method-Not-Allowed-方法不允许" class="headerlink" title="405 Method Not Allowed - 方法不允许"></a>405 Method Not Allowed - 方法不允许</h3><p><strong>含义</strong>：请求的HTTP方法不被允许用于该资源。</p><p><strong>使用场景</strong>：</p><ul><li>对只读资源使用POST&#x2F;PUT&#x2F;DELETE</li><li>API不支持某些HTTP方法</li><li>路由配置错误</li></ul><p><strong>示例</strong>：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">405</span> Method Not Allowed</span><br><span class="line"><span class="attribute">Allow</span><span class="punctuation">: </span>GET, HEAD</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"></span><br><span class="line"><span class="language-prolog">&#123;</span></span><br><span class="line"><span class="language-prolog">  <span class="string">&quot;error&quot;</span>: <span class="string">&quot;Method Not Allowed&quot;</span>,</span></span><br><span class="line"><span class="language-prolog">  <span class="string">&quot;message&quot;</span>: <span class="string">&quot;POST method is not allowed for this resource&quot;</span>,</span></span><br><span class="line"><span class="language-prolog">  <span class="string">&quot;allowed_methods&quot;</span>: [<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;HEAD&quot;</span>]</span></span><br><span class="line"><span class="language-prolog">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>最佳实践</strong>：</p><ul><li>必须包含<code>Allow</code>响应头，列出允许的方法</li><li>帮助客户端了解正确的请求方式</li></ul><hr><h3 id="409-Conflict-资源冲突"><a href="#409-Conflict-资源冲突" class="headerlink" title="409 Conflict - 资源冲突"></a>409 Conflict - 资源冲突</h3><p><strong>含义</strong>：请求与资源的当前状态冲突，无法完成。</p><p><strong>使用场景</strong>：</p><ul><li>创建资源时，资源已存在（如用户名重复）</li><li>更新资源时，版本冲突（乐观锁）</li><li>删除资源时，资源正在被使用</li><li>并发修改冲突</li></ul><p><strong>示例</strong>：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">409</span> Conflict</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"></span><br><span class="line"><span class="language-json"><span class="punctuation">&#123;</span></span></span><br><span class="line"><span class="language-json">  <span class="attr">&quot;error&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Conflict&quot;</span><span class="punctuation">,</span></span></span><br><span class="line"><span class="language-json">  <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Username already exists&quot;</span><span class="punctuation">,</span></span></span><br><span class="line"><span class="language-json">  <span class="attr">&quot;conflict_field&quot;</span><span class="punctuation">:</span> <span class="string">&quot;username&quot;</span><span class="punctuation">,</span></span></span><br><span class="line"><span class="language-json">  <span class="attr">&quot;conflict_value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;john_doe&quot;</span></span></span><br><span class="line"><span class="language-json"><span class="punctuation">&#125;</span></span></span><br></pre></td></tr></table></figure><p><strong>乐观锁示例</strong>：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 客户端请求更新资源</span><br><span class="line">PUT /api/articles/123</span><br><span class="line"><span class="attribute">If-Match</span><span class="punctuation">: </span>&quot;abc123&quot;</span><br><span class="line"></span><br><span class="line"># 服务器检测到版本不匹配</span><br><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">409</span> Conflict</span><br><span class="line">&#123;</span><br><span class="line">  &quot;error&quot;: &quot;Version conflict&quot;,</span><br><span class="line">  &quot;message&quot;: &quot;Resource has been modified by another request&quot;,</span><br><span class="line">  &quot;current_version&quot;: &quot;xyz789&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>最佳实践</strong>：</p><ul><li>提供冲突的详细信息</li><li>对于版本冲突，返回当前版本信息，方便客户端重试</li></ul><hr><h3 id="429-Too-Many-Requests-请求过多"><a href="#429-Too-Many-Requests-请求过多" class="headerlink" title="429 Too Many Requests - 请求过多"></a>429 Too Many Requests - 请求过多</h3><p><strong>含义</strong>：客户端在给定时间内发送了太多请求，需要限流。</p><p><strong>使用场景</strong>：</p><ul><li>API限流保护</li><li>防止恶意刷接口</li><li>防止爬虫过度抓取</li><li>保护服务器资源</li></ul><p><strong>示例</strong>：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">429</span> Too Many Requests</span><br><span class="line"><span class="attribute">Retry-After</span><span class="punctuation">: </span>60</span><br><span class="line"><span class="attribute">X-RateLimit-Limit</span><span class="punctuation">: </span>100</span><br><span class="line"><span class="attribute">X-RateLimit-Remaining</span><span class="punctuation">: </span>0</span><br><span class="line"><span class="attribute">X-RateLimit-Reset</span><span class="punctuation">: </span>1642003200</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"></span><br><span class="line"><span class="language-json"><span class="punctuation">&#123;</span></span></span><br><span class="line"><span class="language-json">  <span class="attr">&quot;error&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Too Many Requests&quot;</span><span class="punctuation">,</span></span></span><br><span class="line"><span class="language-json">  <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Rate limit exceeded&quot;</span><span class="punctuation">,</span></span></span><br><span class="line"><span class="language-json">  <span class="attr">&quot;retry_after&quot;</span><span class="punctuation">:</span> <span class="number">60</span></span></span><br><span class="line"><span class="language-json"><span class="punctuation">&#125;</span></span></span><br></pre></td></tr></table></figure><p><strong>重要响应头</strong>：</p><ul><li><code>Retry-After</code>：告诉客户端多久后可以重试（秒数或HTTP日期）</li><li><code>X-RateLimit-*</code>：自定义限流信息头（非标准但广泛使用）</li></ul><p><strong>限流策略</strong>：</p><ul><li><strong>固定窗口</strong>：每分钟N次请求</li><li><strong>滑动窗口</strong>：最近N秒内M次请求</li><li><strong>令牌桶</strong>：动态分配请求配额</li><li><strong>漏桶</strong>：平滑处理请求速率</li></ul><p><strong>实现示例</strong>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 伪代码</span></span><br><span class="line">rate_limit = check_rate_limit(user_id)</span><br><span class="line"><span class="keyword">if</span> rate_limit.exceeded:</span><br><span class="line">    <span class="keyword">return</span> Response(</span><br><span class="line">        status=<span class="number">429</span>,</span><br><span class="line">        headers=&#123;</span><br><span class="line">            <span class="string">&#x27;Retry-After&#x27;</span>: <span class="built_in">str</span>(rate_limit.retry_after),</span><br><span class="line">            <span class="string">&#x27;X-RateLimit-Limit&#x27;</span>: <span class="built_in">str</span>(rate_limit.limit),</span><br><span class="line">            <span class="string">&#x27;X-RateLimit-Remaining&#x27;</span>: <span class="built_in">str</span>(rate_limit.remaining)</span><br><span class="line">        &#125;</span><br><span class="line">    )</span><br></pre></td></tr></table></figure><hr><h3 id="其他常见4xx状态码"><a href="#其他常见4xx状态码" class="headerlink" title="其他常见4xx状态码"></a>其他常见4xx状态码</h3><p><strong>408 Request Timeout</strong>：请求超时，客户端发送请求时间过长</p><p><strong>410 Gone</strong>：资源已永久删除，且不会有新的地址（比404更明确）</p><p><strong>422 Unprocessable Entity</strong>：请求格式正确，但语义错误（常用于表单验证失败）</p><p><strong>451 Unavailable For Legal Reasons</strong>：因法律原因不可访问（如被政府要求下架的内容）</p><h2 id="5xx：服务器错误状态码"><a href="#5xx：服务器错误状态码" class="headerlink" title="5xx：服务器错误状态码"></a>5xx：服务器错误状态码</h2><p>5xx系列状态码表示服务器处理请求时发生错误。这类错误通常是服务器端的问题，客户端无法通过修改请求来解决。</p><h3 id="500-Internal-Server-Error-服务器内部错误"><a href="#500-Internal-Server-Error-服务器内部错误" class="headerlink" title="500 Internal Server Error - 服务器内部错误"></a>500 Internal Server Error - 服务器内部错误</h3><p><strong>含义</strong>：服务器遇到了意外情况，无法完成请求。</p><p><strong>常见原因</strong>：</p><ul><li>代码bug（空指针、数组越界等）</li><li>未捕获的异常</li><li>数据库连接失败</li><li>配置文件错误</li><li>内存溢出</li><li>第三方服务调用失败</li></ul><p><strong>示例</strong>：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">500</span> Internal Server Error</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"></span><br><span class="line"><span class="language-json"><span class="punctuation">&#123;</span></span></span><br><span class="line"><span class="language-json">  <span class="attr">&quot;error&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Internal Server Error&quot;</span><span class="punctuation">,</span></span></span><br><span class="line"><span class="language-json">  <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;An unexpected error occurred&quot;</span><span class="punctuation">,</span></span></span><br><span class="line"><span class="language-json">  <span class="attr">&quot;request_id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;req_123456789&quot;</span></span></span><br><span class="line"><span class="language-json"><span class="punctuation">&#125;</span></span></span><br></pre></td></tr></table></figure><p><strong>最佳实践</strong>：</p><ul><li><strong>生产环境</strong>：不要返回详细的错误堆栈（安全考虑）</li><li><strong>开发环境</strong>：可以返回详细错误信息便于调试</li><li>记录完整的错误日志（包括堆栈、请求参数等）</li><li>使用请求ID方便追踪问题</li><li>设置错误监控和告警</li></ul><p><strong>错误处理示例</strong>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 伪代码</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    result = process_request(request)</span><br><span class="line">    <span class="keyword">return</span> Response(data=result)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="comment"># 记录详细错误</span></span><br><span class="line">    logger.error(<span class="string">f&quot;Internal error: <span class="subst">&#123;e&#125;</span>&quot;</span>, exc_info=<span class="literal">True</span>, extra=&#123;</span><br><span class="line">        <span class="string">&#x27;request_id&#x27;</span>: request.<span class="built_in">id</span>,</span><br><span class="line">        <span class="string">&#x27;user_id&#x27;</span>: request.user.<span class="built_in">id</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment"># 返回通用错误（生产环境）</span></span><br><span class="line">    <span class="keyword">return</span> Response(</span><br><span class="line">        status=<span class="number">500</span>,</span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&#x27;error&#x27;</span>: <span class="string">&#x27;Internal Server Error&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;request_id&#x27;</span>: request.<span class="built_in">id</span></span><br><span class="line">        &#125;</span><br><span class="line">    )</span><br></pre></td></tr></table></figure><hr><h3 id="502-Bad-Gateway-网关错误"><a href="#502-Bad-Gateway-网关错误" class="headerlink" title="502 Bad Gateway - 网关错误"></a>502 Bad Gateway - 网关错误</h3><p><strong>含义</strong>：作为网关或代理的服务器，从上游服务器收到无效响应。</p><p><strong>使用场景</strong>：</p><ul><li>反向代理（如Nginx）无法从上游服务器获取有效响应</li><li>微服务架构中，API网关无法连接到后端服务</li><li>上游服务崩溃或返回无效响应</li><li>负载均衡器无法连接到后端服务器</li></ul><p><strong>示例</strong>：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">502</span> Bad Gateway</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"></span><br><span class="line"><span class="language-smalltalk">&#123;</span></span><br><span class="line"><span class="language-smalltalk">  <span class="comment">&quot;error&quot;</span>: <span class="comment">&quot;Bad Gateway&quot;</span>,</span></span><br><span class="line"><span class="language-smalltalk">  <span class="comment">&quot;message&quot;</span>: <span class="comment">&quot;Upstream server returned invalid response&quot;</span></span></span><br><span class="line"><span class="language-smalltalk">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>常见原因</strong>：</p><ul><li>上游服务宕机</li><li>上游服务响应格式错误</li><li>网络连接问题</li><li>上游服务超时</li></ul><p><strong>架构示意</strong>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">客户端 → API网关 → 上游服务（异常）</span><br><span class="line">              ↓</span><br><span class="line">          返回502</span><br></pre></td></tr></table></figure><p><strong>解决方案</strong>：</p><ul><li>实现服务健康检查</li><li>配置服务降级策略</li><li>使用熔断器模式</li><li>增加重试机制</li></ul><hr><h3 id="503-Service-Unavailable-服务不可用"><a href="#503-Service-Unavailable-服务不可用" class="headerlink" title="503 Service Unavailable - 服务不可用"></a>503 Service Unavailable - 服务不可用</h3><p><strong>含义</strong>：服务器暂时无法处理请求，通常是由于维护或过载。</p><p><strong>使用场景</strong>：</p><ul><li>服务器正在维护</li><li>服务器过载，无法处理更多请求</li><li>数据库连接池耗尽</li><li>依赖的外部服务不可用</li><li>计划内的停机维护</li></ul><p><strong>示例</strong>：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">503</span> Service Unavailable</span><br><span class="line"><span class="attribute">Retry-After</span><span class="punctuation">: </span>3600</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"></span><br><span class="line"><span class="language-smalltalk">&#123;</span></span><br><span class="line"><span class="language-smalltalk">  <span class="comment">&quot;error&quot;</span>: <span class="comment">&quot;Service Unavailable&quot;</span>,</span></span><br><span class="line"><span class="language-smalltalk">  <span class="comment">&quot;message&quot;</span>: <span class="comment">&quot;The service is temporarily unavailable&quot;</span>,</span></span><br><span class="line"><span class="language-smalltalk">  <span class="comment">&quot;retry_after&quot;</span>: <span class="number">3600</span>,</span></span><br><span class="line"><span class="language-smalltalk">  <span class="comment">&quot;maintenance_mode&quot;</span>: <span class="keyword">true</span></span></span><br><span class="line"><span class="language-smalltalk">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>重要响应头</strong>：</p><ul><li><code>Retry-After</code>：告诉客户端多久后可以重试</li></ul><p><strong>与500的区别</strong>：</p><ul><li><strong>500</strong>：服务器错误，通常是意外情况</li><li><strong>503</strong>：服务不可用，通常是已知的临时情况（维护、过载）</li></ul><p><strong>最佳实践</strong>：</p><ul><li>提供维护页面或友好的错误信息</li><li>设置合理的<code>Retry-After</code>时间</li><li>实现优雅降级</li><li>使用负载均衡和自动扩缩容</li></ul><hr><h3 id="504-Gateway-Timeout-网关超时"><a href="#504-Gateway-Timeout-网关超时" class="headerlink" title="504 Gateway Timeout - 网关超时"></a>504 Gateway Timeout - 网关超时</h3><p><strong>含义</strong>：作为网关或代理的服务器，未能及时从上游服务器收到响应。</p><p><strong>使用场景</strong>：</p><ul><li>上游服务响应时间过长</li><li>网络延迟过高</li><li>上游服务处理超时</li><li>数据库查询超时</li></ul><p><strong>示例</strong>：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">504</span> Gateway Timeout</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"></span><br><span class="line"><span class="language-smalltalk">&#123;</span></span><br><span class="line"><span class="language-smalltalk">  <span class="comment">&quot;error&quot;</span>: <span class="comment">&quot;Gateway Timeout&quot;</span>,</span></span><br><span class="line"><span class="language-smalltalk">  <span class="comment">&quot;message&quot;</span>: <span class="comment">&quot;Upstream server did not respond in time&quot;</span>,</span></span><br><span class="line"><span class="language-smalltalk">  <span class="comment">&quot;timeout&quot;</span>: <span class="number">30</span></span></span><br><span class="line"><span class="language-smalltalk">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>与502的区别</strong>：</p><ul><li><strong>502</strong>：上游服务器返回了无效响应</li><li><strong>504</strong>：上游服务器没有在超时时间内响应</li></ul><p><strong>解决方案</strong>：</p><ul><li>增加超时时间配置</li><li>优化上游服务性能</li><li>实现异步处理</li><li>使用消息队列解耦</li><li>设置合理的超时时间</li></ul><p><strong>超时配置示例</strong>：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Nginx配置示例</span></span><br><span class="line"><span class="attribute">proxy_connect_timeout</span> <span class="number">60s</span>;</span><br><span class="line"><span class="attribute">proxy_send_timeout</span> <span class="number">60s</span>;</span><br><span class="line"><span class="attribute">proxy_read_timeout</span> <span class="number">60s</span>;</span><br></pre></td></tr></table></figure><hr><h3 id="其他5xx状态码"><a href="#其他5xx状态码" class="headerlink" title="其他5xx状态码"></a>其他5xx状态码</h3><p><strong>501 Not Implemented</strong>：服务器不支持请求的功能（如不支持的HTTP方法）</p><p><strong>505 HTTP Version Not Supported</strong>：服务器不支持请求中使用的HTTP协议版本</p><hr><h2 id="状态码选择的最佳实践"><a href="#状态码选择的最佳实践" class="headerlink" title="状态码选择的最佳实践"></a>状态码选择的最佳实践</h2><h3 id="1-遵循RESTful规范"><a href="#1-遵循RESTful规范" class="headerlink" title="1. 遵循RESTful规范"></a>1. 遵循RESTful规范</h3><ul><li><strong>GET</strong>：成功返回200，不存在返回404</li><li><strong>POST</strong>：创建成功返回201，其他成功返回200</li><li><strong>PUT&#x2F;PATCH</strong>：成功返回200或204</li><li><strong>DELETE</strong>：成功返回200或204，不存在返回404</li></ul><h3 id="2-错误处理原则"><a href="#2-错误处理原则" class="headerlink" title="2. 错误处理原则"></a>2. 错误处理原则</h3><ul><li><strong>客户端能修复的错误</strong>：返回4xx，提供详细错误信息</li><li><strong>服务器端错误</strong>：返回5xx，不要泄露内部细节</li><li><strong>认证问题</strong>：401（未认证）vs 403（已认证但无权限）</li></ul><h3 id="3-状态码一致性"><a href="#3-状态码一致性" class="headerlink" title="3. 状态码一致性"></a>3. 状态码一致性</h3><ul><li>在整个API中保持状态码使用的一致性</li><li>建立团队的状态码使用规范</li><li>在API文档中明确说明各状态码的使用场景</li></ul><h3 id="4-错误响应格式"><a href="#4-错误响应格式" class="headerlink" title="4. 错误响应格式"></a>4. 错误响应格式</h3><p>建议使用统一的错误响应格式：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;error&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;code&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ERROR_CODE&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Human-readable error message&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;details&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;field&quot;</span><span class="punctuation">:</span> <span class="string">&quot;additional information&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;request_id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;req_123456789&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="5-监控和日志"><a href="#5-监控和日志" class="headerlink" title="5. 监控和日志"></a>5. 监控和日志</h3><ul><li>记录所有非2xx状态码的请求</li><li>设置5xx错误的告警</li><li>分析4xx错误模式，优化API设计</li><li>监控状态码分布，识别异常</li></ul>]]></content>
      
      
      <categories>
          
          <category> 计网 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTTP </tag>
            
            <tag> 状态码 </tag>
            
            <tag> Web开发 </tag>
            
            <tag> 网络协议 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python中的深拷贝和浅拷贝</title>
      <link href="/JasmineRain.github.io/2026/01/12/python%E4%B8%AD%E7%9A%84%E6%B7%B1%E6%8B%B7%E8%B4%9D%E5%92%8C%E6%B5%85%E6%8B%B7%E8%B4%9D/"/>
      <url>/JasmineRain.github.io/2026/01/12/python%E4%B8%AD%E7%9A%84%E6%B7%B1%E6%8B%B7%E8%B4%9D%E5%92%8C%E6%B5%85%E6%8B%B7%E8%B4%9D/</url>
      
        <content type="html"><![CDATA[<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>Python 中变量是引用。</p><p>浅拷贝只复制外层对象，内部仍共享；<br>深拷贝递归复制所有对象，彼此完全独立。</p><p>如果你遇到过这些问题，那么本文正是为你准备的。我们将从Python的对象模型开始，深入理解浅拷贝和浅拷贝的区别，掌握它们的适用场景，并学会在实际开发中正确选择使用。</p><h2 id="核心要点总结"><a href="#核心要点总结" class="headerlink" title="核心要点总结"></a>核心要点总结</h2><p>在深入细节之前，让我们先记住三个关键点：</p><ol><li><strong>Python中变量是引用</strong>：变量名只是指向对象的标签，不是对象本身</li><li><strong>浅拷贝（shallow copy）</strong>：只复制最外层对象，内部嵌套对象仍然共享引用</li><li><strong>深拷贝（deep copy）</strong>：递归复制所有层级的对象，创建完全独立的副本</li></ol><p>理解这三个概念，是掌握Python对象拷贝的基础。</p><h2 id="Python的对象模型：理解引用的本质"><a href="#Python的对象模型：理解引用的本质" class="headerlink" title="Python的对象模型：理解引用的本质"></a>Python的对象模型：理解引用的本质</h2><p>要理解深拷贝和浅拷贝，首先必须理解Python的对象模型。Python中的对象模型与其他一些语言（如C++、Java）有着根本性的不同。</p><h3 id="变量的本质"><a href="#变量的本质" class="headerlink" title="变量的本质"></a>变量的本质</h3><p>在Python中：</p><ul><li><strong>变量名不是对象</strong></li><li>变量名只是一个<strong>标签（标签&#x2F;引用）</strong>，指向内存中的对象</li><li>一个对象可以有多个标签（多个变量指向同一个对象）</li></ul><h3 id="基础示例"><a href="#基础示例" class="headerlink" title="基础示例"></a>基础示例</h3><p>让我们通过一个简单的例子来理解：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">b = a</span><br></pre></td></tr></table></figure><p>此时的内存结构：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a ─┐</span><br><span class="line">   └──► [1, 2, 3] ◄──── 内存中的对象</span><br><span class="line">b ─┘</span><br></pre></td></tr></table></figure><p>👉 <code>a</code> 和 <code>b</code> 指向 <strong>同一个对象</strong></p><h3 id="验证引用的方式"><a href="#验证引用的方式" class="headerlink" title="验证引用的方式"></a>验证引用的方式</h3><p>我们可以使用Python内置的<code>id()</code>函数和<code>is</code>运算符来验证：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">b = a</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(a))  <span class="comment"># 输出：140234567890 (示例地址)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(b))  <span class="comment"># 输出：140234567890 (相同的地址)</span></span><br><span class="line"><span class="built_in">print</span>(a <span class="keyword">is</span> b) <span class="comment"># 输出：True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改b，a也会改变</span></span><br><span class="line">b.append(<span class="number">4</span>)</span><br><span class="line"><span class="built_in">print</span>(a)  <span class="comment"># 输出：[1, 2, 3, 4]</span></span><br><span class="line"><span class="built_in">print</span>(b)  <span class="comment"># 输出：[1, 2, 3, 4]</span></span><br></pre></td></tr></table></figure><p>这个例子清楚地展示了：当我们执行<code>b = a</code>时，并没有创建一个新的列表对象，而是让<code>b</code>也指向了<code>a</code>所指向的同一个列表对象。因此，通过任何一个变量修改列表，都会影响另一个变量。</p><h3 id="可变对象-vs-不可变对象"><a href="#可变对象-vs-不可变对象" class="headerlink" title="可变对象 vs 不可变对象"></a>可变对象 vs 不可变对象</h3><p>理解可变对象和不可变对象的区别，对理解拷贝非常重要：</p><p><strong>不可变对象（Immutable）</strong>：一旦创建就不能修改</p><ul><li><code>int</code>, <code>float</code>, <code>str</code>, <code>tuple</code>, <code>frozenset</code></li><li>对不可变对象的”修改”实际上是创建新对象</li></ul><p><strong>可变对象（Mutable）</strong>：创建后可以修改</p><ul><li><code>list</code>, <code>dict</code>, <code>set</code>, 自定义类实例</li><li>修改可变对象不会改变对象的身份（id）</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不可变对象示例</span></span><br><span class="line">a = <span class="string">&quot;hello&quot;</span></span><br><span class="line">b = a</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(a) == <span class="built_in">id</span>(b))  <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line">a = a + <span class="string">&quot; world&quot;</span>  <span class="comment"># 创建新对象</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(a) == <span class="built_in">id</span>(b))  <span class="comment"># False，a现在指向新对象</span></span><br><span class="line"><span class="built_in">print</span>(b)  <span class="comment"># 仍然是 &quot;hello&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可变对象示例</span></span><br><span class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">b = a</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(a) == <span class="built_in">id</span>(b))  <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line">a.append(<span class="number">4</span>)  <span class="comment"># 修改原对象</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(a) == <span class="built_in">id</span>(b))  <span class="comment"># True，仍然指向同一对象</span></span><br><span class="line"><span class="built_in">print</span>(b)  <span class="comment"># [1, 2, 3, 4]，也被修改了</span></span><br></pre></td></tr></table></figure><hr><h2 id="浅拷贝（Shallow-Copy）：一层之隔"><a href="#浅拷贝（Shallow-Copy）：一层之隔" class="headerlink" title="浅拷贝（Shallow Copy）：一层之隔"></a>浅拷贝（Shallow Copy）：一层之隔</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><blockquote><p><strong>浅拷贝只复制最外层对象，创建外层对象的新实例，但内部嵌套的可变对象仍然共享引用</strong></p></blockquote><p>浅拷贝是最容易让人困惑的概念之一，因为它的行为看起来”一半像拷贝，一半像引用”。</p><hr><h3 id="常见浅拷贝方式"><a href="#常见浅拷贝方式" class="headerlink" title="常见浅拷贝方式"></a>常见浅拷贝方式</h3><p>Python提供了多种创建浅拷贝的方式：</p><h4 id="1-使用-copy-模块"><a href="#1-使用-copy-模块" class="headerlink" title="1. 使用 copy 模块"></a>1. 使用 <code>copy</code> 模块</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line">original = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, [<span class="number">4</span>, <span class="number">5</span>]]</span><br><span class="line">shallow_copy = copy.copy(original)</span><br></pre></td></tr></table></figure><h4 id="2-使用切片操作符（仅适用于列表）"><a href="#2-使用切片操作符（仅适用于列表）" class="headerlink" title="2. 使用切片操作符（仅适用于列表）"></a>2. 使用切片操作符（仅适用于列表）</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">original = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, [<span class="number">4</span>, <span class="number">5</span>]]</span><br><span class="line">shallow_copy = original[:]  <span class="comment"># 或 original[::]</span></span><br></pre></td></tr></table></figure><h4 id="3-使用内置的-copy-方法"><a href="#3-使用内置的-copy-方法" class="headerlink" title="3. 使用内置的 copy() 方法"></a>3. 使用内置的 <code>copy()</code> 方法</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列表</span></span><br><span class="line">original_list = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, [<span class="number">4</span>, <span class="number">5</span>]]</span><br><span class="line">shallow_copy_list = original_list.copy()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 字典</span></span><br><span class="line">original_dict = &#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;b&#x27;</span>: [<span class="number">2</span>, <span class="number">3</span>]&#125;</span><br><span class="line">shallow_copy_dict = original_dict.copy()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 集合</span></span><br><span class="line">original_set = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">shallow_copy_set = original_set.copy()</span><br></pre></td></tr></table></figure><h4 id="4-使用构造函数"><a href="#4-使用构造函数" class="headerlink" title="4. 使用构造函数"></a>4. 使用构造函数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列表</span></span><br><span class="line">original = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, [<span class="number">4</span>, <span class="number">5</span>]]</span><br><span class="line">shallow_copy = <span class="built_in">list</span>(original)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 字典</span></span><br><span class="line">original = &#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;b&#x27;</span>: [<span class="number">2</span>, <span class="number">3</span>]&#125;</span><br><span class="line">shallow_copy = <span class="built_in">dict</span>(original)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 集合</span></span><br><span class="line">original = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">shallow_copy = <span class="built_in">set</span>(original)</span><br></pre></td></tr></table></figure><h3 id="浅拷贝的内存结构"><a href="#浅拷贝的内存结构" class="headerlink" title="浅拷贝的内存结构"></a>浅拷贝的内存结构</h3><p>让我们通过一个嵌套结构的例子来理解浅拷贝：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line">a = [<span class="number">1</span>, [<span class="number">2</span>, <span class="number">3</span>]]</span><br><span class="line">b = copy.copy(a)</span><br></pre></td></tr></table></figure><p>内存结构示意：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a ───► [ 1 , ───► [2, 3] ]</span><br><span class="line">         │              │</span><br><span class="line">         │              └───┐</span><br><span class="line">         │                  │</span><br><span class="line">b ───► [ 1 , ───► [2, 3] ] ┘</span><br></pre></td></tr></table></figure><p><strong>关键点</strong>：</p><ul><li>✔ 外层 <code>list</code> 是不同的对象（新创建）</li><li>❌ 内层的 <code>[2, 3]</code> 仍然是同一个对象（共享引用）</li></ul><h3 id="验证浅拷贝行为"><a href="#验证浅拷贝行为" class="headerlink" title="验证浅拷贝行为"></a>验证浅拷贝行为</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line">a = [<span class="number">1</span>, [<span class="number">2</span>, <span class="number">3</span>]]</span><br><span class="line">b = copy.copy(a)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证外层对象不同</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(a))        <span class="comment"># 140234567890</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(b))        <span class="comment"># 140234567901 (不同)</span></span><br><span class="line"><span class="built_in">print</span>(a <span class="keyword">is</span> b)       <span class="comment"># False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证内层对象相同</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(a[<span class="number">1</span>]))     <span class="comment"># 140234567912</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(b[<span class="number">1</span>]))     <span class="comment"># 140234567912 (相同！)</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">1</span>] <span class="keyword">is</span> b[<span class="number">1</span>]) <span class="comment"># True</span></span><br></pre></td></tr></table></figure><h3 id="修改行为分析"><a href="#修改行为分析" class="headerlink" title="修改行为分析"></a>修改行为分析</h3><p>浅拷贝最容易被误解的地方在于修改行为。让我们详细分析：</p><h4 id="场景1：修改外层对象的元素（重新赋值）"><a href="#场景1：修改外层对象的元素（重新赋值）" class="headerlink" title="场景1：修改外层对象的元素（重新赋值）"></a>场景1：修改外层对象的元素（重新赋值）</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line">a = [<span class="number">1</span>, [<span class="number">2</span>, <span class="number">3</span>]]</span><br><span class="line">b = copy.copy(a)</span><br><span class="line"></span><br><span class="line">b[<span class="number">0</span>] = <span class="number">99</span>  <span class="comment"># 重新绑定b[0]的引用</span></span><br><span class="line"><span class="built_in">print</span>(a)   <span class="comment"># [1, [2, 3]] 不受影响</span></span><br><span class="line"><span class="built_in">print</span>(b)   <span class="comment"># [99, [2, 3]]</span></span><br></pre></td></tr></table></figure><p><strong>解释</strong>：<code>b[0] = 99</code> 是重新绑定<code>b[0]</code>的引用，指向新的整数对象<code>99</code>，不会影响<code>a[0]</code>。</p><h4 id="场景2：修改内层可变对象"><a href="#场景2：修改内层可变对象" class="headerlink" title="场景2：修改内层可变对象"></a>场景2：修改内层可变对象</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line">a = [<span class="number">1</span>, [<span class="number">2</span>, <span class="number">3</span>]]</span><br><span class="line">b = copy.copy(a)</span><br><span class="line"></span><br><span class="line">b[<span class="number">1</span>].append(<span class="number">4</span>)  <span class="comment"># 修改共享的内部列表</span></span><br><span class="line"><span class="built_in">print</span>(a)        <span class="comment"># [1, [2, 3, 4]] ⚠️ a也被改变了！</span></span><br><span class="line"><span class="built_in">print</span>(b)        <span class="comment"># [1, [2, 3, 4]]</span></span><br></pre></td></tr></table></figure><p><strong>解释</strong>：<code>b[1]</code>和<code>a[1]</code>指向同一个列表对象，修改这个列表会同时影响<code>a</code>和<code>b</code>。</p><h4 id="场景3：添加元素到内层列表"><a href="#场景3：添加元素到内层列表" class="headerlink" title="场景3：添加元素到内层列表"></a>场景3：添加元素到内层列表</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line">a = [<span class="number">1</span>, [<span class="number">2</span>, <span class="number">3</span>]]</span><br><span class="line">b = copy.copy(a)</span><br><span class="line"></span><br><span class="line">b[<span class="number">1</span>] = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>]  <span class="comment"># 重新绑定b[1]的引用</span></span><br><span class="line"><span class="built_in">print</span>(a)             <span class="comment"># [1, [2, 3]] 不受影响</span></span><br><span class="line"><span class="built_in">print</span>(b)             <span class="comment"># [1, [10, 20, 30]]</span></span><br></pre></td></tr></table></figure><p><strong>解释</strong>：虽然<code>b[1] = [10, 20, 30]</code>看起来像是在修改，但实际上这是重新绑定引用，创建了一个新的列表对象。</p><h3 id="记忆口诀"><a href="#记忆口诀" class="headerlink" title="记忆口诀"></a>记忆口诀</h3><blockquote><p><strong>修改”对象内部” → 可能影响原对象</strong><br><strong>修改”引用指向” → 不影响原对象</strong></p></blockquote><p>这是区分浅拷贝行为的关键。</p><hr><h2 id="深拷贝（Deep-Copy）：完全独立"><a href="#深拷贝（Deep-Copy）：完全独立" class="headerlink" title="深拷贝（Deep Copy）：完全独立"></a>深拷贝（Deep Copy）：完全独立</h2><h3 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a>定义</h3><blockquote><p><strong>深拷贝递归复制所有层级的对象，包括嵌套的可变对象，创建一个完全独立的副本</strong></p></blockquote><p>深拷贝是最”彻底”的拷贝方式，它会递归地复制所有嵌套的对象，确保原对象和拷贝对象之间没有任何共享的引用。</p><hr><h3 id="使用方式"><a href="#使用方式" class="headerlink" title="使用方式"></a>使用方式</h3><p>深拷贝只能通过<code>copy</code>模块的<code>deepcopy()</code>函数来实现：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line">original = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, [<span class="number">4</span>, <span class="number">5</span>, [<span class="number">6</span>, <span class="number">7</span>]]]</span><br><span class="line">deep_copy = copy.deepcopy(original)</span><br></pre></td></tr></table></figure><p><strong>注意</strong>：Python的内置数据结构（<code>list</code>、<code>dict</code>、<code>set</code>等）没有提供直接创建深拷贝的方法，必须使用<code>copy.deepcopy()</code>。</p><h3 id="深拷贝的内存结构"><a href="#深拷贝的内存结构" class="headerlink" title="深拷贝的内存结构"></a>深拷贝的内存结构</h3><p>让我们看看深拷贝是如何工作的：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line">a = [<span class="number">1</span>, [<span class="number">2</span>, <span class="number">3</span>]]</span><br><span class="line">b = copy.deepcopy(a)</span><br></pre></td></tr></table></figure><p>内存结构示意：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a ───► [ 1 , ───► [2, 3] ]</span><br><span class="line"></span><br><span class="line">b ───► [ 1 , ───► [2, 3] ]</span><br><span class="line">        │              │</span><br><span class="line">        │              └─── 完全独立的新对象</span><br><span class="line">        │</span><br><span class="line">        └─── 完全独立的新对象</span><br></pre></td></tr></table></figure><p><strong>关键点</strong>：</p><ul><li>✔ 外层 <code>list</code> 是新对象</li><li>✔ 内层的 <code>[2, 3]</code> 也是新对象</li><li>✔ 所有层级都是完全独立的副本</li></ul><h3 id="验证深拷贝行为"><a href="#验证深拷贝行为" class="headerlink" title="验证深拷贝行为"></a>验证深拷贝行为</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line">a = [<span class="number">1</span>, [<span class="number">2</span>, <span class="number">3</span>]]</span><br><span class="line">b = copy.deepcopy(a)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证外层对象不同</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(a))        <span class="comment"># 140234567890</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(b))        <span class="comment"># 140234567901 (不同)</span></span><br><span class="line"><span class="built_in">print</span>(a <span class="keyword">is</span> b)       <span class="comment"># False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证内层对象也不同</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(a[<span class="number">1</span>]))     <span class="comment"># 140234567912</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(b[<span class="number">1</span>]))     <span class="comment"># 140234567923 (不同！)</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">1</span>] <span class="keyword">is</span> b[<span class="number">1</span>]) <span class="comment"># False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改验证</span></span><br><span class="line">b[<span class="number">1</span>].append(<span class="number">4</span>)</span><br><span class="line"><span class="built_in">print</span>(a)  <span class="comment"># [1, [2, 3]] 不受影响</span></span><br><span class="line"><span class="built_in">print</span>(b)  <span class="comment"># [1, [2, 3, 4]]</span></span><br></pre></td></tr></table></figure><h3 id="多层嵌套的深拷贝"><a href="#多层嵌套的深拷贝" class="headerlink" title="多层嵌套的深拷贝"></a>多层嵌套的深拷贝</h3><p>深拷贝会递归处理所有层级的嵌套：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line">original = [<span class="number">1</span>, [<span class="number">2</span>, [<span class="number">3</span>, [<span class="number">4</span>, <span class="number">5</span>]]]]</span><br><span class="line">deep_copy = copy.deepcopy(original)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改最深层的元素</span></span><br><span class="line">deep_copy[<span class="number">1</span>][<span class="number">1</span>][<span class="number">1</span>].append(<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(original)  <span class="comment"># [1, [2, [3, [4, 5]]]]</span></span><br><span class="line"><span class="built_in">print</span>(deep_copy) <span class="comment"># [1, [2, [3, [4, 5, 6]]]]</span></span><br></pre></td></tr></table></figure><p>无论嵌套层级有多深，深拷贝都能确保每一层都是独立的副本。</p><h3 id="深拷贝的递归机制"><a href="#深拷贝的递归机制" class="headerlink" title="深拷贝的递归机制"></a>深拷贝的递归机制</h3><p><code>copy.deepcopy()</code>使用递归算法来复制所有对象：</p><ol><li>遇到可变对象（如<code>list</code>、<code>dict</code>、<code>set</code>）→ 创建新对象并递归拷贝其内容</li><li>遇到不可变对象（如<code>int</code>、<code>str</code>、<code>tuple</code>）→ 直接复用（因为不可变，无需复制）</li><li>遇到自定义对象 → 调用对象的<code>__deepcopy__()</code>方法（如果定义了）</li></ol><p>我们稍后会在自定义对象部分详细说明。</p><hr><h2 id="三种”拷贝”方式的本质对比"><a href="#三种”拷贝”方式的本质对比" class="headerlink" title="三种”拷贝”方式的本质对比"></a>三种”拷贝”方式的本质对比</h2><p>为了更好地理解三种操作的区别，让我们用表格和实例来对比：</p><table><thead><tr><th>操作</th><th>是否创建新对象</th><th>是否共享内部对象</th><th>内存开销</th><th>性能</th><th>使用场景</th></tr></thead><tbody><tr><td>赋值 <code>b = a</code></td><td>❌</td><td>✅</td><td>最小</td><td>最快</td><td>不需要副本时</td></tr><tr><td>浅拷贝</td><td>✅</td><td>✅</td><td>中等</td><td>较快</td><td>需要外层独立，内部可共享</td></tr><tr><td>深拷贝</td><td>✅</td><td>❌</td><td>最大</td><td>最慢</td><td>需要完全独立的副本</td></tr></tbody></table><h3 id="详细对比示例"><a href="#详细对比示例" class="headerlink" title="详细对比示例"></a>详细对比示例</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"><span class="comment"># 原始对象</span></span><br><span class="line">a = [<span class="number">1</span>, [<span class="number">2</span>, <span class="number">3</span>], &#123;<span class="string">&#x27;key&#x27;</span>: <span class="string">&#x27;value&#x27;</span>&#125;]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 赋值</span></span><br><span class="line">b1 = a</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;赋值:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;a is b1: <span class="subst">&#123;a <span class="keyword">is</span> b1&#125;</span>&quot;</span>)                    <span class="comment"># True</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;a[1] is b1[1]: <span class="subst">&#123;a[<span class="number">1</span>] <span class="keyword">is</span> b1[<span class="number">1</span>]&#125;</span>&quot;</span>)        <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 浅拷贝</span></span><br><span class="line">b2 = copy.copy(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n浅拷贝:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;a is b2: <span class="subst">&#123;a <span class="keyword">is</span> b2&#125;</span>&quot;</span>)                    <span class="comment"># False</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;a[1] is b2[1]: <span class="subst">&#123;a[<span class="number">1</span>] <span class="keyword">is</span> b2[<span class="number">1</span>]&#125;</span>&quot;</span>)        <span class="comment"># True (共享!)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;a[2] is b2[2]: <span class="subst">&#123;a[<span class="number">2</span>] <span class="keyword">is</span> b2[<span class="number">2</span>]&#125;</span>&quot;</span>)        <span class="comment"># True (共享!)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 深拷贝</span></span><br><span class="line">b3 = copy.deepcopy(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n深拷贝:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;a is b3: <span class="subst">&#123;a <span class="keyword">is</span> b3&#125;</span>&quot;</span>)                    <span class="comment"># False</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;a[1] is b3[1]: <span class="subst">&#123;a[<span class="number">1</span>] <span class="keyword">is</span> b3[<span class="number">1</span>]&#125;</span>&quot;</span>)        <span class="comment"># False (独立!)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;a[2] is b3[2]: <span class="subst">&#123;a[<span class="number">2</span>] <span class="keyword">is</span> b3[<span class="number">2</span>]&#125;</span>&quot;</span>)        <span class="comment"># False (独立!)</span></span><br></pre></td></tr></table></figure><h3 id="修改行为对比"><a href="#修改行为对比" class="headerlink" title="修改行为对比"></a>修改行为对比</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line">a = [<span class="number">1</span>, [<span class="number">2</span>, <span class="number">3</span>]]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 赋值</span></span><br><span class="line">b1 = a</span><br><span class="line">b1[<span class="number">0</span>] = <span class="number">100</span></span><br><span class="line">b1[<span class="number">1</span>].append(<span class="number">4</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;赋值后 a: <span class="subst">&#123;a&#125;</span>&quot;</span>)  <span class="comment"># [100, [2, 3, 4]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 浅拷贝</span></span><br><span class="line">a = [<span class="number">1</span>, [<span class="number">2</span>, <span class="number">3</span>]]  <span class="comment"># 重置</span></span><br><span class="line">b2 = copy.copy(a)</span><br><span class="line">b2[<span class="number">0</span>] = <span class="number">100</span>      <span class="comment"># 不影响a</span></span><br><span class="line">b2[<span class="number">1</span>].append(<span class="number">4</span>)  <span class="comment"># 影响a</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;浅拷贝后 a: <span class="subst">&#123;a&#125;</span>&quot;</span>)  <span class="comment"># [1, [2, 3, 4]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 深拷贝</span></span><br><span class="line">a = [<span class="number">1</span>, [<span class="number">2</span>, <span class="number">3</span>]]  <span class="comment"># 重置</span></span><br><span class="line">b3 = copy.deepcopy(a)</span><br><span class="line">b3[<span class="number">0</span>] = <span class="number">100</span>      <span class="comment"># 不影响a</span></span><br><span class="line">b3[<span class="number">1</span>].append(<span class="number">4</span>)  <span class="comment"># 不影响a</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;深拷贝后 a: <span class="subst">&#123;a&#125;</span>&quot;</span>)  <span class="comment"># [1, [2, 3]]</span></span><br></pre></td></tr></table></figure><hr><h2 id="为什么浅拷贝最容易出错？⚠️"><a href="#为什么浅拷贝最容易出错？⚠️" class="headerlink" title="为什么浅拷贝最容易出错？⚠️"></a>为什么浅拷贝最容易出错？⚠️</h2><p>浅拷贝被称为”最容易出错”的拷贝方式，原因在于它的行为是<strong>部分的独立性</strong>：外层对象是新的，但内部嵌套对象仍然共享。这种”一半一半”的特性很容易让人产生误解。</p><h3 id="问题的根源"><a href="#问题的根源" class="headerlink" title="问题的根源"></a>问题的根源</h3><p>浅拷贝的问题来源于<strong>不可变对象和可变对象混合使用</strong>时的不一致行为：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line">a = [<span class="number">1</span>, [<span class="number">2</span>, <span class="number">3</span>], &#123;<span class="string">&#x27;key&#x27;</span>: <span class="string">&#x27;value&#x27;</span>&#125;]</span><br><span class="line">b = copy.copy(a)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这些操作不影响a</span></span><br><span class="line">b[<span class="number">0</span>] = <span class="number">100</span>              <span class="comment"># 修改不可变对象（实际上是重新绑定）</span></span><br><span class="line">b[<span class="number">1</span>] = [<span class="number">10</span>, <span class="number">20</span>]        <span class="comment"># 重新绑定引用</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 这些操作会影响a ⚠️</span></span><br><span class="line">b[<span class="number">1</span>].append(<span class="number">4</span>)         <span class="comment"># 修改可变对象内部</span></span><br><span class="line">b[<span class="number">2</span>][<span class="string">&#x27;new_key&#x27;</span>] = <span class="number">123</span>  <span class="comment"># 修改可变对象内部</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a)  <span class="comment"># [1, [2, 3, 4], &#123;&#x27;key&#x27;: &#x27;value&#x27;, &#x27;new_key&#x27;: 123&#125;]</span></span><br></pre></td></tr></table></figure><h3 id="常见陷阱示例"><a href="#常见陷阱示例" class="headerlink" title="常见陷阱示例"></a>常见陷阱示例</h3><h4 id="陷阱1：嵌套列表的共享"><a href="#陷阱1：嵌套列表的共享" class="headerlink" title="陷阱1：嵌套列表的共享"></a>陷阱1：嵌套列表的共享</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建二维列表</span></span><br><span class="line">matrix = [[<span class="number">0</span>] * <span class="number">3</span>] * <span class="number">3</span>  <span class="comment"># ❌ 错误方式</span></span><br><span class="line"><span class="built_in">print</span>(matrix)  <span class="comment"># [[0, 0, 0], [0, 0, 0], [0, 0, 0]]</span></span><br><span class="line"></span><br><span class="line">matrix[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(matrix)  <span class="comment"># [[1, 0, 0], [1, 0, 0], [1, 0, 0]] ⚠️ 所有行都被修改了！</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 正确方式</span></span><br><span class="line">matrix = [[<span class="number">0</span>] * <span class="number">3</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]  <span class="comment"># ✅ 使用列表推导式</span></span><br><span class="line"><span class="comment"># 或</span></span><br><span class="line">matrix = [[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br></pre></td></tr></table></figure><p><strong>解释</strong>：<code>[[0] * 3] * 3</code>创建了3个指向同一个列表的引用，而不是3个独立的列表。</p><h4 id="陷阱2：默认参数的共享"><a href="#陷阱2：默认参数的共享" class="headerlink" title="陷阱2：默认参数的共享"></a>陷阱2：默认参数的共享</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">append_to_list</span>(<span class="params">item, target=[]</span>):  <span class="comment"># ❌ 危险！</span></span><br><span class="line">    target.append(item)</span><br><span class="line">    <span class="keyword">return</span> target</span><br><span class="line"></span><br><span class="line"><span class="comment"># 多次调用</span></span><br><span class="line">result1 = append_to_list(<span class="number">1</span>)</span><br><span class="line">result2 = append_to_list(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(result1)  <span class="comment"># [1, 2] ⚠️ 意外的结果</span></span><br><span class="line"><span class="built_in">print</span>(result2)  <span class="comment"># [1, 2] ⚠️ 不是期望的[2]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 正确方式</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">append_to_list</span>(<span class="params">item, target=<span class="literal">None</span></span>):  <span class="comment"># ✅ 正确</span></span><br><span class="line">    <span class="keyword">if</span> target <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        target = []</span><br><span class="line">    target.append(item)</span><br><span class="line">    <span class="keyword">return</span> target</span><br></pre></td></tr></table></figure><p><strong>解释</strong>：默认参数在函数定义时只计算一次，如果是可变对象，所有调用都会共享同一个对象。</p><h4 id="陷阱3：浅拷贝配置字典"><a href="#陷阱3：浅拷贝配置字典" class="headerlink" title="陷阱3：浅拷贝配置字典"></a>陷阱3：浅拷贝配置字典</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"><span class="comment"># 默认配置</span></span><br><span class="line">default_config = &#123;</span><br><span class="line">    <span class="string">&#x27;database&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;host&#x27;</span>: <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;port&#x27;</span>: <span class="number">5432</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&#x27;cache&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;size&#x27;</span>: <span class="number">1000</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 为不同环境创建配置（错误方式）</span></span><br><span class="line">dev_config = copy.copy(default_config)  <span class="comment"># ❌ 浅拷贝</span></span><br><span class="line">dev_config[<span class="string">&#x27;database&#x27;</span>][<span class="string">&#x27;host&#x27;</span>] = <span class="string">&#x27;dev.example.com&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(default_config[<span class="string">&#x27;database&#x27;</span>][<span class="string">&#x27;host&#x27;</span>])  <span class="comment"># &#x27;dev.example.com&#x27; ⚠️ 原配置被修改了！</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 正确方式</span></span><br><span class="line">dev_config = copy.deepcopy(default_config)  <span class="comment"># ✅ 深拷贝</span></span><br><span class="line">dev_config[<span class="string">&#x27;database&#x27;</span>][<span class="string">&#x27;host&#x27;</span>] = <span class="string">&#x27;dev.example.com&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(default_config[<span class="string">&#x27;database&#x27;</span>][<span class="string">&#x27;host&#x27;</span>])  <span class="comment"># &#x27;localhost&#x27; ✅</span></span><br></pre></td></tr></table></figure><h3 id="判断是否需要深拷贝的规则"><a href="#判断是否需要深拷贝的规则" class="headerlink" title="判断是否需要深拷贝的规则"></a>判断是否需要深拷贝的规则</h3><p><strong>什么时候浅拷贝可能有问题？</strong></p><ul><li>对象中包含嵌套的可变对象（<code>list</code>、<code>dict</code>、<code>set</code>）</li><li>你需要修改嵌套对象的内部状态</li><li>你需要确保原对象不受任何影响</li></ul><p><strong>什么时候浅拷贝足够？</strong></p><ul><li>对象只包含不可变对象（<code>int</code>、<code>str</code>、<code>tuple</code>）</li><li>你只需要独立的外层对象，不修改内部对象</li><li>你希望内部对象共享以节省内存</li></ul><p>👉 <strong>记忆口诀</strong>：</p><blockquote><p><strong>修改”对象内部” → 可能影响原对象（浅拷贝有问题）</strong><br><strong>修改”引用指向” → 不影响原对象（浅拷贝安全）</strong></p></blockquote><hr><h2 id="不可变对象的特殊情况：拷贝优化"><a href="#不可变对象的特殊情况：拷贝优化" class="headerlink" title="不可变对象的特殊情况：拷贝优化"></a>不可变对象的特殊情况：拷贝优化</h2><p>Python对不可变对象的拷贝进行了优化，这是一个重要的性能优化特性。</p><h3 id="不可变对象的拷贝行为"><a href="#不可变对象的拷贝行为" class="headerlink" title="不可变对象的拷贝行为"></a>不可变对象的拷贝行为</h3><p>对于不可变对象（如<code>int</code>、<code>str</code>、<code>tuple</code>、<code>frozenset</code>），无论是浅拷贝还是深拷贝，Python都会直接复用原对象：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"><span class="comment"># 元组</span></span><br><span class="line">a = (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">b = copy.copy(a)</span><br><span class="line">c = copy.deepcopy(a)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a <span class="keyword">is</span> b <span class="keyword">is</span> c)  <span class="comment"># True，都指向同一个对象</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(a) == <span class="built_in">id</span>(b) == <span class="built_in">id</span>(c))  <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 字符串</span></span><br><span class="line">s = <span class="string">&quot;hello&quot;</span></span><br><span class="line">s_copy = copy.copy(s)</span><br><span class="line">s_deepcopy = copy.deepcopy(s)</span><br><span class="line"><span class="built_in">print</span>(s <span class="keyword">is</span> s_copy <span class="keyword">is</span> s_deepcopy)  <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 整数</span></span><br><span class="line">num = <span class="number">42</span></span><br><span class="line">num_copy = copy.copy(num)</span><br><span class="line">num_deepcopy = copy.deepcopy(num)</span><br><span class="line"><span class="built_in">print</span>(num <span class="keyword">is</span> num_copy <span class="keyword">is</span> num_deepcopy)  <span class="comment"># True</span></span><br></pre></td></tr></table></figure><h3 id="为什么不可变对象不需要拷贝？"><a href="#为什么不可变对象不需要拷贝？" class="headerlink" title="为什么不可变对象不需要拷贝？"></a>为什么不可变对象不需要拷贝？</h3><p><strong>原因</strong>：</p><ol><li><strong>不可变对象不能被修改</strong>：一旦创建，内容永远不会改变</li><li><strong>复用是安全的</strong>：由于不能修改，多个变量共享同一个对象不会有任何副作用</li><li><strong>节省内存</strong>：避免了不必要的对象复制，提高了内存效率</li><li><strong>提升性能</strong>：避免了创建新对象的开销</li></ol><h3 id="混合类型的拷贝行为"><a href="#混合类型的拷贝行为" class="headerlink" title="混合类型的拷贝行为"></a>混合类型的拷贝行为</h3><p>当对象中包含不可变对象时，拷贝行为会有所不同：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列表包含不可变对象</span></span><br><span class="line">a = [<span class="number">1</span>, <span class="number">2</span>, (<span class="number">3</span>, <span class="number">4</span>)]</span><br><span class="line">b = copy.copy(a)</span><br><span class="line">c = copy.deepcopy(a)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">2</span>] <span class="keyword">is</span> b[<span class="number">2</span>])  <span class="comment"># True，元组是共享的</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">2</span>] <span class="keyword">is</span> c[<span class="number">2</span>])  <span class="comment"># True，深拷贝也会复用不可变的元组</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 列表包含可变对象</span></span><br><span class="line">a = [<span class="number">1</span>, [<span class="number">2</span>, <span class="number">3</span>]]</span><br><span class="line">b = copy.copy(a)</span><br><span class="line">c = copy.deepcopy(a)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">1</span>] <span class="keyword">is</span> b[<span class="number">1</span>])  <span class="comment"># True，浅拷贝共享列表</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">1</span>] <span class="keyword">is</span> c[<span class="number">1</span>])  <span class="comment"># False，深拷贝创建新列表</span></span><br></pre></td></tr></table></figure><p><strong>规则</strong>：</p><ul><li>浅拷贝：外层对象新建，内部对象（无论可变与否）都共享</li><li>深拷贝：外层对象新建，内部可变对象新建，内部不可变对象复用</li></ul><h3 id="特殊情况：包含可变对象的元组"><a href="#特殊情况：包含可变对象的元组" class="headerlink" title="特殊情况：包含可变对象的元组"></a>特殊情况：包含可变对象的元组</h3><p>虽然元组本身是不可变的，但它可以包含可变对象。这种情况下，深拷贝的行为值得注意：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"><span class="comment"># 元组包含可变对象</span></span><br><span class="line">a = (<span class="number">1</span>, [<span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">b = copy.copy(a)</span><br><span class="line">c = copy.deepcopy(a)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a <span class="keyword">is</span> b)     <span class="comment"># True，浅拷贝复用元组</span></span><br><span class="line"><span class="built_in">print</span>(a <span class="keyword">is</span> c)     <span class="comment"># False，深拷贝创建新元组（因为需要拷贝内部列表）</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">1</span>] <span class="keyword">is</span> b[<span class="number">1</span>])  <span class="comment"># True，浅拷贝共享内部列表</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">1</span>] <span class="keyword">is</span> c[<span class="number">1</span>])  <span class="comment"># False，深拷贝创建新的内部列表</span></span><br></pre></td></tr></table></figure><hr><h2 id="自定义对象的拷贝：控制拷贝行为"><a href="#自定义对象的拷贝：控制拷贝行为" class="headerlink" title="自定义对象的拷贝：控制拷贝行为"></a>自定义对象的拷贝：控制拷贝行为</h2><p>当我们需要拷贝自定义类的实例时，Python提供了灵活的机制来控制拷贝行为。</p><h3 id="默认拷贝行为"><a href="#默认拷贝行为" class="headerlink" title="默认拷贝行为"></a>默认拷贝行为</h3><p>对于自定义对象，如果没有定义特殊的拷贝方法，Python会使用默认行为：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, hobbies</span>):</span><br><span class="line">        <span class="variable language_">self</span>.name = name</span><br><span class="line">        <span class="variable language_">self</span>.hobbies = hobbies  <span class="comment"># 假设hobbies是一个列表</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;Person(name=<span class="subst">&#123;self.name!r&#125;</span>, hobbies=<span class="subst">&#123;self.hobbies&#125;</span>)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建实例</span></span><br><span class="line">alice = Person(<span class="string">&quot;Alice&quot;</span>, [<span class="string">&quot;reading&quot;</span>, <span class="string">&quot;coding&quot;</span>])</span><br><span class="line">bob_shallow = copy.copy(alice)</span><br><span class="line">bob_deep = copy.deepcopy(alice)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 浅拷贝行为</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;alice is bob_shallow: <span class="subst">&#123;alice <span class="keyword">is</span> bob_shallow&#125;</span>&quot;</span>)           <span class="comment"># False，新对象</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;alice.hobbies is bob_shallow.hobbies: <span class="subst">&#123;alice.hobbies <span class="keyword">is</span> bob_shallow.hobbies&#125;</span>&quot;</span>)  <span class="comment"># True，共享hobbies</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 深拷贝行为</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;alice is bob_deep: <span class="subst">&#123;alice <span class="keyword">is</span> bob_deep&#125;</span>&quot;</span>)                 <span class="comment"># False，新对象</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;alice.hobbies is bob_deep.hobbies: <span class="subst">&#123;alice.hobbies <span class="keyword">is</span> bob_deep.hobbies&#125;</span>&quot;</span>)  <span class="comment"># False，hobbies也是新对象</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改测试</span></span><br><span class="line">bob_shallow.hobbies.append(<span class="string">&quot;gaming&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(alice)      <span class="comment"># Person(name=&#x27;Alice&#x27;, hobbies=[&#x27;reading&#x27;, &#x27;coding&#x27;, &#x27;gaming&#x27;]) ⚠️</span></span><br><span class="line"><span class="built_in">print</span>(bob_shallow) <span class="comment"># Person(name=&#x27;Alice&#x27;, hobbies=[&#x27;reading&#x27;, &#x27;coding&#x27;, &#x27;gaming&#x27;])</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 深拷贝不受影响</span></span><br><span class="line">alice.hobbies = [<span class="string">&quot;reading&quot;</span>, <span class="string">&quot;coding&quot;</span>]  <span class="comment"># 重置</span></span><br><span class="line">bob_deep.hobbies.append(<span class="string">&quot;swimming&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(alice)      <span class="comment"># Person(name=&#x27;Alice&#x27;, hobbies=[&#x27;reading&#x27;, &#x27;coding&#x27;])</span></span><br><span class="line"><span class="built_in">print</span>(bob_deep)   <span class="comment"># Person(name=&#x27;Alice&#x27;, hobbies=[&#x27;reading&#x27;, &#x27;coding&#x27;, &#x27;swimming&#x27;])</span></span><br></pre></td></tr></table></figure><h3 id="自定义拷贝方法"><a href="#自定义拷贝方法" class="headerlink" title="自定义拷贝方法"></a>自定义拷贝方法</h3><p>Python允许我们通过定义<code>__copy__()</code>和<code>__deepcopy__()</code>方法来控制对象的拷贝行为。</p><h4 id="实现-copy-方法"><a href="#实现-copy-方法" class="headerlink" title="实现 __copy__() 方法"></a>实现 <code>__copy__()</code> 方法</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DatabaseConnection</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, host, port, connection_id</span>):</span><br><span class="line">        <span class="variable language_">self</span>.host = host</span><br><span class="line">        <span class="variable language_">self</span>.port = port</span><br><span class="line">        <span class="variable language_">self</span>.connection_id = connection_id</span><br><span class="line">        <span class="variable language_">self</span>.connected = <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__copy__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 浅拷贝时创建新连接对象，但使用相同的主机和端口</span></span><br><span class="line">        new_obj = <span class="built_in">type</span>(<span class="variable language_">self</span>)(<span class="variable language_">self</span>.host, <span class="variable language_">self</span>.port, <span class="variable language_">self</span>.connection_id + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> new_obj</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;DatabaseConnection(host=<span class="subst">&#123;self.host&#125;</span>, id=<span class="subst">&#123;self.connection_id&#125;</span>, connected=<span class="subst">&#123;self.connected&#125;</span>)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用</span></span><br><span class="line">conn1 = DatabaseConnection(<span class="string">&quot;localhost&quot;</span>, <span class="number">5432</span>, <span class="number">1</span>)</span><br><span class="line">conn2 = copy.copy(conn1)</span><br><span class="line"><span class="built_in">print</span>(conn1)  <span class="comment"># DatabaseConnection(host=localhost, id=1, connected=False)</span></span><br><span class="line"><span class="built_in">print</span>(conn2)  <span class="comment"># DatabaseConnection(host=localhost, id=2, connected=False)  # 新的连接ID</span></span><br></pre></td></tr></table></figure><h4 id="实现-deepcopy-方法"><a href="#实现-deepcopy-方法" class="headerlink" title="实现 __deepcopy__() 方法"></a>实现 <code>__deepcopy__()</code> 方法</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TreeNode</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, value, children=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.value = value</span><br><span class="line">        <span class="variable language_">self</span>.children = children <span class="keyword">or</span> []</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__deepcopy__</span>(<span class="params">self, memo</span>):</span><br><span class="line">        <span class="comment"># memo用于避免循环引用的无限递归</span></span><br><span class="line">        <span class="comment"># 创建新节点</span></span><br><span class="line">        new_node = TreeNode(<span class="variable language_">self</span>.value)</span><br><span class="line">        <span class="comment"># 将当前对象添加到memo，避免循环引用问题</span></span><br><span class="line">        memo[<span class="built_in">id</span>(<span class="variable language_">self</span>)] = new_node</span><br><span class="line">        <span class="comment"># 递归拷贝子节点</span></span><br><span class="line">        new_node.children = [copy.deepcopy(child, memo) <span class="keyword">for</span> child <span class="keyword">in</span> <span class="variable language_">self</span>.children]</span><br><span class="line">        <span class="keyword">return</span> new_node</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;TreeNode(value=<span class="subst">&#123;self.value&#125;</span>, children=<span class="subst">&#123;<span class="built_in">len</span>(self.children)&#125;</span>)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用</span></span><br><span class="line">root = TreeNode(<span class="number">1</span>, [</span><br><span class="line">    TreeNode(<span class="number">2</span>, [TreeNode(<span class="number">4</span>)]),</span><br><span class="line">    TreeNode(<span class="number">3</span>)</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">root_copy = copy.deepcopy(root)</span><br><span class="line"><span class="built_in">print</span>(root)       <span class="comment"># TreeNode(value=1, children=2)</span></span><br><span class="line"><span class="built_in">print</span>(root_copy)  <span class="comment"># TreeNode(value=1, children=2)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证独立性</span></span><br><span class="line">root_copy.children.append(TreeNode(<span class="number">5</span>))</span><br><span class="line"><span class="built_in">print</span>(root.children)      <span class="comment"># [TreeNode(value=2, children=1), TreeNode(value=3, children=0)]</span></span><br><span class="line"><span class="built_in">print</span>(root_copy.children) <span class="comment"># [TreeNode(value=2, children=1), TreeNode(value=3, children=0), TreeNode(value=5, children=0)]</span></span><br></pre></td></tr></table></figure><h3 id="处理循环引用"><a href="#处理循环引用" class="headerlink" title="处理循环引用"></a>处理循环引用</h3><p><code>__deepcopy__()</code>方法的<code>memo</code>参数用于处理循环引用问题：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Node</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, value</span>):</span><br><span class="line">        <span class="variable language_">self</span>.value = value</span><br><span class="line">        <span class="variable language_">self</span>.ref = <span class="literal">None</span>  <span class="comment"># 指向其他节点</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__deepcopy__</span>(<span class="params">self, memo</span>):</span><br><span class="line">        <span class="comment"># 检查是否已经在memo中，避免循环引用</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">id</span>(<span class="variable language_">self</span>) <span class="keyword">in</span> memo:</span><br><span class="line">            <span class="keyword">return</span> memo[<span class="built_in">id</span>(<span class="variable language_">self</span>)]</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 创建新节点并添加到memo</span></span><br><span class="line">        new_node = Node(<span class="variable language_">self</span>.value)</span><br><span class="line">        memo[<span class="built_in">id</span>(<span class="variable language_">self</span>)] = new_node</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 递归拷贝引用</span></span><br><span class="line">        new_node.ref = copy.deepcopy(<span class="variable language_">self</span>.ref, memo) <span class="keyword">if</span> <span class="variable language_">self</span>.ref <span class="keyword">else</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">return</span> new_node</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建循环引用</span></span><br><span class="line">node1 = Node(<span class="number">1</span>)</span><br><span class="line">node2 = Node(<span class="number">2</span>)</span><br><span class="line">node1.ref = node2</span><br><span class="line">node2.ref = node1  <span class="comment"># 循环引用</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 深拷贝可以正确处理</span></span><br><span class="line">node1_copy = copy.deepcopy(node1)</span><br><span class="line"><span class="built_in">print</span>(node1_copy.value)        <span class="comment"># 1</span></span><br><span class="line"><span class="built_in">print</span>(node1_copy.ref.value)    <span class="comment"># 2</span></span><br><span class="line"><span class="built_in">print</span>(node1_copy.ref.ref.value) <span class="comment"># 1 (循环引用被正确处理)</span></span><br></pre></td></tr></table></figure><h3 id="使用-slots-的类"><a href="#使用-slots-的类" class="headerlink" title="使用 __slots__ 的类"></a>使用 <code>__slots__</code> 的类</h3><p>对于使用<code>__slots__</code>定义的类，拷贝行为也是正常的：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Point</span>:</span><br><span class="line">    __slots__ = [<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, x, y</span>):</span><br><span class="line">        <span class="variable language_">self</span>.x = x</span><br><span class="line">        <span class="variable language_">self</span>.y = y</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;Point(<span class="subst">&#123;self.x&#125;</span>, <span class="subst">&#123;self.y&#125;</span>)&quot;</span></span><br><span class="line"></span><br><span class="line">p1 = Point(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">p2 = copy.copy(p1)</span><br><span class="line">p3 = copy.deepcopy(p1)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(p2)  <span class="comment"># Point(1, 2)</span></span><br><span class="line"><span class="built_in">print</span>(p3)  <span class="comment"># Point(1, 2)</span></span><br></pre></td></tr></table></figure><h2 id="实际应用场景：何时使用哪种拷贝？"><a href="#实际应用场景：何时使用哪种拷贝？" class="headerlink" title="实际应用场景：何时使用哪种拷贝？"></a>实际应用场景：何时使用哪种拷贝？</h2><p>在实际开发中，选择合适的拷贝方式非常重要。错误的选择可能导致bug，或者浪费性能。</p><hr><h3 id="❌-不要滥用深拷贝"><a href="#❌-不要滥用深拷贝" class="headerlink" title="❌ 不要滥用深拷贝"></a>❌ 不要滥用深拷贝</h3><p>深拷贝虽然安全，但有其代价：</p><ol><li><strong>性能开销</strong>：深拷贝需要递归遍历所有对象，对于大对象或深层嵌套结构，性能开销显著</li><li><strong>内存占用</strong>：创建完全独立的副本会占用更多内存</li><li><strong>可能过度复制</strong>：某些情况下，你可能不需要完全独立的副本，共享部分数据可能更合理</li><li><strong>循环引用处理</strong>：虽然Python能处理循环引用，但会增加复杂度</li></ol><h4 id="性能对比示例"><a href="#性能对比示例" class="headerlink" title="性能对比示例"></a>性能对比示例</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建大型嵌套结构</span></span><br><span class="line">large_list = [[i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试浅拷贝性能</span></span><br><span class="line">start = time.time()</span><br><span class="line">shallow_copy = copy.copy(large_list)</span><br><span class="line">shallow_time = time.time() - start</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试深拷贝性能</span></span><br><span class="line">start = time.time()</span><br><span class="line">deep_copy = copy.deepcopy(large_list)</span><br><span class="line">deep_time = time.time() - start</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;浅拷贝时间: <span class="subst">&#123;shallow_time:<span class="number">.4</span>f&#125;</span>秒&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;深拷贝时间: <span class="subst">&#123;deep_time:<span class="number">.4</span>f&#125;</span>秒&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;深拷贝比浅拷贝慢 <span class="subst">&#123;deep_time/shallow_time:<span class="number">.1</span>f&#125;</span>倍&quot;</span>)</span><br></pre></td></tr></table></figure><p>通常深拷贝会比浅拷贝慢10-100倍甚至更多，具体取决于对象的复杂程度。</p><hr><h3 id="✅-应该使用深拷贝的场景"><a href="#✅-应该使用深拷贝的场景" class="headerlink" title="✅ 应该使用深拷贝的场景"></a>✅ 应该使用深拷贝的场景</h3><h4 id="1-配置管理和模板"><a href="#1-配置管理和模板" class="headerlink" title="1. 配置管理和模板"></a>1. 配置管理和模板</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"><span class="comment"># 默认配置模板</span></span><br><span class="line">DEFAULT_CONFIG = &#123;</span><br><span class="line">    <span class="string">&#x27;database&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;host&#x27;</span>: <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;port&#x27;</span>: <span class="number">5432</span>,</span><br><span class="line">        <span class="string">&#x27;credentials&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: <span class="string">&#x27;admin&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;secret&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&#x27;cache&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;enabled&#x27;</span>: <span class="literal">True</span>,</span><br><span class="line">        <span class="string">&#x27;size&#x27;</span>: <span class="number">1000</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 为不同环境创建配置</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_environment_config</span>(<span class="params">env_name, overrides</span>):</span><br><span class="line">    config = copy.deepcopy(DEFAULT_CONFIG)  <span class="comment"># 深拷贝确保独立</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 合并覆盖配置</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">merge_config</span>(<span class="params">base, override</span>):</span><br><span class="line">        <span class="keyword">for</span> key, value <span class="keyword">in</span> override.items():</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">isinstance</span>(value, <span class="built_in">dict</span>) <span class="keyword">and</span> key <span class="keyword">in</span> base:</span><br><span class="line">                merge_config(base[key], value)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                base[key] = value</span><br><span class="line">    </span><br><span class="line">    merge_config(config, overrides)</span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用</span></span><br><span class="line">dev_config = create_environment_config(<span class="string">&#x27;dev&#x27;</span>, &#123;</span><br><span class="line">    <span class="string">&#x27;database&#x27;</span>: &#123;<span class="string">&#x27;host&#x27;</span>: <span class="string">&#x27;dev.example.com&#x27;</span>&#125;,</span><br><span class="line">    <span class="string">&#x27;cache&#x27;</span>: &#123;<span class="string">&#x27;size&#x27;</span>: <span class="number">500</span>&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">prod_config = create_environment_config(<span class="string">&#x27;prod&#x27;</span>, &#123;</span><br><span class="line">    <span class="string">&#x27;database&#x27;</span>: &#123;<span class="string">&#x27;host&#x27;</span>: <span class="string">&#x27;prod.example.com&#x27;</span>, <span class="string">&#x27;port&#x27;</span>: <span class="number">5433</span>&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 确保原配置不受影响</span></span><br><span class="line"><span class="built_in">print</span>(DEFAULT_CONFIG[<span class="string">&#x27;database&#x27;</span>][<span class="string">&#x27;host&#x27;</span>])  <span class="comment"># &#x27;localhost&#x27; ✅</span></span><br></pre></td></tr></table></figure><h4 id="2-状态快照和回滚"><a href="#2-状态快照和回滚" class="headerlink" title="2. 状态快照和回滚"></a>2. 状态快照和回滚</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Editor</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.content = []</span><br><span class="line">        <span class="variable language_">self</span>.history = []</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_line</span>(<span class="params">self, line</span>):</span><br><span class="line">        <span class="comment"># 保存状态快照（深拷贝）</span></span><br><span class="line">        <span class="variable language_">self</span>.history.append(copy.deepcopy(<span class="variable language_">self</span>.content))</span><br><span class="line">        <span class="variable language_">self</span>.content.append(line)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">undo</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.history:</span><br><span class="line">            <span class="variable language_">self</span>.content = <span class="variable language_">self</span>.history.pop()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用</span></span><br><span class="line">editor = Editor()</span><br><span class="line">editor.add_line(<span class="string">&quot;第一行&quot;</span>)</span><br><span class="line">editor.add_line(<span class="string">&quot;第二行&quot;</span>)</span><br><span class="line">editor.add_line(<span class="string">&quot;第三行&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(editor.content)  <span class="comment"># [&#x27;第一行&#x27;, &#x27;第二行&#x27;, &#x27;第三行&#x27;]</span></span><br><span class="line"></span><br><span class="line">editor.undo()</span><br><span class="line"><span class="built_in">print</span>(editor.content)  <span class="comment"># [&#x27;第一行&#x27;, &#x27;第二行&#x27;]</span></span><br></pre></td></tr></table></figure><h4 id="3-树形结构和图算法"><a href="#3-树形结构和图算法" class="headerlink" title="3. 树形结构和图算法"></a>3. 树形结构和图算法</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TreeNode</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, value, left=<span class="literal">None</span>, right=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.value = value</span><br><span class="line">        <span class="variable language_">self</span>.left = left</span><br><span class="line">        <span class="variable language_">self</span>.right = right</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">clone</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;创建完全独立的树副本&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> copy.deepcopy(<span class="variable language_">self</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;TreeNode(<span class="subst">&#123;self.value&#125;</span>)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用</span></span><br><span class="line">root = TreeNode(<span class="number">1</span>,</span><br><span class="line">    TreeNode(<span class="number">2</span>, TreeNode(<span class="number">4</span>), TreeNode(<span class="number">5</span>)),</span><br><span class="line">    TreeNode(<span class="number">3</span>)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 克隆树用于独立操作</span></span><br><span class="line">cloned_root = root.clone()</span><br><span class="line"><span class="comment"># 修改克隆树不会影响原树</span></span><br></pre></td></tr></table></figure><h4 id="4-测试数据隔离"><a href="#4-测试数据隔离" class="headerlink" title="4. 测试数据隔离"></a>4. 测试数据隔离</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试数据模板</span></span><br><span class="line">TEST_USER = &#123;</span><br><span class="line">    <span class="string">&#x27;id&#x27;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;Test User&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;profile&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;age&#x27;</span>: <span class="number">30</span>,</span><br><span class="line">        <span class="string">&#x27;email&#x27;</span>: <span class="string">&#x27;test@example.com&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;preferences&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;theme&#x27;</span>: <span class="string">&#x27;dark&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;language&#x27;</span>: <span class="string">&#x27;en&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_user_creation</span>():</span><br><span class="line">    <span class="comment"># 每个测试使用独立的数据副本</span></span><br><span class="line">    user = copy.deepcopy(TEST_USER)</span><br><span class="line">    <span class="comment"># 修改user不会影响TEST_USER</span></span><br><span class="line">    user[<span class="string">&#x27;name&#x27;</span>] = <span class="string">&#x27;Modified User&#x27;</span></span><br><span class="line">    <span class="keyword">assert</span> TEST_USER[<span class="string">&#x27;name&#x27;</span>] == <span class="string">&#x27;Test User&#x27;</span>  <span class="comment"># 原数据未被修改</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_user_update</span>():</span><br><span class="line">    user = copy.deepcopy(TEST_USER)</span><br><span class="line">    user[<span class="string">&#x27;profile&#x27;</span>][<span class="string">&#x27;age&#x27;</span>] = <span class="number">31</span></span><br><span class="line">    <span class="keyword">assert</span> TEST_USER[<span class="string">&#x27;profile&#x27;</span>][<span class="string">&#x27;age&#x27;</span>] == <span class="number">30</span>  <span class="comment"># 原数据未被修改</span></span><br></pre></td></tr></table></figure><h4 id="5-数据转换和处理管道"><a href="#5-数据转换和处理管道" class="headerlink" title="5. 数据转换和处理管道"></a>5. 数据转换和处理管道</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">process_data</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;处理数据，但不修改原始数据&quot;&quot;&quot;</span></span><br><span class="line">    processed = copy.deepcopy(data)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 对副本进行处理</span></span><br><span class="line">    <span class="comment"># ... 各种处理逻辑 ...</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> processed</span><br><span class="line"></span><br><span class="line"><span class="comment"># 原始数据保持不变，可以用于其他用途</span></span><br><span class="line">original_data = &#123;<span class="string">&#x27;key&#x27;</span>: <span class="string">&#x27;value&#x27;</span>, <span class="string">&#x27;nested&#x27;</span>: &#123;<span class="string">&#x27;data&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]&#125;&#125;</span><br><span class="line">processed_data = process_data(original_data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># original_data 和 processed_data 完全独立</span></span><br></pre></td></tr></table></figure><hr><h3 id="✅-应该使用浅拷贝的场景"><a href="#✅-应该使用浅拷贝的场景" class="headerlink" title="✅ 应该使用浅拷贝的场景"></a>✅ 应该使用浅拷贝的场景</h3><h4 id="1-只需要外层独立的情况"><a href="#1-只需要外层独立的情况" class="headerlink" title="1. 只需要外层独立的情况"></a>1. 只需要外层独立的情况</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"><span class="comment"># 假设我们有一个包含统计信息的列表</span></span><br><span class="line">data_points = [</span><br><span class="line">    &#123;<span class="string">&#x27;timestamp&#x27;</span>: <span class="number">1000</span>, <span class="string">&#x27;value&#x27;</span>: <span class="number">10</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;timestamp&#x27;</span>: <span class="number">2000</span>, <span class="string">&#x27;value&#x27;</span>: <span class="number">20</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;timestamp&#x27;</span>: <span class="number">3000</span>, <span class="string">&#x27;value&#x27;</span>: <span class="number">30</span>&#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 需要创建数据处理的不同视图，但不修改内部数据</span></span><br><span class="line">view1 = copy.copy(data_points)</span><br><span class="line">view2 = copy.copy(data_points)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 只在外层操作（如排序、过滤），不修改字典内部</span></span><br><span class="line">view1.sort(key=<span class="keyword">lambda</span> x: x[<span class="string">&#x27;value&#x27;</span>], reverse=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># data_points 和 view2 的顺序不受影响</span></span><br></pre></td></tr></table></figure><h4 id="2-对象包含大量共享的不可变数据"><a href="#2-对象包含大量共享的不可变数据" class="headerlink" title="2. 对象包含大量共享的不可变数据"></a>2. 对象包含大量共享的不可变数据</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Document</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, title, content, metadata</span>):</span><br><span class="line">        <span class="variable language_">self</span>.title = title  <span class="comment"># 字符串（不可变）</span></span><br><span class="line">        <span class="variable language_">self</span>.content = content  <span class="comment"># 字符串（不可变）</span></span><br><span class="line">        <span class="variable language_">self</span>.metadata = metadata  <span class="comment"># 字典（可变）</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">create_draft</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 创建草稿，共享不可变内容，只创建新的metadata</span></span><br><span class="line">        draft = copy.copy(<span class="variable language_">self</span>)</span><br><span class="line">        draft.metadata = copy.deepcopy(<span class="variable language_">self</span>.metadata)  <span class="comment"># 只深拷贝可变部分</span></span><br><span class="line">        draft.metadata[<span class="string">&#x27;status&#x27;</span>] = <span class="string">&#x27;draft&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> draft</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这样既节省内存，又确保可变部分独立</span></span><br></pre></td></tr></table></figure><h4 id="3-只读数据结构的临时修改"><a href="#3-只读数据结构的临时修改" class="headerlink" title="3. 只读数据结构的临时修改"></a>3. 只读数据结构的临时修改</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置数据（通常不修改）</span></span><br><span class="line">CONFIG = &#123;</span><br><span class="line">    <span class="string">&#x27;app_name&#x27;</span>: <span class="string">&#x27;MyApp&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;version&#x27;</span>: <span class="string">&#x27;1.0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;settings&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;debug&#x27;</span>: <span class="literal">False</span>,</span><br><span class="line">        <span class="string">&#x27;port&#x27;</span>: <span class="number">8000</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 临时修改用于某个操作</span></span><br><span class="line">temp_config = copy.copy(CONFIG)</span><br><span class="line">temp_config[<span class="string">&#x27;settings&#x27;</span>] = temp_config[<span class="string">&#x27;settings&#x27;</span>].copy()  <span class="comment"># 只浅拷贝settings</span></span><br><span class="line">temp_config[<span class="string">&#x27;settings&#x27;</span>][<span class="string">&#x27;debug&#x27;</span>] = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 只在temp_config中临时启用debug，不影响CONFIG</span></span><br></pre></td></tr></table></figure><hr><h3 id="🔍-决策流程图"><a href="#🔍-决策流程图" class="headerlink" title="🔍 决策流程图"></a>🔍 决策流程图</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">需要创建对象副本吗？</span><br><span class="line">    │</span><br><span class="line">    ├─ 不需要独立 → 使用赋值 (b = a)</span><br><span class="line">    │</span><br><span class="line">    ├─ 需要独立</span><br><span class="line">    │   │</span><br><span class="line">    │   ├─ 对象是否包含嵌套的可变对象？</span><br><span class="line">    │   │   │</span><br><span class="line">    │   │   ├─ 否 → 使用浅拷贝 (copy.copy 或 .copy())</span><br><span class="line">    │   │   │</span><br><span class="line">    │   │   └─ 是</span><br><span class="line">    │   │       │</span><br><span class="line">    │   │       ├─ 会修改嵌套对象吗？</span><br><span class="line">    │   │       │   │</span><br><span class="line">    │   │       │   ├─ 否 → 浅拷贝可能足够（需谨慎）</span><br><span class="line">    │   │       │   │</span><br><span class="line">    │   │       │   └─ 是 → 使用深拷贝 (copy.deepcopy)</span><br><span class="line">    │   │       │</span><br><span class="line">    │   │       └─ 性能要求高吗？</span><br><span class="line">    │   │           │</span><br><span class="line">    │   │           ├─ 是 → 考虑使用浅拷贝 + 手动深拷贝可变部分</span><br><span class="line">    │   │           │</span><br><span class="line">    │   │           └─ 否 → 使用深拷贝（更安全）</span><br></pre></td></tr></table></figure><hr><h2 id="性能优化建议"><a href="#性能优化建议" class="headerlink" title="性能优化建议"></a>性能优化建议</h2><h3 id="1-混合策略：部分深拷贝"><a href="#1-混合策略：部分深拷贝" class="headerlink" title="1. 混合策略：部分深拷贝"></a>1. 混合策略：部分深拷贝</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">smart_copy</span>(<span class="params">obj</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;智能拷贝：对不可变对象使用浅拷贝，对可变对象使用深拷贝&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(obj, (<span class="built_in">int</span>, <span class="built_in">float</span>, <span class="built_in">str</span>, <span class="built_in">tuple</span>, <span class="built_in">frozenset</span>)):</span><br><span class="line">        <span class="keyword">return</span> obj  <span class="comment"># 不可变对象直接返回</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">isinstance</span>(obj, <span class="built_in">list</span>):</span><br><span class="line">        <span class="keyword">return</span> [smart_copy(item) <span class="keyword">for</span> item <span class="keyword">in</span> obj]</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">isinstance</span>(obj, <span class="built_in">dict</span>):</span><br><span class="line">        <span class="keyword">return</span> &#123;key: smart_copy(value) <span class="keyword">for</span> key, value <span class="keyword">in</span> obj.items()&#125;</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">isinstance</span>(obj, <span class="built_in">set</span>):</span><br><span class="line">        <span class="keyword">return</span> &#123;smart_copy(item) <span class="keyword">for</span> item <span class="keyword">in</span> obj&#125;</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> copy.deepcopy(obj)  <span class="comment"># 自定义对象使用深拷贝</span></span><br></pre></td></tr></table></figure><h3 id="2-使用生成器避免不必要的拷贝"><a href="#2-使用生成器避免不必要的拷贝" class="headerlink" title="2. 使用生成器避免不必要的拷贝"></a>2. 使用生成器避免不必要的拷贝</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不需要修改数据，只是查看不同视图</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">filtered_view</span>(<span class="params">data, condition</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;返回过滤后的视图，不创建副本&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> (item <span class="keyword">for</span> item <span class="keyword">in</span> data <span class="keyword">if</span> condition(item))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 只在真正需要列表时才转换</span></span><br><span class="line">filtered_list = <span class="built_in">list</span>(filtered_view(data, <span class="keyword">lambda</span> x: x &gt; <span class="number">0</span>))</span><br></pre></td></tr></table></figure><h3 id="3-延迟拷贝（Copy-on-Write）"><a href="#3-延迟拷贝（Copy-on-Write）" class="headerlink" title="3. 延迟拷贝（Copy-on-Write）"></a>3. 延迟拷贝（Copy-on-Write）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">LazyCopy</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;延迟拷贝：只有在修改时才创建副本&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, obj</span>):</span><br><span class="line">        <span class="variable language_">self</span>._obj = obj</span><br><span class="line">        <span class="variable language_">self</span>._copy = <span class="literal">None</span></span><br><span class="line">        <span class="variable language_">self</span>._copied = <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_ensure_copy</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="variable language_">self</span>._copied:</span><br><span class="line">            <span class="variable language_">self</span>._copy = copy.deepcopy(<span class="variable language_">self</span>._obj)</span><br><span class="line">            <span class="variable language_">self</span>._copied = <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, key</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>._copied:</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">self</span>._copy[key]</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>._obj[key]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__setitem__</span>(<span class="params">self, key, value</span>):</span><br><span class="line">        <span class="variable language_">self</span>._ensure_copy()</span><br><span class="line">        <span class="variable language_">self</span>._copy[key] = value</span><br></pre></td></tr></table></figure><hr><h2 id="总结与最佳实践"><a href="#总结与最佳实践" class="headerlink" title="总结与最佳实践"></a>总结与最佳实践</h2><h3 id="核心要点回顾"><a href="#核心要点回顾" class="headerlink" title="核心要点回顾"></a>核心要点回顾</h3><ol><li><strong>理解Python的引用模型</strong>：变量是引用，不是对象本身</li><li><strong>浅拷贝</strong>：只复制外层，内部共享（适合简单场景，需谨慎）</li><li><strong>深拷贝</strong>：完全独立（安全但性能开销大）</li><li><strong>不可变对象优化</strong>：Python会复用不可变对象，无需担心</li></ol><h3 id="最佳实践清单"><a href="#最佳实践清单" class="headerlink" title="最佳实践清单"></a>最佳实践清单</h3><p>✅ <strong>应该做的</strong>：</p><ul><li>对于嵌套的可变对象，优先考虑深拷贝</li><li>在函数中使用默认参数时，使用<code>None</code>并创建新对象</li><li>在测试中始终使用深拷贝来隔离数据</li><li>对于配置管理，使用深拷贝创建独立副本</li><li>理解你的数据结构，选择合适的拷贝方式</li></ul><p>❌ <strong>不应该做的</strong>：</p><ul><li>不要盲目使用深拷贝，考虑性能影响</li><li>不要假设浅拷贝是完全独立的</li><li>不要在循环中频繁进行深拷贝</li><li>不要忽略不可变对象的复用优化</li></ul><h3 id="调试技巧"><a href="#调试技巧" class="headerlink" title="调试技巧"></a>调试技巧</h3><p>如果遇到因为拷贝导致的bug，可以使用以下技巧：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compare_objects</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;比较两个对象是否共享引用&quot;&quot;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;外层对象相同: <span class="subst">&#123;a <span class="keyword">is</span> b&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(a, (<span class="built_in">list</span>, <span class="built_in">dict</span>, <span class="built_in">tuple</span>)) <span class="keyword">and</span> <span class="built_in">isinstance</span>(b, (<span class="built_in">list</span>, <span class="built_in">dict</span>, <span class="built_in">tuple</span>)):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(a) == <span class="built_in">len</span>(b):</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">isinstance</span>(a, <span class="built_in">dict</span>):</span><br><span class="line">                    key = <span class="built_in">list</span>(a.keys())[i]</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;key&#125;</span>: <span class="subst">&#123;a[key] <span class="keyword">is</span> b[key]&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;  [<span class="subst">&#123;i&#125;</span>]: <span class="subst">&#123;a[i] <span class="keyword">is</span> b[i]&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用示例</span></span><br><span class="line">original = [<span class="number">1</span>, [<span class="number">2</span>, <span class="number">3</span>]]</span><br><span class="line">copied = copy.copy(original)</span><br><span class="line">compare_objects(original, copied)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 拷贝 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>指针和引用的区别</title>
      <link href="/JasmineRain.github.io/2026/01/12/%E6%8C%87%E9%92%88%E5%92%8C%E5%BC%95%E7%94%A8%E7%9A%84%E5%8C%BA%E5%88%AB/"/>
      <url>/JasmineRain.github.io/2026/01/12/%E6%8C%87%E9%92%88%E5%92%8C%E5%BC%95%E7%94%A8%E7%9A%84%E5%8C%BA%E5%88%AB/</url>
      
        <content type="html"><![CDATA[<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>指针是保存地址的变量，可以为空、可变；<br>引用是变量的别名，必须初始化、不可为空、不可重新绑定。<br>cpp中优先使用引用，只有在需要“可空&#x2F;可变指向”时才使用指针</p><h2 id="指针和引用对照"><a href="#指针和引用对照" class="headerlink" title="指针和引用对照"></a>指针和引用对照</h2><table><thead><tr><th>对比点</th><th>指针(Pointer)</th><th>引用(Reference)</th></tr></thead><tbody><tr><td>本质</td><td>保存地址的变量</td><td>变量的别名</td></tr><tr><td>是否必须初始化</td><td>否</td><td>是</td></tr><tr><td>是否可以为空</td><td>是</td><td>否</td></tr><tr><td>是否可以改变指向</td><td>是</td><td>否</td></tr><tr><td>是否有独立内存</td><td>有</td><td>无</td></tr><tr><td>访问方式</td><td>*p解引用</td><td>直接用变量名</td></tr><tr><td>sizeof</td><td>指针大小（8字节）</td><td>等于所引用对象大小</td></tr><tr><td>多级</td><td>int**</td><td>不存在</td></tr><tr><td>常见用途</td><td>动态数组、数组、指针传参</td><td>参数传递、返回值</td></tr></tbody></table><h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><h3 id="指针"><a href="#指针" class="headerlink" title="指针"></a>指针</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="type">int</span>* p = &amp;a;</span><br><span class="line"></span><br><span class="line">*p = <span class="number">20</span>;</span><br><span class="line">cout &lt;&lt; a;   <span class="comment">// 20</span></span><br></pre></td></tr></table></figure><blockquote><p><code>p</code>存的是<code>a</code>的地址<br>需要<code>*</code>才能访问值</p></blockquote><h3 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="type">int</span>&amp; r = a;</span><br><span class="line"></span><br><span class="line">r = <span class="number">20</span>;</span><br><span class="line">cout &lt;&lt; a;   <span class="comment">// 20</span></span><br></pre></td></tr></table></figure><blockquote><p><code>r</code>就是<code>a</code>不需要<code>*</code></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> cpp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 指针和引用 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2025.12.30计网期末</title>
      <link href="/JasmineRain.github.io/2025/12/28/2025-12-30%E8%AE%A1%E7%BD%91%E6%9C%9F%E6%9C%AB/"/>
      <url>/JasmineRain.github.io/2025/12/28/2025-12-30%E8%AE%A1%E7%BD%91%E6%9C%9F%E6%9C%AB/</url>
      
        <content type="html"><![CDATA[<ul><li><p>ISP(Internet Service Provider),互联网服务提供商</p></li><li><p>ICP(Internet Content Provider),互联网内容提供商</p></li><li><p>IDC(Internet Data Center),互联网数据中心</p></li><li><p>ASP(Active Server Pages),动态服务器页面</p></li><li><p>Internet的网络层四个重要协议，IP,ICMP,ARP,RARP</p></li><li><p>ICMP(Internet Control Message Protocol)负责传输控制和差错报告信息</p></li><li><p>在允许丢包的前提下，UDP相比TCP的传输效率更高</p></li><li><p>局域网拓扑结构没有统一的模式</p></li><li><p>在HTTP协议中，请求报文中的请求行包括：请求方法、URL和HTTP版本号</p></li><li><p>一个网卡的硬件地址是烧写在其ROM中的</p></li><li><p>理想低通信道的最高码元传输速率为2WBaud</p></li><li><p>采用星型拓扑的 10Mbps 基带双绞线以太网可以表示为10BaseT</p></li><li><p>在连续ARQ协议中，当滑动窗口序号位数为n，则发送窗口最大尺寸为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^n-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7477em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></p></li><li><p>互联网的主要硬件设备有中继器、网桥和路由器</p></li><li><p>汇接局全覆盖适合于中等城市的本地网的网路组织</p></li><li><p>TDM(时分复用)是典型的电路交换网络的关键技术。在电路交换网络中,TDM通过将传输线路的使用时间划分成固定的时间片,让多个用户轮流使用同一条物理线路进行通信,从而实现多路复用。</p></li><li><p>CSMA&#x2F;CD协议中最小帧长度与传输距离的关系。最小帧长(bit) &#x3D; 2 × 传输速率(bps) × 2τ<br>其中τ是信号在最远两个站点之间传播的时间。</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> 期末 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 计网 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Prompt设计</title>
      <link href="/JasmineRain.github.io/2025/12/11/Prompt%E8%AE%BE%E8%AE%A1/"/>
      <url>/JasmineRain.github.io/2025/12/11/Prompt%E8%AE%BE%E8%AE%A1/</url>
      
        <content type="html"><![CDATA[<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>Prompt设计&#x3D;如何用指令让大模型产生稳定、可控、正确的输出。</p><h2 id="Prompt的基本结构"><a href="#Prompt的基本结构" class="headerlink" title="Prompt的基本结构"></a>Prompt的基本结构</h2><ul><li>角色(Role)</li><li>任务(Task)</li><li>格式要求(Format)</li><li>约束(Constraints)</li><li>示例(Examples,Few-shot)</li></ul><p>优秀的Prompt&#x3D;角色+任务+限制+示例+输出格式</p><h2 id="Prompt的四大经典模式"><a href="#Prompt的四大经典模式" class="headerlink" title="Prompt的四大经典模式"></a>Prompt的四大经典模式</h2><h3 id="Zero-shot-Prompt"><a href="#Zero-shot-Prompt" class="headerlink" title="Zero-shot Prompt"></a>Zero-shot Prompt</h3><p>不给示例，让大模型直接回答。</p><blockquote><p>初步测试模型能力。</p></blockquote><h3 id="Few-shot-Prompt"><a href="#Few-shot-Prompt" class="headerlink" title="Few-shot Prompt"></a>Few-shot Prompt</h3><p>给模型几个示例，让它模仿输出格式</p><blockquote><p>提高稳定性、一致性、减少模型走偏</p></blockquote><h3 id="Chain-of-Thought"><a href="#Chain-of-Thought" class="headerlink" title="Chain of Thought"></a>Chain of Thought</h3><p>让模型展示推理过程，提升逻辑正确率</p><blockquote><p>数学、推理、复杂逻辑测试</p></blockquote><h3 id="Self-Consistency"><a href="#Self-Consistency" class="headerlink" title="Self-Consistency"></a>Self-Consistency</h3><p>让模型给多个答案，再综合最佳解</p><blockquote><p>减少错误和逻辑混乱</p></blockquote><h2 id="Prompt设计中常见问题-如何避免"><a href="#Prompt设计中常见问题-如何避免" class="headerlink" title="Prompt设计中常见问题&amp;如何避免"></a>Prompt设计中常见问题&amp;如何避免</h2><h3 id="模糊指令"><a href="#模糊指令" class="headerlink" title="模糊指令"></a>模糊指令</h3><p>模型会胡乱发挥</p><blockquote><p>用明确任务+输出格式避免</p></blockquote><h3 id="缺乏格式约束"><a href="#缺乏格式约束" class="headerlink" title="缺乏格式约束"></a>缺乏格式约束</h3><p>模型输出多余内容</p><blockquote><p>用结构化输出约束</p></blockquote><h3 id="提问太宽泛"><a href="#提问太宽泛" class="headerlink" title="提问太宽泛"></a>提问太宽泛</h3><p>容易出现幻觉</p><blockquote><p>用范围限制</p></blockquote><h2 id="Prompt在大模型中的应用"><a href="#Prompt在大模型中的应用" class="headerlink" title="Prompt在大模型中的应用"></a>Prompt在大模型中的应用</h2><ol><li>构建测评用例：限定任务、限定输出格式、避免模型自由发挥</li><li>测试稳定性：用同一Prompt多次调用，看模型输出一致性</li><li>对话场景模拟：多轮、自然语言噪声、用户不规范输入</li><li>Prompt防越狱(Jailbreak)测试:测试模型是否能守住安全边界</li></ol>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
          <category> 大模型 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Prompt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ADSL</title>
      <link href="/JasmineRain.github.io/2025/12/09/ADSL/"/>
      <url>/JasmineRain.github.io/2025/12/09/ADSL/</url>
      
        <content type="html"><![CDATA[<h2 id="📡-ADSL"><a href="#📡-ADSL" class="headerlink" title="📡 ADSL"></a>📡 ADSL</h2><p><strong>ADSL（Asymmetric Digital Subscriber Line）非对称数字用户线路</strong>是一种利用 <strong>普通电话线（铜线）提供宽带上网</strong> 的技术。</p><p><strong>ADSL &#x3D; 用电话线实现宽带，下行快、上行慢，能同时打电话 + 上网。</strong></p><p><strong>非对称</strong> 指：<br>👉 <strong>下载速率 &gt; 上传速率</strong></p><p>例如：下行 10 Mbps，上行 1 Mbps。</p><hr><h2 id="🧩-ADSL-的作用"><a href="#🧩-ADSL-的作用" class="headerlink" title="🧩 ADSL 的作用"></a>🧩 ADSL 的作用</h2><ul><li>让用户在 <strong>不更换电话线</strong> 的前提下使用宽带上网</li><li>同时支持：<br>✔ 上网<br>✔ 打电话<br>✔ 视频<br>互不干扰</li></ul><hr><h2 id="🔧-ADSL-的核心原理"><a href="#🔧-ADSL-的核心原理" class="headerlink" title="🔧 ADSL 的核心原理"></a>🔧 ADSL 的核心原理</h2><p>利用电话线 <strong>高频部分传输数据</strong>，低频部分继续传输语音。</p><h3 id="电话线频率分割"><a href="#电话线频率分割" class="headerlink" title="电话线频率分割"></a>电话线频率分割</h3><table><thead><tr><th>功能</th><th>频率范围</th></tr></thead><tbody><tr><td>语音电话</td><td>0 ~ 4 kHz</td></tr><tr><td>上行数据</td><td>25 ~ 138 kHz</td></tr><tr><td>下行数据</td><td>138 kHz ~ 1.1 MHz</td></tr></tbody></table><p>这就是为什么 ADSL <strong>可以边打电话边上网</strong>。</p><hr><h2 id="🔌-ADSL-上网需要哪些设备"><a href="#🔌-ADSL-上网需要哪些设备" class="headerlink" title="🔌 ADSL 上网需要哪些设备"></a>🔌 ADSL 上网需要哪些设备</h2><ol><li><p><strong>ADSL Modem（猫）</strong><br>把电话线信号转换为数字数据。</p></li><li><p><strong>分离器（Splitter）</strong><br>用来把语音信号和宽带信号分离。</p></li></ol><p>家庭连接方式：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">电话线 → 分离器 →（语音）电话机</span><br><span class="line"><span class="code">                      →（数据）ADSL Modem → 路由器 → Wi-Fi</span></span><br></pre></td></tr></table></figure><hr><h2 id="🚀-ADSL-的技术特点"><a href="#🚀-ADSL-的技术特点" class="headerlink" title="🚀 ADSL 的技术特点"></a>🚀 ADSL 的技术特点</h2><h3 id="⭐-优点"><a href="#⭐-优点" class="headerlink" title="⭐ 优点"></a>⭐ 优点</h3><ul><li>利用现有电话线，部署成本低</li><li>下载速度较快（适合家庭上网）</li><li>不影响电话通话</li></ul><h3 id="❗-缺点"><a href="#❗-缺点" class="headerlink" title="❗ 缺点"></a>❗ 缺点</h3><ul><li>上传速度低（非对称）</li><li>距离越远越慢（离机房越远速度越低）</li><li>信号容易受干扰，稳定性不如光纤</li><li>带宽上限较低（几十 Mbps 左右）</li></ul><hr><h2 id="🔥-ADSL-已被取代"><a href="#🔥-ADSL-已被取代" class="headerlink" title="🔥 ADSL 已被取代"></a>🔥 ADSL 已被取代</h2><p>现在大多数家庭已从 ADSL 升级到：</p><ul><li><strong>FTTH（光纤入户）</strong></li><li><strong>FTTB</strong></li><li><strong>HFC（光纤同轴混合）</strong></li></ul><p>光纤相比 ADSL：<br>💡 更快<br>💡 更稳定<br>💡 对距离几乎不敏感</p>]]></content>
      
      
      <categories>
          
          <category> 计网 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 计网 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TCP和UDP</title>
      <link href="/JasmineRain.github.io/2025/12/09/TCP%E5%92%8CUDP/"/>
      <url>/JasmineRain.github.io/2025/12/09/TCP%E5%92%8CUDP/</url>
      
        <content type="html"><![CDATA[<h2 id="👉总结"><a href="#👉总结" class="headerlink" title="👉总结"></a>👉总结</h2><p><strong>TCP：有连接、有序、可靠 → 慢。</strong><br><strong>UDP：无连接、不可靠 → 快。</strong></p><h2 id="🚀-TCP（Transmission-Control-Protocol）"><a href="#🚀-TCP（Transmission-Control-Protocol）" class="headerlink" title="🚀 TCP（Transmission Control Protocol）"></a>🚀 TCP（Transmission Control Protocol）</h2><p><strong>面向连接、可靠传输、字节流</strong>。</p><h3 id="⭐-TCP-的特点"><a href="#⭐-TCP-的特点" class="headerlink" title="⭐ TCP 的特点"></a>⭐ TCP 的特点</h3><table><thead><tr><th>特点</th><th>说明</th></tr></thead><tbody><tr><td><strong>面向连接</strong></td><td>三次握手建立连接、四次挥手关闭</td></tr><tr><td><strong>可靠传输</strong></td><td>超时重传、确认应答、序列号、滑动窗口</td></tr><tr><td><strong>有序传输</strong></td><td>丢包&#x2F;乱序会自动重排</td></tr><tr><td><strong>流量控制</strong></td><td>滑动窗口避免发送过快</td></tr><tr><td><strong>拥塞控制</strong></td><td>慢启动、拥塞避免、快速重传等</td></tr><tr><td><strong>面向字节流</strong></td><td>数据没有界限，需要应用层自己定义边界</td></tr></tbody></table><p>📍 <strong>适用场景：</strong><br>需要保证数据可靠、有序，如：<br>HTTP、HTTPS、FTP、SMTP、SSH…</p><hr><h2 id="🚀-UDP（User-Datagram-Protocol）"><a href="#🚀-UDP（User-Datagram-Protocol）" class="headerlink" title="🚀 UDP（User Datagram Protocol）"></a>🚀 UDP（User Datagram Protocol）</h2><p><strong>无连接、不可靠、面向报文</strong>。</p><h3 id="⭐-UDP-的特点"><a href="#⭐-UDP-的特点" class="headerlink" title="⭐ UDP 的特点"></a>⭐ UDP 的特点</h3><table><thead><tr><th>特点</th><th>说明</th></tr></thead><tbody><tr><td><strong>无连接</strong></td><td>无需握手，直接发送</td></tr><tr><td><strong>不保证可靠性</strong></td><td>不重传、不确认、不保证顺序</td></tr><tr><td><strong>面向报文</strong></td><td>发一次就是一个独立报文，不拆不并</td></tr><tr><td><strong>速度快、开销小</strong></td><td>适合实时场景</td></tr><tr><td><strong>可以广播和组播</strong></td><td>TCP 不支持</td></tr></tbody></table><p>📍 <strong>适用场景：</strong><br>速度优先、实时性要求高，如：<br>直播、游戏、语音通话、视频会议、DNS 查询…</p><hr><h2 id="🔥-TCP-vs-UDP-对比表"><a href="#🔥-TCP-vs-UDP-对比表" class="headerlink" title="🔥 TCP vs UDP 对比表"></a>🔥 TCP vs UDP 对比表</h2><table><thead><tr><th>特性</th><th>TCP</th><th>UDP</th></tr></thead><tbody><tr><td>是否连接</td><td>✅面向连接</td><td>❌ 无连接</td></tr><tr><td>可靠性</td><td>✅可靠</td><td>❌ 不可靠</td></tr><tr><td>顺序性</td><td>✅保证顺序</td><td>❌ 不保证</td></tr><tr><td>速度</td><td>慢</td><td>快</td></tr><tr><td>是否重传</td><td>✅会重传</td><td>❌ 不</td></tr><tr><td>开销</td><td>大</td><td>小</td></tr><tr><td>是否流控&#x2F;拥塞控制</td><td>✅有</td><td>❌ 没有</td></tr><tr><td>分组方式</td><td>字节流</td><td>报文</td></tr><tr><td>是否支持广播</td><td>❌ 不支持</td><td>✅支持</td></tr></tbody></table><hr><h2 id="📡-TCP-连接管理简图"><a href="#📡-TCP-连接管理简图" class="headerlink" title="📡 TCP 连接管理简图"></a>📡 TCP 连接管理简图</h2><p><strong>三次握手</strong>：</p><ol><li>SYN</li><li>SYN + ACK</li><li>ACK</li></ol><p><strong>四次挥手</strong>：</p><ol><li>FIN</li><li>ACK</li><li>FIN</li><li>ACK</li></ol>]]></content>
      
      
      <categories>
          
          <category> 计网 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 计网 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>路由器</title>
      <link href="/JasmineRain.github.io/2025/12/09/%E8%B7%AF%E7%94%B1%E5%99%A8/"/>
      <url>/JasmineRain.github.io/2025/12/09/%E8%B7%AF%E7%94%B1%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="🚀-什么是路由器（Router）"><a href="#🚀-什么是路由器（Router）" class="headerlink" title="🚀 什么是路由器（Router）"></a>🚀 什么是路由器（Router）</h2><p><strong>路由器是一种连接多个网络并根据路由规则“转发数据包”的网络层设备。</strong></p><p>它工作在 <strong>OSI 第三层——网络层</strong>。<br>在不同的局域网、广域网之间，路由器负责决定数据包“下一跳到哪去”。</p><hr><h2 id="🧩-路由器的主要作用"><a href="#🧩-路由器的主要作用" class="headerlink" title="🧩 路由器的主要作用"></a>🧩 路由器的主要作用</h2><h3 id="1️⃣-实现不同网络之间的通信"><a href="#1️⃣-实现不同网络之间的通信" class="headerlink" title="1️⃣ 实现不同网络之间的通信"></a>1️⃣ <strong>实现不同网络之间的通信</strong></h3><p>不同网段（如 192.168.1.x 与 192.168.2.x）无法直接通信，需要路由器连接。</p><h3 id="2️⃣-选择最佳路径（路由选择）"><a href="#2️⃣-选择最佳路径（路由选择）" class="headerlink" title="2️⃣ 选择最佳路径（路由选择）"></a>2️⃣ <strong>选择最佳路径（路由选择）</strong></h3><p>路由器根据路由表决定数据从哪条路径走。</p><h3 id="3️⃣-数据包转发（路由转发）"><a href="#3️⃣-数据包转发（路由转发）" class="headerlink" title="3️⃣ 数据包转发（路由转发）"></a>3️⃣ <strong>数据包转发（路由转发）</strong></h3><p>收到数据包 → 查看目的 IP → 查路由表 → 转发到下一跳。</p><h3 id="4️⃣-网络隔离-安全管理"><a href="#4️⃣-网络隔离-安全管理" class="headerlink" title="4️⃣ 网络隔离 + 安全管理"></a>4️⃣ <strong>网络隔离 + 安全管理</strong></h3><p>NAT、防火墙、ACL 等功能能隔离内外网。</p><h3 id="5️⃣-提供无线功能（家用路由器）"><a href="#5️⃣-提供无线功能（家用路由器）" class="headerlink" title="5️⃣ 提供无线功能（家用路由器）"></a>5️⃣ <strong>提供无线功能（家用路由器）</strong></h3><p>无线路由器 &#x3D; 路由 + 交换机 + AP（无线接入点）+ DHCP 等功能。</p><hr><h2 id="📡-路由器的核心功能详解"><a href="#📡-路由器的核心功能详解" class="headerlink" title="📡 路由器的核心功能详解"></a>📡 路由器的核心功能详解</h2><h3 id="①-路由选择（Routing）"><a href="#①-路由选择（Routing）" class="headerlink" title="① 路由选择（Routing）"></a>① 路由选择（Routing）</h3><p>通过路由协议建立路由表，如：</p><ul><li><strong>静态路由</strong></li><li><strong>RIP</strong>（距离向量）</li><li><strong>OSPF</strong>（链路状态）</li><li><strong>BGP</strong>（互联网骨干路由协议）</li></ul><p>路由器计算最优路径，然后填到路由表。</p><h3 id="②-路由转发（Forwarding）"><a href="#②-路由转发（Forwarding）" class="headerlink" title="② 路由转发（Forwarding）"></a>② 路由转发（Forwarding）</h3><p>路由器按“最长前缀匹配”原则，从路由表中找最佳条目，然后把包发出去。</p><h3 id="③-NAT（网络地址转换）"><a href="#③-NAT（网络地址转换）" class="headerlink" title="③ NAT（网络地址转换）"></a>③ NAT（网络地址转换）</h3><p>将私网 IP（如 192.168.x.x）转换成公网 IP，使内网电脑共同访问互联网。</p><p>家用路由器都依靠 NAT 上网。</p><h3 id="④-DHCP（提供自动分配-IP）"><a href="#④-DHCP（提供自动分配-IP）" class="headerlink" title="④ DHCP（提供自动分配 IP）"></a>④ DHCP（提供自动分配 IP）</h3><p>很多路由器内置 DHCP 服务器，为终端自动分配：</p><ul><li>IP 地址</li><li>子网掩码</li><li>网关</li><li>DNS</li></ul><hr><h2 id="🔥-路由器-vs-交换机"><a href="#🔥-路由器-vs-交换机" class="headerlink" title="🔥 路由器 vs 交换机"></a>🔥 路由器 vs 交换机</h2><table><thead><tr><th>设备</th><th>工作层级</th><th>区分依据</th><th>作用</th></tr></thead><tbody><tr><td><strong>交换机（Switch）</strong></td><td>数据链路层（第 2 层）</td><td>MAC 地址</td><td>连接同一局域网</td></tr><tr><td><strong>路由器（Router）</strong></td><td>网络层（第 3 层）</td><td>IP 地址</td><td>连接不同网络</td></tr></tbody></table><p>总结：<br>➡ <strong>交换机连网段，路由器连网络。</strong></p><hr><h2 id="🏠-家用路由器实际上是“三合一”"><a href="#🏠-家用路由器实际上是“三合一”" class="headerlink" title="🏠 家用路由器实际上是“三合一”"></a>🏠 家用路由器实际上是“三合一”</h2><ol><li>路由器（负责转发互联网流量）</li><li>交换机（LAN 口互联）</li><li>无线 AP（Wi-Fi 功能）</li></ol><p>所以普通用户只叫它“路由器”。</p><hr><h2 id="🔥-路由器的组成"><a href="#🔥-路由器的组成" class="headerlink" title="🔥 路由器的组成"></a>🔥 路由器的组成</h2><ul><li><strong>输入端口（Input Port）</strong></li><li><strong>交换结构（Switching Fabric）</strong></li><li><strong>输出端口（Output Port）</strong></li><li><strong>路由处理器（Route Processor）</strong></li></ul><hr><h2 id="🧠-一句话总结"><a href="#🧠-一句话总结" class="headerlink" title="🧠 一句话总结"></a>🧠 一句话总结</h2><p><strong>路由器决定数据包走哪条路，确保不同网络之间能互相通信，它是网络层的核心设备。</strong></p>]]></content>
      
      
      <categories>
          
          <category> 计网 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 计网 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ARP和RARP</title>
      <link href="/JasmineRain.github.io/2025/12/09/ARP%E5%92%8CRARP/"/>
      <url>/JasmineRain.github.io/2025/12/09/ARP%E5%92%8CRARP/</url>
      
        <content type="html"><![CDATA[<h2 id="✅ARP（Address-Resolution-Protocol）地址解析协议"><a href="#✅ARP（Address-Resolution-Protocol）地址解析协议" class="headerlink" title="✅ARP（Address Resolution Protocol）地址解析协议"></a>✅ARP（Address Resolution Protocol）地址解析协议</h2><p>作用：👉已知IP地址，求MAC地址</p><p>使用场景：🎬主机在发送数据时，链路层需要目标MAC地址。如果ARP缓存里没有，就必须用ARP</p><p>工作流程：👔</p><ul><li>ARP 请求广播：<ul><li>源主机广播：“谁是 IP &#x3D; X.X.X.X？请把 MAC 地址告诉我。”</li></ul></li><li>ARP 响应单播：<ul><li>目标主机回复：“我的 MAC 地址是 xx-xx-xx-xx-xx-xx。”</li></ul></li><li>ARP 缓存<ul><li>主机保存 IP ? MAC 的映射，提高效率。</li></ul></li></ul><p>特点：🕵️</p><ul><li>请求是<strong>广播</strong></li><li>响应是<strong>单播</strong></li><li>属于<strong>网络层和链路层之间的协议</strong></li></ul><h2 id="✅RARP（Reverse-ARP）反向地址解析协议"><a href="#✅RARP（Reverse-ARP）反向地址解析协议" class="headerlink" title="✅RARP（Reverse ARP）反向地址解析协议"></a>✅RARP（Reverse ARP）反向地址解析协议</h2><p>作用：👉已知 MAC 地址，求 IP 地址。</p><p>典型用途：<br>🎬早期用于 无盘工作站。<br>无盘设备只有网卡 MAC，没有本地存储 IP，需要通过 RARP 服务器获取 IP。</p><p>工作流程：👔</p><ul><li>主机发送 RARP 请求广播：<ul><li>“我的 MAC 地址是 xxx，谁能告诉我我的 IP？”</li></ul></li><li>RARP 服务器单播响应：<ul><li>告诉它对应的 IP。</li></ul></li></ul><p>缺点（导致淘汰的原因）：🕵️<br>❌必须在同一局域网<br>❌需要专门的 RARP 服务器<br>❌只能分配 IP，不能配置网关、掩码等</p><p>已被替代：<br>👍BOOTP → DHCP（现代网络几乎都靠 DHCP 分配 IP）</p><p>🔥ARP 与 RARP 对比表</p><table><thead><tr><th>协议</th><th>已知</th><th>求解</th><th>使用方式</th><th>是否继续使用</th></tr></thead><tbody><tr><td>ARP</td><td>IP 地址</td><td>MAC 地址</td><td>广播请求+单播响应</td><td>?仍广泛使用</td></tr><tr><td>RARP</td><td>MAC 地址</td><td>IP 地址</td><td>广播请求 + 单播响应</td><td>? 被 DHCP 取代</td></tr></tbody></table><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>ARP：IP → MAC（发送前查 MAC）<br>RARP：MAC → IP（无盘机查 IP）</p>]]></content>
      
      
      <categories>
          
          <category> 计网 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 计网 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>路由选择协议</title>
      <link href="/JasmineRain.github.io/2025/12/04/%E8%B7%AF%E7%94%B1%E9%80%89%E6%8B%A9%E5%8D%8F%E8%AE%AE/"/>
      <url>/JasmineRain.github.io/2025/12/04/%E8%B7%AF%E7%94%B1%E9%80%89%E6%8B%A9%E5%8D%8F%E8%AE%AE/</url>
      
        <content type="html"><![CDATA[<h2 id="🚦-路由选择协议（Routing-Protocol）"><a href="#🚦-路由选择协议（Routing-Protocol）" class="headerlink" title="🚦 路由选择协议（Routing Protocol）"></a>🚦 路由选择协议（Routing Protocol）</h2><p>“路由选择协议”用于让路由器自动发现网络拓扑、计算路径、维护路由表，从而实现数据包的最优转发。</p><h2 id="📌-路由选择协议分类"><a href="#📌-路由选择协议分类" class="headerlink" title="📌 路由选择协议分类"></a>📌 路由选择协议分类</h2><h3 id="静态路由-vs-动态路由"><a href="#静态路由-vs-动态路由" class="headerlink" title="静态路由 vs 动态路由"></a>静态路由 vs 动态路由</h3><p>静态路由（Static Routing）：管理员手动配置，拓扑变化不会自动更新</p><p>动态路由（Dynamic Routing）：路由器通过协议自动交换信息并更新路径</p><h3 id="内部网关协议（IGP）-vs-外部网关协议（EGP）"><a href="#内部网关协议（IGP）-vs-外部网关协议（EGP）" class="headerlink" title="内部网关协议（IGP） vs 外部网关协议（EGP）"></a>内部网关协议（IGP） vs 外部网关协议（EGP）</h3><p>判断依据：自治系统（AS）</p><table><thead><tr><th>类型</th><th>范围</th><th>协议</th></tr></thead><tbody><tr><td>IGP</td><td>同一个 AS 内部使用</td><td>RIP、OSPF、IS-IS、EIGRP</td></tr><tr><td>EGP</td><td>AS 之间</td><td>BGP</td></tr></tbody></table><h3 id="距离向量、链路状态、路径向量"><a href="#距离向量、链路状态、路径向量" class="headerlink" title="距离向量、链路状态、路径向量"></a>距离向量、链路状态、路径向量</h3><table><thead><tr><th>协议类型</th><th>工作方式</th><th>特点</th><th>示例</th></tr></thead><tbody><tr><td>距离向量（DV）</td><td>路由器告诉邻居“我到各目的地的距离”</td><td>简单、收敛慢、环路风险</td><td>RIP</td></tr><tr><td>链路状态（LS）</td><td>路由器向全网泛洪 LSAs，计算最短路径</td><td>收敛快，适合大网，复杂</td><td>OSPF、IS-IS</td></tr><tr><td>路径向量（PV）</td><td>记录路径经过的 AS 序列</td><td>适合互联网规模</td><td>BGP</td></tr></tbody></table><h2 id="📕主流路由协议"><a href="#📕主流路由协议" class="headerlink" title="📕主流路由协议"></a>📕主流路由协议</h2><h3 id="RIP（Routing-Information-Protocol）"><a href="#RIP（Routing-Information-Protocol）" class="headerlink" title="RIP（Routing Information Protocol）"></a>RIP（Routing Information Protocol）</h3><p>类型：IGP + 距离向量协议</p><p>度量 metric：跳数（hop count）</p><p>最大跳数：15（16 &#x3D; 不可达）</p><p>版本：RIPv1（不支持子网掩码）、RIPv2（支持 CIDR&#x2F;VLSM，使用组播）</p><p>特点：</p><ul><li>每 30 秒广播路由更新</li><li>简单、配置容易</li><li>收敛慢</li><li>易产生路由环路 → 引入 水平分割、毒性反转</li></ul><h3 id="OSPF（Open-Shortest-Path-First）"><a href="#OSPF（Open-Shortest-Path-First）" class="headerlink" title="OSPF（Open Shortest Path First）"></a>OSPF（Open Shortest Path First）</h3><p>类型：IGP + 链路状态协议</p><p>度量 metric：带宽（Cost &#x3D; 100Mbps &#x2F; 带宽）</p><p>算法：Dijkstra 最短路径算法（SPF）</p><p>特点：</p><ul><li>收敛速度非常快</li><li>网络分为区域（Area），Backbone（Area 0）必须存在</li><li>使用 Hello 维护邻居关系</li><li>采用 LSA 泛洪</li></ul><p>适合大型企业网、校园网等结构化网络。</p><h3 id="IS-IS"><a href="#IS-IS" class="headerlink" title="IS-IS"></a>IS-IS</h3><p>类型：IGP + 链路状态<br>与 OSPF 类似，但起源于 OSI 网络模型。</p><p>特点：</p><ul><li>运行在第 2 层，不基于 IP → 灵活</li><li>在运营商骨干中大量使用</li><li>支持大型拓扑和复杂结构</li></ul><h3 id="EIGRP（Cisco-私有）"><a href="#EIGRP（Cisco-私有）" class="headerlink" title="EIGRP（Cisco 私有）"></a>EIGRP（Cisco 私有）</h3><p>类型：高级距离向量（混合）<br>算法：DUAL（Diffusing Update Algorithm）</p><p>特点：</p><ul><li>收敛快、环路避免效果好</li><li>使用多种 metric（带宽、延迟、负载、可靠性等）</li><li>仅 Cisco 设备可用（后开源部分协议）</li></ul><h3 id="BGP（Border-Gateway-Protocol）"><a href="#BGP（Border-Gateway-Protocol）" class="headerlink" title="BGP（Border Gateway Protocol）"></a>BGP（Border Gateway Protocol）</h3><p>类型：EGP + 路径向量协议<br>作用：支撑全球互联网路由（AS 间路由）</p><p>特点：</p><ul><li>将路径表示为 AS Path</li><li>高度可控、安全、可进行策略路由</li><li>不追求最快，只追求“策略一致性”</li><li>收敛慢（为了稳定）</li></ul><p>版本：BGP-4（支持 CIDR）<br>用于：运营商、跨国公司、互联网骨干。</p><h2 id="🧩-路由协议的关键概念"><a href="#🧩-路由协议的关键概念" class="headerlink" title="🧩 路由协议的关键概念"></a>🧩 路由协议的关键概念</h2><h3 id="路由环路（Routing-Loop）"><a href="#路由环路（Routing-Loop）" class="headerlink" title="路由环路（Routing Loop）"></a>路由环路（Routing Loop）</h3><p>多个路由器之间互相指向对方，导致路由陷入死循环。</p><ul><li>RIP：水平分割、毒性反转、最大跳数限制</li><li>OSPF&#x2F;IS-IS：LSA + SPF 算法避免环路</li><li>BGP：AS PATH 防环路</li></ul><h3 id="度量（Metric）"><a href="#度量（Metric）" class="headerlink" title="度量（Metric）"></a>度量（Metric）</h3><p>用于衡量一条路径优劣，协议各不相同：</p><table><thead><tr><th>协议</th><th>Metric</th></tr></thead><tbody><tr><td>RIP</td><td>跳数</td></tr><tr><td>OSPF</td><td>Cost（带宽倒数）</td></tr><tr><td>EIGRP</td><td>带宽、延迟等复合</td></tr><tr><td>BGP</td><td>各种策略属性（Local Preference、AS_PATH 等）</td></tr></tbody></table><h3 id="收敛（Convergence）"><a href="#收敛（Convergence）" class="headerlink" title="收敛（Convergence）"></a>收敛（Convergence）</h3><p>网络变化后所有路由器达成一致状态的时间。<br>OSPF、IS-IS、EIGRP 收敛快；RIP、BGP 收敛慢。</p><h2 id="路由协议对比总结"><a href="#路由协议对比总结" class="headerlink" title="路由协议对比总结"></a>路由协议对比总结</h2><table><thead><tr><th>协议</th><th>IGP&#x2F;EGP</th><th>类型</th><th>收敛速度</th><th>规模</th><th>Metric</th></tr></thead><tbody><tr><td>RIP</td><td>IGP</td><td>DV</td><td>慢</td><td>小</td><td>Hop count</td></tr><tr><td>OSPF</td><td>IGP</td><td>LS</td><td>快</td><td>大</td><td>Cost(带宽)</td></tr><tr><td>IS-IS</td><td>IGP</td><td>LS</td><td>快</td><td>非常大</td><td>Cost</td></tr><tr><td>EIGRP</td><td>IGP</td><td>Hybrid</td><td>快</td><td>中-大</td><td>综合</td></tr><tr><td>BGP</td><td>EGP</td><td>PV</td><td>最慢</td><td>全球</td><td>多种属性</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 计网 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 计网 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DomReady时间</title>
      <link href="/JasmineRain.github.io/2025/12/03/DomReady%E6%97%B6%E9%97%B4/"/>
      <url>/JasmineRain.github.io/2025/12/03/DomReady%E6%97%B6%E9%97%B4/</url>
      
        <content type="html"><![CDATA[<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p><strong>DomReady 时间 &#x3D; 页面可互动（初步可用）的时刻</strong>是衡量前端页面加载体验非常核心的性能指标。</p><p>DomReady &#x3D; 从页面开始加载 → HTML 解析完成 → DOM 树构建完成 的时间，即：</p><ul><li>HTML被完全解析</li><li>DOM树已经构建好</li><li>但CSS、图片、视频等静态资源可能还没加载完</li></ul><p>它对应浏览器事件:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;DOMContentLoaded&quot;</span>, fn)</span><br></pre></td></tr></table></figure><h2 id="DomReady-和-load-的区别"><a href="#DomReady-和-load-的区别" class="headerlink" title="DomReady 和 load 的区别"></a>DomReady 和 load 的区别</h2><p>DomReady 比 load 时间早得多。</p><table><thead><tr><th>指标</th><th>触发时机</th><th>是否等待CSS</th><th>是否等待图片&#x2F;视频</th></tr></thead><tbody><tr><td>DomReady(DOMContentLoaded)</td><td>DOM树构建完成</td><td>会等待 CSS（因为 CSS 可能会阻塞 DOM）</td><td>❌不等待图片</td></tr><tr><td>window.load</td><td>页面所有资源加载完毕</td><td>✅</td><td>✅</td></tr></tbody></table><h2 id="DomReady-如何计算"><a href="#DomReady-如何计算" class="headerlink" title="DomReady 如何计算"></a>DomReady 如何计算</h2><p>常见的计算方式：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> domReadyTime = performance.<span class="property">timing</span>.<span class="property">domContentLoadedEventEnd</span> - performance.<span class="property">timing</span>.<span class="property">navigationStart</span>;</span><br></pre></td></tr></table></figure><p>或在 Performance API 时代（更推荐）：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> [entry] = performance.<span class="title function_">getEntriesByType</span>(<span class="string">&quot;navigation&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(entry.<span class="property">domContentLoadedEventEnd</span>);</span><br></pre></td></tr></table></figure><h2 id="DomReady-时间越短越好吗"><a href="#DomReady-时间越短越好吗" class="headerlink" title="DomReady 时间越短越好吗"></a>DomReady 时间越短越好吗</h2><p>通常<strong>越短越好。</strong><br>它意味着你的页面 HTML 解析速度快，用户能更早开始使用页面。</p><p>但需要注意：</p><ul><li><p>CSS 文件太多 → DomReady 会延长（CSS 会阻塞 DOM 构建）</p></li><li><p>JS 在 <code>&lt;head&gt;</code> 中没有 <code>defer</code> → 会阻塞 DOM 解析</p></li><li><p>HTML 文件太大 → 解析时间变长</p></li></ul><h2 id="如何优化-DomReady"><a href="#如何优化-DomReady" class="headerlink" title="如何优化 DomReady"></a>如何优化 DomReady</h2><h3 id="减少同步-JS（阻塞-HTML-解析）"><a href="#减少同步-JS（阻塞-HTML-解析）" class="headerlink" title="减少同步 JS（阻塞 HTML 解析）"></a>减少同步 JS（阻塞 HTML 解析）</h3><p>把 <code>&lt;script&gt;</code> 加上：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;xx.js&quot;</span> <span class="attr">defer</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>或放在 body 底部。</p><h3 id="压缩-HTML"><a href="#压缩-HTML" class="headerlink" title="压缩 HTML"></a>压缩 HTML</h3><p>减少解析量</p><h3 id="减少或延后-CSS"><a href="#减少或延后-CSS" class="headerlink" title="减少或延后 CSS"></a>减少或延后 CSS</h3><p>将非关键 CSS 延迟加载：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;preload&quot;</span> <span class="attr">href</span>=<span class="string">&quot;style.css&quot;</span> <span class="attr">as</span>=<span class="string">&quot;style&quot;</span> <span class="attr">onload</span>=<span class="string">&quot;this.rel=&#x27;stylesheet&#x27;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="避免大量-DOM-操作"><a href="#避免大量-DOM-操作" class="headerlink" title="避免大量 DOM 操作"></a>避免大量 DOM 操作</h3><p>会延迟DOM构建</p>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DomReady </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>测试覆盖率工具</title>
      <link href="/JasmineRain.github.io/2025/11/25/%E6%B5%8B%E8%AF%95%E8%A6%86%E7%9B%96%E7%8E%87%E5%B7%A5%E5%85%B7/"/>
      <url>/JasmineRain.github.io/2025/11/25/%E6%B5%8B%E8%AF%95%E8%A6%86%E7%9B%96%E7%8E%87%E5%B7%A5%E5%85%B7/</url>
      
        <content type="html"><![CDATA[<h2 id="JaCoCo"><a href="#JaCoCo" class="headerlink" title="JaCoCo"></a>JaCoCo</h2><p>JaCoCo(Java Code Coverage)是Java代码覆盖率分析工具，用来统计:</p><ul><li>哪些代码被执行了</li><li>哪些代码没有执行</li><li>覆盖率百分比是多少</li></ul><p>JaCoCo一般与JUint+Maven&#x2F;Gradle一起使用，生成HTML报告</p><p>主要适合：</p><ul><li>软件测试实验</li><li>Java项目</li><li>单元测试覆盖率分析</li></ul><table><thead><tr><th>覆盖类型</th><th>含义</th></tr></thead><tbody><tr><td>Line Coverage(行覆盖)</td><td>哪些代码行被执行</td></tr><tr><td>Branch Coverage(分支覆盖)</td><td>if&#x2F;else&#x2F;switch的分支覆盖情况</td></tr><tr><td>Instruction Coverage(指令覆盖)</td><td>JVM字节码层面更细粒度的覆盖率</td></tr><tr><td>Method Coverage(方法覆盖)</td><td>调用了哪些方法</td></tr><tr><td>Class Coverage(类覆盖)</td><td>多少类被执行测试</td></tr></tbody></table><h3 id="Maven项目中使用JaCoCo示例"><a href="#Maven项目中使用JaCoCo示例" class="headerlink" title="Maven项目中使用JaCoCo示例"></a>Maven项目中使用JaCoCo示例</h3><ul><li>在<code>pom.xml</code>添加插件</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.jacoco<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jacoco-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.8.11<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- 运行测试时自动生成覆盖率数据 --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goal</span>&gt;</span>prepare-agent<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">&lt;!-- 测试后生成报告 --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">id</span>&gt;</span>report<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">phase</span>&gt;</span>test<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goal</span>&gt;</span>report<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>运行时测试生成覆盖率</li></ul><p>在项目根目录执行:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn <span class="built_in">test</span></span><br></pre></td></tr></table></figure><p>之后会生成:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">target/site/jacoco/index.html</span><br></pre></td></tr></table></figure><p>用浏览器打开即可查看覆盖率报告</p><ul><li>运行时覆盖率报告示例</li></ul><p>HTML报告中通常包含:</p><table><thead><tr><th>指标</th><th>含义</th></tr></thead><tbody><tr><td>Missed Instructions</td><td>未执行的字节码指令数量</td></tr><tr><td>Cov.(覆盖率%)</td><td>覆盖比例</td></tr><tr><td>Missed Branches</td><td>if&#x2F;else未覆盖的分支</td></tr><tr><td>Total Lines</td><td>总行数</td></tr><tr><td>Methods</td><td>方法数</td></tr><tr><td>Classes</td><td>类数量</td></tr></tbody></table><p>颜色含义：<br>绿色：已覆盖<br>红色：未覆盖<br>黄色：覆盖部分（比如只走了if，没有走else）</p>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JaCoCo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python入门</title>
      <link href="/JasmineRain.github.io/2025/11/22/python%E5%85%A5%E9%97%A8/"/>
      <url>/JasmineRain.github.io/2025/11/22/python%E5%85%A5%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># hello world</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Hello World!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 多行输出</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;&quot;第一行</span></span><br><span class="line"><span class="string">第二行</span></span><br><span class="line"><span class="string">第三行&quot;&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;first line&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;second line&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;third line&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;first line\nsecond line\nthird line&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读入字符串</span></span><br><span class="line">s=<span class="built_in">input</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读入整数数字</span></span><br><span class="line">n=<span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 格式化输出</span></span><br><span class="line">name=<span class="built_in">input</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;I am &quot;</span>+name)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保留两位小数</span></span><br><span class="line">n=<span class="built_in">float</span>(<span class="built_in">input</span>())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&#123;:.2f&#125;&quot;</span>.<span class="built_in">format</span>(n))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 强制类型转换</span></span><br><span class="line">n=<span class="built_in">float</span>(<span class="built_in">input</span>())</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">int</span>(n))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输入变量类型</span></span><br><span class="line">n=<span class="built_in">input</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(n))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读入十六进制 输出十进制</span></span><br><span class="line">n=<span class="built_in">input</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">int</span>(n,<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出连接字符串</span></span><br><span class="line">str1=<span class="built_in">input</span>()</span><br><span class="line">str2=<span class="built_in">input</span>()</span><br><span class="line"><span class="built_in">print</span>(str1+str2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出字符串长度</span></span><br><span class="line"><span class="built_in">str</span>=<span class="built_in">input</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(<span class="built_in">str</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 格式化输出字符串</span></span><br><span class="line">s=<span class="built_in">input</span>()</span><br><span class="line"><span class="built_in">print</span>(s.lower())<span class="comment"># 全部小写</span></span><br><span class="line"><span class="built_in">print</span>(s.upper())<span class="comment"># 全部大写</span></span><br><span class="line"><span class="built_in">print</span>(s.capitalize())<span class="comment"># 首字符大写</span></span><br><span class="line"><span class="built_in">print</span>(s.title())<span class="comment"># 每个单词的首字符大写</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除字符串左右的空白符</span></span><br><span class="line">s=<span class="built_in">input</span>()</span><br><span class="line">s=s.strip()</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出字符串100次</span></span><br><span class="line">s=<span class="built_in">input</span>()</span><br><span class="line"><span class="built_in">print</span>(s*<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 截取字符串前10位并输出</span></span><br><span class="line">s=<span class="built_in">input</span>()</span><br><span class="line"><span class="built_in">print</span>(s[:<span class="number">10</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输入有空格的字符串 将分别的单词封装成列表 输出列表</span></span><br><span class="line">s=<span class="built_in">input</span>()</span><br><span class="line">lst=s.split()</span><br><span class="line"><span class="built_in">print</span>(lst)</span><br></pre></td></tr></table></figure><hr><p>NP18</p>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>压力测试</title>
      <link href="/JasmineRain.github.io/2025/11/22/%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95/"/>
      <url>/JasmineRain.github.io/2025/11/22/%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>压力测试是一种非功能测试，用来评估系统在高负载、极端压力下的表现。它的目的是让系统不能正常工作，压垮它，看看会在哪里坏、怎么坏、坏得是否优雅。</p><p>压力测试&#x3D;把系统压到极致，观察性能瓶颈和系统崩溃点。</p><h2 id="压力测试和性能测试的关系"><a href="#压力测试和性能测试的关系" class="headerlink" title="压力测试和性能测试的关系"></a>压力测试和性能测试的关系</h2><table><thead><tr><th>测试类型</th><th>目的</th></tr></thead><tbody><tr><td>性能测试</td><td>测试正常负载下的性能(响应时间、TPS、QPS、吞吐量)</td></tr><tr><td>负载测试</td><td>测试逐步增加负载时间时系统何时达到最大并发</td></tr><tr><td>压力测试</td><td>超过最大负载后继续加压，直到崩溃</td></tr><tr><td>稳定性&#x2F;耐久测试</td><td>长时间运行系统，观察是否泄露、积累错误</td></tr></tbody></table><p>压力测试是性能测试的一种，属于极限破坏类测试。</p><h2 id="压力测试的目的"><a href="#压力测试的目的" class="headerlink" title="压力测试的目的"></a>压力测试的目的</h2><ol><li>找出系统性能瓶颈（CPU、内存、数据库、IO、网络）</li><li>找出系统最大承载能力上限</li><li>观察系统在高压下的：稳定性、可用性、恢复能力</li><li>发现潜在的：死锁、内存泄漏、线程池耗尽、数据库连接耗尽、队列积压、超时、错误率上升</li></ol><h2 id="压力测试流程"><a href="#压力测试流程" class="headerlink" title="压力测试流程"></a>压力测试流程</h2><ol><li>确定测压目标</li><li>确定压测指标</li><li>编写压测脚本</li><li>准备测压环境</li><li>执行压力测试：超过负载逐步加压，直到系统出现明显异常</li><li>记录日志和监控</li><li>分析瓶颈并优化</li><li>重新测压验证优化效果</li></ol><h2 id="压力测试中的关键指标"><a href="#压力测试中的关键指标" class="headerlink" title="压力测试中的关键指标"></a>压力测试中的关键指标</h2><ul><li>性能指标<ul><li>QPS(每秒查询数)</li><li>TPS(每秒事务数)</li><li>RT(响应时间)</li><li>吞吐量(MB&#x2F;s)</li></ul></li><li>资源指标<ul><li>CPU、内存(Heap&#x2F;Non-Heap)</li><li>磁盘IO</li><li>网络带宽</li><li>线程数&#x2F;线程池状态</li><li>GC次数&#x2F;停顿时间(Java)</li></ul></li><li>系统指标<ul><li>错误率(Error%)</li><li>超时率</li><li>成功率</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 压力测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>功能测试</title>
      <link href="/JasmineRain.github.io/2025/11/22/%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95/"/>
      <url>/JasmineRain.github.io/2025/11/22/%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>功能测试是按照需求&#x2F;规格从外部行为验证软件是否实现了规定的功能。关注输入处理输出是否与需求一致，属于黑盒测试范畴。</p><h2 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h2><ol><li>验证功能实现是否满足需求(正确性)</li><li>发现业务逻辑、界面、数据校验等错误</li><li>验证系统各模块、接口间的交互是否按要求工作</li><li>为发布决策提供质量判断(功能维度)</li></ol><h2 id="测试范围"><a href="#测试范围" class="headerlink" title="测试范围"></a>测试范围</h2><p>功能点(功能列表中的每一项)<br>界面交互(按钮、输入框、提示信息)<br>边界和异常处理（输入校验、错误提示）<br>业务流程（多步骤用例）<br>数据持久化（数据库写入&#x2F;读取）<br>系统集成点（第三方接口、消息队列）<br>权限&#x2F;角色控制</p><h2 id="按目的分几类功能测试"><a href="#按目的分几类功能测试" class="headerlink" title="按目的分几类功能测试"></a>按目的分几类功能测试</h2><p>单功能测试：单个功能点（例如“修改密码”）。<br>集成功能测试：模块间协作（例如：下单→支付→发货）。<br>回归功能测试：功能变更后保证老功能不被破坏。<br>冒烟功能测试：核心功能是否能工作（发布前快速验证）。<br>验收测试（或UAT）：交付前按业务方验收用例检验。</p><h2 id="用例设计技术"><a href="#用例设计技术" class="headerlink" title="用例设计技术"></a>用例设计技术</h2><p>等价类划分（合理分组相同处理的输入）<br>边界值分析（关注边界、上下1位）<br>判定表（复杂条件组合）<br>因果图（把逻辑转为图再转用例）<br>状态迁移测试（有状态机的功能）<br>场景&#x2F;用户流程（端到端业务场景）<br>错误推测（基于经验找潜在错误）</p>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 功能测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>非增量集成测试和增量集成测试</title>
      <link href="/JasmineRain.github.io/2025/11/21/%E9%9D%9E%E5%A2%9E%E9%87%8F%E9%9B%86%E6%88%90%E6%B5%8B%E8%AF%95%E5%92%8C%E5%A2%9E%E9%87%8F%E9%9B%86%E6%88%90%E6%B5%8B%E8%AF%95/"/>
      <url>/JasmineRain.github.io/2025/11/21/%E9%9D%9E%E5%A2%9E%E9%87%8F%E9%9B%86%E6%88%90%E6%B5%8B%E8%AF%95%E5%92%8C%E5%A2%9E%E9%87%8F%E9%9B%86%E6%88%90%E6%B5%8B%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<h2 id="非增量集成测试"><a href="#非增量集成测试" class="headerlink" title="非增量集成测试"></a>非增量集成测试</h2><h3 id="非增量集成测试定义"><a href="#非增量集成测试定义" class="headerlink" title="非增量集成测试定义"></a>非增量集成测试定义</h3><p>一次性集成测试。</p><p>所有模块在开发完成后一次性组合起来进行测试。<br>模块间的接口和交互问题在整个系统集成后才发现。</p><p>模块少、依赖关系简单的项目。<br>开发周期较短、临时性小型项目。</p><h3 id="非增量集成测试特点"><a href="#非增量集成测试特点" class="headerlink" title="非增量集成测试特点"></a>非增量集成测试特点</h3><p>测试模块完成后，不分阶段，直接整体集成<br>可以快速验证系统整体功能，但定位问题困难那</p><h3 id="非增量集成测试优点"><a href="#非增量集成测试优点" class="headerlink" title="非增量集成测试优点"></a>非增量集成测试优点</h3><p>测试准备简单，不需要构建复杂的测试驱动。<br>对小型、模块数量少的项目比较适用。</p><h3 id="非增量集成测试缺点"><a href="#非增量集成测试缺点" class="headerlink" title="非增量集成测试缺点"></a>非增量集成测试缺点</h3><p>定位困难，出现问题难以追踪到具体模块。<br>发现问题较晚，修复成本高，风险大，如果多个模块有问题，调试非常复杂。</p><h2 id="增量集成测试"><a href="#增量集成测试" class="headerlink" title="增量集成测试"></a>增量集成测试</h2><h3 id="增量集成测试定义"><a href="#增量集成测试定义" class="headerlink" title="增量集成测试定义"></a>增量集成测试定义</h3><p>每次开发完成后逐步集成测试，每次只集成部分模块。每次集成后进行测试，发现问题及时解决，然后再集成下一个模块。</p><p>可以分为：</p><ul><li>自顶向下(Top-down)<ul><li>先测试顶层模块，再逐步集成底层模块</li><li>需要使用<strong>桩Stub</strong>模拟未完成的底层模块</li></ul></li><li>自底向上(Botton-up)<ul><li>先测试底层模块，再逐步集成上层模块</li><li>需要使用**驱动(Driver)**模拟未完成的上层模块</li></ul></li><li>混合<ul><li>顶层和底层同时逐步集成，中间模块逐步完成</li></ul></li></ul><p>适合模块多、依赖复杂的系统。<br>开发周期长、系统功能复杂的大型项目。</p><h3 id="增量集成测试特点"><a href="#增量集成测试特点" class="headerlink" title="增量集成测试特点"></a>增量集成测试特点</h3><p>集成过程分阶段，逐步测试模块接口。早期发现问题，便于定位和修复。</p><h3 id="增量集成测试优点"><a href="#增量集成测试优点" class="headerlink" title="增量集成测试优点"></a>增量集成测试优点</h3><ol><li>缺陷发现早，定位准确</li><li>系统风险低，问题不会积累到最后才爆发</li><li>适合大型复杂系统</li></ol><h3 id="增量集成测试缺点"><a href="#增量集成测试缺点" class="headerlink" title="增量集成测试缺点"></a>增量集成测试缺点</h3><ol><li>测试准备工作多，需要桩和驱动</li><li>测试计划复杂，周期可能较长</li></ol><h2 id="对比"><a href="#对比" class="headerlink" title="对比"></a>对比</h2><table><thead><tr><th>特性</th><th>非增量集成测试</th><th>增量集成测试</th></tr></thead><tbody><tr><td>集成方式</td><td>一次性集成全部模块</td><td>逐步集成模块</td></tr><tr><td>缺陷发现</td><td>晚，定位困难</td><td>早，定位容易</td></tr><tr><td>风险</td><td>高</td><td>低</td></tr><tr><td>测试准备</td><td>简单</td><td>复杂，需要桩和驱动</td></tr><tr><td>适用项目</td><td>小型、模块少</td><td>大型、模块多</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 集成测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>浸泡测试</title>
      <link href="/JasmineRain.github.io/2025/11/20/%E6%B5%B8%E6%B3%A1%E6%B5%8B%E8%AF%95/"/>
      <url>/JasmineRain.github.io/2025/11/20/%E6%B5%B8%E6%B3%A1%E6%B5%8B%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>浸泡测试（Soak Testing）是一种性能测试，主要用来检验系统在长时间高负载运行后是否会出现内存泄露（Memory Leak）、句柄泄漏（Handle Leak）、性能逐渐变慢、CPU 占用持续上升、响应时间变长、服务崩溃或重启、数据积压、队列堆积的问题。</p><p>浸泡测试关注的是系统长时间运行的稳定性，而不是瞬间性能。</p><h2 id="目的"><a href="#目的" class="headerlink" title="目的"></a>目的</h2><ol><li>发现资源泄露的问题</li><li>验证系统是否稳定运行数小时或数天</li><li>观察性能是否有下降趋势</li><li>检测数据库连接池是否正确释放连接</li><li>发现长时间运行后才能出现的隐藏Bug</li></ol><h2 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h2><ol><li>设置一个长期稳定、可持续的负载</li><li>持续监控系统资源<br>监控指标包括:</li></ol><table><thead><tr><th>指标</th><th>重点</th></tr></thead><tbody><tr><td>内存使用率</td><td>是否不断上升(内存泄露)</td></tr><tr><td>CPU使用率</td><td>是否持续升高</td></tr><tr><td>磁盘IO&#x2F;网络IO</td><td>是否出现阻塞</td></tr><tr><td>GC(垃圾回收情况)</td><td>Full GC是否越来越频繁</td></tr><tr><td>线程数、连接数</td><td>是否不断增加</td></tr><tr><td>系统响应时间</td><td>是否不断变慢</td></tr></tbody></table><ol start="3"><li>测试结束后分析趋势图</li></ol><h2 id="浸泡测试与压力测试的区别"><a href="#浸泡测试与压力测试的区别" class="headerlink" title="浸泡测试与压力测试的区别"></a>浸泡测试与压力测试的区别</h2><table><thead><tr><th>测试类型</th><th>目的</th><th>特点</th></tr></thead><tbody><tr><td>压力测试</td><td>找极限、让系统崩溃掉</td><td>高负载、短时间</td></tr><tr><td>浸泡测试</td><td>看长时间是否稳定</td><td>中等负载、长时间</td></tr><tr><td>负载测试</td><td>评估系统性能指标</td><td>常规业务负载</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 浸泡测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>按开发阶段划分软件测试类型</title>
      <link href="/JasmineRain.github.io/2025/11/20/%E6%8C%89%E5%BC%80%E5%8F%91%E9%98%B6%E6%AE%B5%E5%88%92%E5%88%86%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95%E7%B1%BB%E5%9E%8B/"/>
      <url>/JasmineRain.github.io/2025/11/20/%E6%8C%89%E5%BC%80%E5%8F%91%E9%98%B6%E6%AE%B5%E5%88%92%E5%88%86%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95%E7%B1%BB%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="阶段划分"><a href="#阶段划分" class="headerlink" title="阶段划分"></a>阶段划分</h2><p>单元测试-&gt;集成测试-&gt;确认测试-&gt;系统测试-&gt;验收测试</p><h2 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h2><p>编码完成后，测试最小功能单元(函数、类、模块)是否正确</p><h2 id="集成测试"><a href="#集成测试" class="headerlink" title="集成测试"></a>集成测试</h2><p>单元测试之后，测试模块之间的接口、交互是否正确</p><h2 id="确认测试"><a href="#确认测试" class="headerlink" title="确认测试"></a>确认测试</h2><p>组件集成后、系统测试前，验证软件是否符合规格说明书(SRS),也叫验证测试</p><h2 id="系统测试"><a href="#系统测试" class="headerlink" title="系统测试"></a>系统测试</h2><p>整个系统开发完成后，对整个系统进行功能、性能、安全等全面测试</p><h2 id="验收测试"><a href="#验收测试" class="headerlink" title="验收测试"></a>验收测试</h2><p>上线前，用户验证系统是否满足业务需求，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>测试、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span>测试</p>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 测试类型 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>软件质量管理之QM、QA、QC</title>
      <link href="/JasmineRain.github.io/2025/11/19/%E8%BD%AF%E4%BB%B6%E8%B4%A8%E9%87%8F%E7%AE%A1%E7%90%86%E4%B9%8BQM%E3%80%81QA%E3%80%81QC/"/>
      <url>/JasmineRain.github.io/2025/11/19/%E8%BD%AF%E4%BB%B6%E8%B4%A8%E9%87%8F%E7%AE%A1%E7%90%86%E4%B9%8BQM%E3%80%81QA%E3%80%81QC/</url>
      
        <content type="html"><![CDATA[<h2 id="总览"><a href="#总览" class="headerlink" title="总览"></a>总览</h2><p><strong>QM &#x3D; 管理质量体系（制定制度）</strong><br><strong>QA &#x3D; 过程质量保证（监督执行）</strong><br><strong>QC &#x3D; 产品质量控制（具体测试）</strong></p><h2 id="QM"><a href="#QM" class="headerlink" title="QM"></a>QM</h2><p>“做制度的”</p><p>QM 是一个组织层面上的质量管理活动，负责制定整体质量目标、规范、流程。</p><p>关键词：制度、流程、策略、标准、体系（ISO9001、CMMI）</p><p>企业层面的“质量管理体系建设者”。</p><h2 id="QA"><a href="#QA" class="headerlink" title="QA"></a>QA</h2><p>“看着流程走，确保做对事”</p><p>QA 的核心是：过程导向，预防缺陷。<br>它不具体写测试用例，而是保证整个开发流程按质量体系执行。</p><p>关键词：过程、审核、评审、预防缺陷、监控执行情况</p><p>QA 做什么？</p><ul><li>监督开发过程是否遵循规范</li><li>检查需求评审、设计评审是否完成</li><li>做质量审计</li><li>推动缺陷根因分析</li><li>推进流程改进</li></ul><p>QA 不测功能，也不会直接测试产品。</p><p>QA 保证“事情是按正确的方法做的”。</p><h2 id="QC"><a href="#QC" class="headerlink" title="QC"></a>QC</h2><p>“动手实测产品，发现问题”</p><p>QC 就是传统意义上的测试人员，面向产品，发现缺陷。</p><p>关键词：产品、测试、缺陷识别、验证、结果导向</p><p>QC 做什么？</p><ul><li>功能测试</li><li>性能测试</li><li>安全测试</li><li>测试用例编写与执行</li><li>缺陷报告</li><li>回归测试</li></ul><p>QC 是“直接发现问题的人”。</p><h2 id="对比"><a href="#对比" class="headerlink" title="对比"></a>对比</h2><table><thead><tr><th>角色</th><th>关注点</th><th>做什么</th></tr></thead><tbody><tr><td>QM</td><td>制度层</td><td>定规则、建体系</td></tr><tr><td>QA</td><td>过程层</td><td>监督流程是否按规则执行</td></tr><tr><td>QC</td><td>产品层</td><td>通过测试发现缺陷</td></tr></tbody></table><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p><strong>QM（质量管理）</strong>：负责制定组织级的质量策略、流程和标准，构建质量体系。<br><strong>QA（质量保证）</strong>：通过过程监控、评审、审计等方式确保开发过程遵守质量体系，以预防缺陷。<br><strong>QC（质量控制）</strong>：针对产品本身执行测试，通过检验和验证活动发现缺陷，以保证交付物质量。</p>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 软件质量管理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>强度测试</title>
      <link href="/JasmineRain.github.io/2025/11/18/%E5%BC%BA%E5%BA%A6%E6%B5%8B%E8%AF%95/"/>
      <url>/JasmineRain.github.io/2025/11/18/%E5%BC%BA%E5%BA%A6%E6%B5%8B%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>强度测试（Strength Testing）是软件性能测试的一种，用于验证系统在长时间高压力、高强度条件下是否能够稳定运行。它关注的是系统在接近极限的情况下能否保持可用性，而不是瞬时吞吐或峰值性能。</p><p>强度测试是让系统在高压力、极端资源消耗或恶劣环境下长时间运行，验证系统是否会出现崩溃、内存泄漏、死锁、性能下降等问题。<br>它主要评估系统的 稳定性（Stability） 和 鲁棒性（Robustness）。</p><p>强度测试又称：耐久性测试（Endurance Test）、浸泡测试（Soak Test）、稳定性测试（Stability Test）</p><h2 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h2><ol><li>检查系统在压力不断累积下是否会出问题</li><li>发现隐藏的性能瓶颈</li><li>找出资源耗尽类型缺陷（内存泄漏、线程泄漏、死锁）</li><li>评估系统的恢复能力（是否能自愈或降级）</li></ol><h2 id="强度测试常测哪些问题"><a href="#强度测试常测哪些问题" class="headerlink" title="强度测试常测哪些问题"></a>强度测试常测哪些问题</h2><ul><li>内存泄漏（memory leak）</li><li>句柄泄漏（file handle &#x2F; socket 不释放）</li><li>线程池耗尽</li><li>数据库连接池耗尽</li><li>服务长期运行后响应变慢</li><li>CPU 持续高占用导致系统卡死</li><li>缓存击穿 &#x2F; 缓存雪崩</li><li>日志无限增长导致磁盘满</li></ul><p>这些都 短期压力测试无法发现。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>强度测试是在接近最大工作负载的情况下，长时间、持续地对系统进行测试，以发现内存泄漏等长时间运行才会暴露的问题，评估系统稳定性。</p>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 强度测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>E2E测试</title>
      <link href="/JasmineRain.github.io/2025/11/18/E2E%E6%B5%8B%E8%AF%95/"/>
      <url>/JasmineRain.github.io/2025/11/18/E2E%E6%B5%8B%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>E2E 测试（End-to-End Test，全流程测试）是软件测试中最高层级的一种测试方法，它通过模拟真实用户场景，从系统的入口到出口，验证整个系统在真实使用流程下是否能正确运作。</p><p>E2E测试就是模拟用户真实使用行为，从开始操作到最终结果，验证整个系统（前端 + 后端 + 数据库 + 外部服务）是否真正能跑通。</p><h2 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h2><ol><li>测试的是 完整业务流程（例如：登录 → 搜索 → 下单 → 支付）。</li><li>覆盖多个系统组件：前端、后端、数据库、API、第三方服务。</li><li>验证系统能否像用户实际操作一样 端到端跑通。</li><li>往往是跨模块、跨系统的集成验证。</li></ol><h2 id="E2E测试常见场景"><a href="#E2E测试常见场景" class="headerlink" title="E2E测试常见场景"></a>E2E测试常见场景</h2><table><thead><tr><th>场景</th><th>说明</th></tr></thead><tbody><tr><td>注册登录流程</td><td>用户注册 → 邮箱验证 → 登录成功</td></tr><tr><td>购物流程</td><td>选择商品 → 加入购物车 → 下单 → 支付</td></tr><tr><td>权限流程</td><td>普通用户不能访问管理员页面</td></tr><tr><td>多系统协作流程</td><td>业务系统 A → 调用 B → 写入数据库 → 显示结果</td></tr></tbody></table><h2 id="常用E2E测试工具"><a href="#常用E2E测试工具" class="headerlink" title="常用E2E测试工具"></a>常用E2E测试工具</h2><p>前端：Cypress、Playwright、Selenium<br>移动端：Appium<br>后端API E2E：Postman+Newman、k6(API负载+E2E)</p><h2 id="优缺点"><a href="#优缺点" class="headerlink" title="优缺点"></a>优缺点</h2><p>优点：</p><ol><li>真实模拟用户行为 → 最贴近真实使用</li><li>验证系统整体质量 → 能发现跨模块问题</li><li>适合测试复杂业务流程</li></ol><p>缺点：</p><ol><li>编写成本高</li><li>执行时间长</li><li>维护成本高（UI改动易导致测试失效）</li><li>不适合测试微小逻辑，适合整体流程</li></ol>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> E2E测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>负载测试</title>
      <link href="/JasmineRain.github.io/2025/11/18/%E8%B4%9F%E8%BD%BD%E6%B5%8B%E8%AF%95/"/>
      <url>/JasmineRain.github.io/2025/11/18/%E8%B4%9F%E8%BD%BD%E6%B5%8B%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>负载测试是在逐步增加并发量和请求量的情况下，验证系统在接近设计容量范围内的性能表现，确定系统能承受多大的稳定负载而不出现性能下降。</p><p>负载测试（Load Test）是一种性能测试，用来评估系统在正常和接近高负载情况下是否仍能保持：正确性、稳定性、性能指标达标（响应时间、QPS、吞吐量等），它模拟大量用户同时访问系统，通过持续施压来观察系统极限。</p><h2 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h2><ol><li>验证系统承载能力是否达到设计值（如承诺 10k QPS 是否能达到）</li><li>找出性能瓶颈（数据库、缓存、CPU、锁竞争等）</li><li>确保系统在高负载下仍能稳定运行</li><li>为扩容、容量规划提供依据</li><li>发现隐藏问题（慢查询、内存泄漏、线程池耗尽）</li></ol><h2 id="常见负载测试指标"><a href="#常见负载测试指标" class="headerlink" title="常见负载测试指标"></a>常见负载测试指标</h2><table><thead><tr><th>指标</th><th>含义</th></tr></thead><tbody><tr><td>QPS</td><td>每秒请求数</td></tr><tr><td>TPS</td><td>每秒事务数</td></tr><tr><td>响应时间(P50,P90,P95,P99)</td><td>延迟表现</td></tr><tr><td>吞吐量</td><td>系统每秒处理的数据量</td></tr><tr><td>CPU、内存、I&#x2F;O、网络使用率</td><td>监控资源瓶颈</td></tr><tr><td>错误率</td><td>请求失败占比</td></tr><tr><td>饱和度(Saturation)</td><td>系统举例极限有多近</td></tr></tbody></table><h2 id="通用流程"><a href="#通用流程" class="headerlink" title="通用流程"></a>通用流程</h2><ol><li>明确性能目标：例如：QPS ≥ 5000、P99 响应时间 ≤ 50ms、错误率 ≤ 0.1%</li><li>构造测试场景：登录、查询、下单、推送；使用真实数据（Mock 可能失真）</li><li>典型的负载模型：固定并发（steady load）、阶梯式增加（step load）、峰值负载（burst load）</li><li>使用压测工具模拟请求:常见工具：JMeter、k6（推荐）、Locust、wrk、ab、Gatling</li><li>实时监控系统资源：Prometheus + Grafana或云产品自带监控</li><li>分析结果、定位瓶颈：判断是否达到目标；查找慢查询、线程池、GC、数据库锁、Redis 命令等</li></ol>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>阿尔法测试和贝塔测试</title>
      <link href="/JasmineRain.github.io/2025/11/18/%E9%98%BF%E5%B0%94%E6%B3%95%E6%B5%8B%E8%AF%95%E5%92%8C%E8%B4%9D%E5%A1%94%E6%B5%8B%E8%AF%95/"/>
      <url>/JasmineRain.github.io/2025/11/18/%E9%98%BF%E5%B0%94%E6%B3%95%E6%B5%8B%E8%AF%95%E5%92%8C%E8%B4%9D%E5%A1%94%E6%B5%8B%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>测试是内部测试,<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span>测试是公开给部分真实用户的外部测试。<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>测试</h2><p>在软件接近完成但仍不稳定时，由 内部团队（开发、测试、产品） 在受控环境下进行的测试。</p><p>特点：</p><blockquote><ul><li>内部人员参与</li><li>在公司内部环境进行</li><li>发现严重缺陷、功能性问题</li><li>目标是“验证功能基本可用”</li><li>测试方式包括黑盒 + 白盒</li><li>会模拟用户行为，但不是现实使用环境</li></ul></blockquote><p>目的：找出主要缺陷，使软件达到可公开给用户试用的质量。</p><h2 id="测试-1"><a href="#测试-1" class="headerlink" title="测试"></a><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span>测试</h2><p>在阿尔法测试完成后，将软件发布给 真实用户（外部用户）在实际场景中使用，收集反馈。</p><p>特点：</p><blockquote><ul><li>外部真实用户参与</li><li>在真实环境、真实设备上使用</li><li>注重用户体验、性能、兼容性</li><li>测试人员不受控，范围更宽</li><li>收集用户反馈和未知问题</li></ul></blockquote><p>目的：验证软件在真实场景是否稳定、好用，是否能正式上线。</p><h2 id="对比"><a href="#对比" class="headerlink" title="对比"></a>对比</h2><table><thead><tr><th>对比项</th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>测试</th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span>测试</th></tr></thead><tbody><tr><td>测试执行者</td><td>内部员工</td><td>外部用户</td></tr><tr><td>测试环境</td><td>受控环境（公司内部）</td><td>真实用户环境</td></tr><tr><td>主要目标</td><td>找出功能性缺陷、严重 Bug</td><td>用户反馈、体验问题、真实使用问题</td></tr><tr><td>软件稳定性</td><td>较不稳定</td><td>较稳定</td></tr><tr><td>覆盖场景</td><td>设计场景</td><td>实际使用场景</td></tr><tr><td>是否可控</td><td>高</td><td>低</td></tr><tr><td>是否正式对外开放</td><td>通常不</td><td>是（但限制人数）</td></tr><tr><td>收集的问题类型</td><td>Bug、逻辑缺陷</td><td>性能、体验、兼容性</td></tr></tbody></table><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>测试由内部人员在受控环境中进行，主要检查功能完整性和发现主要缺陷；<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span>测试由真实用户在真实环境中使用软件，用于验证用户体验、性能和兼容性，以确保软件接近正式发布质量。]]></content>
      
      
      <categories>
          
          <category> 测开 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>测试驱动开发</title>
      <link href="/JasmineRain.github.io/2025/11/18/%E6%B5%8B%E8%AF%95%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/"/>
      <url>/JasmineRain.github.io/2025/11/18/%E6%B5%8B%E8%AF%95%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/</url>
      
        <content type="html"><![CDATA[<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>测试驱动开发（TDD，Test-Driven Development） 是一种先写测试、后写代码的敏捷开发方法，通过“红 → 绿 → 重构”三步循环来驱动功能实现，使代码质量更高、设计更清晰、Bug 更少。</p><p>TDD 是先写失败的测试，再写最少量代码让测试通过，最后重构代码，在保证测试仍然通过的前提下持续优化设计的开发方式。</p><h2 id="TDD核心循环-Red-Green-Refactor"><a href="#TDD核心循环-Red-Green-Refactor" class="headerlink" title="TDD核心循环:Red-&gt;Green-&gt;Refactor"></a>TDD核心循环:Red-&gt;Green-&gt;Refactor</h2><ul><li>Red(写测试，测试失败)：编写一个针对某个功能的单元测试，因为功能未实现，测试必然失败(Red)</li><li>Green(让测试通过)：编写实现代码，不追求完美，只写最少代码让测试通过</li><li>Refactor(重构)：优化代码结构、命名、抽象，确保测试仍全部通过，不改变对外行为</li></ul><h2 id="优势与价值"><a href="#优势与价值" class="headerlink" title="优势与价值"></a>优势与价值</h2><ul><li><p>减少 Bug：因为先写测试，功能未覆盖的场景立即暴露</p></li><li><p>保证可维护性：持续的自动化测试确保重构安全</p></li><li><p>让设计更清晰：写测试时你必须明确需求和 API</p></li><li><p>降低回归成本：所有测试自动运行</p></li><li><p>避免过度设计：你只写让测试通过所需最少代码</p></li><li><p>适用于中大型后端项目、复杂逻辑、核心业务模块。</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>99分位响应时间</title>
      <link href="/JasmineRain.github.io/2025/11/18/99%E5%88%86%E4%BD%8D%E5%93%8D%E5%BA%94%E6%97%B6%E9%97%B4/"/>
      <url>/JasmineRain.github.io/2025/11/18/99%E5%88%86%E4%BD%8D%E5%93%8D%E5%BA%94%E6%97%B6%E9%97%B4/</url>
      
        <content type="html"><![CDATA[<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>99 分位响应时间（P99 响应时间） &#x3D; 在所有请求中，99% 的请求响应时间都比它更快，只有最慢的 1% 的请求比它更慢。</p><p>P99 &#x3D; “最慢的那 1% 的用户体验”，用于衡量系统在极端情况下的稳定性，非常适合高并发、强 SLA 的系统（支付、直播、游戏、接口网关等）。</p><p>平均值会被部分极慢请求“拉低”，无法反映极端情况。中位数（P50）很好看，但不能说明峰值延时。P99 是系统瓶颈、队列、锁竞争、GC 暴涨、网络抖动的最佳暴露点</p><p>特别适合高并发场景：支付、直播间消息、微服务网关、数据库查询。</p><h2 id="如何计算P99"><a href="#如何计算P99" class="headerlink" title="如何计算P99"></a>如何计算P99</h2><h3 id="直接从数据排序计算"><a href="#直接从数据排序计算" class="headerlink" title="直接从数据排序计算"></a>直接从数据排序计算</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 假设 resp_times 是响应时间列表（单位 ms）</span></span><br><span class="line">resp_times.sort()</span><br><span class="line">p99 = resp_times[<span class="built_in">int</span>(<span class="number">0.99</span> * <span class="built_in">len</span>(resp_times))]</span><br></pre></td></tr></table></figure><h3 id="使用监测-压测工具自动计算"><a href="#使用监测-压测工具自动计算" class="headerlink" title="使用监测&#x2F;压测工具自动计算"></a>使用监测&#x2F;压测工具自动计算</h3><p>Prometheus + Grafana：<code>histogram_quantile(0.99, rate(http_request_duration_seconds_bucket[5m]))</code></p><p>k6：自动输出 <code>http_req_duration&#123;p99&#125;</code></p><p>JMeter：聚合报告里会显示 P99</p><p>APM（SkyWalking、Zipkin、New Relic、Datadog）也自动提供 P99&#x2F;P999</p>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 99分位响应时间 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常用测试工具总结</title>
      <link href="/JasmineRain.github.io/2025/11/17/%E5%B8%B8%E7%94%A8%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7%E6%80%BB%E7%BB%93/"/>
      <url>/JasmineRain.github.io/2025/11/17/%E5%B8%B8%E7%94%A8%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h2 id="单元测试-Unit-Test-工具"><a href="#单元测试-Unit-Test-工具" class="headerlink" title="单元测试(Unit Test)工具"></a>单元测试(Unit Test)工具</h2><h3 id="JUnit"><a href="#JUnit" class="headerlink" title="JUnit"></a>JUnit</h3><p>最主流的Java单元测试框架</p><h3 id="TestNG"><a href="#TestNG" class="headerlink" title="TestNG"></a>TestNG</h3><p>类似于JUnit，但功能更强(分组、依赖)</p><h3 id="Google-Test-gtest"><a href="#Google-Test-gtest" class="headerlink" title="Google Test(gtest)"></a>Google Test(gtest)</h3><p>C++最常用的单元测试框架</p><h3 id="pytest"><a href="#pytest" class="headerlink" title="pytest"></a>pytest</h3><p>最强python测试框架</p><h3 id="Mocha-Jest"><a href="#Mocha-Jest" class="headerlink" title="Mocha&#x2F;Jest"></a>Mocha&#x2F;Jest</h3><p>前端单元测试最常用工具</p><h3 id="Go-testing-pkg"><a href="#Go-testing-pkg" class="headerlink" title="Go testing pkg"></a>Go testing pkg</h3><p>Go自带的单元测试框架</p><h2 id="接口-API测试工具"><a href="#接口-API测试工具" class="headerlink" title="接口&#x2F;API测试工具"></a>接口&#x2F;API测试工具</h2><h3 id="Postman"><a href="#Postman" class="headerlink" title="Postman"></a>Postman</h3><p>API调试&#x2F;测试，最常用，请求构造、环境变量、脚本测试</p><h3 id="JMeter"><a href="#JMeter" class="headerlink" title="JMeter"></a>JMeter</h3><p>可做接口测试+压力测试，企业常用</p><h3 id="SoapUI"><a href="#SoapUI" class="headerlink" title="SoapUI"></a>SoapUI</h3><p>支持SOAP&#x2F;REST API，适合老项目</p><h3 id="Insomnia"><a href="#Insomnia" class="headerlink" title="Insomnia"></a>Insomnia</h3><p>类似于Postman，界面更精简</p><h3 id="Hoppscotch"><a href="#Hoppscotch" class="headerlink" title="Hoppscotch"></a>Hoppscotch</h3><p>Web工具，在线API测试，轻量化</p><h2 id="自动化测试-UI测试-工具"><a href="#自动化测试-UI测试-工具" class="headerlink" title="自动化测试(UI测试)工具"></a>自动化测试(UI测试)工具</h2><h3 id="Selenium"><a href="#Selenium" class="headerlink" title="Selenium"></a>Selenium</h3><p>Web，最经典Web UI自动化框架</p><h3 id="Playwright"><a href="#Playwright" class="headerlink" title="Playwright"></a>Playwright</h3><p>Web，新一代自动化测试，更快、更稳定</p><h3 id="Cypress"><a href="#Cypress" class="headerlink" title="Cypress"></a>Cypress</h3><p>Web，前端使用，简单、直观</p><h3 id="Appium"><a href="#Appium" class="headerlink" title="Appium"></a>Appium</h3><p>移动端，Android&#x2F;IOS自动化测试框架</p><h3 id="Robot-Framework"><a href="#Robot-Framework" class="headerlink" title="Robot Framework"></a>Robot Framework</h3><p>通用，基于关键字的自动化测试框架</p><h2 id="性能测试-压力测试工具"><a href="#性能测试-压力测试工具" class="headerlink" title="性能测试&#x2F;压力测试工具"></a>性能测试&#x2F;压力测试工具</h2><h3 id="Locust"><a href="#Locust" class="headerlink" title="Locust"></a>Locust</h3><p>Python编写压测脚本，灵活度大</p><h3 id="k6"><a href="#k6" class="headerlink" title="k6"></a>k6</h3><p>Go写的性能测试工具，脚本用JS编写，轻量高性能</p><h3 id="wrk-wrk2"><a href="#wrk-wrk2" class="headerlink" title="wrk&#x2F;wrk2"></a>wrk&#x2F;wrk2</h3><p>超高性能HTTP压测工具</p><h3 id="Gatling"><a href="#Gatling" class="headerlink" title="Gatling"></a>Gatling</h3><p>Scala&#x2F;Java的高并发压力测试工具</p><h2 id="持续集成-CI-CD-工具"><a href="#持续集成-CI-CD-工具" class="headerlink" title="持续集成(CI&#x2F;CD)工具"></a>持续集成(CI&#x2F;CD)工具</h2><h3 id="Jenkins"><a href="#Jenkins" class="headerlink" title="Jenkins"></a>Jenkins</h3><p>最流行，强大但需要维护</p><h3 id="Github-Actions"><a href="#Github-Actions" class="headerlink" title="Github Actions"></a>Github Actions</h3><p>Github项目推荐，易用</p><h3 id="GitLab-CI"><a href="#GitLab-CI" class="headerlink" title="GitLab CI"></a>GitLab CI</h3><p>与GitLab集成，非常方便</p><h3 id="CircleCI"><a href="#CircleCI" class="headerlink" title="CircleCI"></a>CircleCI</h3><p>云端CI工具，上手简单</p><h3 id="Azure-DevOps-Pipelines"><a href="#Azure-DevOps-Pipelines" class="headerlink" title="Azure DevOps Pipelines"></a>Azure DevOps Pipelines</h3><p>微软系统项目使用多</p><h2 id="安全测试工具"><a href="#安全测试工具" class="headerlink" title="安全测试工具"></a>安全测试工具</h2><h3 id="Burp-Suite"><a href="#Burp-Suite" class="headerlink" title="Burp Suite"></a>Burp Suite</h3><p>Web安全测试神器</p><h3 id="OWASP-ZAP"><a href="#OWASP-ZAP" class="headerlink" title="OWASP ZAP"></a>OWASP ZAP</h3><p>开源Web渗透测试工具</p><h3 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h3><p>网络扫描、安全探测</p><h3 id="Metasploit"><a href="#Metasploit" class="headerlink" title="Metasploit"></a>Metasploit</h3><p>渗透攻击测试框架</p><h3 id="Nikto"><a href="#Nikto" class="headerlink" title="Nikto"></a>Nikto</h3><p>Web漏洞扫描</p><h2 id="契约测试工具-Contract-Testing"><a href="#契约测试工具-Contract-Testing" class="headerlink" title="契约测试工具(Contract Testing)"></a>契约测试工具(Contract Testing)</h2><h3 id="Pact"><a href="#Pact" class="headerlink" title="Pact"></a>Pact</h3><p>最主流契约测试，前后端&#x2F;微服务用</p><h3 id="Spring-Cloud-Contract"><a href="#Spring-Cloud-Contract" class="headerlink" title="Spring Cloud Contract"></a>Spring Cloud Contract</h3><p>Java微服务中常用</p><h3 id="Hoverfly"><a href="#Hoverfly" class="headerlink" title="Hoverfly"></a>Hoverfly</h3><p>API模拟和契约校验</p><h2 id="Mock-Stub工具-模拟测试"><a href="#Mock-Stub工具-模拟测试" class="headerlink" title="Mock&#x2F;Stub工具(模拟测试)"></a>Mock&#x2F;Stub工具(模拟测试)</h2><h3 id="Mockito"><a href="#Mockito" class="headerlink" title="Mockito"></a>Mockito</h3><p>Java mock框架</p><h3 id="GoMock"><a href="#GoMock" class="headerlink" title="GoMock"></a>GoMock</h3><p>Go mock工具</p><h3 id="WireMock"><a href="#WireMock" class="headerlink" title="WireMock"></a>WireMock</h3><p>REST API mock工具</p><h3 id="Mock-js"><a href="#Mock-js" class="headerlink" title="Mock.js"></a>Mock.js</h3><p>前端生成假数据</p><h2 id="日志-监控测试工具"><a href="#日志-监控测试工具" class="headerlink" title="日志&amp;监控测试工具"></a>日志&amp;监控测试工具</h2><h3 id="Prometheus-Grafana"><a href="#Prometheus-Grafana" class="headerlink" title="Prometheus + Grafana"></a>Prometheus + Grafana</h3><p>性能监控、服务指标可视化</p><h3 id="ELK-ElasticSearch-Logstash-Kibana"><a href="#ELK-ElasticSearch-Logstash-Kibana" class="headerlink" title="ELK(ElasticSearch+Logstash+Kibana)"></a>ELK(ElasticSearch+Logstash+Kibana)</h3><p>日志收集与分析</p><h3 id="Jaeger-Zipkin"><a href="#Jaeger-Zipkin" class="headerlink" title="Jaeger&#x2F;Zipkin"></a>Jaeger&#x2F;Zipkin</h3><p>分布式链路追踪(微服务)</p><h2 id="测试管理工具-测试流程"><a href="#测试管理工具-测试流程" class="headerlink" title="测试管理工具(测试流程)"></a>测试管理工具(测试流程)</h2><h3 id="TestLink"><a href="#TestLink" class="headerlink" title="TestLink"></a>TestLink</h3><p>测试用例管理</p><h3 id="禅道"><a href="#禅道" class="headerlink" title="禅道"></a>禅道</h3><p>中国最常用测试管理工具</p><h3 id="Jira"><a href="#Jira" class="headerlink" title="Jira"></a>Jira</h3><p>国际团队最常用，敏捷项目管理</p><h3 id="Azure-DevOps"><a href="#Azure-DevOps" class="headerlink" title="Azure DevOps"></a>Azure DevOps</h3><p>测试计划+CI&#x2F;CD+项目管理一体化</p>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>契约测试</title>
      <link href="/JasmineRain.github.io/2025/11/17/%E5%A5%91%E7%BA%A6%E6%B5%8B%E8%AF%95/"/>
      <url>/JasmineRain.github.io/2025/11/17/%E5%A5%91%E7%BA%A6%E6%B5%8B%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>契约测试（Contract Testing）是一种用于微服务或前后端分离系统中的测试方式，主要目的是确保服务提供方（Provider）和服务调用方（Consumer）之间的接口“契约”始终保持一致、不会被意外破坏。</p><p>Consumer 定义“我需要什么样的 API”，Provider 承诺“我提供的 API 符合你的要求”，并通过测试自动验证双方是否匹配。</p><p>契约测试就是为了解决接口不一致、沟通不清导致的问题。</p><h2 id="how"><a href="#how" class="headerlink" title="how"></a>how</h2><h3 id="Consumer-Contract-消费者契约"><a href="#Consumer-Contract-消费者契约" class="headerlink" title="Consumer Contract(消费者契约)"></a>Consumer Contract(消费者契约)</h3><p>由消费者写下“我调用这个 API 时，我需要的数据结构是什么”。</p><h3 id="Provider-Verification-服务提供方验证"><a href="#Provider-Verification-服务提供方验证" class="headerlink" title="Provider Verification(服务提供方验证)"></a>Provider Verification(服务提供方验证)</h3><p>Provider 必须验证自己返回的数据结构与消费者要求一致。如果不一致，则无法上线，防止破坏接口。</p><h2 id="常用tools"><a href="#常用tools" class="headerlink" title="常用tools"></a>常用tools</h2><p>Pact（最流行）</p><p>Spring Cloud Contract（Java&#x2F;微服务中常用）</p><p>Hoverfly（API 模拟）</p><p>契约测试的特殊点是 双方共同维护，不需要全部服务都跑起来。</p>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 契约测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Fake</title>
      <link href="/JasmineRain.github.io/2025/11/17/Fake/"/>
      <url>/JasmineRain.github.io/2025/11/17/Fake/</url>
      
        <content type="html"><![CDATA[<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>Fake（伪对象） 在软件测试、尤其是单元测试和测试开发中，是一种常见的 Test Double（测试替身）。</p><p>Fake 是一种 “带有简化实现的替代对象”，它能部分模拟真实对象的行为，但不完全等价。</p><p>它通常 有实际逻辑、能跑起来，但只是 简化版 &#x2F; 非生产级。</p><p>假设业务真正使用：MySQL 数据库、Redis 缓存、文件存储系统</p><p>这些在单元测试中启动非常慢，也很重。</p><p>于是你可以构造 Fake：FakeDB（伪数据库）：用 内存 map 存储数据，不用启动真正的 MySQL；提供 find&#x2F;add&#x2F;update 接口；测试环境可运行、速度快。FakeCache（伪缓存）：用 map 代替 Redis；实现 get&#x2F;set 逻辑</p><p>它们可以运行，但不能用于生产，只适合测试。</p><h2 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">    ID   <span class="type">int</span></span><br><span class="line">    Name <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> UserRepo <span class="keyword">interface</span> &#123;</span><br><span class="line">    GetUser(id <span class="type">int</span>) (*User, <span class="type">error</span>)</span><br><span class="line">    SaveUser(u *User) <span class="type">error</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Fake 实现</span></span><br><span class="line"><span class="keyword">type</span> FakeUserRepo <span class="keyword">struct</span> &#123;</span><br><span class="line">    data <span class="keyword">map</span>[<span class="type">int</span>]*User</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewFakeUserRepo</span><span class="params">()</span></span> *FakeUserRepo &#123;</span><br><span class="line">    <span class="keyword">return</span> &amp;FakeUserRepo&#123;</span><br><span class="line">        data: <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">int</span>]*User),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(f *FakeUserRepo)</span></span> GetUser(id <span class="type">int</span>) (*User, <span class="type">error</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> u, ok := f.data[id]; ok &#123;</span><br><span class="line">        <span class="keyword">return</span> u, <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span>, fmt.Errorf(<span class="string">&quot;not found&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(f *FakeUserRepo)</span></span> SaveUser(u *User) <span class="type">error</span> &#123;</span><br><span class="line">    f.data[u.ID] = u</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>现在，所有的单元测试都可以直接用：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">repo := NewFakeUserRepo()</span><br><span class="line">service := NewUserService(repo)</span><br></pre></td></tr></table></figure><p>完全不需要真正的MySQL</p><p>Fake &#x3D; 带简单实现的伪对象，用于替代真实组件，使测试更快更稳定。</p>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Stub</title>
      <link href="/JasmineRain.github.io/2025/11/17/Stub/"/>
      <url>/JasmineRain.github.io/2025/11/17/Stub/</url>
      
        <content type="html"><![CDATA[<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>Stub（桩）是 Test Double（测试替身）的重要类型。</p><p>Stub（桩）是用于替代真实依赖，但会返回“固定的、预设的”结果的对象。</p><p>Stub 是一种测试替身，用来替代真实依赖，返回预设的、固定的数据，使单元测试可控、快速、可靠。</p><h2 id="用途"><a href="#用途" class="headerlink" title="用途"></a>用途</h2><ol><li>控制依赖的返回结果：数据库查询、三方 API 返回、RPC 结果……</li><li>模拟各种测试场景:查询成功、查询失败、超时、无数据…..</li><li>让单元测试更快、更稳定、更可控:不用访问真实网络 &#x2F; 数据库，执行速度飞快。</li></ol><h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><p>假设有如下函数</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetUserNameByID</span><span class="params">(repo UserRepository,id <span class="type">int</span>)</span></span><span class="type">string</span>&#123;</span><br><span class="line">    user,err:=repo.FindByID(id)</span><br><span class="line">    <span class="keyword">if</span> err!=<span class="literal">nil</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;unknown&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> user.Name</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以自由控制返回的数据，Stub实现为：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> StubUserRepository <span class="keyword">struct</span>&#123;</span><br><span class="line">    users <span class="keyword">map</span>[<span class="type">int</span>]User</span><br><span class="line">    err <span class="type">error</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s StubUserRepository)</span></span> FindByID(id <span class="type">int</span>)(User ,<span class="type">error</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span> s.err!=<span class="literal">nil</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> User&#123;&#125;,s.err</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s.users[id],<span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Stub的单元测试</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestGetUserNameByID_Success</span><span class="params">(t *testing.T)</span></span>&#123;</span><br><span class="line">    stubRepo:=StubUserRepository&#123;</span><br><span class="line">        users:<span class="keyword">map</span>[<span class="type">int</span>]User&#123;</span><br><span class="line">            <span class="number">1</span>:&#123;ID:<span class="number">1</span>,Name:<span class="string">&quot;Alice&quot;</span>&#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    name:=GetUserNameByID(stubRepo,<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> name!=<span class="string">&quot;Alice&quot;</span>&#123;</span><br><span class="line">        t.Error(<span class="string">&quot;expected Alice,got %s&quot;</span>,name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestGetUserNameByID_Error</span><span class="params">(t *testing.T)</span></span>&#123;</span><br><span class="line">    stubRepo:=StubUserRepository&#123;</span><br><span class="line">        err:=errors.New(<span class="string">&quot;db error&quot;</span>),</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    name:=GetUserNameByID(stubRepo,<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> name!=<span class="string">&quot;unknown&quot;</span>&#123;</span><br><span class="line">        t.Errorf(<span class="string">&quot;expected unknown,got %s&quot;</span>,name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Dummy对象</title>
      <link href="/JasmineRain.github.io/2025/11/17/Dummy%E5%AF%B9%E8%B1%A1/"/>
      <url>/JasmineRain.github.io/2025/11/17/Dummy%E5%AF%B9%E8%B1%A1/</url>
      
        <content type="html"><![CDATA[<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p><strong>Dummy 对象</strong>（哑对象）是软件测试和单元测试中经常出现的概念，它属于 Test Double（测试替身） 的一种。</p><p>Dummy 对象是一种“什么都不做，只为了占位置”的对象。</p><p>它不会被真正使用、也不参与逻辑，只是为了满足参数要求，让程序能够正常运行。</p><p>它就像“哑巴”，不会说话、不做事、不参与逻辑，仅仅存在。</p><p>核心特征：只占位，不使用。</p><h2 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h2><ul><li>函数或类需要某个参数，但测试时根本不需要用到这个参数</li></ul><p>例如：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Register</span><span class="params">(user User,logger Logger)</span></span>&#123;</span><br><span class="line">    <span class="comment">//测试时只关注user 而不是logger</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>测试时logger可以用Dummy，对象只为了占位置</p><ul><li>避免因为依赖导致无法进行单元测试</li></ul><p>例如依赖数据库、网络、日志系统… 但你测试的函数根本不需要它 → 用 Dummy 代替。</p>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python基础</title>
      <link href="/JasmineRain.github.io/2025/11/17/Python%E5%9F%BA%E7%A1%80/"/>
      <url>/JasmineRain.github.io/2025/11/17/Python%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h2 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h2><p>加入注释并不会对代码的运行产生影响，但加入注释可以使代码更加易懂易用。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用 # 字符开头的是单行注释</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">跨多行字符串会用三引号</span></span><br><span class="line"><span class="string">（即三个单引号或三个双引号）</span></span><br><span class="line"><span class="string">包裹，但也通常被用于注释</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><h2 id="一切皆对象"><a href="#一切皆对象" class="headerlink" title="一切皆对象"></a>一切皆对象</h2><p>在 Python 中，你无需事先声明变量名及其类型，直接赋值即可创建各种类型的变量：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = -<span class="number">3</span>  <span class="comment"># 语句结尾不用加分号</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line">-<span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f = <span class="number">3.1415926535897932384626</span>; f  <span class="comment"># 实在想加分号也可以，这里节省了一行</span></span><br><span class="line"><span class="number">3.141592653589793</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s1 = <span class="string">&quot;O&quot;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s1  <span class="comment"># 在 Python 中双引号和单引号的作用相同</span></span><br><span class="line"><span class="string">&#x27;O&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = <span class="string">&#x27;A&#x27;</span> == <span class="number">65</span>  <span class="comment"># &#x27;A&#x27; 和 65 不是一个数据类型，所以不相等</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b  <span class="comment"># True, False 首字母均大写</span></span><br><span class="line"><span class="literal">False</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="literal">True</span> + <span class="number">1</span> == <span class="number">2</span> <span class="keyword">and</span> <span class="keyword">not</span> <span class="literal">False</span> != <span class="number">0</span>  <span class="comment"># Python 中的表达式中大多使用单词，但是也支持符号</span></span><br><span class="line"><span class="literal">True</span></span><br></pre></td></tr></table></figure><p>这不代表 Python 没有类型的概念，实际上解释器会根据赋值或运算自动推断变量类型，你可以使用内置函数 type() 查看这些变量的类型：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">type</span>(x)</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;int&#x27;</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">type</span>(f)</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;float&#x27;</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">type</span>(s1)  <span class="comment"># 不要给字符串起名为 str，否则 str 对象会被篡改</span></span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;str&#x27;</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">type</span>(b)</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;bool&#x27;</span>&gt;</span><br></pre></td></tr></table></figure><h2 id="数字运算"><a href="#数字运算" class="headerlink" title="数字运算"></a>数字运算</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">5.0</span> * <span class="number">6</span>  <span class="comment"># 浮点数的运算结果是浮点数</span></span><br><span class="line"><span class="number">30.0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">15</span> / <span class="number">3</span>  <span class="comment"># 与 C/C++ 不同，除法永远返回浮点 float 类型</span></span><br><span class="line"><span class="number">5.0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">5</span> / <span class="number">100000</span>  <span class="comment"># 位数太多，结果显示成科学计数法形式</span></span><br><span class="line"><span class="number">5e-05</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">5</span> // <span class="number">3</span> <span class="comment"># 使用整数除法（地板除）则会向下取整，输出整数类型</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>-<span class="number">5</span> // <span class="number">3</span> <span class="comment"># 符合向下取整原则，注意这与 C/C++ 不同</span></span><br><span class="line">-<span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">5</span> % <span class="number">3</span> <span class="comment"># 取模</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>-<span class="number">5</span> % <span class="number">3</span> <span class="comment"># 负数取模结果一定是非负数，这点也与 C/C++ 不同，不过都满足 (a//b)*b+(a%b)==a </span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="built_in">abs</span>(-<span class="number">1e4</span>)  <span class="comment"># 求绝对值的内置函数</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x += <span class="number">1</span>  <span class="comment"># 没有自增/自减运算符</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x  <span class="comment"># 科学计数法默认为 float</span></span><br><span class="line"><span class="number">10001.0</span></span><br></pre></td></tr></table></figure><p>除法运算（&#x2F;）永远返回浮点类型（在 Python 2 中返回整数）。如果想要整数或向下取整的结果的话，可以使用整数除法（&#x2F;&#x2F;）。同样的，也可以像 C++ 中一样，使用模（%）来计算余数，科学计数法的形式也相同。</p><p>特别地，Python 用 ** 即可进行幂运算，还通过内置的 pow(a, b, mod) 提供了 快速幂 的高效实现。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">3</span> ** <span class="number">4</span> <span class="comment"># 幂运算</span></span><br><span class="line"><span class="number">81</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">2</span> ** <span class="number">512</span></span><br><span class="line"><span class="number">13407807929942597099574024998205846127479365820592393377723561443721764030073546976801874298166903427690031858186486050853753882811946569946433649006084096</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">512</span>, <span class="built_in">int</span>(<span class="number">1e4</span>)) <span class="comment"># 即 2**512 % 10000 的快速实现, 1e4 是 float 所以要转 int</span></span><br><span class="line"><span class="number">4096</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">0.1</span> + <span class="number">0.1</span> + <span class="number">0.1</span> - <span class="number">0.3</span> == <span class="number">0.</span>  <span class="comment"># 和 C/C++ 一样需要注意浮点数不能直接判相等</span></span><br><span class="line"><span class="literal">False</span></span><br></pre></td></tr></table></figure><h2 id="数据类型判断"><a href="#数据类型判断" class="headerlink" title="数据类型判断"></a>数据类型判断</h2><p>对于一个变量，可以使用<code>type(object)</code>返回变量的类型，例如<code>type(8)</code>和<code>type(&#39;a&#39;)</code>的值分别为 <code>&lt;class &#39;int&#39;&gt;</code>和<code>&lt;class &#39;str&#39;&gt;</code>。</p><p>Python 中的输入输出主要通过内置函数 input() 和 print() 完成，print() 的用法十分符合直觉：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]; <span class="built_in">print</span>(a[-<span class="number">1</span>])  <span class="comment"># 打印时默认末尾换行</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(ans[<span class="number">0</span>], ans[<span class="number">1</span>])  <span class="comment"># 可以输出任意多个变量，默认以空格间隔</span></span><br><span class="line"><span class="number">1</span> <span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(a[<span class="number">0</span>], a[<span class="number">1</span>], end=<span class="string">&#x27;&#x27;</span>)  <span class="comment"># 令 end=&#x27;&#x27;, 使末尾不换行</span></span><br><span class="line"><span class="number">1</span> <span class="number">2</span>&gt;&gt;&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(a[<span class="number">0</span>], a[<span class="number">1</span>], sep=<span class="string">&#x27;, &#x27;</span>)  <span class="comment"># 令 sep=&#x27;, &#x27;，改变间隔样式</span></span><br><span class="line"><span class="number">1</span>, <span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(<span class="built_in">str</span>(a[<span class="number">0</span>]) + <span class="string">&#x27;, &#x27;</span> + <span class="built_in">str</span>(a[<span class="number">1</span>]))  <span class="comment"># 输出同上，但是手动拼接成一整个字符串</span></span><br></pre></td></tr></table></figure><p>input() 函数的行为接近 C++ 中的 getline()，即将一整行作为字符串读入，且末尾没有换行符。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="built_in">input</span>(<span class="string">&#x27;请输入一串数字: &#x27;</span>); s  <span class="comment"># 调试时可以向 input() 传入字符串作为提示</span></span><br><span class="line">请输入一串数字: <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span></span><br><span class="line"><span class="string">&#x27;1 2 3 4 5 6&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h2><p>Python 3 提供了强大的基于 Unicode 的字符串类型，使用起来和 C++ 中的 string 类似，一些概念如转义字符也都相通，除了加号拼接和索引访问，还额外支持数乘 * 重复字符串，和 in 操作符。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s1 = <span class="string">&quot;O&quot;</span>  <span class="comment"># 单引号和双引号都能包起字符串，有时可节省转义字符</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s1 += <span class="string">&#x27;I-Wiki&#x27;</span>  <span class="comment"># 为和 C++ 同步建议使用双引号 </span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;OI&#x27;</span> <span class="keyword">in</span> s1  <span class="comment"># 检测子串很方便</span></span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">len</span>(s1)  <span class="comment"># 类似 C++ 的 s.length()，但更通用</span></span><br><span class="line"><span class="number">7</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s2 = <span class="string">&quot;&quot;&quot; 感谢你的阅读</span></span><br><span class="line"><span class="string"><span class="meta">... </span>欢迎参与贡献!</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>   <span class="comment"># 使用三重引号的字符串可以跨越多行</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s1 + s2 </span><br><span class="line"><span class="string">&#x27;OI-Wiki 感谢你的阅读\n欢迎参与贡献!&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(s1 + s2)  <span class="comment"># 这里使用了 print() 函数打印字符串</span></span><br><span class="line">OI-Wiki 感谢你的阅读</span><br><span class="line">欢迎参与贡献!</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s2[<span class="number">2</span>] * <span class="number">2</span> + s2[<span class="number">3</span>] + s2[-<span class="number">1</span>]  <span class="comment"># 负数索引从右开始计数，加上 len(s)，相当于模 n 的剩余类环</span></span><br><span class="line"><span class="string">&#x27;谢谢你!&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s1[<span class="number">0</span>] = <span class="string">&#x27;o&#x27;</span>  <span class="comment"># str 是不可变类型，不能原地修改，其实 += 也是创建了新的对象</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">TypeError: <span class="string">&#x27;str&#x27;</span> <span class="built_in">object</span> does <span class="keyword">not</span> support item assignment</span><br></pre></td></tr></table></figure><p>Python 支持多种复合数据类型，可将不同值组合在一起。最常用的 list，类型是用方括号标注、逗号分隔的一组值。例如，[1, 2, 3] 和 [‘a’,’b’,’c’] 都是列表。</p><p>除了索引，字符串还支持切片，它的设计非常精妙，格式为 s[左闭索引:右开索引:步长]：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">&#x27;OI-Wiki 感谢你的阅读\n欢迎参与贡献!&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s[:<span class="number">8</span>]  <span class="comment"># 省略左闭索引则从头开始</span></span><br><span class="line"><span class="string">&#x27;OI-Wiki &#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s[<span class="number">8</span>:<span class="number">14</span>]  <span class="comment"># 左闭右开设计的妙处，长度为 14-8=6，还和上一个字符串无缝衔接</span></span><br><span class="line"><span class="string">&#x27;感谢你的阅读&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s[-<span class="number">4</span>:]  <span class="comment"># 省略右开索引则直到结尾</span></span><br><span class="line"><span class="string">&#x27;与贡献!&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s[<span class="number">8</span>:<span class="number">14</span>:<span class="number">2</span>]  <span class="comment"># 步长为2</span></span><br><span class="line"><span class="string">&#x27;感你阅&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s[::-<span class="number">1</span>]  <span class="comment"># 步长为 -1 时，获得了反转的字符串</span></span><br><span class="line"><span class="string">&#x27;!献贡与参迎欢\n读阅的你谢感 ikiW-IO&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s  <span class="comment"># 但原来的字符串并未改变</span></span><br><span class="line"><span class="string">&#x27;OI-Wiki 感谢你的阅读\n欢迎参与贡献!&#x27;</span></span><br></pre></td></tr></table></figure><p>在最新的 Python 3 版本中，字符串是以 Unicode 编码的，也就是说，Python 的字符串支持多语言。1在 Python 中，可以对一个 Unicode 字符使用内置函数 ord() 将其转换为对应的 Unicode 编码，逆向的转换使用内置函数 chr()。C&#x2F;C++ 中 char 类型也可以和 对应的 ASCII 码互转。</p><p>如果想把数字转换成对应的字符串，可以使用内置函数 str()，反之可以使用 int() 和 float()，你可以类比为 C&#x2F;C++ 中的强制类型转换，但括号不是加在类型上而是作为函数的一部分括住参数。</p><p>Python 的字符串类型提供了许多强大的方法，包括计算某字符的索引与出现次数，转换大小写等等。</p><h2 id="创建数组"><a href="#创建数组" class="headerlink" title="创建数组"></a>创建数组</h2><p>列表（list）大概是 Python 中最常用也最强大的序列类型，列表中可以存放任意类型的元素，包括嵌套的列表，这符合数据结构中「广义表」的定义。请注意不要将其与 C++ STL 中的双向链表 list 混淆，故本文将使用「列表」而非 list 以免造成误解。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>[]  <span class="comment"># 创建空列表，注意列表使用方括号</span></span><br><span class="line">[]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>nums = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">13</span>]; nums  <span class="comment"># 初始化列表，注意整个列表可以直接打印</span></span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">13</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>nums[<span class="number">0</span>] = <span class="number">1</span>; nums  <span class="comment"># 支持索引访问，支持修改元素</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">13</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>nums.append(nums[-<span class="number">2</span>]+nums[-<span class="number">1</span>]); nums  <span class="comment"># append() 同 vector 的 push_back()，也都没有返回值</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">21</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>nums.pop()  <span class="comment"># 弹出并返回末尾元素，可以当栈使用；其实还可指定位置，默认是末尾</span></span><br><span class="line"><span class="number">21</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>nums.insert(<span class="number">0</span>, <span class="number">1</span>); nums  <span class="comment"># 同 vector 的 insert(position, val)</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">13</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>nums.remove(<span class="number">1</span>); nums  <span class="comment"># 按值移除元素（只删第一个出现的），若不存在则抛出错误</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">13</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">len</span>(nums)  <span class="comment"># 求列表长度，类似 vector 的 size()，但 len() 是内置函数</span></span><br><span class="line"><span class="number">7</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>nums.reverse(); nums  <span class="comment"># 原地逆置</span></span><br><span class="line">[<span class="number">13</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">sorted</span>(nums)  <span class="comment"># 获得排序后的列表</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">13</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>nums  <span class="comment"># 但原来的列表并未排序</span></span><br><span class="line">[<span class="number">13</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>nums.sort(); nums  <span class="comment"># 原地排序，可以指定参数 key 作为排序标准</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">13</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>nums.count(<span class="number">1</span>)  <span class="comment"># 类似 std::count()</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>nums.index(<span class="number">1</span>)  <span class="comment"># 返回值首次出现项的索引号，若不存在则抛出错误</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>nums.clear(); nums  <span class="comment"># 同 vector 的 clear()</span></span><br></pre></td></tr></table></figure><p>以上示例展现了列表与 vector 的相似之处，vector 中常用的操作一般也都能在列表中找到对应方法，不过某些方法如 len(),sorted() 会以内置函数的面目出现，而 STL 算法中的函数如 find(),count(),max_element(),sort(),reverse() 在 Python 中又成了对象的方法，使用时需要注意区分。</p><p>将展示列表作为 Python 的基本序列类型的一些强大功能：</p><p>Python 支持多种复合数据类型，可将不同值组合在一起。最常用的 list，类型是用方括号标注、逗号分隔的一组值。例如，[1, 2, 3] 和 [‘a’,’b’,’c’] 都是列表。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>lst = [<span class="number">1</span>, <span class="string">&#x27;1&#x27;</span>] + [<span class="string">&quot;2&quot;</span>, <span class="number">3.0</span>]  <span class="comment"># 列表直接相加生成一个新列表</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lst  <span class="comment"># 这里存放不同的类型只是想说明可以这么做，但这不是好的做法</span></span><br><span class="line">[<span class="number">1</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="number">3.0</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">3</span> <span class="keyword">in</span> lst  <span class="comment"># 实用的成员检测操作，字符串也有该操作且还支持子串检测</span></span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">1</span>, <span class="string">&#x27;1&#x27;</span>] <span class="keyword">in</span> lst  <span class="comment"># 仅支持单个成员检测，不会发现「子序列」</span></span><br><span class="line"><span class="literal">False</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lst[<span class="number">1</span>:<span class="number">3</span>] = [<span class="number">2</span>, <span class="number">3</span>]; lst  <span class="comment"># 切片并赋值，原列表被修改</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3.0</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lst[::-<span class="number">1</span>]  <span class="comment"># 获得反转后的新列表</span></span><br><span class="line">[<span class="number">3.0</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lst *= <span class="number">2</span>; lst  <span class="comment"># 数乘拼接</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3.0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3.0</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">del</span> lst[<span class="number">4</span>:]; lst  <span class="comment"># 也可写 lst[4:] = []，del 语句不止可以用于删除序列中元素</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3.0</span>]</span><br></pre></td></tr></table></figure><p>列表作为序列的一些常用操作，可以看出许多操作如切片是与字符串相通的，但字符串是「不可变序列」而列表是「可变序列」，故可以通过切片灵活地修改列表。在 C&#x2F;C++ 中我们往往会通过循环处理字符数组，下面将展示如何使用 「列表推导式」 在字符串和列表之间转换：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># 建立一个 [65, 70) 区间上的整数数组，range 也是一种类型，可看作左闭右开区间，第三个参数为步长可省略</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>nums = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">65</span>,<span class="number">70</span>))  <span class="comment"># 记得 range 外面还要套一层 list()</span></span><br><span class="line">[<span class="number">65</span>, <span class="number">66</span>, <span class="number">67</span>, <span class="number">68</span>, <span class="number">69</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lst = [<span class="built_in">chr</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> nums]  <span class="comment"># 列表推导式的典型结构，[exp for var in iterable if cond]</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lst  <span class="comment"># 上两句可以合并成 [chr(x) for x in range(65,70)]</span></span><br><span class="line">[<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;E&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">&#x27;&#x27;</span>.join(lst); s <span class="comment"># 用空字符串 &#x27;&#x27; 拼接列表中的元素生成新字符串</span></span><br><span class="line"><span class="string">&#x27;ABCDE&#x27;</span></span><br><span class="line">&gt;&gt; <span class="built_in">list</span>(s)  <span class="comment"># 字符串生成字符列表</span></span><br><span class="line">[<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;E&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># 如果你不知道有 s.lower() 方法就可能写出下面这样新瓶装旧酒的表达式</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(<span class="built_in">ord</span>(ch) - <span class="number">65</span> + <span class="number">97</span>) <span class="keyword">for</span> ch <span class="keyword">in</span> s <span class="keyword">if</span> ch &gt;= <span class="string">&#x27;A&#x27;</span> <span class="keyword">and</span> ch &lt;= <span class="string">&#x27;Z&#x27;</span>])  </span><br><span class="line"><span class="string">&#x27;abcde&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>vis = [[<span class="number">0</span>] * <span class="number">3</span>] * <span class="number">3</span>  <span class="comment"># 开一个 3*3 的全 0 数组</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>vis </span><br><span class="line">[[<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>vis[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>; vis  <span class="comment"># 怎么会把其他行也修改了？</span></span><br><span class="line">[[<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>], [<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>], [<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>]]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># 先来看下一维列表的赋值</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a1 = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]; a2 = a1; a3 = a1[:]  <span class="comment"># 列表也可以直接被赋给新的变量</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a1[<span class="number">0</span>] = <span class="number">1</span>; a1  <span class="comment"># 修改列表 a1，似乎正常</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a2  <span class="comment"># 怎么 a2 也被改变了</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a3  <span class="comment"># a3 没有变化</span></span><br><span class="line">[<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">id</span>(a1) == <span class="built_in">id</span>(a2) <span class="keyword">and</span> <span class="built_in">id</span>(a1) != <span class="built_in">id</span>(a3)  <span class="comment"># 内置函数 id() 给出对象的「标识值」，可类比为地址，地址相同说明是一个对象</span></span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>vis2 = vis[:]  <span class="comment"># 拷贝一份二维列表</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>vis[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">2</span>; vis  <span class="comment"># vis 会被批量修改</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[[<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>]]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>vis2  <span class="comment"># 但 vis2 是切片拷贝还是被改了</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[[<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>]]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">id</span>(vis) != <span class="built_in">id</span>(vis2)  <span class="comment"># vis 和 vis2 不是一个对象</span></span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># vis2 虽然不是 vis 的引用，但其中对应行都指向相同的对象</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="built_in">id</span>(vis[i]) == <span class="built_in">id</span>(vis2[i]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">[<span class="literal">True</span>, <span class="literal">True</span>, <span class="literal">True</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># 回看二维列表自身</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="built_in">id</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> vis]  <span class="comment"># 具体数字和这里不一样但三个值一定相同，说明是三个相同对象</span></span><br><span class="line">[<span class="number">139760373248192</span>, <span class="number">139760373248192</span>, <span class="number">139760373248192</span>]</span><br></pre></td></tr></table></figure><p>Python 中赋值只传递了引用而非创建新值，可以创建不同类型的变量并赋给新变量，验证发现二者的标识值是相同的，只不过直到现在我们才介绍了列表这一种可变类型，而给数字、字符串这样的不可变类型赋新值时实际上创建了新的对象，故而前后两个变量互不干扰。但列表是可变类型，所以我们修改一个列表的元素时，另一个列表由于指向同一个对象所以也被修改了。创建二维数组也是类似的情况，示例中用乘法创建二维列表相当于把 [0]*3 这个一维列表重复了 3 遍，所以涉及其中一个列表的操作会同时影响其他两个列表。更不幸的是，在将二维列表赋给其他变量的时候，就算用切片来拷贝，也只是「浅拷贝」，其中的元素仍然指向相同的对象，解决这个问题需要使用标准库中的 deepcopy，或者尽量避免整个赋值二维列表。不过还好，创建二维列表时避免创建重复的列表还是比较简单，只需使用「列表推导式」：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>vis1 = [[<span class="number">0</span>] * <span class="number">3</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]  <span class="comment"># 把用不到的循环计数变量设为下划线 _ 是一种惯例</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># 但在 REPL 中 _ 默认指代上一个表达式输出的结果，故也可使用双下划线</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>vis1</span><br><span class="line">[[<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="built_in">id</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> vis1]  <span class="comment"># 具体数字和这里不一样但三个值一定不同，说明是三个不同对象</span></span><br><span class="line">[<span class="number">139685508981248</span>, <span class="number">139685508981568</span>, <span class="number">139685508981184</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>vis1[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">[[<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a2[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">10</span>  <span class="comment"># 访问和赋值二维数组</span></span><br></pre></td></tr></table></figure><p>Python 是高度动态的解释型语言，因此其程序运行有大量的额外开销。尤其是 for 循环在 Python 中运行的奇慢无比。因此在使用 Python 时若想获得高性能，尽量使用列表推导式，或者 filter,map 等内置函数直接操作整个序列来避免循环，当然这还是要根据具体问题而定。</p><h2 id="NumPy"><a href="#NumPy" class="headerlink" title="NumPy"></a>NumPy</h2><p>利用 NumPy 建立多维数组并进行访问。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> numpy <span class="keyword">as</span> np  </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>np.empty(<span class="number">3</span>) <span class="comment"># 开容量为 3 的空数组，注意没有初始化为 0</span></span><br><span class="line">array([<span class="number">0.00000000e+000</span>, <span class="number">0.00000000e+000</span>, <span class="number">2.01191014e+180</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>np.zeros((<span class="number">3</span>, <span class="number">3</span>)) <span class="comment"># 开 3*3 的数组，并初始化为 0</span></span><br><span class="line">array([[<span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>],</span><br><span class="line">       [<span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>],</span><br><span class="line">       [<span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>]])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a1 = np.zeros((<span class="number">3</span>, <span class="number">3</span>), dtype=<span class="built_in">int</span>) <span class="comment"># 开 3×3 的整数数组</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a1[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span> <span class="comment"># 访问和赋值</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a1[<span class="number">0</span>, <span class="number">0</span>] = <span class="number">1</span> <span class="comment"># 更友好的语法</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a1.shape <span class="comment"># 数组的形状</span></span><br><span class="line">(<span class="number">3</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a1[:<span class="number">2</span>, :<span class="number">2</span>] <span class="comment"># 取前两行、前两列构成的子阵，无拷贝</span></span><br><span class="line">array([[<span class="number">1</span>, <span class="number">0</span>],</span><br><span class="line">       [<span class="number">0</span>, <span class="number">0</span>]])</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a1[:, [<span class="number">0</span>, <span class="number">2</span>]] <span class="comment"># 获取第 1、3 列，无拷贝</span></span><br><span class="line">array([[<span class="number">1</span>, <span class="number">0</span>],</span><br><span class="line">       [<span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">       [<span class="number">0</span>, <span class="number">0</span>]])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>np.<span class="built_in">max</span>(a1) <span class="comment"># 获取数组最大值</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a1.flatten() <span class="comment"># 将数组展平</span></span><br><span class="line">array([<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>np.sort(a1, axis = <span class="number">1</span>) <span class="comment"># 沿行方向对数组进行排序，返回排序结果</span></span><br><span class="line">array([[<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">       [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">       [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a1.sort(axis = <span class="number">1</span>) <span class="comment"># 沿行方向对数组进行原地排序</span></span><br></pre></td></tr></table></figure><h2 id="array"><a href="#array" class="headerlink" title="array"></a>array</h2><p>array 是 Python 标准库提供的一种高效数值数组，可以紧凑地表示基本类型值的数组，但不支持数组嵌套</p>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>身份证输入框测试用例设计</title>
      <link href="/JasmineRain.github.io/2025/11/17/%E8%BA%AB%E4%BB%BD%E8%AF%81%E8%BE%93%E5%85%A5%E6%A1%86%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B%E8%AE%BE%E8%AE%A1/"/>
      <url>/JasmineRain.github.io/2025/11/17/%E8%BA%AB%E4%BB%BD%E8%AF%81%E8%BE%93%E5%85%A5%E6%A1%86%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B%E8%AE%BE%E8%AE%A1/</url>
      
        <content type="html"><![CDATA[<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>身份证输入框测试需覆盖格式校验、业务规划（年龄&#x2F;性别&#x2F;地址）、兼容性、安全性、用户体验五大维度，设计正向与反向用例合法性识别、错误提示及容错处理。</p><h2 id="详细测试用例设计"><a href="#详细测试用例设计" class="headerlink" title="详细测试用例设计"></a>详细测试用例设计</h2><h3 id="格式校验（核心-18位编码规则）"><a href="#格式校验（核心-18位编码规则）" class="headerlink" title="格式校验（核心:18位编码规则）"></a>格式校验（核心:18位编码规则）</h3><h3 id="业务规则验证（解析编码含义）"><a href="#业务规则验证（解析编码含义）" class="headerlink" title="业务规则验证（解析编码含义）"></a>业务规则验证（解析编码含义）</h3><h3 id="交互与兼容性"><a href="#交互与兼容性" class="headerlink" title="交互与兼容性"></a>交互与兼容性</h3><h3 id="安全性与容错"><a href="#安全性与容错" class="headerlink" title="安全性与容错"></a>安全性与容错</h3><h3 id="特殊场景"><a href="#特殊场景" class="headerlink" title="特殊场景"></a>特殊场景</h3>]]></content>
      
      
      <categories>
          
          <category> 测开 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 测试 </tag>
            
            <tag> 用例设计 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SQL基础操作</title>
      <link href="/JasmineRain.github.io/2025/11/17/SQL%E5%9F%BA%E7%A1%80%E6%93%8D%E4%BD%9C/"/>
      <url>/JasmineRain.github.io/2025/11/17/SQL%E5%9F%BA%E7%A1%80%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<h2 id="基础查询"><a href="#基础查询" class="headerlink" title="基础查询"></a>基础查询</h2><h3 id="查询所有列"><a href="#查询所有列" class="headerlink" title="查询所有列"></a>查询所有列</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> table_name;</span><br></pre></td></tr></table></figure><p>*表示通配符，*表示选择表中的所有列<br>table_name表示需要查询的表的名称</p><h3 id="查询多列"><a href="#查询多列" class="headerlink" title="查询多列"></a>查询多列</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column1,column2,... <span class="keyword">FROM</span> table_name;</span><br></pre></td></tr></table></figure><p>这条语句会返回table_name表中的column1,column2,…列的所有行</p><h3 id="使用别名"><a href="#使用别名" class="headerlink" title="使用别名"></a>使用别名</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> first_name <span class="keyword">AS</span> name,last_name <span class="keyword">AS</span> surname <span class="keyword">FROM</span> table_name <span class="keyword">AS</span> tn;</span><br></pre></td></tr></table></figure><p>这条语句会返回表中的first_name,last_name列，并将它们分别重命名为name和surname。同时table_name被重命名为tn</p><h3 id="查询结果的过滤"><a href="#查询结果的过滤" class="headerlink" title="查询结果的过滤"></a>查询结果的过滤</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column1,column2,... <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> <span class="keyword">condition</span>;</span><br></pre></td></tr></table></figure><p>WHERE子句可以根据条件过滤结果<br>condition:限制条件</p><h3 id="查询结果的排序"><a href="#查询结果的排序" class="headerlink" title="查询结果的排序"></a>查询结果的排序</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column1,column2,... <span class="keyword">FROM</span> table_name <span class="keyword">ORDER</span> <span class="keyword">BY</span> column1 [<span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span>],column2 [<span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span>],...;</span><br></pre></td></tr></table></figure><p>ORDER BY子句可以根据指定的列对查询结果进行排序。<br>column1 [ASC|DESC]:按照column1[升序|降序]进行排序，若不加ASC或者DESC则默认升序。</p><h3 id="查询结果的去重"><a href="#查询结果的去重" class="headerlink" title="查询结果的去重"></a>查询结果的去重</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> column1,column2,... <span class="keyword">FROM</span> table_name;</span><br></pre></td></tr></table></figure><p>使用DISTINCT关键字可以去除查询结果中的重复行。<br>对column1,colum2,…列中的重复行进行去除。</p><h3 id="查询结果的限制"><a href="#查询结果的限制" class="headerlink" title="查询结果的限制"></a>查询结果的限制</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column1,column2,... <span class="keyword">FROM</span> table_name LIMIT n;</span><br></pre></td></tr></table></figure><p>在某些数据库系统中，使用LIMIT子句限制查询结果的行数。<br>限制输出n行</p><h2 id="条件查询"><a href="#条件查询" class="headerlink" title="条件查询"></a>条件查询</h2><h3 id="多列排序"><a href="#多列排序" class="headerlink" title="多列排序"></a>多列排序</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> column1 <span class="keyword">ASC</span>,column2 <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure><p>ASC:表示按升序排序（默认值）<br>DESC：表示按降序排序<br>column1：指定要排序的列名</p><p>同时也可以在ORDER BY 子句中使用列的别名进行排序。</p><p>例如</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column1,column2 <span class="keyword">AS</span> co <span class="keyword">FROM</span> user_profile <span class="keyword">ORDER</span> <span class="keyword">BY</span> co <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure><h3 id="基础操作符"><a href="#基础操作符" class="headerlink" title="基础操作符"></a>基础操作符</h3><p>操作符用于WHERE子句中指定条件，以过滤查询结果。</p><ol><li>比较运算符（&#x3D;、&lt;&gt;或!&#x3D;、&gt;、&lt;、&gt;&#x3D;、&lt;&#x3D;）</li><li>逻辑运算符：AND、OR、NOT</li><li>IN操作符：<blockquote><p>IN操作符用于指定多个可能的值，返回布尔值。</p></blockquote></li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column1,column2 <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> column1 <span class="keyword">IN</span> (value1,value2,...);</span><br><span class="line"></span><br><span class="line">#查询部门id为<span class="number">101</span>或者<span class="number">103</span>的员工</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> department_id <span class="keyword">IN</span> (<span class="number">101</span>,<span class="number">103</span>)</span><br></pre></td></tr></table></figure><ol start="4"><li>BETWEEN操作符<br>BETWEEN操作符用于指定一个范围，返回布尔值。</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column1,column2 <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> column1 <span class="keyword">BETWEEN</span> value1 <span class="keyword">AND</span> value2;</span><br><span class="line"></span><br><span class="line">#查询工资在<span class="number">50000</span>到<span class="number">70000</span>之间的员工</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> salary <span class="keyword">BETWEEN</span> <span class="number">50000</span> <span class="keyword">AND</span> <span class="number">70000</span>;</span><br></pre></td></tr></table></figure><ol start="5"><li>LIKE操作符<br>LIKE操作符用于模式匹配，返回布尔值。</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column1,column2 <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> column1 <span class="keyword">LIKE</span> <span class="keyword">pattern</span>;</span><br><span class="line"></span><br><span class="line">#查询名字以字母&quot;A&quot;开头的员工</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> first_name <span class="keyword">LIKE</span> &quot;A%&quot;;</span><br></pre></td></tr></table></figure><p>%:匹配任意数量的字符，包括零字符<br>_:匹配单个字符</p><h3 id="高级操作符"><a href="#高级操作符" class="headerlink" title="高级操作符"></a>高级操作符</h3><p><code>IS NULL</code>和<code>IS NOT NULL</code>,用于检查一个列是否为NULL或不为NULL。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 查询工资为<span class="keyword">NULL</span>的员工</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> salary <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line"># 查询工资不为<span class="keyword">NULL</span>的员工</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> salary <span class="keyword">IS</span> <span class="keyword">NOT NULL</span>;</span><br></pre></td></tr></table></figure><p><code>EXISTS</code>操作符用于检查子查询是否返回任何行。如果子查询返回至少一行，则<code>EXISTS</code>条件为<code>TRUE</code>。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column1,column2 <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> <span class="keyword">EXISTS</span> (<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">FROM</span> another_table <span class="keyword">WHERE</span> <span class="keyword">condition</span>);</span><br><span class="line"></span><br><span class="line"># 查询所有工资不低于表中其他员工工资的员工</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> user_profile el <span class="keyword">WHERE</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">FROM</span> user_profile e2</span><br><span class="line">    <span class="keyword">WHERE</span> e2.device_id <span class="operator">&gt;</span>e1.device_id</span><br><span class="line">);</span><br><span class="line"># 对于每个e1，子查询查找是否存在工资比e1更高的员工(e2.salary<span class="operator">&gt;</span>e1.salary)</span><br><span class="line"># 如果不存在，说明e1的工资是最高的</span><br></pre></td></tr></table></figure><p><code>ALL</code>和<code>ANY</code>操作符用于比较一个值与子查询返回的值集，<code>ALL</code>：与子查询返回的所有值进行比较，<code>ANY</code>：与子查询返回的任意一个值进行比较。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column1,column2 <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> column1<span class="operator">&gt;</span><span class="keyword">ALL</span>(<span class="keyword">SELECT</span> column1 <span class="keyword">FROM</span> another_table <span class="keyword">WHERE</span> <span class="keyword">condition</span>);</span><br><span class="line"></span><br><span class="line"># 查询工资高于所有部门平均工资的员工</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees e <span class="keyword">WHERE</span> salary <span class="operator">&gt;</span> <span class="keyword">ALL</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary)</span><br><span class="line">    <span class="keyword">FROM</span> employees</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h3><h4 id="常见的正则表达式"><a href="#常见的正则表达式" class="headerlink" title="常见的正则表达式"></a>常见的正则表达式</h4><h5 id="字符类"><a href="#字符类" class="headerlink" title="字符类"></a>字符类</h5><p>字符类用于匹配特定的字符集集合</p><ul><li><code>.</code>：匹配任何单个字符(除换行符外):<code>a.b</code>匹配<code>a</code>后面跟着任何字符，再跟着<code>b</code>,如<code>a1b</code>,<code>a-b</code></li><li><code>[abc]</code>:匹配方括号内的任意一个字符：<code>[abc]</code>匹配<code>a</code>、<code>b</code>或<code>c</code></li><li><code>[^abc]</code>:匹配不在方括号内的任意一个字符：<code>[^abc]</code>匹配除<code>a</code>、<code>b</code>和<code>c</code>之外的任何字符</li><li><code>[a-z]</code>:匹配指定范围内的任意一个字符：<code>[a-z]</code>匹配任何小写字母</li><li><code>[A-Z]</code>:匹配任何大写字母</li><li><code>[0-9]</code>:匹配任何数字</li></ul><h5 id="预定义字符类"><a href="#预定义字符类" class="headerlink" title="预定义字符类"></a>预定义字符类</h5><p>预定义字符类是一些常用的字符类的简写形式</p><ul><li><code>\d</code>:匹配任何数字，等价于<code>[0-9]</code>:<code>\d</code>匹配任何单个数字</li><li><code>\D</code>匹配任何非数字字符，等价于<code>[^0-9]</code>:匹配任何非数字字符</li><li><code>\s</code>:匹配任何空白字符，包括空格、制表符、换行符等。<code>\s</code> 匹配任何空白字符。</li><li><code>\S</code>：匹配任何非空白字符。<code>\S</code> 匹配任何非空白字符。</li><li><code>\w</code>：匹配任何字母数字字符，等价于 [a-zA-Z0-9_]。<code>\w</code> 匹配任何字母数字字符或下划线。</li><li><code>\W</code>：匹配任何非字母数字字符。<code>\W</code> 匹配任何非字母数字字符。</li></ul><h5 id="边界匹配"><a href="#边界匹配" class="headerlink" title="边界匹配"></a>边界匹配</h5><p>边界匹配用于匹配字符串的开始或结束位置。</p><ul><li><code>^</code>：匹配字符串的开始位置。<code>^abc</code> 匹配以 <code>abc </code>开头的字符串。</li><li><code>$</code>：匹配字符串的结束位置。<code>abc$</code> 匹配以 <code>abc</code> 结尾的字符串。</li><li><code>\b</code>：匹配单词边界。<code>\bword\b</code> 匹配完整的单词 <code>word</code>，而不是 <code>word</code> 的子字符串。</li></ul><h5 id="量词"><a href="#量词" class="headerlink" title="量词"></a>量词</h5><p>量词用于指定前面的字符或字符类可以出现的次数。</p><ul><li><code>*</code>：匹配前面的字符或字符类 0 次或多次。<code>a*</code> 匹配 0 个或多个 <code>a</code>，如 <code>a</code>、<code>aa</code>、<code>aaa</code> 或空字符串。</li><li><code>+</code>：匹配前面的字符或字符类 1 次或多次。<code>a+</code> 匹配 1 个或多个 <code>a</code>，如 <code>a</code>、<code>aa</code>、<code>aaa</code>，但不匹配空字符串。</li><li><code>?</code>：匹配前面的字符或字符类 0 次或 1 次。<code>a?</code> 匹配 0 个或 1 个 <code>a</code>，如 <code>a</code> 或空字符串。</li><li><code>&#123;n&#125;</code>：匹配前面的字符或字符类恰好 <code>n </code>次。<code>a&#123;3&#125;</code> 匹配恰好 3 个 <code>a</code>，如 <code>aaa</code>。</li><li><code>&#123;n,&#125;</code>：匹配前面的字符或字符类至少 n 次。<code>a&#123;3,&#125;</code> 匹配 3 个或更多 <code>a</code>，如 <code>aaa</code>、<code>aaaa</code>。</li><li><code>&#123;n,m&#125;</code>：匹配前面的字符或字符类至少 <code>n</code> 次，但不超过 <code>m</code> 次。<code>a&#123;2,4&#125;</code> 匹配 2 到 4 个 <code>a</code>，如 <code>aa</code>、<code>aaa</code>、<code>aaaa</code>。</li></ul><h5 id="分组和捕获"><a href="#分组和捕获" class="headerlink" title="分组和捕获"></a>分组和捕获</h5><p>分组和捕获用于将正则表达式的一部分分组，并捕获匹配的内容。</p><ul><li><code>()</code>：分组和捕获。<code>(abc)</code> 匹配 <code>abc</code>，并捕获匹配的内容。</li><li><code>(?:...)</code>：非捕获分组。<code>(?:abc)</code> 匹配 <code>abc</code>，但不捕获匹配的内容。</li></ul><h5 id="选择"><a href="#选择" class="headerlink" title="选择"></a>选择</h5><p>选择用于匹配多个模式中的一个。</p><ul><li><code>|</code>：选择。<code>abc|def</code> 匹配 <code>abc</code> 或 <code>def</code>。</li></ul><h5 id="贪婪和非贪婪"><a href="#贪婪和非贪婪" class="headerlink" title="贪婪和非贪婪"></a>贪婪和非贪婪</h5><p>量词的贪婪和非贪婪模式决定了匹配的长度。</p><ul><li>贪婪模式：默认情况下，量词是贪婪的，尽可能多地匹配字符。a+ 匹配尽可能多的 a。</li><li>非贪婪模式：在量词后加 ?，使其变为非贪婪模式，尽可能少地匹配字符。a+? 匹配尽可能少的 a。</li></ul><h5 id="断言"><a href="#断言" class="headerlink" title="断言"></a>断言</h5><p>断言用于指定匹配的条件，但不消耗字符。</p><ul><li>前瞻断言：<ul><li>正前瞻：<code>(?=...)</code>，匹配后面跟着指定模式的字符。<code>abc(?=def)</code> 匹配 <code>abc</code>，但只有在其后面跟着 <code>def</code> 时才匹配。</li><li>负前瞻：<code>(?!...)</code>，匹配后面不跟着指定模式的字符。<code>abc(?!def)</code> 匹配 <code>abc</code>，但只有在其后面不跟着 <code>def</code> 时才匹配。</li></ul></li><li>后顾断言：<ul><li>正后顾：<code>(?&lt;=...)</code>，匹配前面跟着指定模式的字符。<code>(?&lt;=abc)def</code> 匹配 <code>def</code>，但只有在其前面跟着 abc 时才匹配。</li><li>负后顾：<code>(?&lt;!...)</code>，匹配前面不跟着指定模式的字符。<code>(?&lt;!abc)def</code> 匹配 <code>def</code>，但只有在其前面不跟着 <code>abc</code> 时才匹配。</li></ul></li></ul><h4 id="使用语法"><a href="#使用语法" class="headerlink" title="使用语法"></a>使用语法</h4><p>在Mysql中，可以使用<code>REGEXP</code>或<code>RLIKE</code>操作符来使用正则表达式</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># REGEXP</span><br><span class="line"><span class="keyword">SELECT</span> column1,column2 <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> column1 REGEXP <span class="string">&#x27;pattern&#x27;</span>;</span><br><span class="line"></span><br><span class="line"># RLIKE</span><br><span class="line"><span class="keyword">SELECT</span> column1,column2 <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> column_name RLIKE <span class="string">&#x27;pattern&#x27;</span>;</span><br></pre></td></tr></table></figure><h4 id="使用LIKE和正则表达式的区别"><a href="#使用LIKE和正则表达式的区别" class="headerlink" title="使用LIKE和正则表达式的区别"></a>使用<code>LIKE</code>和正则表达式的区别</h4><ul><li><code>LIKE</code>操作符：<ul><li>适用于简单的匹配模式，支持<code>%</code>和<code>_</code>两个通配符</li><li>性能较好，适用于大多数简单的文本匹配需求</li></ul></li><li>正则表达式<ul><li>适用于复杂的模式匹配，支持更广泛的模式匹配功能</li><li>性能可能稍差，但在处理复杂模式时非常强大</li></ul></li></ul><h2 id="高级查询"><a href="#高级查询" class="headerlink" title="高级查询"></a>高级查询</h2><h3 id="计算函数"><a href="#计算函数" class="headerlink" title="计算函数"></a>计算函数</h3><h3 id="分组查询"><a href="#分组查询" class="headerlink" title="分组查询"></a>分组查询</h3><h2 id="多表查询"><a href="#多表查询" class="headerlink" title="多表查询"></a>多表查询</h2><h3 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h3><h3 id="链接查询"><a href="#链接查询" class="headerlink" title="链接查询"></a>链接查询</h3><h3 id="组合查询"><a href="#组合查询" class="headerlink" title="组合查询"></a>组合查询</h3><h2 id="必会的常用函数"><a href="#必会的常用函数" class="headerlink" title="必会的常用函数"></a>必会的常用函数</h2><h3 id="条件函数"><a href="#条件函数" class="headerlink" title="条件函数"></a>条件函数</h3><h3 id="日期函数"><a href="#日期函数" class="headerlink" title="日期函数"></a>日期函数</h3><h3 id="文本函数"><a href="#文本函数" class="headerlink" title="文本函数"></a>文本函数</h3><h3 id="窗口函数"><a href="#窗口函数" class="headerlink" title="窗口函数"></a>窗口函数</h3><h3 id="聚合函数与窗口函数的结合使用"><a href="#聚合函数与窗口函数的结合使用" class="headerlink" title="聚合函数与窗口函数的结合使用"></a>聚合函数与窗口函数的结合使用</h3><h3 id="数学函数"><a href="#数学函数" class="headerlink" title="数学函数"></a>数学函数</h3>]]></content>
      
      
      <categories>
          
          <category> SQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>心跳检测</title>
      <link href="/JasmineRain.github.io/2025/11/16/%E5%BF%83%E8%B7%B3%E6%A3%80%E6%B5%8B/"/>
      <url>/JasmineRain.github.io/2025/11/16/%E5%BF%83%E8%B7%B3%E6%A3%80%E6%B5%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p><strong>心跳检测</strong>(Heartbeat)就是客户端定期给服务器发一个“我还活着”的小包（通常无业务意义）。</p><p>目的：检测客户端是否掉线;保持 NAT &#x2F; 防火墙映射不过期（重要）;让服务端维护在线状态、回收资源</p><h2 id="心跳检测的模式"><a href="#心跳检测的模式" class="headerlink" title="心跳检测的模式"></a>心跳检测的模式</h2><h3 id="模式A：客户端主动发送-→-服务端被动检测（常用）"><a href="#模式A：客户端主动发送-→-服务端被动检测（常用）" class="headerlink" title="模式A：客户端主动发送 → 服务端被动检测（常用）"></a>模式A：客户端主动发送 → 服务端被动检测（常用）</h3><p>客户端每隔 N 秒 发送一个 ping<br>服务端收到后更新“最后活跃时间 last_active”</p><blockquote><p>优点：简单稳定<br>缺点：服务器压力稍大（要记录时间）</p></blockquote><h3 id="模式-B：服务端主动发-→-客户端回-pong（WebSocket-常用）"><a href="#模式-B：服务端主动发-→-客户端回-pong（WebSocket-常用）" class="headerlink" title="模式 B：服务端主动发 → 客户端回 pong（WebSocket 常用）"></a>模式 B：服务端主动发 → 客户端回 pong（WebSocket 常用）</h3><p>Server: ping<br>Client: pong（自动回复）</p><blockquote><p>优点：服务端主动性强，适合 WebSocket<br>缺点：需要维护 ping loop</p></blockquote><h2 id="心跳机制的核心思想"><a href="#心跳机制的核心思想" class="headerlink" title="心跳机制的核心思想"></a>心跳机制的核心思想</h2><p>服务器维护每个连接的两个字段：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">conn.last_active   <span class="comment">// 最近一次接收消息或心跳的时间戳</span></span><br><span class="line">conn.timeout       <span class="comment">// 超时时间，例如 60s</span></span><br></pre></td></tr></table></figure><p>每隔一段时间（例如 10 秒），服务器进行一次检查：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> now - conn.last_active &gt; <span class="built_in">timeout</span>:</span><br><span class="line">    close(conn)</span><br></pre></td></tr></table></figure><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><h3 id="心跳不能太短-会炸服务器"><a href="#心跳不能太短-会炸服务器" class="headerlink" title="心跳不能太短(会炸服务器)"></a>心跳不能太短(会炸服务器)</h3><p>推荐值：WebSocket：20～40s；移动网络：30～60s；IoT：60～300s</p><p>太短会导致：CPU 天量 syscalls；网络风暴；电量快速下降（手机）</p><h3 id="NAT超时问题-非常关键"><a href="#NAT超时问题-非常关键" class="headerlink" title="NAT超时问题(非常关键)"></a>NAT超时问题(非常关键)</h3><p>移动网络&#x2F;路由器会在几分钟后关掉一个空闲 TCP，所以心跳保持连接是必须的。</p><h3 id="和业务包一起更新-last-active"><a href="#和业务包一起更新-last-active" class="headerlink" title="和业务包一起更新 last_active"></a>和业务包一起更新 last_active</h3><p>不是只有心跳才能更新活跃时间！</p><h3 id="心跳包必须轻量（不要带大数据）"><a href="#心跳包必须轻量（不要带大数据）" class="headerlink" title="心跳包必须轻量（不要带大数据）"></a>心跳包必须轻量（不要带大数据）</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">PING</span></span><br><span class="line">PONG</span><br><span class="line">&#123;&#125;</span><br></pre></td></tr></table></figure><h2 id="高性能时间轮"><a href="#高性能时间轮" class="headerlink" title="高性能时间轮"></a>高性能时间轮</h2><p>处理百万连接时，不能对每个连接每秒循环检查。</p><p>解决方案：<br>使用时间轮（Time Wheel） O(1) 复杂度<br>Netty、ClickHouse、Kafka 都在用。</p><p>作用：每个连接插入到对应的时间槽；每秒只检查当前槽位的连接；不用遍历全部连接</p>]]></content>
      
      
      
        <tags>
            
            <tag> 心跳检测 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TCP的三次握手和四次挥手</title>
      <link href="/JasmineRain.github.io/2025/11/16/TCP%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B/"/>
      <url>/JasmineRain.github.io/2025/11/16/TCP%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="TCP三次握手（建立连接）"><a href="#TCP三次握手（建立连接）" class="headerlink" title="TCP三次握手（建立连接）"></a>TCP三次握手（建立连接）</h2><p>TCP是面向连接的，需要通过三次握手建立可靠连接</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">客户端（Client）                       服务端（<span class="keyword">Server</span>）</span><br><span class="line">     | <span class="comment">------ SYN = 1, seq = x ------&gt; |</span></span><br><span class="line">     | &lt;<span class="comment">--- SYN = 1, ACK = 1, y,x+1 ---|</span></span><br><span class="line">     | <span class="comment">------ ACK = 1, ack = y+1 -----&gt; |</span></span><br><span class="line">连接建立</span><br></pre></td></tr></table></figure><h3 id="第一次：Client-Server：SYN-1"><a href="#第一次：Client-Server：SYN-1" class="headerlink" title="第一次：Client-&gt;Server：SYN&#x3D;1"></a>第一次：Client-&gt;Server：SYN&#x3D;1</h3><p>客户端发送一个SYN包(同步序列号)，告诉服务器：我要发起连接，并带上初始序列号seq&#x3D;x</p><p>让服务器知道客户端想建立连接</p><h3 id="第二次：Server-client：SYN-1，ACK-1"><a href="#第二次：Server-client：SYN-1，ACK-1" class="headerlink" title="第二次：Server-&gt;client：SYN&#x3D;1，ACK&#x3D;1"></a>第二次：Server-&gt;client：SYN&#x3D;1，ACK&#x3D;1</h3><p>服务器收到SYN后，发送SYN+ACK<br>ACK&#x3D;1表示：我收到了你的SYN，确认号ack&#x3D;x+1<br>SYN&#x3D;1表示：我也准备好了建立连接，序列号seq&#x3D;y</p><p>服务器同意连接<br>服务器也要同步序列号(SYN)</p><h3 id="第三次：Client-Server-ACK-1"><a href="#第三次：Client-Server-ACK-1" class="headerlink" title="第三次：Client-&gt;Server:ACK&#x3D;1"></a>第三次：Client-&gt;Server:ACK&#x3D;1</h3><p>客户端收到SYN+ACK后返回ACK：<br>ack&#x3D;y+1，表示收到服务端的SYN<br>双方建立连接</p><p>客户端最终确认<br>连接正式建立，可以传输数据</p><h2 id="为什么是三次？"><a href="#为什么是三次？" class="headerlink" title="为什么是三次？"></a>为什么是三次？</h2><p>因为需要 双向确认双方序列号都正常<br>第一次：客户端 → 服务器（客户端序列号）<br>第二次：服务器 → 客户端（服务器序列号 + 确认客户端）<br>第三次：客户端 → 服务器（确认服务器）</p><p>三次握手的目的，是双方都确认彼此的接收能力和发送能力以及初始序列号，保证可靠通信。</p><h2 id="TCP四次挥手（断开连接）"><a href="#TCP四次挥手（断开连接）" class="headerlink" title="TCP四次挥手（断开连接）"></a>TCP四次挥手（断开连接）</h2><p>关闭连接需要 四次挥手，因为 TCP 是全双工，必须分别关闭两个方向的通道。</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">客户端（Client）                       服务端（<span class="keyword">Server</span>）</span><br><span class="line">     | <span class="comment">------ FIN = 1, seq = u ------&gt; |</span></span><br><span class="line">     | &lt;<span class="comment">--------- ACK = 1, u+1 ------- |</span></span><br><span class="line">     | &lt;<span class="comment">------ FIN = 1, seq = v ------ |</span></span><br><span class="line">     | <span class="comment">------- ACK = 1, v+1 ---------&gt; |</span></span><br><span class="line">连接断开</span><br></pre></td></tr></table></figure><h3 id="第一次挥手：Client-Server-FIN"><a href="#第一次挥手：Client-Server-FIN" class="headerlink" title="第一次挥手：Client-&gt;Server:FIN"></a>第一次挥手：Client-&gt;Server:FIN</h3><p>客户端说：我想关闭客户端-&gt;服务端的数据通道(我不发数据了)</p><h3 id="第二次挥手：Server-Client-ACK"><a href="#第二次挥手：Server-Client-ACK" class="headerlink" title="第二次挥手：Server-&gt;Client:ACK"></a>第二次挥手：Server-&gt;Client:ACK</h3><p>服务器回复ACK：我收到了，但我还可能要发数据给你</p><p>此时状态为：Client：FIN-WAIT-2;Server:CLOSE-WAIT(服务器还在处理剩余数据)</p><h3 id="第三次挥手：Server-Client-FIN"><a href="#第三次挥手：Server-Client-FIN" class="headerlink" title="第三次挥手：Server-&gt;Client:FIN"></a>第三次挥手：Server-&gt;Client:FIN</h3><p>服务器处理完数据后发送FIN<br>告诉客户端：我也发完了，可以关闭了</p><h3 id="第四次挥手：Client-Server-ACK"><a href="#第四次挥手：Client-Server-ACK" class="headerlink" title="第四次挥手：Client-&gt;Server:ACK"></a>第四次挥手：Client-&gt;Server:ACK</h3><p>客户端确认服务器的FIN<br>此时：客户端进入TIME_WAIT(等待2MSL)，服务器进入CLOSE</p><h2 id="为什么要等待2MSL（TIME-WAIT）"><a href="#为什么要等待2MSL（TIME-WAIT）" class="headerlink" title="为什么要等待2MSL（TIME_WAIT）?"></a>为什么要等待2MSL（TIME_WAIT）?</h2><p>因为需要保证：</p><ol><li><strong>确保 ACK 能让服务端收到</strong>:如果服务端没收到 ACK，会重发 FIN;如果客户端还在，能重新 ACK</li><li><strong>让本次连接所有旧报文在网络中消失</strong>:避免下一次连接收到旧包造成混乱</li></ol><p>四次挥手是因为 TCP 是全双工模式，双方都必须独立发送 FIN 来关闭通信方向。TIME_WAIT 是为了保证可靠关闭，防止旧报文影响后续连接。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>三次握手：SYN-&gt;SYN+ACK-&gt;ACK<br>四次挥手:FIN-&gt;ACK-&gt;FIN-&gt;ACK</p>]]></content>
      
      
      <categories>
          
          <category> 计算机网络 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 计网 </tag>
            
            <tag> TCP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LRU页面置换算法</title>
      <link href="/JasmineRain.github.io/2025/11/14/LRU%E9%A1%B5%E9%9D%A2%E7%BD%AE%E6%8D%A2%E7%AE%97%E6%B3%95/"/>
      <url>/JasmineRain.github.io/2025/11/14/LRU%E9%A1%B5%E9%9D%A2%E7%BD%AE%E6%8D%A2%E7%AE%97%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>LRU（最近最少使用）算法就是：<strong>每次需要淘汰页面时，选那个“最长时间没被访问”的页面换出去</strong>。</p><p>它是一种典型的<strong>缓存置换算法</strong>，用来决定内存不够时应该把哪一页踢掉。</p><p>LRU 的核心思想：过去访问行为预测未来访问行为。</p><h2 id="举例"><a href="#举例" class="headerlink" title="举例"></a>举例</h2><p>设有 3 个物理块，访问序列：<br>1, 2, 3, 2, 4, 1, 2</p><p>我们模拟 LRU：</p><table><thead><tr><th>步骤</th><th>访问</th><th>内存状态</th><th>淘汰</th></tr></thead><tbody><tr><td>1</td><td>1</td><td>1</td><td>-</td></tr><tr><td>2</td><td>2</td><td>1 2</td><td>-</td></tr><tr><td>3</td><td>3</td><td>1 2 3</td><td>-</td></tr><tr><td>4</td><td>2</td><td>1 3 2</td><td>2刚被访问，放到最新</td></tr><tr><td>5</td><td>4</td><td>3 2 4</td><td>淘汰1，最久没用</td></tr><tr><td>6</td><td>1</td><td>2 4 1</td><td>淘汰3</td></tr><tr><td>7</td><td>2</td><td>4 1 2</td><td>-</td></tr></tbody></table><p>思想：每次访问都把页面放到“最新”位置。淘汰最久没用的。</p><h2 id="实现LRU"><a href="#实现LRU" class="headerlink" title="实现LRU"></a>实现LRU</h2><ol><li>链表（或双端队列）实现:</li></ol><blockquote><p>最新访问的页放队尾<br>最久未访问的页放队头<br>缺页时：淘汰队头<br>每次命中：把该页移动到队尾</p></blockquote><p>缺点：需要频繁移动节点，时间 O(1)，但真实硬件上开销仍然不小。</p><ol start="2"><li>硬件支持的“访问位 + 时钟”近似 LRU:</li></ol><p>因为真正 LRU 实现太重，所以 CPU 给每个页表项提供：</p><blockquote><p>Referenced bit（访问位，R bit）<br>Dirty bit（修改位）</p></blockquote><p>系统周期性：</p><blockquote><p>将所有页的访问位复制到一个计数器中<br>得到一个“老化值”（aging）</p></blockquote><p>更像是“用计数器模拟访问时间先后”。</p>]]></content>
      
      
      <categories>
          
          <category> 操作系统 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LRU </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>健全性测试</title>
      <link href="/JasmineRain.github.io/2025/11/11/%E5%81%A5%E5%85%A8%E6%80%A7%E6%B5%8B%E8%AF%95/"/>
      <url>/JasmineRain.github.io/2025/11/11/%E5%81%A5%E5%85%A8%E6%80%A7%E6%B5%8B%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>“健全性测试”（Sanity Testing）是一种软件测试类型，属于回归测试（Regression Testing）的子集，用于在对软件做出小范围修改或修复缺陷后，快速验证关键功能是否仍能正常工作。</p><p>健全性测试是指在软件新版本发布或修改后，检查关键模块是否“健全”（即是否仍然可用、逻辑未被破坏）。</p><p>其核心思想是：“不用全面测，只测关键改动相关的核心功能，确认系统基本可用。”</p><h2 id="目的"><a href="#目的" class="headerlink" title="目的"></a>目的</h2><ol><li><p>验证 bug 修复是否成功；</p></li><li><p>验证修改是否未引入新的严重问题；</p></li><li><p>决定是否需要进行更全面的回归测试。</p></li></ol><h2 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h2><table><thead><tr><th>项目</th><th>内容</th></tr></thead><tbody><tr><td>测试范围</td><td>小，主要针对改动处或相关功能</td></tr><tr><td>执行时间</td><td>短，几分钟到几小时</td></tr><tr><td>测试深度</td><td>浅，不做全面验证</td></tr><tr><td>触发时机</td><td>修复缺陷或版本轻微更新后</td></tr><tr><td>执行者</td><td>通常由测试人员或开发人员快速执行</td></tr></tbody></table><h2 id="与其他测试的对比"><a href="#与其他测试的对比" class="headerlink" title="与其他测试的对比"></a>与其他测试的对比</h2><table><thead><tr><th>类型</th><th>目标</th><th>范围</th><th>时间</th></tr></thead><tbody><tr><td>冒烟测试（Smoke Testing）</td><td>确认系统是否能启动、主要功能是否可运行</td><td>宽但浅</td><td>每次构建后</td></tr><tr><td>健全性测试（Sanity Testing）</td><td>验证修复或小改动是否未破坏核心逻辑</td><td>窄但针对性强</td><td>修复或补丁后</td></tr><tr><td>回归测试（Regression Testing）</td><td>验证修改是否影响整个系统</td><td>广泛</td><td>每次更新后</td></tr></tbody></table><blockquote><p>如果你修了一个登录 bug，健全性测试就只验证“登录是否可用、注册和退出是否受影响”；不会去测购物车、支付、搜索等其他模块。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 健全性测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>冒烟测试</title>
      <link href="/JasmineRain.github.io/2025/11/11/%E5%86%92%E7%83%9F%E6%B5%8B%E8%AF%95/"/>
      <url>/JasmineRain.github.io/2025/11/11/%E5%86%92%E7%83%9F%E6%B5%8B%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>冒烟测试是一种常见的初步测试方式。</p><p>冒烟测试(Smoke Testing)是指在新版本软件构建完成后，对系统的<strong>主要功能进行快速验证</strong>，以确认系统是否能“正常启动”和“基本可用”。</p><p>(就像点燃一台新机器，看它会不会冒烟。若一开机就冒烟（崩溃&#x2F;无法运行），那后续的详细测试就没必要做了。)</p><h2 id="目的"><a href="#目的" class="headerlink" title="目的"></a>目的</h2><p>验证软件的基本功能是否可运行；</p><p>判断新版本是否稳定到可以进入系统测试阶段；</p><p>快速发现严重问题（如系统无法启动、核心功能失效）。</p><h2 id="实施"><a href="#实施" class="headerlink" title="实施"></a>实施</h2><p>冒烟测试通常在：</p><pre><code>1.每次代码集成/构建之后；2.回归测试前；3.版本发布前；    由开发或测试工程师执行。</code></pre><h2 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h2><table><thead><tr><th>特点</th><th>说明</th></tr></thead><tbody><tr><td>测试范围</td><td>小（核心功能）</td></tr><tr><td>测试深度</td><td>浅（只验证能否用）</td></tr><tr><td>执行频率</td><td>高（每次构建后）</td></tr><tr><td>目的</td><td>快速判断系统是否可测</td></tr><tr><td>责任人</td><td>通常由开发或测试人员执行</td></tr></tbody></table><blockquote><p>冒烟测试是上线前的体检；回归测试是修复后的复查。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 冒烟测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mock对象</title>
      <link href="/JasmineRain.github.io/2025/11/07/Mock%E5%AF%B9%E8%B1%A1/"/>
      <url>/JasmineRain.github.io/2025/11/07/Mock%E5%AF%B9%E8%B1%A1/</url>
      
        <content type="html"><![CDATA[<p>Mock 对象（模拟对象） 是在单元测试中用于模拟真实依赖对象行为的一种测试技术。</p><p>在编写单元测试时，一个类往往依赖其他组件（如数据库、网络请求、外部接口等）。</p><p>这些外部依赖难以控制、耗时、或在测试阶段尚未实现。</p><p>这时我们就用 Mock 对象来替代真实依赖，用虚拟对象“假装”执行并返回期望结果。</p><h2 id="为何使用Mock对象"><a href="#为何使用Mock对象" class="headerlink" title="为何使用Mock对象"></a>为何使用Mock对象</h2><ul><li>依赖未实现（接口、模块还没写好）——使用 Mock 模拟接口返回</li><li>调用外部服务成本高（如数据库、API）——用 Mock 模拟返回值而不真实连接</li><li>测试目标类与外部系统强耦合——用 Mock 隔离依赖，专注测试目标逻辑</li><li>难以触发某些异常场景——Mock 可轻松模拟错误返回、异常抛出</li></ul><p>目的：<strong>让单元测试只测试目标类逻辑，不依赖外部环境。</strong></p><h2 id="Mock框架常用工具"><a href="#Mock框架常用工具" class="headerlink" title="Mock框架常用工具"></a>Mock框架常用工具</h2><p>Mockito:简单易用、支持链式调用、广泛兼容 JUnit。常用Mockito+JUnit5.</p><p>EasyMock</p><p>PowerMock：可 Mock 静态方法、final 类、私有方法（配合 Mockito 使用）</p>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Mock对象 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JUnit</title>
      <link href="/JasmineRain.github.io/2025/11/07/JUnit/"/>
      <url>/JasmineRain.github.io/2025/11/07/JUnit/</url>
      
        <content type="html"><![CDATA[<p>JUnit是java语言中最常用的单元测试框架。</p><p>它用于自动化测试Java代码的逻辑正确性，可以快速定位程序错误，提高开发效率。</p><p>JUnit目前最常用的版本有：</p><ul><li>JUnit4：经典版本（基于注解）；</li><li>JUnit5（Jupiter）：最新框架，模块化设计，更强大的扩展能力。</li></ul><h2 id="JUnit的主要作用"><a href="#JUnit的主要作用" class="headerlink" title="JUnit的主要作用"></a>JUnit的主要作用</h2><ul><li>验证程序功能是否正确：自动执行测试方法，检查输出是否符合预期。</li><li>避免回归错误：当代码修改后，可通过测试快速发现是否破坏了原有功能。</li><li>促进模块化开发：鼓励“先写测试，再写实现”</li><li>提高开发与维护效率：自动化执行所有测试，提高系统稳定性。</li></ul>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JUnit </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>突变测试</title>
      <link href="/JasmineRain.github.io/2025/11/05/%E7%AA%81%E5%8F%98%E6%B5%8B%E8%AF%95/"/>
      <url>/JasmineRain.github.io/2025/11/05/%E7%AA%81%E5%8F%98%E6%B5%8B%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<p>突变测试（Mutation Testing）是一种软件测试评估技术，用于检验测试用例的有效性和质量。</p><p>它通过对程序源代码进行微小的修改（突变），生成一些称为“突变体（Mutants）”的新程序，然后运行原有的测试用例集，看是否能检测到这些突变。</p><h3 id="核心思想"><a href="#核心思想" class="headerlink" title="核心思想"></a>核心思想</h3><p>突变测试的基本假设是：<br>1.程序中存在的小的错误可能导致行为改变；<br>2.有效的测试应该能检测到这些错误。<br>如果测试用例不能区分原程序和突变程序（即测试都通过），说明测试集可能不够好。</p><h3 id="基本过程"><a href="#基本过程" class="headerlink" title="基本过程"></a>基本过程</h3><h4 id="生成突变体"><a href="#生成突变体" class="headerlink" title="生成突变体"></a>生成突变体</h4><p>在原始代码中，引入一个微小的语法变化（例如修改运算符、常量、条件表达式等），生成新的版本称为突变体。</p><h4 id="执行测试集"><a href="#执行测试集" class="headerlink" title="执行测试集"></a>执行测试集</h4><p>使用原有的测试用例对每个突变体进行测试。</p><h4 id="判断结果"><a href="#判断结果" class="headerlink" title="判断结果"></a>判断结果</h4><p>对每个测试体有三种情况：</p><ul><li>杀死：测试用例检测到行为不同，说明测试有效</li><li>幸存：测试未检测出差异，说明测试集不足</li><li>等价突变：逻辑改变但结果始终相同，不可检测（需人工分析）</li></ul><h4 id="计算突变得分"><a href="#计算突变得分" class="headerlink" title="计算突变得分"></a>计算突变得分</h4><p>衡量测试集质量的指标：</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>M</mi><mi>u</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>S</mi><mi>c</mi><mi>o</mi><mi>r</mi><mi>e</mi><mo>=</mo><mfrac><mtext>被杀死的突变体数量</mtext><mrow><mtext>总突变体数量</mtext><mo>−</mo><mtext>等价突变体数量</mtext></mrow></mfrac><mo>∗</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">Mutation Score=\frac{被杀死的突变体数量}{总突变体数量-等价突变体数量}*100%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">core</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1297em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">总突变体数量</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord cjk_fallback">等价突变体数量</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">被杀死的突变体数量</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">100</span></span></span></span></span><h3 id="突变测试优点"><a href="#突变测试优点" class="headerlink" title="突变测试优点"></a>突变测试优点</h3><p>可量化测试质量</p><p>提高测试集的有效性</p><p>较覆盖率更精细</p><h3 id="突变测试缺点"><a href="#突变测试缺点" class="headerlink" title="突变测试缺点"></a>突变测试缺点</h3><p>计算成本高</p><p>需要自动化工具</p><p>存在等价突变体问题</p>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 突变测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SQL中属于分组查询的语句</title>
      <link href="/JasmineRain.github.io/2025/11/05/SQL%E4%B8%AD%E5%B1%9E%E4%BA%8E%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2%E7%9A%84%E8%AF%AD%E5%8F%A5/"/>
      <url>/JasmineRain.github.io/2025/11/05/SQL%E4%B8%AD%E5%B1%9E%E4%BA%8E%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2%E7%9A%84%E8%AF%AD%E5%8F%A5/</url>
      
        <content type="html"><![CDATA[<h2 id="ans"><a href="#ans" class="headerlink" title="ans"></a>ans</h2><p>在SQL中，属于分组查询的语句是<code>GROUP BY</code></p><p><code>GROUP BY</code>用于将查询结果按照一个或多个字段进行分组，常与聚合函数（如<code>COUNT()</code>、<code>SUM()</code>、<code>AVG()</code>、<code>MAX()</code>、<code>MIN()</code>）一起使用，用来对每个分组进行统计计算</p><h2 id="语法格式"><a href="#语法格式" class="headerlink" title="语法格式"></a>语法格式</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 列名，聚合函数(列名)</span><br><span class="line"><span class="keyword">FROM</span> 表名</span><br><span class="line"><span class="keyword">WHERE</span> 条件</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> 列名；</span><br></pre></td></tr></table></figure><h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><p>假设有一个表sales:</p><table><thead><tr><th>id</th><th>salesman</th><th>amount</th></tr></thead><tbody><tr><td>1</td><td>Alice</td><td>1000</td></tr><tr><td>2</td><td>Bob</td><td>1500</td></tr><tr><td>3</td><td>Alice</td><td>2000</td></tr><tr><td>4</td><td>Divid</td><td>1200</td></tr></tbody></table><p>查询每个销售员的总销量：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> salesman,<span class="built_in">SUM</span>(amount) <span class="keyword">AS</span> total_sales</span><br><span class="line"><span class="keyword">FROM</span> sales</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> salesman</span><br></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th>salesman</th><th>total_sales</th></tr></thead><tbody><tr><td>Alice</td><td>3000</td></tr><tr><td>Bob</td><td>1500</td></tr><tr><td>Divid</td><td>1200</td></tr></tbody></table><h2 id="相关查询"><a href="#相关查询" class="headerlink" title="相关查询"></a>相关查询</h2><ul><li>普通查询：SELECT，查询数据</li><li>条件查询：WHERE，设置筛选条件</li><li>排序查询：ORDER BY，对结果排序</li><li>分组筛选：HAVING，对分组结果再筛选</li></ul>]]></content>
      
      
      <categories>
          
          <category> SQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>白盒测试</title>
      <link href="/JasmineRain.github.io/2025/11/04/%E7%99%BD%E7%9B%92%E6%B5%8B%E8%AF%95/"/>
      <url>/JasmineRain.github.io/2025/11/04/%E7%99%BD%E7%9B%92%E6%B5%8B%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<p>白盒测试，又称结构测试、逻辑驱动测试，是一种基于程序内部逻辑结构进行的测试方法。</p><p>了解程序的源代码、逻辑结构和实现细节，从而通过分析控制流、数据流等来设计测试比例，以验证程序的每个路径、语句和分支是否按预期工作。</p><p>白盒测试核心思想：站在程序内部的角度，检查代码结构的正确性与逻辑的完整性</p><h2 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h2><p>验证程序内部的逻辑是否正确</p><p>发现程序内部潜在的逻辑错误或缺陷</p><p>确保程序的所有语句至少执行一次</p><h2 id="主要技术与类型"><a href="#主要技术与类型" class="headerlink" title="主要技术与类型"></a>主要技术与类型</h2><p>白盒测试的核心在于覆盖率分析。</p><ul><li>语句覆盖：程序中每条可执行语句至少执行一次</li><li>判定覆盖&#x2F;分支覆盖：每个判断的“真&#x2F;假”分支至少执行一次</li><li>条件覆盖：判断中的每个布尔表达式都取到真、假</li><li>判定-条件覆盖：同时满足判定覆盖与条件覆盖</li><li>条件组合覆盖：组合所有条件真&#x2F;假的所有情况</li><li>路径覆盖：程序中所有可能路径至少执行一次</li><li>数据流覆盖：检查变量的定义、使用与失效之间的路径</li></ul><h2 id="测试的常用方法"><a href="#测试的常用方法" class="headerlink" title="测试的常用方法"></a>测试的常用方法</h2><h2 id="控制流测试"><a href="#控制流测试" class="headerlink" title="控制流测试"></a>控制流测试</h2><p>通过分析程序的控制结构（顺序、选择、循环）建立<strong>控制流图（Control Flow Graph, CFG）</strong>，设计测试用例以覆盖所有语句、分支与路径。</p><p>常用技术包括：基本路径测试（Basis Path Testing）、环路测试（Loop Testing）</p><p>控制流图关键元素：节点（表示语句或代码块）、边（表示控制流的转移（执行路径））</p><p>可通过 <strong>圈复杂度（Cyclomatic Complexity）</strong> 计算最少测试路径</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>V</mi><mo stretchy="false">(</mo><mi>G</mi><mo stretchy="false">)</mo><mo>=</mo><mi>E</mi><mo>−</mo><mi>N</mi><mo>+</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">V(G)=E-N+2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mopen">(</span><span class="mord mathnormal">G</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span></span><p>其中，E 为边数，N 为节点数。</p><h2 id="数据流测试"><a href="#数据流测试" class="headerlink" title="数据流测试"></a>数据流测试</h2><p>侧重分析变量的定义（Definition）、引用（Use）和失效（Kill）关系，检查是否存在未定义即使用、定义后未使用等错误。</p><p>常见缺陷类型：使用未定义变量；定义但从未使用；使用后未释放资源；变量作用域混乱。</p><h2 id="循环测试"><a href="#循环测试" class="headerlink" title="循环测试"></a>循环测试</h2><p>专门针对程序中的循环结构进行测试。<br>基本策略包括：零次循环测试（跳过循环）；一次循环测试；多次循环测试（典型次数）；边界循环测试（最大次数或超过一次）。</p><p>例如：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;...&#125;</span><br></pre></td></tr></table></figure><p>测试时应考虑 n&#x3D;0, n&#x3D;1, n&#x3D;2, n&#x3D;边界值等情况。</p><h2 id="基本路径测试"><a href="#基本路径测试" class="headerlink" title="基本路径测试"></a>基本路径测试</h2><p>由 McCabe 提出，是控制流测试的一种。<br>主要步骤：画出程序的控制流图；计算圈复杂度 V(G)；确定独立路径集合；为每条独立路径设计测试用例。</p><p>示例：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (x &gt; <span class="number">0</span>)</span><br><span class="line">   x = x - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   x = x + <span class="number">1</span>;</span><br><span class="line"><span class="built_in">print</span>(x);</span><br></pre></td></tr></table></figure><p>独立路径有两条：</p><ol><li><p>x &gt; 0 的路径；</p></li><li><p>x &lt;&#x3D; 0 的路径。</p></li></ol><p>白盒测试的实施流程：阅读与理解源代码（掌握逻辑结构）-&gt;建立程序控制流图（CFG）-&gt;选择合适的覆盖标准（语句&#x2F;分支&#x2F;路径）-&gt;设计测试用例（输入集）-&gt;执行测试、记录结果-&gt;分析未覆盖的代码部分-&gt;修正缺陷与补充测试</p><h2 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h2><p>能发现隐藏的逻辑错误、未执行代码、死循环等内部缺陷；测试覆盖率高，可度量测试充分性；可评估代码质量、复杂度、可靠性；可与持续集成结合实现自动化测试</p><h2 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h2><p>需要掌握代码实现，成本较高；不适用于大型系统的整体测试；难以检测需求层面的缺陷；当代码变更频繁时维护成本高</p>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 白盒测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>马原期末复习要点</title>
      <link href="/JasmineRain.github.io/2025/11/04/%E9%A9%AC%E5%8E%9F%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0%E8%A6%81%E7%82%B9/"/>
      <url>/JasmineRain.github.io/2025/11/04/%E9%A9%AC%E5%8E%9F%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0%E8%A6%81%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<h2 id="导论"><a href="#导论" class="headerlink" title="导论"></a>导论</h2><h3 id="什么是马克思主义"><a href="#什么是马克思主义" class="headerlink" title="什么是马克思主义"></a>什么是马克思主义</h3><p>马克思主义是由马克思、恩格斯创立并为后继者不断发展的科学理论体系，是关于自然、社会、人类思维发展一般规律的学说，是关于社会主义必然取代资本主义、最终实现共产主义的学说，是关于无产阶级解放、全人类解放和每个人自由而全面发展的学说，是无产阶级政党和社会主义国家的指导思想，是指引人民创造美好生活的行动指南。</p><h3 id="马克思主义的创立与发展"><a href="#马克思主义的创立与发展" class="headerlink" title="马克思主义的创立与发展"></a>马克思主义的创立与发展</h3><p>马克思主义的三大理论来源：德国古典哲学，英国古典政治经济学和空想社会主义</p><h3 id="马克思主义的基本特征"><a href="#马克思主义的基本特征" class="headerlink" title="马克思主义的基本特征"></a>马克思主义的基本特征</h3><p>马克思主义具有鲜明的科学性、人民性、实践性、发展性。</p><h3 id="马克思主义的当代价值"><a href="#马克思主义的当代价值" class="headerlink" title="马克思主义的当代价值"></a>马克思主义的当代价值</h3><p>马克思主义是观察当代世界变化的认识工具，是指引当代中国发展的行动指南，是引领人类社会进步的科学真理。</p><h3 id="自觉学习和运用马克思主义"><a href="#自觉学习和运用马克思主义" class="headerlink" title="自觉学习和运用马克思主义"></a>自觉学习和运用马克思主义</h3><ul><li><p>努力学习和掌握马克思主义的基本立场观点方法</p></li><li><p>努力学习和掌握马克思主义中国化和时代化的理论成果</p></li><li><p>坚持理论联系实际的马克思主义学风</p></li><li><p>自觉将马克思主义内化于心、外化于行</p></li></ul><hr><h2 id="物质世界及发展规律"><a href="#物质世界及发展规律" class="headerlink" title="物质世界及发展规律"></a>物质世界及发展规律</h2><h3 id="世界的多样性和物质统一性"><a href="#世界的多样性和物质统一性" class="headerlink" title="世界的多样性和物质统一性"></a>世界的多样性和物质统一性</h3><p>物质范畴是一切唯物主义哲学的理论基石。马克思主义的物质范畴具有丰富而深刻的理论意义。</p><blockquote><p>1.坚持了唯物主义一元论，同唯心主义一元论和二元论划清了界限<br>2.坚持了能动的反映论和可知论，批判了不可知论<br>3.体现了唯物论和辩证论的统一<br>4.体现了唯物主义自然观与历史观的统一</p></blockquote><p>物质是什么：是不依赖于人的意识而存在，并能为人的意识所反映的<strong>客观实在</strong>。（因此具有<strong>客观实在性</strong>）</p><p>意识是什么：意识是人脑这样一种特殊物质的机能和属性，是客观世界的主观映像。</p><p><strong>物质和运动的关系</strong>：物质的根本属性是运动。物质是运动的物质。<br>运动离不开物质，物质是运动的唯一载体，运动是物质的运动。</p><p><strong>物质与意识的关系</strong>：物质决定意识；意识对物质具有反作用。（原理）<br>要求我们从实际出发，实事求是。同时要注意意识到的能动作用，树立正确的意识。（方法论）</p><p><strong>意识的能动作用</strong>：<br>意识具有目的性和计划性<br>意识具有创造性<br>意识具有指导实践改造客观世界的作用<br>意识具有指导和控制人们的行为和生理活动的作用</p><blockquote><p>意识不等同于人工智能。意识是人类特有的。</p></blockquote><p><strong>主观能动性和客观规律的关系</strong>：<br>尊重客观规律是发挥主观能动性的前提和基础，人只有在尊重客观规律的基础上，才能认识和改造世界。<br>但是，在自然规律面前，人并不是无能为力的，人可以发挥主观能动性，利用客观规律，认识和改造世界。</p><p>方法论：人既要尊重客观规律，又要发挥主观能动性。正确利用规律，认识和改造世界。</p><h3 id="事物的普遍联系和变化发展"><a href="#事物的普遍联系和变化发展" class="headerlink" title="事物的普遍联系和变化发展"></a>事物的普遍联系和变化发展</h3><p>联系和发展的观点是唯物辩证法的总观点，集中体现了唯物辩证法的总特征。</p><p><strong>联系的特点</strong>：联系具有<strong>客观性</strong>；联系具有<strong>普遍性</strong>；联系具有<strong>多样性</strong>；联系具有<strong>条件性</strong>。</p><p><strong>发展</strong>：是事物变化中前进的，上升的运动。实质是新事物的产生和旧事物的灭亡。</p><p><strong>矛盾的同一性和斗争性</strong>：（体现了对立统一规律是事物发展的根本规律）<br>1.矛盾的同一性是指矛盾着的对立面相互依存，相互贯通的性质和趋势。矛盾的斗争性是矛盾着的对立面相互排斥，相互分离的性质和趋势。（先解释何为同一性，斗争性）<br>2.矛盾的同一性和斗争性相互联结，相辅相成。矛盾的同一性是有条件的，相对的，矛盾的斗争性是无条件的，绝对的。（再说二者关系）<br>3.矛盾的同一性和斗争性相结合，构成了事物的矛盾运动，推动着事物的变化发展。（最后作用）</p><p><strong>矛盾的普遍性和特殊性</strong>：<br>1.矛盾无处不在，时时有矛盾，事事有矛盾。（矛盾的普遍性）不同事物有不同的矛盾，同一事物在不同过程和不同阶段有不同的矛盾，同一事物的不同矛盾，同一矛盾的不同方面也各有其特殊性。（矛盾的特殊性）<br>2.矛盾的普遍性和特殊性的关系，也就是矛盾的共性和个性的关系，一般和个别的关系。共性寓于个性之中，没有离开个性的共性，也没有离开共性的个性。矛盾的共性是无条件的，绝对的，矛盾的个性是有条件的，相对的。</p><p><strong>量变与质变</strong>：<br>1.量变是质变的必要条件，质变是量变的必然结果并作为新的量变开辟新道路。<br>2.量变与质变是相互依存，相互贯通的，量变引起质变，在新质的基础上，事物有开始量变，如此循环往复，构成了事物的发展过程。</p><h3 id="唯物辩证法是认识和改造世界的根本方法"><a href="#唯物辩证法是认识和改造世界的根本方法" class="headerlink" title="唯物辩证法是认识和改造世界的根本方法"></a>唯物辩证法是认识和改造世界的根本方法</h3><p><strong>辩证否定观</strong>：<br>1.辩证否定观即自己否定自己，自己发展自己<br>2.实质是扬弃，对新事物的即批判又继承，即否定又肯定，即克服消极因素又保留积极因素。</p><hr><h2 id="实践与认识及其发展规律"><a href="#实践与认识及其发展规律" class="headerlink" title="实践与认识及其发展规律"></a>实践与认识及其发展规律</h2><h3 id="实践与认识"><a href="#实践与认识" class="headerlink" title="实践与认识"></a>实践与认识</h3><p>实践的特征：<strong>客观实在性</strong>、<strong>自觉能动性</strong>、<strong>社会历史性</strong></p><p>实践的基本构成：实践的主体，客体和中介</p><p>实践的形式分为三种基本类型：物质生产实践；社会政治实践；科学文化实践</p><p><strong>实践对认识的决定作用</strong>：<br>1.实践决定认识，实践是认识的基础<br>2.实践是认识的<strong>来源</strong>，实践是认识发展的<strong>动力</strong>，实践是认识的<strong>目的</strong>，实践是检验认识真理性的<strong>唯一标准</strong>。</p><p>认识的本质：是在实践的基础上对客体的能动反映。认识的过程首先是从实践到认识的过程。这个过程主要表现在实践基础上认识活动由<strong>感性认识能动地飞跃到理性认识</strong>，这是认识的第一次飞跃。</p><h3 id="真理与价值"><a href="#真理与价值" class="headerlink" title="真理与价值"></a>真理与价值</h3><p>真理的<strong>客观性</strong>，<strong>绝对性</strong>和<strong>相对性</strong>；</p><p><strong>客观性</strong>（真理是标志主观与客观相符合的哲学范畴，是对客观事物及其规律的正确反映）</p><p><strong>绝对性</strong>（真理的绝对性是指<strong>主客观统一的确定性和发展的无限性</strong>）</p><p><strong>相对性</strong>（是指人们在一定条件下<strong>对客观事物及其本质和发展规律的正确认识总是有限度的，不完善的</strong>）</p><p><strong>真理与谬误</strong>：真理与谬误相互对立，真理与谬误的对立又是相对的，它们在一定条件下能够<strong>相互转化</strong>。真理总是同谬误相比较而存在，相斗争而发展的。</p><p><strong>实践是检验真理的唯一标准</strong>：真理是人们对客观事物及其发展规律的<strong>正确反映</strong>，它的本性在于主观和客观相符合，从实践的特点看，实践具有<strong>直接现实性</strong>。实践的直接现实性是它在客观实在性的具体表现。</p><p><strong>真理的绝对性和相对性的辩证关系</strong>：<br>1.<strong>二者相互依存</strong>：人们对于客观事物的本质和规律的每一个正确认识都是在一定条件下，范围，程度上的认识，因此是有相对性和绝对性的，但是一定范围，程度，条件的认识也是对客观事物的正确反映，因而是无条件的，绝对的。<br>2.<strong>二者相互包含，真理的绝对性寓于相对性之中，真理的相对性必然包含并表现这绝对性</strong><br>3.总之，<strong>二者相互联系，不可分割，是同一客观真理的两种属性</strong></p><blockquote><p><strong>如何理解实践是检验真理的唯一标准？</strong><br>实践之所以能够作为真理的检验标准，这是由真理的本性和实践的特点决定的。<br>（1）首先，从真理的本性看，真理是人们对客观事物及其发展规律的正确反映，它的本性在于主观和客观的相符合。只有那种能够把主观认识与客观事物联系和沟通起来，从而使人们能够把两者加以比较和对照的东西，才能充当检验真理的标准，具有这种特性的东西，只能是作为主客观联系的桥梁、纽带或“交错点”的社会实践<br>（2）其次，从实践的特点看，实践是人们改造世界的客观物质性活动，具有直接现实性的品格。人们通过实践把思想、理论在现实中实现出来，并把这种实现出来的东西同原来的思想理论相对照，从而判明是否正确。所以，实践的直接显示性的特点，是作为检验真理的标准的主要依据，使它成为最公平的审判官，具有最高的权威。</p></blockquote><hr><h2 id="人类社会及其发展规律"><a href="#人类社会及其发展规律" class="headerlink" title="人类社会及其发展规律"></a>人类社会及其发展规律</h2><h3 id="人类社会的存在与发展"><a href="#人类社会的存在与发展" class="headerlink" title="人类社会的存在与发展"></a>人类社会的存在与发展</h3><p><strong>人类社会和社会意识的辩证关系</strong>：<br>1.社会存在决定社会意识，社会意识是社会存在的反映，并反作用于社会存在<br>2.社会意识并非消极被动的受制于社会存在，它即依赖于社会存在，又具有相对独立性</p><p>意义：对我们树立科学历史观，正确认识社会历史具有重要意义。对于社会发展包括社会文化建设具有<strong>重要指导意义</strong></p><p><strong>社会基本矛盾及其运动规律</strong>：<br>1.生产力与生产关系的矛盾运动及其规律<br>生产力决定生产关系，生产关系对生产力具有能动的反作用<br>生产力与生产关系的相互作用是一个过程，表现为二者的矛盾运动<br>就是生产力一定要适应生产力状况的规律<br>2.经济基础决定上层建筑的矛盾运动及其规律<br>经济基础决定上层建筑，上层建筑反作用于经济基础，相互影响，相互作用。<br>上层建筑一定要适合经济基础状况，经济基础状况决定上层建筑的发展方向，决定上层建筑相应的调整和变革；上层建筑的反作用也必须取决于和服从于经济基础的性质和客观要求。</p><h3 id="社会历史发展的动力"><a href="#社会历史发展的动力" class="headerlink" title="社会历史发展的动力"></a>社会历史发展的动力</h3><p>生产力和生产关系，经济基础和上层建筑的矛盾是社会基本矛盾；社会基本矛盾是发展的根本动力；社会主要矛盾不是一成不变的，它在一定条件下会发生转化。社会主要矛盾及其转化的原理，对于指导中国特色社会主义实践具有重要意义。</p><p><strong>改革在社会发展中的作用</strong>：改革是推动社会发展的又一重要动力。他是在一定程度上解决社会矛盾，促进生产力发展，推动社会进步的有效途径和手段，来改变与生产力不相适应的生产关系和经济基础不相适应的上层建筑。</p><p><strong>科学技术在社会发展中的作用</strong>：科技革命是推动经济和社会发展的强大旗杆；要有合理的社会制度保障科学技术的正确运用，始终坚持使科学技术为人类社会的健康发展服务，让科学计数为人造福。</p><h3 id="人民群众在历史发展中的作用"><a href="#人民群众在历史发展中的作用" class="headerlink" title="人民群众在历史发展中的作用"></a>人民群众在历史发展中的作用</h3><p><strong>人们群众在历史发展中的作用</strong>：<br>1.人们群众是历史的创造者<br>2.人们群众是社会物质财富的创造者；是社会神财富的创造者；是社会变革的决定力量。</p><p>无产阶级政党的群众路线是：<strong>一切为了群众，一切依靠群众，从群众中来，到群众中去</strong></p><hr><h2 id="资本主义的本质及规律"><a href="#资本主义的本质及规律" class="headerlink" title="资本主义的本质及规律"></a>资本主义的本质及规律</h2><h3 id="商品经济和价值规律"><a href="#商品经济和价值规律" class="headerlink" title="商品经济和价值规律"></a>商品经济和价值规律</h3><p>商品经济：以交换为目的，存在社会分工，私有制。商品经济是社会经济发展到一定程度的产物。<br>商品的属性：使用价值和价值。商品的使用价值和价值之间是对立统一的关系；<br>商品价值量的决定：是由社会必要劳动时间来决定的。商品的价值量同简单劳动与复杂劳动有着密的关系。<br>货币是体现商品价值，是商品经济内在矛盾发展的产物，货币的本质体现一种社会关系。<br>货币具有价值尺度，流通手段，（前两个是最基本职能）储藏手段，支付手段和世界货币等职能。</p><p><strong>价值规律及其作用</strong>：<br>价值规律是商品生产和商品交换的基本规律即商品的价值量由生产商品的社会必要劳动时间决定，商品交换以价值量为基础，按照等价交换的原则进行。</p><p><strong>作用</strong>：<br>1.自发调节生产资料和劳动力在社会生产部门的分配比例<br>2.自发地刺激社会生产力发展<br>3.自发地调节社会收入分配</p><p><strong>消极作用</strong>：<br>1.社会资源的浪费<br>2.收入的两极分化<br>3.阻碍技术的进步</p><h3 id="资本主义经济制度"><a href="#资本主义经济制度" class="headerlink" title="资本主义经济制度"></a>资本主义经济制度</h3><p><strong>资本主义生产关系的产生</strong>：商品经济得到发展，商人积累的财富不断增加，资本的原始积累的形成。劳动力成为商品与货币转化为资本；劳动力成为商品，劳动力商品也具有价值和使用价值，货币转化为资本。</p><p><strong>资本主义所有制</strong>：是生产资料归资本家所有的一种私有制形式。本质是资本与雇佣劳动之间剥削与被剥削关系的体现。</p><p><strong>资本主义生产方式</strong>：生产剩余价值是资本主义生产方式的绝对规律，雇佣劳动者的剩余价值是剩余价值的唯一源泉；剩余价值生产的两种基本方法，绝对剩余价值的生产和相对剩余价值的生产；剩余价值的资本化，就是资本积累；资本的循环周转与再生产；工资与剩余价值的分配。</p><p><strong>资本主义的基本矛盾与经济危机</strong>：生产社会化和生产资料资本主义私有占有之间的矛盾，是资本主义的基本矛盾。资本主义发展到一定阶段，就会产生以生产过剩为基本特征的经济危机。</p><h3 id="资本主义上层建筑"><a href="#资本主义上层建筑" class="headerlink" title="资本主义上层建筑"></a>资本主义上层建筑</h3><hr><h2 id="资本主义的发展及其趋势"><a href="#资本主义的发展及其趋势" class="headerlink" title="资本主义的发展及其趋势"></a>资本主义的发展及其趋势</h2><h3 id="垄断资本主义的形成与发展"><a href="#垄断资本主义的形成与发展" class="headerlink" title="垄断资本主义的形成与发展"></a>垄断资本主义的形成与发展</h3><h3 id="正确认识当代资本主义的新变化"><a href="#正确认识当代资本主义的新变化" class="headerlink" title="正确认识当代资本主义的新变化"></a>正确认识当代资本主义的新变化</h3><h3 id="资本主义的历史地位和发展趋势"><a href="#资本主义的历史地位和发展趋势" class="headerlink" title="资本主义的历史地位和发展趋势"></a>资本主义的历史地位和发展趋势</h3><p><strong>资本主义为社会主义所代替的历史必然性</strong><br>1.资本主义基本矛盾“包含着现代的一切冲突的萌芽”<br>2.资本积累推动资本主义基本锚段不断激化并最终否定资本主义自身<br>3.国家垄断资本主义是资本社会化的最高形式，将形成社会主义的前奏<br>4.资本主义社会存在着资产阶级和无产阶级两大阶级之间的矛盾和斗争</p><hr><h2 id="社会主义的发展及其规律"><a href="#社会主义的发展及其规律" class="headerlink" title="社会主义的发展及其规律"></a>社会主义的发展及其规律</h2><h3 id="社会主义五百年的历史进程"><a href="#社会主义五百年的历史进程" class="headerlink" title="社会主义五百年的历史进程"></a>社会主义五百年的历史进程</h3><h3 id="科学社会主义基本原则"><a href="#科学社会主义基本原则" class="headerlink" title="科学社会主义基本原则"></a>科学社会主义基本原则</h3><p><strong>如何正确把握科学社会主义基本原则</strong>：<br>1.必须始终坚持科学社会主义基本原则，反对任何背离科学社会主义基本原则的错误倾向<br>2.要善于把科学社会主义基本原则与本国实际相结合，创造性地回答和解决社会主义革命，建设，改革中的重大问题<br>3.紧跟时代和实践的发展，在不断总结新鲜经验中进一步丰富和发展科学社会主义基本原则。中国特色社会主义实现了科学社会主义基本原则与当代中国实际，中华优秀传统文化有机结合。</p><h3 id="在实践中探索社会主义的发展规律"><a href="#在实践中探索社会主义的发展规律" class="headerlink" title="在实践中探索社会主义的发展规律"></a>在实践中探索社会主义的发展规律</h3><hr><h2 id="共产主义崇高理想及其最终实现"><a href="#共产主义崇高理想及其最终实现" class="headerlink" title="共产主义崇高理想及其最终实现"></a>共产主义崇高理想及其最终实现</h2><h3 id="展望未来共产主义新社会"><a href="#展望未来共产主义新社会" class="headerlink" title="展望未来共产主义新社会"></a>展望未来共产主义新社会</h3><h3 id="实现共产主义是历史发展的必然趋势"><a href="#实现共产主义是历史发展的必然趋势" class="headerlink" title="实现共产主义是历史发展的必然趋势"></a>实现共产主义是历史发展的必然趋势</h3><h3 id="共产主义远大理想与中国特色社会主义共同理想"><a href="#共产主义远大理想与中国特色社会主义共同理想" class="headerlink" title="共产主义远大理想与中国特色社会主义共同理想"></a>共产主义远大理想与中国特色社会主义共同理想</h3><p>坚持远大理想与共同理想的辩证统一：坚持和发展中国特色社会主义是中华民族通向共产主义的必由之路；要正确认识和把握共产主义远大理想与中国特色社会主义共同理想的关系。<br>坚定理想信念，投身新时代中国特色社会主义伟大事业如何做：新时代青年，必须坚定理想信念，深入学习马克思主义基本原理以及马克思主义中国化的理论成果，特别是要学习习近平新时代中国特色社会主义思想，让真理武装头脑。当代青年要积极投身新时代中国特色社会主义伟大事业，勇做担当中华民族伟大复兴大任的时代新人。</p>]]></content>
      
      
      <categories>
          
          <category> 思政课 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 马原 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>毛概期末复习要点</title>
      <link href="/JasmineRain.github.io/2025/11/04/%E6%AF%9B%E6%A6%82%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0%E8%A6%81%E7%82%B9/"/>
      <url>/JasmineRain.github.io/2025/11/04/%E6%AF%9B%E6%A6%82%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0%E8%A6%81%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><ul><li><a href="#%E5%AF%BC%E8%AE%BA">导论</a></li><li><a href="#%E6%AF%9B%E6%B3%BD%E4%B8%9C%E6%80%9D%E6%83%B3%E5%8F%8A%E5%85%B6%E5%9C%B0%E4%BD%8D">毛泽东思想及其地位</a><ul><li><a href="#%E6%AF%9B%E6%B3%BD%E4%B8%9C%E6%80%9D%E6%83%B3%E7%9A%84%E5%BD%A2%E6%88%90%E5%92%8C%E5%8F%91%E5%B1%95">毛泽东思想的形成和发展</a></li><li><a href="#%E6%AF%9B%E6%B3%BD%E4%B8%9C%E6%80%9D%E6%83%B3%E7%9A%84%E4%B8%BB%E8%A6%81%E5%86%85%E5%AE%B9%E5%92%8C%E6%B4%BB%E7%9A%84%E7%81%B5%E9%AD%82">毛泽东思想的主要内容和活的灵魂</a></li><li><a href="#%E6%AF%9B%E6%B3%BD%E4%B8%9C%E6%80%9D%E6%83%B3%E7%9A%84%E5%8E%86%E5%8F%B2%E5%9C%B0%E4%BD%8D">毛泽东思想的历史地位</a></li></ul></li><li><a href="#%E6%96%B0%E6%B0%91%E4%B8%BB%E4%B8%BB%E4%B9%89%E9%9D%A9%E5%91%BD%E7%90%86%E8%AE%BA">新民主主义革命理论</a><ul><li><a href="#%E6%96%B0%E6%B0%91%E4%B8%BB%E4%B8%BB%E4%B9%89%E9%9D%A9%E5%91%BD%E7%90%86%E8%AE%BA%E5%BD%A2%E6%88%90%E7%9A%84%E4%BE%9D%E6%8D%AE">新民主主义革命理论形成的依据</a></li><li><a href="#%E6%96%B0%E6%B0%91%E4%B8%BB%E4%B8%BB%E4%B9%89%E9%9D%A9%E5%91%BD%E7%9A%84%E6%80%BB%E8%B7%AF%E7%BA%BF%E5%92%8C%E5%9F%BA%E6%9C%AC%E7%BA%B2%E9%A2%86">新民主主义革命的总路线和基本纲领</a></li><li><a href="#%E6%96%B0%E6%B0%91%E4%B8%BB%E4%B8%BB%E4%B9%89%E9%9D%A9%E5%91%BD%E7%9A%84%E9%81%93%E8%B7%AF%E5%92%8C%E5%9F%BA%E6%9C%AC%E7%BB%8F%E9%AA%8C">新民主主义革命的道路和基本经验</a></li></ul></li><li><a href="#%E7%A4%BE%E4%BC%9A%E4%B8%BB%E4%B9%89%E6%94%B9%E9%80%A0%E7%90%86%E8%AE%BA">社会主义改造理论</a><ul><li><a href="#%E4%BB%8E%E6%96%B0%E6%B0%91%E4%B8%BB%E4%B8%BB%E4%B9%89%E5%88%B0%E7%A4%BE%E4%BC%9A%E4%B8%BB%E4%B9%89%E7%9A%84%E8%BD%AC%E5%8F%98">从新民主主义到社会主义的转变</a></li><li><a href="#%E7%A4%BE%E4%BC%9A%E4%B8%BB%E4%B9%89%E6%94%B9%E9%80%A0%E9%81%93%E8%B7%AF%E5%92%8C%E5%8E%86%E5%8F%B2%E7%BB%8F%E9%AA%8C">社会主义改造道路和历史经验</a></li><li><a href="#%E7%A4%BE%E4%BC%9A%E4%B8%BB%E4%B9%89%E5%9F%BA%E6%9C%AC%E5%88%B6%E5%BA%A6%E5%9C%A8%E4%B8%AD%E5%9B%BD%E7%9A%84%E7%A1%AE%E7%AB%8B">社会主义基本制度在中国的确立</a></li></ul></li><li><a href="#%E7%A4%BE%E4%BC%9A%E4%B8%BB%E4%B9%89%E5%BB%BA%E8%AE%BE%E9%81%93%E8%B7%AF%E5%88%9D%E6%AD%A5%E6%8E%A2%E7%B4%A2%E7%9A%84%E7%90%86%E8%AE%BA%E6%88%90%E6%9E%9C">社会主义建设道路初步探索的理论成果</a><ul><li><a href="#%E5%88%9D%E6%AD%A5%E6%8E%A2%E7%B4%A2%E7%9A%84%E9%87%8D%E8%A6%81%E7%90%86%E8%AE%BA%E6%88%90%E6%9E%9C">初步探索的重要理论成果</a></li><li><a href="#%E5%88%9D%E6%AD%A5%E6%8E%A2%E7%B4%A2%E7%9A%84%E6%84%8F%E4%B9%89%E5%92%8C%E7%BB%8F%E9%AA%8C%E6%95%99%E8%AE%AD">初步探索的意义和经验教训</a></li></ul></li><li><a href="#%E4%B8%AD%E5%9B%BD%E7%89%B9%E8%89%B2%E7%A4%BE%E4%BC%9A%E4%B8%BB%E4%B9%89%E7%90%86%E8%AE%BA%E4%BD%93%E7%B3%BB%E7%9A%84%E5%BD%A2%E6%88%90%E5%8F%91%E5%B1%95">中国特色社会主义理论体系的形成发展</a><ul><li><a href="#%E4%B8%AD%E5%9B%BD%E7%89%B9%E8%89%B2%E7%A4%BE%E4%BC%9A%E4%B8%BB%E4%B9%89%E7%90%86%E8%AE%BA%E4%BD%93%E7%B3%BB%E5%BD%A2%E6%88%90%E5%8F%91%E5%B1%95%E7%9A%84%E7%A4%BE%E4%BC%9A%E5%8E%86%E5%8F%B2%E6%9D%A1%E4%BB%B6">中国特色社会主义理论体系形成发展的社会历史条件</a></li><li><a href="#%E4%B8%AD%E5%9B%BD%E7%89%B9%E8%89%B2%E7%A4%BE%E4%BC%9A%E4%B8%BB%E4%B9%89%E7%90%86%E8%AE%BA%E4%BD%93%E7%B3%BB%E5%BD%A2%E6%88%90%E5%8F%91%E5%B1%95%E8%BF%87%E7%A8%8B">中国特色社会主义理论体系形成发展过程</a></li></ul></li><li><a href="#%E9%82%93%E5%B0%8F%E5%B9%B3%E7%90%86%E8%AE%BA">邓小平理论</a><ul><li><a href="#%E9%82%93%E5%B0%8F%E5%B9%B3%E7%90%86%E8%AE%BA%E9%A6%96%E8%A6%81%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%9A%84%E7%90%86%E8%AE%BA%E9%97%AE%E9%A2%98%E5%92%8C%E7%B2%BE%E9%AB%93">邓小平理论首要的基本的理论问题和精髓</a></li><li><a href="#%E9%82%93%E5%B0%8F%E5%B9%B3%E7%90%86%E8%AE%BA%E7%9A%84%E4%B8%BB%E8%A6%81%E5%86%85%E5%AE%B9">邓小平理论的主要内容</a></li><li><a href="#%E9%82%93%E5%B0%8F%E5%B9%B3%E7%90%86%E8%AE%BA%E7%9A%84%E5%8E%86%E5%8F%B2%E5%9C%B0%E4%BD%8D">邓小平理论的历史地位</a></li></ul></li><li><a href="#%E4%B8%89%E4%B8%AA%E4%BB%A3%E8%A1%A8%E9%87%8D%E8%A6%81%E6%80%9D%E6%83%B3">“三个代表”重要思想</a><ul><li><a href="#%E4%B8%89%E4%B8%AA%E4%BB%A3%E8%A1%A8%E9%87%8D%E8%A6%81%E6%80%9D%E6%83%B3%E7%9A%84%E6%A0%B8%E5%BF%83%E8%A7%82%E7%82%B9">“三个代表”重要思想的核心观点</a></li><li><a href="#%E4%B8%89%E4%B8%AA%E4%BB%A3%E8%A1%A8%E9%87%8D%E8%A6%81%E6%80%9D%E6%83%B3%E7%9A%84%E4%B8%BB%E8%A6%81%E5%86%85%E5%AE%B9">“三个代表”重要思想的主要内容</a></li><li><a href="#%E4%B8%89%E4%B8%AA%E4%BB%A3%E8%A1%A8%E9%87%8D%E8%A6%81%E6%80%9D%E6%83%B3%E7%9A%84%E5%8E%86%E5%8F%B2%E5%9C%B0%E4%BD%8D">“三个代表”重要思想的历史地位</a></li></ul></li><li><a href="#%E7%A7%91%E5%AD%A6%E5%8F%91%E5%B1%95%E8%A7%82">科学发展观</a><ul><li><a href="#%E7%A7%91%E5%AD%A6%E5%8F%91%E5%B1%95%E8%A7%82%E7%9A%84%E7%A7%91%E5%AD%A6%E5%86%85%E6%B6%B5">科学发展观的科学内涵</a></li><li><a href="#%E7%A7%91%E5%AD%A6%E5%8F%91%E5%B1%95%E8%A7%82%E7%9A%84%E4%B8%BB%E8%A6%81%E5%86%85%E5%AE%B9">科学发展观的主要内容</a></li><li><a href="#%E7%A7%91%E5%AD%A6%E5%8F%91%E5%B1%95%E8%A7%82%E7%9A%84%E5%8E%86%E5%8F%B2%E5%9C%B0%E4%BD%8D">科学发展观的历史地位</a></li></ul></li><li><a href="#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E5%8F%8A%E7%AD%94%E6%A1%88">常见问题及答案</a></li></ul><h2 id="导论"><a href="#导论" class="headerlink" title="导论"></a>导论</h2><p>中国化马克思主义的发展逻辑</p><ul><li>两次历史性飞跃：<br>  1.马克思主义与中国实际相结合，产生毛泽东思想；<br>  2.马克思主义与当代中国实际相结合，产生中国特色社会主义理论体系</li><li>三大理论成果：<br>  1.毛泽东思想<br>  2.中国特色社会主义理论体系<br>  3.习近平新时代中国特色社会主义思想</li></ul><p>马克思主义中国化时代化的科学内涵</p><ul><li>中国化：立足中国国情，解决中国问题</li><li>时代化：回应时代课题，把握时代脉搏</li></ul><hr><h2 id="毛泽东思想及其地位"><a href="#毛泽东思想及其地位" class="headerlink" title="毛泽东思想及其地位"></a>毛泽东思想及其地位</h2><h2 id="毛泽东思想的形成和发展"><a href="#毛泽东思想的形成和发展" class="headerlink" title="毛泽东思想的形成和发展"></a>毛泽东思想的形成和发展</h2><p>1.毛泽东思想的概念</p><blockquote><p><strong>毛泽东思想</strong>是马克思列宁主义基本原理与中国具体实际相结合的产物，是中国革命和建设经验的理论总结，是中国共产党人的集体智慧的结晶。</p></blockquote><p>2.毛泽东思想的形成过程</p><blockquote><table><thead><tr><th>阶段</th><th>时间</th><th>关键事件或著作</th><th>特点&#x2F;意义</th></tr></thead><tbody><tr><td>初步形成阶段</td><td>1927-1935</td><td>《中国社会各阶级的分析》《实践论》《矛盾论》</td><td>标志：1935年遵义会议后，毛泽东思想开始在党内确立指导地位</td></tr><tr><td>走向成熟阶段</td><td>1935-1945</td><td>《新民主主义论》《论联合政府》等</td><td>标志：1945年的党的七大将毛泽东思想确立为党的指导思想</td></tr><tr><td>丰富发展阶段</td><td>1945-1976</td><td>关于社会主义建设的探索，如《论十大关系》等</td><td>既有积极经验，也有失误教训（如“大跃进”、文革）</td></tr></tbody></table></blockquote><p>3.毛泽东思想的发展</p><blockquote><p>毛泽东思想不是一蹴而就的，它是在<strong>革命与建设实践中不断丰富和发展的</strong>，尤其在土地革命战争时期、抗日战争时期和社会主义建设初期不断深化。</p></blockquote><h2 id="毛泽东思想的主要内容和活的灵魂"><a href="#毛泽东思想的主要内容和活的灵魂" class="headerlink" title="毛泽东思想的主要内容和活的灵魂"></a>毛泽东思想的主要内容和活的灵魂</h2><p>1.毛泽东思想的主要内容</p><blockquote><ul><li>新民主主义革命理论</li><li>社会主义革命和建设理论</li><li>革命军队建设和军事战略思想</li><li>党的建设理论</li><li>思想政治工作和群众路线等工作方法</li></ul></blockquote><p>2.毛泽东思想活的灵魂</p><blockquote><ul><li><strong>实事求是</strong>:一切从实际出发，理论联系实际，在实践中检验发展真理。</li><li><strong>群众路线</strong>：一切为了群众，一切依靠群众，从群众中来到群众中去。</li><li><strong>独立自主</strong>：独立思考，维护民族独立，捍卫国家主权。</li></ul></blockquote><h2 id="毛泽东思想的历史地位"><a href="#毛泽东思想的历史地位" class="headerlink" title="毛泽东思想的历史地位"></a>毛泽东思想的历史地位</h2><p>1.毛泽东思想的历史地位</p><blockquote><ul><li>马克思主义中国化的<strong>第一个重大理论成果</strong>。</li><li>中国革命和建设的<strong>科学指南</strong>。</li><li>共产党和中国人民宝贵的<strong>精神财富</strong>。</li></ul></blockquote><p>2.毛泽东思想的现实意义</p><blockquote><ul><li>是中国共产党开创的中国特色社会主义的重要思想基础</li><li>为新时代坚持和发展中国特色社会主义提供历史借鉴</li><li>弘扬实事求是、群众路线、独立自主等优良传统</li></ul></blockquote><hr><h2 id="新民主主义革命理论"><a href="#新民主主义革命理论" class="headerlink" title="新民主主义革命理论"></a>新民主主义革命理论</h2><h2 id="新民主主义革命理论形成的依据"><a href="#新民主主义革命理论形成的依据" class="headerlink" title="新民主主义革命理论形成的依据"></a>新民主主义革命理论形成的依据</h2><p>1.理论依据</p><ul><li><strong>马克思列宁主义关于殖民地半殖民地革命的理论</strong>，尤其是列宁关于无产阶级领导民族民主革命的思想</li><li>但毛泽东指出，中国不能照搬俄国模式，必须从中国实际出发探索革命道路。</li></ul><p>2.现实依据</p><ul><li><strong>中国所处的时代背景</strong>：是帝国主义和无产阶级革命的时代</li><li><strong>中国的国情</strong>：半殖民地半封建社会，民族压迫与阶级压迫交织</li><li><strong>辛亥革命失败的教训</strong>：资产阶级不能完成反帝反封建的历史任务</li><li><strong>中国革命实践的总结</strong>：特别是土地革命和抗日战争经验推动理论深化</li></ul><h2 id="新民主主义革命的总路线和基本纲领"><a href="#新民主主义革命的总路线和基本纲领" class="headerlink" title="新民主主义革命的总路线和基本纲领"></a>新民主主义革命的总路线和基本纲领</h2><p>1.总路线</p><blockquote><p>“一切为了群众，一切依靠群众，从群众中来，到群众中去”，其核心表述是：<strong>“无产阶级领导的、人民大众的、反对帝国主义、封建主义和官僚资本主义的革命”</strong></p></blockquote><p>2.基本纲领</p><blockquote><table><thead><tr><th>类型</th><th>内容</th></tr></thead><tbody><tr><td>政治纲领</td><td>建立各革命阶级联合专政的、以工人阶级为领导的<strong>人民民主专政的共和国</strong></td></tr><tr><td>经济纲领</td><td>没收封建土地归农民所有，没收官僚资本归国家所有，保护民族工商业</td></tr><tr><td>文化纲领</td><td>发展<strong>民族的、科学的、大众的</strong>新文化，反对封建文化与殖民文化</td></tr></tbody></table></blockquote><h2 id="新民主主义革命的道路和基本经验"><a href="#新民主主义革命的道路和基本经验" class="headerlink" title="新民主主义革命的道路和基本经验"></a>新民主主义革命的道路和基本经验</h2><p>1.为什么要<strong>农村包围城市，武装夺取政权</strong></p><blockquote><ul><li>中国是一个<strong>以农民为主体的农业大国</strong>，城市力量薄弱</li><li>敌人控制大城市，农村是相对薄弱环节</li><li>必须先从农村建立根据地，逐步扩大革命力量</li><li><strong>实质是把武装斗争、农村根据地和党的领导三者结合起来</strong></li></ul></blockquote><p>2.新民主主义革命的基本经验</p><blockquote><ul><li><strong>必须有一个无产阶级政党领导</strong></li><li><strong>必须建立统一战线</strong></li><li><strong>必须坚持武装斗争</strong></li><li><strong>必须建立革命根据地</strong></li><li><strong>必须以革命的群众路线为工作方法</strong></li></ul></blockquote><hr><h2 id="社会主义改造理论"><a href="#社会主义改造理论" class="headerlink" title="社会主义改造理论"></a>社会主义改造理论</h2><h2 id="从新民主主义到社会主义的转变"><a href="#从新民主主义到社会主义的转变" class="headerlink" title="从新民主主义到社会主义的转变"></a>从新民主主义到社会主义的转变</h2><p>1.必要性</p><blockquote><ul><li><strong>政治上</strong>：巩固人民民主政权必须消除资产阶级的经济基础</li><li><strong>经济上</strong>：民族资本主义力量薄弱，资本主义难以独立发展国家经济</li><li><strong>社会上</strong>：广大劳动人民要求共同富裕，追求社会公平</li><li><strong>国际背景</strong>：冷战开始，社会主义阵营支持新中国的发展</li></ul></blockquote><p>2.简述中国从新民主主义到社会主义的转变及其意义</p><blockquote><ul><li><strong>背景和必要性</strong>：政治经济社会条件决定要向社会主义过渡</li><li><strong>具体实践</strong>：三大改造——农业、手工业、资本主义工商业</li><li><strong>改造方式</strong>：合作社、公私合营、“和平赎买”等</li><li><strong>历史经验</strong>：党领导、逐步过渡、统一战线、和平改革</li><li><strong>最终确立</strong>：1956年完成，标志中国社会主义制度确立</li><li><strong>现实意义</strong>：为后来的发展奠定了基础，是中国式社会主义的开端</li></ul></blockquote><h2 id="社会主义改造道路和历史经验"><a href="#社会主义改造道路和历史经验" class="headerlink" title="社会主义改造道路和历史经验"></a>社会主义改造道路和历史经验</h2><p>1.三大改造内容</p><blockquote><table><thead><tr><th>改造对象</th><th>改造方式</th><th>主要形式</th></tr></thead><tbody><tr><td>个体农业</td><td>农民合作互助</td><td>初级农业合作社到高级农业合作社</td></tr><tr><td>个体手工业</td><td>鼓励合作生产</td><td>手工业生产合作社</td></tr><tr><td>资本主义工商业</td><td>“和平赎买”，利用限制改造</td><td>公私合营企业到国家资本主义</td></tr></tbody></table></blockquote><p>2.社会主义改造成功的历史经验</p><blockquote><ul><li>坚持<strong>社会主义工业化建设</strong>与<strong>社会主义改造</strong>同时进行</li><li>在党的领导下，采取<strong>积极引导、逐步过渡的方式</strong></li><li>运用<strong>统一战线的策略</strong>，团结资产阶级，避免对抗</li><li>采取**“和平赎买”**政策，保护民族工商业者的利益</li></ul></blockquote><h2 id="社会主义基本制度在中国的确立"><a href="#社会主义基本制度在中国的确立" class="headerlink" title="社会主义基本制度在中国的确立"></a>社会主义基本制度在中国的确立</h2><p>1.完成标志</p><blockquote><ul><li>1956年，三大改造基本完成</li><li>公有制成为主体</li><li>社会主义制度在中国全面确立</li></ul></blockquote><p>2.意义</p><blockquote><ul><li>实现了中国历史上最深刻、最广泛的社会变革</li><li>实现了从新民主主义到社会主义的过渡</li><li>为中国现代化建设打下制度基础</li><li>显示了毛泽东思想指导下中国特色社会主义探索的重要成果</li></ul></blockquote><hr><h2 id="社会主义建设道路初步探索的理论成果"><a href="#社会主义建设道路初步探索的理论成果" class="headerlink" title="社会主义建设道路初步探索的理论成果"></a>社会主义建设道路初步探索的理论成果</h2><h2 id="初步探索的重要理论成果"><a href="#初步探索的重要理论成果" class="headerlink" title="初步探索的重要理论成果"></a>初步探索的重要理论成果</h2><p>1.提出和实践社会主义建设总路线，核心是“<strong>一个中心，两个基本点</strong>”，以社会主义工业化为中心，坚持巩固社会主义制度和发展生产力</p><p>2.对社会主义经济建设规律的认识，强调计划经济的主导作用，推动农业、工业、交通运输和国防建设协调发展，注重发展重工业，为国家经济打基础</p><p>3.十年建设的总体布局，实施第一个五年计划，建立较完整的工业体系和国民经济体系，在探索中逐步完善社会主义制度</p><p>4.思想路线和政治路线的探索，强调思想改造，强调发挥社会主义积极性，推动群众运动</p><h2 id="初步探索的意义和经验教训"><a href="#初步探索的意义和经验教训" class="headerlink" title="初步探索的意义和经验教训"></a>初步探索的意义和经验教训</h2><p>1.意义</p><blockquote><ul><li>为中国特色社会主义提供历史经验教训（在理论上形成了早期的探索框架，认识到中国必须走自己的道路）</li><li>对社会主义建设规律的初步认识（毛泽东提出的“人民内部矛盾”、“独立自主工业化道路”，有重大理论价值）</li><li>奠定改革开放的吧思想和实践基础（生产力决定发展方向、重视人民群众、经济发展为中心等基本认识）</li></ul></blockquote><p>2.经验</p><blockquote><p>强调自力更生、独立自主；重视群众路线，积极探索适合中国国情的制度</p></blockquote><p>3.教训</p><blockquote><p><strong>忽视经济发展规律</strong>，重视政治运动，轻经济建设，<strong>左倾错误严重</strong>，过分集权，民主和法治不健全，缺乏对市场机制的认识</p></blockquote><hr><h2 id="中国特色社会主义理论体系的形成发展"><a href="#中国特色社会主义理论体系的形成发展" class="headerlink" title="中国特色社会主义理论体系的形成发展"></a>中国特色社会主义理论体系的形成发展</h2><h2 id="中国特色社会主义理论体系形成发展的社会历史条件"><a href="#中国特色社会主义理论体系形成发展的社会历史条件" class="headerlink" title="中国特色社会主义理论体系形成发展的社会历史条件"></a>中国特色社会主义理论体系形成发展的社会历史条件</h2><p>1.<strong>时代背景</strong>：</p><blockquote><p>1.当代中国所处的历史阶段：中国已确立了社会主义基本制度，面临着如何建设和发展社会主义的问题<br>2.世界发展大势：冷战结束、经济全球化深入发展，社会主义和资本主义的竞争格局发生变化<br>3.新技术革命：信息技术、生产力迅速发展，为改革和开放提供了技术支撑</p></blockquote><p>2.<strong>国内背景</strong>：</p><blockquote><p>1.改革开发的实践需求，改革开放以来，中国遇到很多新问题，迫切需要在理论上指导现代化建设，探索符合中国国情的发展道路<br>2.社会主义建设经验教训，对文革等历史经验的深刻总结，强调从实际出发、尊重经济发展规律</p></blockquote><p>3.<strong>理论基础</strong>:</p><blockquote><p>1.马克思列宁主义、毛泽东思想的基本原理<br>2.对毛泽东时代和改革开放以来正反两方面经验的总结<br>3.立足于中国特色社会主义实践</p></blockquote><h2 id="中国特色社会主义理论体系形成发展过程"><a href="#中国特色社会主义理论体系形成发展过程" class="headerlink" title="中国特色社会主义理论体系形成发展过程"></a>中国特色社会主义理论体系形成发展过程</h2><p>1.<strong>邓小平理论</strong>（1978年开始形成，1992年基本确立）</p><p>1.提出了建设中国特色社会主义<br>2.强调发展生产力、实施改革开放、坚持四项基本原则<br>3.理论核心：发展才是硬道理<br>4.197年中共十五大将其写入党章</p><p>2.<strong>“三个代表”重要思想</strong>（1997-2002）</p><blockquote><p>1.党必须始终代表中国先进生产力的发展要求<br>2.代表先进文化的前进方向<br>3.代表最广大人民的根本利益</p></blockquote><p>3.<strong>科学发展观的提出和完善</strong>（2002-2012）</p><blockquote><p>1.以人为本<br>2.全面协调可持续发展</p></blockquote><p>4.<strong>习近平新时代中国特色社会主义思想的形成</strong>（2012至今）</p><p>  1.坚持和发展中国特色社会主义<br>  2.全面建设社会主义现代化强国<br>  3.全面深化改革、全面依法治国、全面从严治党、全面建成小康社会（四个全面）</p><hr><h2 id="邓小平理论"><a href="#邓小平理论" class="headerlink" title="邓小平理论"></a>邓小平理论</h2><h2 id="邓小平理论首要的基本的理论问题和精髓"><a href="#邓小平理论首要的基本的理论问题和精髓" class="headerlink" title="邓小平理论首要的基本的理论问题和精髓"></a>邓小平理论首要的基本的理论问题和精髓</h2><p>1.首要的基本理论问题:<strong>什么是社会主义、怎样建设社会主义</strong></p><blockquote><ul><li>在摆脱“左”的思想束缚后，中国亟需重新认识社会主义</li><li>邓小平强调：不能照搬苏联模式，必须从中国国情出发</li><li>指出贫穷不是社会主义，发展生产力是社会主义的根本任务</li></ul></blockquote><p>2.邓小平理论的精髓：<strong>解放思想、实事求是</strong></p><blockquote><ul><li><strong>解放思想</strong>：突破教条主义束缚，敢于创新</li><li><strong>实事求是</strong>：从中国实际出发，理论联系实际</li><li>是党和国家指导思想从“以阶级斗争为纲”转向“以经济建设为中心”的理论基础</li></ul></blockquote><h2 id="邓小平理论的主要内容"><a href="#邓小平理论的主要内容" class="headerlink" title="邓小平理论的主要内容"></a>邓小平理论的主要内容</h2><p>1.邓小平理论的主要内容</p><blockquote><ul><li><strong>发展才是硬道理</strong>:把发展经济放在首位，认为“发展是解决中国一切问题的关键”,推动改革开放，激发经济活力</li><li><strong>社会主义的本质</strong>:解放生产力、发展生产力，消灭剥削、消除两极分化，最终达到共同富裕</li><li><strong>“一个中心、两个基本点”</strong>：一个中心：以经济建设为中心，两个基本点：坚持四项基本原则，坚持改革开放</li><li><strong>社会主义初级阶段理论</strong>：明确中国长期处于并将长期处于社会主义初级阶段，所有路线、方针、政策必须从这一国情出发</li><li><strong>“两手抓、两手都要硬”</strong>：一手抓物质文明建设，一手抓精神文明建设，不能顾此失彼</li></ul></blockquote><h2 id="邓小平理论的历史地位"><a href="#邓小平理论的历史地位" class="headerlink" title="邓小平理论的历史地位"></a>邓小平理论的历史地位</h2><p>1.<strong>是马克思主义中国化的第二次飞跃</strong>：马克思主义与中国实际相结合的又一次历史性飞跃（第一次是毛泽东思想），实现了从革命到建设的理论转变</p><p>2.<strong>是中国特色社会主义理论体系的开篇之作</strong>：奠定了中国特色社会主义理论体系的基础，为之后的“三个代表”“科学发展观”“新时代思想”提供理论起点</p><p>3.<strong>是改革开放和现代化建设的指导思想</strong>：把中国带入快速发展阶段，推动社会主义制度自我完善和发展</p><hr><h2 id="“三个代表”重要思想"><a href="#“三个代表”重要思想" class="headerlink" title="“三个代表”重要思想"></a>“三个代表”重要思想</h2><h2 id="“三个代表”重要思想的核心观点"><a href="#“三个代表”重要思想的核心观点" class="headerlink" title="“三个代表”重要思想的核心观点"></a>“三个代表”重要思想的核心观点</h2><p><strong>中国共产党要始终代表中国先进社会生产力的发展要求，代表中国先进文化的前进方向，代表中国最广大人民的根本利益。</strong></p><h2 id="“三个代表”重要思想的主要内容"><a href="#“三个代表”重要思想的主要内容" class="headerlink" title="“三个代表”重要思想的主要内容"></a>“三个代表”重要思想的主要内容</h2><p>1.<strong>始终代表中国先进社会生产力的发展要求</strong>：坚持以经济建设为中心，把握科技进步对生产力发展的关键作用，推进体制改革、推动现代化建设</p><p>2.<strong>始终代表中国先进文化的前进方向</strong>：推动社会主义文化大发展大繁荣，以社会主义核心价值观引领社会风尚，发展面向现代化、世界和未来的民族科学大众文化</p><p>3.<strong>始终代表最广大人民的根本利益</strong>：立党为公、执政为民，把人民群众的根本利益作为出发点和落脚点，实现好、维护好、发展好人民的利益</p><h2 id="“三个代表”重要思想的历史地位"><a href="#“三个代表”重要思想的历史地位" class="headerlink" title="“三个代表”重要思想的历史地位"></a>“三个代表”重要思想的历史地位</h2><p>1.<strong>是党在新世纪坚持和发展中国特色社会主义的强大理论武器</strong>：把党的先进性本质与历史使命提升到新的高度，指导中国在复杂国际局势下实现了政治稳定与经济发展</p><p>2.<strong>是对马克思列宁主义、毛泽东思想、邓小平理论的继承和发展</strong>：推进了马克思主义中国化的又一次历史性飞跃，丰富和发展了中国特色社会主义理论体系</p><p>3.<strong>是加强和改进党的建设的根本遵循</strong>：强调党的建设必须与时代同步，推动党的建设实现历史性转变，增强执政能力</p><p>4.<strong>为科学发展观和新时代中国特色社会主义思想奠定基础</strong>：理论上的继承关系清晰，为后续理论提供现实基础与思想铺垫</p><hr><h3 id="科学发展观"><a href="#科学发展观" class="headerlink" title="科学发展观"></a>科学发展观</h3><h2 id="科学发展观的科学内涵"><a href="#科学发展观的科学内涵" class="headerlink" title="科学发展观的科学内涵"></a>科学发展观的科学内涵</h2><p>科学发展观的核心是<strong>以人为本</strong>，基本要求是<strong>全面协调可持续</strong>，根本方法是<strong>统筹兼顾</strong></p><p>1.<strong>坚持以人为本</strong>：把实现好、维护好、发展好最广大人民的根本利益作为出发点和落脚点</p><p>2.<strong>全面发展</strong>：推动经济建设、政治建设、文化建设、社会建设、生态文明建设协调发展</p><p>3.<strong>协调发展</strong>：统筹城乡发展、区域发展、经济社会发展、人与自然和谐发展、国内发展与对外开放</p><p>4.<strong>可持续发展</strong>：推动资源节约型、环境友好型社会建设，实现经济社会发展与人口、资源、环境相协调</p><p>5.<strong>统筹兼顾</strong>：从全局出发，协调各方面的利益关系，实现整体利益的最大化和长远发展</p><h2 id="科学发展观的主要内容"><a href="#科学发展观的主要内容" class="headerlink" title="科学发展观的主要内容"></a>科学发展观的主要内容</h2><p>1.<strong>发展是第一要义</strong>：坚持把发展作为党执政兴国的第一要务</p><p>2.<strong>以人为本是核心立场</strong>：坚持人民主体地位，实现人的全面发展</p><p>3.<strong>全面协调可持续是基本要求</strong>：推动各方面发展协调统一</p><p>4.<strong>统筹兼顾是根本方法</strong>：注重统筹各个方面和各个层次的发展利益关系</p><h2 id="科学发展观的历史地位"><a href="#科学发展观的历史地位" class="headerlink" title="科学发展观的历史地位"></a>科学发展观的历史地位</h2><p>1.<strong>中国特色社会主义理论体系的重要组成部分</strong>：它继承和发展了邓小平理论、“三个代表”重要思想，是马克思主义中国化的又一理论成果</p><p>2.<strong>党的指导思想的重大创新</strong>：科学发展观将发展观念从“速度优先”转向“质量与效益并重”，强调可持续性和公平性，是对传统发展观的重大超越</p><p>3.<strong>全面建设小康社会的战略指导思想</strong>：为解决发展中出现的矛盾和问题提供了根本遵循</p><p>4.<strong>推进国家治理体系和治理能力现代化的重要指导原则</strong>：科学发展观推动了党和国家决策的科学化、民主化</p><hr><h2 id="常见问题及答案"><a href="#常见问题及答案" class="headerlink" title="常见问题及答案"></a>常见问题及答案</h2><ol><li><strong>简述马克思主义中国化时代化的内涵</strong>（重点）</li></ol><blockquote><ul><li>运用马克思主义的立场、观点和方法，观察时代、把握时代、引领时代，解决中国革命、建设、改革中的实际问题。</li><li>总结和提炼中国革命、建设、改革的实践经验并将其上升为理论，不断丰富和发展马克思主义的理论宝库，赋予马克思主义新的时代内涵。</li><li>运用中国人民喜闻乐见的民族语言来阐述马克思主义，使其根植于中华优秀传统文化的土壤中，具有中国特色、中国风格、中国气派。</li></ul></blockquote><p>2.<strong>简述毛泽东思想的主要内容有哪些</strong></p><blockquote><ul><li>新民主主义革命理论</li><li>社会主义革命和社会主义建设理论</li><li>革命军队建设和军事战略理论</li><li>政策和策略的理论</li><li>思想政治工作和文化工作的理论</li><li>党的建设理论</li><li>国际战略和外交工作的理论等内容</li></ul></blockquote><p>3.<strong>简述毛泽东思想活的灵魂主要内容及其含义</strong></p><blockquote><p>毛泽东思想活的灵魂理论包括实事求是、群众路线、独立自主。</p><ul><li>实事求是，就是一切从实际出发，理论联系实际，坚持在实践中检验真理和发展真理。是核心和实质。是毛泽东思想的基本点和精髓。</li><li>群众路线，就是一切为了群众，一切依靠群众，从群众中来，到群众中去，把党的正确主张变为群众的自觉行动。</li><li>独立自主，就是坚持独立思考，走自己的路，就是坚定不移的维护民族独立、捍卫国家主权，把立足点放在依靠自己力量的基础上，同时积极争取外援，开展国际经济文化交流，学习外国一切对我们有益的先进事物。</li></ul></blockquote><p>4.<strong>如何理解新民主主义革命的三大法宝及其相互关系</strong></p><blockquote><p>新民主主义革命的三大法宝是统一战线、武装斗争、党的建设。<br>相互关系：统一战线和武装斗争是中国革命的两个基本特点，是战胜敌人的两个基本武器。统一战线是实际武装斗争的统一战线，武装斗争是统一战线的中心支柱，党的组织则是掌握统一战线和武装斗争这两个武器以实行对敌冲锋陷阵的英勇战士。</p></blockquote><p>5.<strong>简述土地革命、武装斗争、农村革命根据地建设三者之间的关系</strong>（重点）</p><blockquote><p>土地革命是民主革命的基本内容，武装斗争是主要形式，农村革命根据地是战略阵地。土地革命能支持武装斗争，武装斗争能保卫土地革命成果，根据地是两者的依托。</p></blockquote><p>6.<strong>如何认识党在过渡时期的总路线</strong></p><blockquote><p>要在相当长的时期内，逐步实现国家社会主义的工业化，并逐步实现国家对农业、对手工业和资本主义工商业的社会主义改造。</p></blockquote><p>7.<strong>简述党在社会主义建设道路的初步探索中获取了哪些重要的理论成果</strong></p><blockquote><ul><li>调动一切积极因素为社会主义事业服务</li><li>正确认识和处理社会主义社会矛盾的思想</li><li>走中国工业化的思想</li><li>社会主义发展阶段</li><li>“四个现代化”战略目标</li><li>科学教育文化工作</li></ul></blockquote><p>8.<strong>如何认识党对社会主义建设道路初步探索的意义</strong></p><blockquote><ul><li>巩固和发展我国的社会主义制度</li><li>为开创中国特色社会主义提供了宝贵经验、理论准备和物质基础</li><li>丰富了科学社会主义的理论和实践</li></ul></blockquote><p>9.<strong>简述“三个代表”重要思想的主要内容</strong></p><blockquote><ul><li>发展是当执政新国的第一要务</li><li>建立社会主义市场经济体制</li><li>全面建设小康社会</li><li>建设社会主义政治文明</li><li>实施“引进来”和“走出去”相结合的对外开放战略</li><li>推进党的建设新的伟大工程</li></ul></blockquote><p>10.<strong>简述科学发展观的主要内容</strong></p><blockquote><ul><li>加快转变经济发展方式</li><li>发展社会主义民主政治</li><li>推进社会主义文化强国建设</li><li>构建社会主义和谐社会</li><li>推进生态文明建设</li><li>全面提高党的建设科学化水平</li></ul></blockquote><p>11.<strong>邓小平理论中社会主义的本质是什么</strong></p><blockquote><ul><li>解放和发展生产力</li><li>消灭剥削，消除两级分化，最终达到共同富裕</li></ul></blockquote><p>12.<strong>科学发展观的科学内涵是什么</strong></p><blockquote><ul><li>推动经济社会发展是科学发展观的第一要义</li><li>以人为本是科学发展观的核心立场</li><li>全面协调可持续是科学发展观的基本要求</li><li>统筹兼顾是科学发展观的根本方法</li></ul></blockquote><p>13.<strong>社会主义改革开放的主要内容有哪些</strong></p><blockquote><p>改革的实质和目标是要从根本上改变束缚我国生产力发展的经济体制，建立充满生机和活力的社会主义新经济体制，同时相应地改革政治体制和其他方面的体制，以实现中国的社会主义现代化。对外开放是对世界所有国家的开放，包括对发达国家的开放，也包括对发展中国家的开放；不仅是经济领域的开放。还包括科技、教育、文化等领域的开放。</p></blockquote><p>14.<strong>邓小平理论中“分三步走基本实现现代化的发展战略”的步骤</strong>（重点）</p><blockquote><ul><li>第一步：到1990年，实现国民生产总值比1980年翻一番，解决人民的温饱问题</li><li>第二步：到20世纪末，使国民生产总值再增长一倍，人民生活达到小康水平。</li><li>第三步：到21世纪中叶，人均国民生产总值达到中等发达国家水平，人民生活比较富裕，基本实现现代化。然后，在这个基础上继续前进。</li></ul></blockquote><p>15.<strong>如何认识邓小平理论的历史地位</strong></p><blockquote><ul><li>马克思列宁主义、毛泽东思想的继承和发展</li><li>中国特色社会主义理论体系的开篇之作</li><li>改革开放和社会主义现代化建设的科学指南</li></ul></blockquote><p>16.<strong>为了更好地实现“三步走”的现代化战略，邓小平提出了以重点带动全局的思想。简述他提出的三个战略重点</strong></p><blockquote><p>农业、能源和交通、教育和科学</p></blockquote><p>17.<strong>邓小平的社会主义市场经济理论丰富内涵有哪些</strong></p><blockquote><ul><li>一是计划经济和市场经济不是划分社会制度的标志，计划经济不等于社会主义，市场经济也不等于资本主义</li><li>二是计划和市场都是经济手段，对经济活动的调节各有优劣，社会主义实行市场经济是要把两者优势结合起来</li><li>三是市场经济作为资源配置手段，本身不具有制度属性，可以和不同的社会制度结合，从而表现出不同的性质</li></ul></blockquote><p>18.<strong>党在社会主义初级阶段的基本路线是什么</strong>（重点）</p><blockquote><p>领导和团结全国各族人民，以经济建设为中心，坚持四项基本原则，坚持改革开放，自力更生，艰苦创业，为把我国建设成富强、民主、文明的社会主义现代化强国而奋斗。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 思政课 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 毛概 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>黑盒测试</title>
      <link href="/JasmineRain.github.io/2025/11/04/%E9%BB%91%E7%9B%92%E6%B5%8B%E8%AF%95/"/>
      <url>/JasmineRain.github.io/2025/11/04/%E9%BB%91%E7%9B%92%E6%B5%8B%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<p>黑盒测试把软件当作“功能黑箱”，只关心输入和输出，不关注代码和逻辑。</p><p>常用于：功能测试、接口测试、系统测试、验收测试、性能测试、安全测试。</p><img src="/JasmineRain.github.io/2025/11/04/%E9%BB%91%E7%9B%92%E6%B5%8B%E8%AF%95/black-box-testing.png" class="" title="黑盒测试关系"><h2 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h2><ol><li><p>理解需求：阅读需求说明、用户故事，产出需求分析报告</p></li><li><p>识别功能点：列出所有功能模块与场景，产出功能列表</p></li><li><p>设计测试用例：使用等价类、边界值方法，产出测试用例文档</p></li><li><p>执行测试：手工或自动化测试，产出测试记录</p></li><li><p>缺陷管理：提交Bug、复测、验证，产出测试记录</p></li><li><p>回归测试：修复后再次验证影响范围，产出回归测试报告</p></li><li><p>测试总结：输出测试覆盖率等指标，产出测试总结报告</p></li></ol><h2 id="核心测试用例设计方法"><a href="#核心测试用例设计方法" class="headerlink" title="核心测试用例设计方法"></a>核心测试用例设计方法</h2><ul><li><strong>等价类划分</strong>：将输入分为有效等价类和无效等价类</li></ul><p>例如：年龄输入框(允许18~60)</p><table><thead><tr><th>类型</th><th>等价类</th><th>测试值</th></tr></thead><tbody><tr><td>有效</td><td>18~60</td><td>25</td></tr><tr><td>无效</td><td>&lt;18</td><td>10</td></tr><tr><td>无效</td><td>&gt;60</td><td>70</td></tr><tr><td>无效</td><td>空输入、特殊字符</td><td>“”、”abc”</td></tr></tbody></table><ul><li><p><strong>边界值分析</strong>：错误最可能发生在边界附近，测试<code>min</code>、<code>min+1</code>、<code>min-1</code>、<code>max</code>、<code>max+1</code>、<code>max-1</code></p></li><li><p><strong>判定表法</strong>：条件组合逻辑</p></li><li><p><strong>状态迁移测试</strong>：登录失败次数、订单流程、权限切换</p></li><li><p><strong>错误推测法</strong>：经验法</p></li></ul><h2 id="相关工具"><a href="#相关工具" class="headerlink" title="相关工具"></a>相关工具</h2><p>用例管理（测试流程管理）：TestLink、禅道，Tapd</p><p>接口测试（REST API测试）：Postman、JMeter</p><p>自动化测试（UI测试）：Selenium、Appium、Playwright</p><p>缺陷管理（bug跟踪）：禅道、Jira</p>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 黑盒测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>敏捷开发</title>
      <link href="/JasmineRain.github.io/2025/11/04/%E6%95%8F%E6%8D%B7%E5%BC%80%E5%8F%91/"/>
      <url>/JasmineRain.github.io/2025/11/04/%E6%95%8F%E6%8D%B7%E5%BC%80%E5%8F%91/</url>
      
        <content type="html"><![CDATA[<p>敏捷开发是一种软件开发思想，目标是：快速交付高质量软件，并能灵活应对需求变化。</p><p>它来自2001年的《敏捷宣言》，重视：个体互动、可工作的软件、客户合作、响应变化。特点：灵活、沟通、反馈、持续改进。</p><p>敏捷开发主要采用迭代式开发（Iteration）或冲刺开发（Sprint），每个Sprint通常为2~4周。</p><p>流程：需求收集-&gt;计划会议-&gt;迭代开发-&gt;每日站会-&gt;测试与评审-&gt;迭代回顾</p><ul><li>需求收集：由产品经理或客户提出的功能需求，每个需求写成用户故事</li><li>计划会议：团队从产品代办列表中选择本次迭代要做的任务，明确每个任务的负责人和完成标准</li><li>迭代开发：团队在固定周期内实现功能，每日站立开会，每人回答昨天做了什么、今天准备做什么、有什么问题或障碍</li><li>测评与评审：展示完成的功能，让客户或产品负责人进行评审并给出反馈</li><li>回顾会议：团队思考本次迭代中，哪些做的好，如何改进，如何更高效</li></ul><h2 id="常见框架"><a href="#常见框架" class="headerlink" title="常见框架"></a>常见框架</h2><ol><li>Scrum（最常见）<br>事件：Sprint、每日站会、评审会、回顾会</li><li>Kanban（看板方法）<br>永可视化“任务流”管理开发状态<br>to do-&gt;doing-&gt;done</li><li>XP（Extreme Programming，极限编程）<br>偏重技术实践：测试驱动开发（TDD）、持续集成（CI）、结对编程、重构与代码质量</li></ol><h2 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h2><p>灵活性高、快速响应变化；客户反馈及时、风险可控；提高质量与透明度</p><h2 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h2><p>不适合需求非常固定的大型项目；团队沟通成本高；缺乏经验的团队容易混乱</p>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 敏捷开发 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>多线程</title>
      <link href="/JasmineRain.github.io/2025/11/03/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
      <url>/JasmineRain.github.io/2025/11/03/%E5%A4%9A%E7%BA%BF%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h2><p>线程：进程内的执行单元，拥有自己的栈、寄存器、程序计数器，但与同一进程的其他线程共享地址空间</p><p>目的：并发执行以提高吞吐、利用多核、改善响应性、表达并发逻辑。</p><h2 id="线程实现层次"><a href="#线程实现层次" class="headerlink" title="线程实现层次"></a>线程实现层次</h2><p>内核线程：由OS内核调度。线程创建&#x2F;切换开销大，但能利用多核。</p><p>用户级线程：由用户态库调度，切换快但不能利用多个CPU（除非映射到内核线程）。</p><p>混合模型：库把用户线程映射到多个内核线程。</p><h2 id="线程生命周期"><a href="#线程生命周期" class="headerlink" title="线程生命周期"></a>线程生命周期</h2><p>创建、可运行、运行、阻塞&#x2F;等待、终止</p><h2 id="主要同步原语（及用途）"><a href="#主要同步原语（及用途）" class="headerlink" title="主要同步原语（及用途）"></a>主要同步原语（及用途）</h2><p>互斥锁（Mutex&#x2F;Lock）：保护临界区，确保同时只有一个线程访问共享资源</p><p>自旋锁（Spinlock）：短期等待适用，忙等而不阻塞内核调度</p><p>读写锁（RWLock）：允许多个读者并行、写者独占。适合读多写少的场景</p><p>信号量（Semaphore）：计数资源控制</p><p>条件变量（Condition Variable）：线程A等待某条件，线程B改变条件并通知</p><p>屏障（Barrier）：多线程在屏障处同步，全部到达后继续</p><p>原子操作（Atomic）：无需锁的原子读写&#x2F;更新</p><p>内存栅栏&#x2F;屏障（Memory Barrier）：强制内存操作顺序，防止编译器&#x2F;CPU重排</p><h2 id="内存模型与可见性"><a href="#内存模型与可见性" class="headerlink" title="内存模型与可见性"></a>内存模型与可见性</h2><p>可见性（Visibility）：一个线程写的变量何时对其他线程可见？需要同步手段（锁&#x2F;原子&#x2F;volatile 在不同语言中）。</p><p>重排序（Reordering）：编译器和 CPU 会重排指令以优化，可能导致并发错误；必须通过同步原语保证happens-before关系（即保证发生顺序）。</p><p>happens-before：一种形式化的关系（Java 内存模型等），若 A happens-before B，则 A 的结果对 B 可见、并发不引发数据竞争。</p><p>数据竞争（Data Race）：至少两个线程访问同一内存位置且至少一个为写且无同步，结果未定义&#x2F;不可预测。</p><h2 id="常见并发问题与成因"><a href="#常见并发问题与成因" class="headerlink" title="常见并发问题与成因"></a>常见并发问题与成因</h2><p>竞态条件（Race Condition）：对共享状态的无同步访问造成不确定行为。</p><p>死锁（Deadlock）：两个或多个线程互相等待对方持有的资源，永远阻塞。四个必要条件：互斥、保持并等待、不可抢占、循环等待。</p><p>活锁（Livelock）：线程不断响应对方而导致无法前进（状态在变，但没有实质进展）。</p><p>饥饿（Starvation）：某线程长期得不到资源（如优先级反转）。</p><p>优先级反转（Priority Inversion）：低优先级持有资源阻塞高优先级，导致调度问题。</p><h2 id="并发设计模式"><a href="#并发设计模式" class="headerlink" title="并发设计模式"></a>并发设计模式</h2><p>生产者-消费者（Producer-Consumer）：缓冲队列 + 条件&#x2F;信号量。</p><p>工作者池 &#x2F; 线程池（Worker Pool &#x2F; Thread Pool）：固定&#x2F;弹性线程处理任务队列，避免频繁创建销毁线程。</p><p>任务&#x2F;事件驱动（Event Loop &#x2F; Reactor）：单线程处理 IO 事件，用异步回调或协程。</p><p>Fork-Join（分治并行）：递归分割任务，多线程并行处理再合并（用于并行排序、并行求和）。</p><p>Immutable Objects（不可变对象）：避免共享可变状态，减少同步需求。</p><p>消息传递（Actor &#x2F; Queue）：线程间通过消息通信而不是共享内存，减少竞争。</p><h2 id="性能与开销考量"><a href="#性能与开销考量" class="headerlink" title="性能与开销考量"></a>性能与开销考量</h2><p>线程创建&#x2F;销毁成本高，频繁操作应使用线程池。</p><p>锁的粒度：粗锁简单但并发度低；细锁复杂但并发度高（应权衡）。</p><p>锁争用会导致上下文切换、缓存一致性开销（cache-coherence）。</p><p>使用原子操作与无锁算法可以在高并发场景下提高性能，但实现更复杂并易错。</p><p>过度并发（线程数远超 CPU 核数）会因调度开销导致性能下降——一般线程数 ≈ CPU 核数 × (1 + I&#x2F;O比) 为起点。</p><h2 id="调试、检测与工具"><a href="#调试、检测与工具" class="headerlink" title="调试、检测与工具"></a>调试、检测与工具</h2><p>日志 + 线程 id + 时间戳：记录关键操作与锁获取释放，帮助定位竞态与死锁。</p><p>静态分析工具：如 ThreadSanitizer（TSAN）、Java 的 FindBugs&#x2F;SpotBugs、数据竞争检测器等。</p><p>死锁检测：在运行时打印锁等待链；很多 JVM 提供死锁检测（jstack）。</p><p>单步缩小问题：把并发简化成最小复现用例（最容易发现竞态）。</p><p>重试&#x2F;随机化测试（fuzzing）：随机改变调度、延时，暴露时间相关 bug。</p><h2 id="语言层面差异"><a href="#语言层面差异" class="headerlink" title="语言层面差异"></a>语言层面差异</h2><p>C&#x2F;C++（C++11 起）：<code>std::thread</code>, <code>std::mutex</code>, <code>std::unique_lock</code>, <code>std::condition_variable</code>, <code>std::atomic</code>。需要注意内存序（memory_order）。</p><p>Java：<code>Thread</code>, <code>Runnable/Callable</code>, <code>synchronized</code>, <code>ReentrantLock</code>, <code>volatile</code>, <code>AtomicInteger/Long</code>, <code>ExecutorService</code>, 并发集合（<code>ConcurrentHashMap</code>、<code>BlockingQueue</code> 等）。Java 有严格的内存模型（JMM）。</p><p>Python：<code>threading</code> 模块易用，但受 GIL（Global Interpreter Lock）限制，CPU 密集型任务不并行，通常用 <code>multiprocessing</code> 或用 C 扩展&#x2F;或使用 Jython&#x2F;IronPython。</p><p>Go：轻量级 goroutine + channel（消息传递）为主，鼓励“不要通过共享内存通信，而通过通信来共享内存”。</p><p>Rust：在类型系统层面做很多并发安全检查（Send&#x2F;Sync），鼓励无数据竞争代码。</p><h2 id="生产者-消费者代码"><a href="#生产者-消费者代码" class="headerlink" title="生产者-消费者代码"></a>生产者-消费者代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用BlockingQueue</span></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProdCons</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        BlockingQueue&lt;Integer&gt; q = <span class="keyword">new</span> <span class="title class_">ArrayBlockingQueue</span>&lt;&gt;(<span class="number">10</span>);</span><br><span class="line">        <span class="type">ExecutorService</span> <span class="variable">es</span> <span class="operator">=</span> Executors.newFixedThreadPool(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Producer</span></span><br><span class="line">        es.submit(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">100</span>;i++) &#123;</span><br><span class="line">                    q.put(i);</span><br><span class="line">                    System.out.println(<span class="string">&quot;Produced &quot;</span> + i);</span><br><span class="line">                &#125;</span><br><span class="line">                q.put(-<span class="number">1</span>); <span class="comment">// sentinel</span></span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123; Thread.currentThread().interrupt(); &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Consumer</span></span><br><span class="line">        es.submit(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                    <span class="type">int</span> <span class="variable">v</span> <span class="operator">=</span> q.take();</span><br><span class="line">                    <span class="keyword">if</span> (v == -<span class="number">1</span>) &#123; q.put(-<span class="number">1</span>); <span class="keyword">break</span>; &#125;</span><br><span class="line">                    System.out.println(<span class="string">&quot;Consumed &quot;</span> + v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123; Thread.currentThread().interrupt(); &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        es.shutdown();</span><br><span class="line">        es.awaitTermination(<span class="number">1</span>, TimeUnit.MINUTES);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//mutex+condition_variable实现简单队列</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;thread&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;mutex&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;condition_variable&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line">std::queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">std::mutex m;</span><br><span class="line">std::condition_variable cv;</span><br><span class="line"><span class="type">bool</span> finished = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">producer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">100</span>;i++) &#123;</span><br><span class="line">        <span class="function">std::unique_lock&lt;std::mutex&gt; <span class="title">lk</span><span class="params">(m)</span></span>;</span><br><span class="line">        q.<span class="built_in">push</span>(i);</span><br><span class="line">        lk.<span class="built_in">unlock</span>();</span><br><span class="line">        cv.<span class="built_in">notify_one</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">std::unique_lock&lt;std::mutex&gt; <span class="title">lk</span><span class="params">(m)</span></span>;</span><br><span class="line">    finished = <span class="literal">true</span>;</span><br><span class="line">    lk.<span class="built_in">unlock</span>();</span><br><span class="line">    cv.<span class="built_in">notify_all</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">consumer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="function">std::unique_lock&lt;std::mutex&gt; <span class="title">lk</span><span class="params">(m)</span></span>;</span><br><span class="line">        cv.<span class="built_in">wait</span>(lk, []&#123; <span class="keyword">return</span> !q.<span class="built_in">empty</span>() || finished; &#125;);</span><br><span class="line">        <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> v = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;Consumed &quot;</span> &lt;&lt; v &lt;&lt; std::endl;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (finished) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">std::thread <span class="title">p</span><span class="params">(producer)</span></span>;</span><br><span class="line">    <span class="function">std::thread <span class="title">c</span><span class="params">(consumer)</span></span>;</span><br><span class="line">    p.<span class="built_in">join</span>();</span><br><span class="line">    c.<span class="built_in">join</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#GIL</span></span><br><span class="line"><span class="comment">#CPU密集型应使用`multiprocessing或在其他语言实现并行`</span></span><br><span class="line"><span class="keyword">import</span> threading, queue, time</span><br><span class="line"></span><br><span class="line">q = queue.Queue()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">producer</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        q.put(i)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;produced&#x27;</span>, i)</span><br><span class="line">        time.sleep(<span class="number">0.01</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">consumer</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        item = q.get()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;consumed&#x27;</span>, item)</span><br><span class="line">        q.task_done()</span><br><span class="line">        <span class="keyword">if</span> item == <span class="number">9</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">t1 = threading.Thread(target=producer)</span><br><span class="line">t2 = threading.Thread(target=consumer)</span><br><span class="line">t1.start(); t2.start()</span><br><span class="line">t1.join(); t2.join()</span><br></pre></td></tr></table></figure><h2 id="无锁与lock-free"><a href="#无锁与lock-free" class="headerlink" title="无锁与lock-free"></a>无锁与lock-free</h2><p>无锁（lock-free）：任意时刻至少有一个线程能完成操作（避免全体阻塞）。</p><p>无阻塞（wait-free）：所有线程在有限步骤内完成操作（最强）。</p><p>实现通常依赖硬件原子操作（CAS、LL&#x2F;SC）。实现难、需要考虑 ABA 问题（可用版本号或双宽 CAS、hazard pointers、epoch GC 等解决）。</p><blockquote><p>常见误区<br>“加锁就安全” —— 锁必须覆盖所有访问点；不一致加锁仍会出问题。<br>“volatile 可以代替锁” —— volatile（Java）保证可见性但不能保证复合操作的原子性（如 x++）。<br>“更多线程总更快” —— 超过合理数量会因上下文切换、缓存抖动而慢。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 多线程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 多线程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCode Question Solve Trip</title>
      <link href="/JasmineRain.github.io/2025/10/28/LeetCode-Question-Solve-Trip/"/>
      <url>/JasmineRain.github.io/2025/10/28/LeetCode-Question-Solve-Trip/</url>
      
        <content type="html"><![CDATA[<h2 id="1-Two-Sum"><a href="#1-Two-Sum" class="headerlink" title="1.Two Sum"></a>1.Two Sum</h2><p><a href="https://leetcode.com/problems/two-sum/description/">Description of the problem</a></p><ul><li>双循环遍历</li></ul><p>时间复杂度：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p><p>空间复杂度：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">twoSum</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> target)</span> </span>&#123;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt;ans;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;nums.<span class="built_in">size</span>()<span class="number">-1</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=i<span class="number">+1</span>;j&lt;nums.<span class="built_in">size</span>();j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(nums[i]+nums[j]==target)&#123;</span><br><span class="line">                    ans.<span class="built_in">push_back</span>(i);</span><br><span class="line">                    ans.<span class="built_in">push_back</span>(j);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li>哈希表</li></ul><p>时间复杂度：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></p><p>空间复杂度：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">twoSum</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> target)</span> </span>&#123;</span><br><span class="line">        unordered_map&lt;<span class="type">int</span>,<span class="type">int</span>&gt;mp;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;nums.<span class="built_in">size</span>();++i)&#123;</span><br><span class="line">            <span class="type">int</span> com=target-nums[i];</span><br><span class="line">            <span class="keyword">if</span>(mp.<span class="built_in">find</span>(com)!=mp.<span class="built_in">end</span>())&#123;</span><br><span class="line">                <span class="keyword">return</span> &#123;mp[com],i&#125;;</span><br><span class="line">            &#125;</span><br><span class="line">            mp[nums[i]]=i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="Add-Two-Numbers"><a href="#Add-Two-Numbers" class="headerlink" title="Add Two Numbers"></a>Add Two Numbers</h2><p><a href="https://leetcode.com/problems/add-two-numbers/description/">Description of the problem</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * struct ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     ListNode *next;</span></span><br><span class="line"><span class="comment"> *     ListNode() : val(0), next(nullptr) &#123;&#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int x) : val(x), next(nullptr) &#123;&#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int x, ListNode *next) : val(x), next(next) &#123;&#125;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">addTwoNumbers</span><span class="params">(ListNode* l1, ListNode* l2)</span> </span>&#123;</span><br><span class="line">        ListNode* d=<span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">0</span>);</span><br><span class="line">        ListNode* c=d;</span><br><span class="line">        <span class="type">int</span> have=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(l1!=<span class="literal">nullptr</span>||l2!=<span class="literal">nullptr</span>||have)&#123;</span><br><span class="line">            <span class="type">int</span> sum=have;</span><br><span class="line">            <span class="keyword">if</span>(l1)&#123;</span><br><span class="line">                sum+=l1-&gt;val;</span><br><span class="line">                l1=l1-&gt;next;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(l2)&#123;</span><br><span class="line">                sum+=l2-&gt;val;</span><br><span class="line">                l2=l2-&gt;next;</span><br><span class="line">            &#125;</span><br><span class="line">            have=sum/<span class="number">10</span>;</span><br><span class="line">            c-&gt;next=<span class="keyword">new</span> <span class="built_in">ListNode</span>(sum%<span class="number">10</span>);</span><br><span class="line">            c=c-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> d-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="Longest-Substring-Without-Repeating-Characters"><a href="#Longest-Substring-Without-Repeating-Characters" class="headerlink" title="Longest Substring Without Repeating Characters"></a>Longest Substring Without Repeating Characters</h2><p><a href="https://leetcode.com/problems/longest-substring-without-repeating-characters/description/">Description of the problem</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//滑动窗口</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">lengthOfLongestSubstring</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        unordered_map&lt;<span class="type">char</span>,<span class="type">int</span>&gt;index;</span><br><span class="line">        <span class="type">int</span> k=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;s.<span class="built_in">size</span>();++i)&#123;</span><br><span class="line">            <span class="keyword">if</span>(index.<span class="built_in">count</span>(s[i])&amp;&amp;index[s[i]]&gt;=k)&#123;</span><br><span class="line">                k=index[s[i]]<span class="number">+1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            index[s[i]]=i;</span><br><span class="line">            ans=<span class="built_in">max</span>(ans,i-k<span class="number">+1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="Median-of-Two-Sorted-Arrays"><a href="#Median-of-Two-Sorted-Arrays" class="headerlink" title="Median of Two Sorted Arrays"></a>Median of Two Sorted Arrays</h2><p><a href="https://leetcode.com/problems/median-of-two-sorted-arrays/description/">Description of the problem</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Algorithm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Go常见函数</title>
      <link href="/JasmineRain.github.io/2025/10/20/Go%E5%B8%B8%E8%A7%81%E5%87%BD%E6%95%B0/"/>
      <url>/JasmineRain.github.io/2025/10/20/Go%E5%B8%B8%E8%A7%81%E5%87%BD%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<ul><li>删除字符串首尾所有的空白字符(包括空格、制表符、换行符)</li></ul><p>strings.TrimSpace(s)</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;strings&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    s := <span class="string">&quot;Hello World   &quot;</span>   <span class="comment">// 末尾有空格</span></span><br><span class="line">    result := strings.TrimSpace(s)</span><br><span class="line">    fmt.Printf(<span class="string">&quot;[%s]\n&quot;</span>, result)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>删除字符串右边的空格</li></ul><p>strings.TrimRight(s,” “)</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">s := <span class="string">&quot;  Hello World   &quot;</span></span><br><span class="line">res := strings.TrimRight(s, <span class="string">&quot; &quot;</span>)</span><br><span class="line">fmt.Printf(<span class="string">&quot;[%s]\n&quot;</span>, res)</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>删除字符串开头的空格</li></ul><p>strings.TrimLeft(s,” “)</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">s := <span class="string">&quot;   Hello World  &quot;</span></span><br><span class="line">res := strings.TrimLeft(s, <span class="string">&quot; &quot;</span>)</span><br><span class="line">fmt.Printf(<span class="string">&quot;[%s]\n&quot;</span>, res)</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>删除字符串所有的空格(包括中间的)</li></ul><p>strings.ReplaceAll(s,” “,””)</p>]]></content>
      
      
      
        <tags>
            
            <tag> Go </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Go命令行操作</title>
      <link href="/JasmineRain.github.io/2025/10/20/Go%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%93%8D%E4%BD%9C/"/>
      <url>/JasmineRain.github.io/2025/10/20/Go%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">go</span> version<span class="comment">//检查Go是否安装</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> env<span class="comment">//查看环境配置</span></span><br><span class="line"></span><br><span class="line">mkdir myapp<span class="comment">//新建文件夹</span></span><br><span class="line">cd myapp</span><br><span class="line"><span class="keyword">go</span> mod init myapp<span class="comment">//初始化模块</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> list -m all<span class="comment">//查看依赖</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> get -u github.com/gin-gonic/gin<span class="comment">//更新依赖</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> run main.<span class="keyword">go</span><span class="comment">//运行程序</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> build<span class="comment">//生成可执行文件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> build -o server.exe main.<span class="keyword">go</span><span class="comment">//编译并指定输出文件名</span></span><br><span class="line">server.exe<span class="comment">//执行二进制文件(Windows)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> list<span class="comment">//查看当前包依赖</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> mod tidy<span class="comment">//下载依赖包</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> test<span class="comment">//测试</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> test -v<span class="comment">//带详细输出的测试</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> doc fmt<span class="comment">//查看包文档</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> doc fmt.Println<span class="comment">//查看函数文档</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> get &lt;pkg&gt;<span class="comment">//下载依赖包</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> install<span class="comment">//编译并安装包到GOBIN</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> clean<span class="comment">//清除编译缓存</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> fmt<span class="comment">//自动格式化代码</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> vet<span class="comment">//检查潜在错误</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> doc<span class="comment">//查看官方文档</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> list<span class="comment">//查看包信息</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Go </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TCP中何时会出现RST(reset)报文?</title>
      <link href="/JasmineRain.github.io/2025/10/10/TCP%E4%B8%AD%E4%BD%95%E6%97%B6%E4%BC%9A%E5%87%BA%E7%8E%B0RST-reset-%E6%8A%A5%E6%96%87/"/>
      <url>/JasmineRain.github.io/2025/10/10/TCP%E4%B8%AD%E4%BD%95%E6%97%B6%E4%BC%9A%E5%87%BA%E7%8E%B0RST-reset-%E6%8A%A5%E6%96%87/</url>
      
        <content type="html"><![CDATA[<h2 id="什么是TCP-RST报文"><a href="#什么是TCP-RST报文" class="headerlink" title="什么是TCP RST报文?"></a>什么是TCP RST报文?</h2><p>RST报文段是TCP协议中的一个控制标志位，代表：</p><blockquote><p>连接出现异常，立即中断当前连接</p></blockquote><p>也就是说，RST&#x3D;强制断开连接<br>它不经过四次挥手，而是直接告诉对方：别再发了，这个连接无效</p><p>RST报文是TCP协议中用来终止一个连接的报文。当一个TCP连接出现异常时，比如主机崩溃、网络中断、连接超时等，TCP会向另一端发送一个RST报文来终止连接。</p><h2 id="RST报文的常见触发时机"><a href="#RST报文的常见触发时机" class="headerlink" title="RST报文的常见触发时机"></a>RST报文的常见触发时机</h2><p>我们可以分为三大类：无效连接、异常关闭、应用层拒绝</p><h3 id="对方不存在的连接"><a href="#对方不存在的连接" class="headerlink" title="对方不存在的连接"></a>对方不存在的连接</h3><p>场景：收到非预期的TCP报文</p><ul><li>服务器端口没在监听(没有listen())</li><li>客户端乱发了一个SYN以外的数据包</li><li>收到数据的连接在本地不存在(比如已经被关闭)</li></ul><p>常见原因：</p><ul><li>程序没启动，端口没监听</li><li>应用崩溃，socket已释放</li><li>收到过期的包(老连接的残余包)</li></ul><h3 id="非正常关闭连接时"><a href="#非正常关闭连接时" class="headerlink" title="非正常关闭连接时"></a>非正常关闭连接时</h3><p>场景：进程提前关闭socket，但仍有数据到达</p><ul><li>应用层超时关闭，但对方还在发包</li><li>系统异常断开连接(如kill进程)</li></ul><h3 id="应用层主动拒绝连接-listen拒绝"><a href="#应用层主动拒绝连接-listen拒绝" class="headerlink" title="应用层主动拒绝连接(listen拒绝)"></a>应用层主动拒绝连接(listen拒绝)</h3><p>场景：服务器正在运行，但明确拒绝连接</p><p>例如：</p><ul><li>防火墙策略拒绝某个源IP</li><li>内核backlog队列满了(即TCP三次握手的SYN队列已满)</li></ul><p>这时：</p><ul><li>收到SYN</li><li>内核拒绝新连接-&gt;回复一个RST报文</li></ul><p>说明服务器活着，但是拒绝接受连接</p><h3 id="应用层主动触发RST"><a href="#应用层主动触发RST" class="headerlink" title="应用层主动触发RST"></a>应用层主动触发RST</h3><p>应用层可以通过设置socket选项来触发RST,比如：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setsockopt(sock, SOL_SOCKET, SO_LINGER, &amp;linger_opt, <span class="keyword">sizeof</span>(linger_opt));</span><br></pre></td></tr></table></figure><p>当:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">linger_opt.l_onoff = <span class="number">1</span>;</span><br><span class="line">linger_opt.l_linger = <span class="number">0</span>;</span><br><span class="line">close(sock);</span><br></pre></td></tr></table></figure><p>表示立即关闭连接并发送RST(而不是优雅挥手)</p><p>用于：</p><ul><li>快速中断阻塞连接</li><li>避免TIME_WAIT堆积</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> 计算机网络 </tag>
            
            <tag> 八股 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>两个进程间需要交换大量数据时，有哪些合适的进程间通信手段？</title>
      <link href="/JasmineRain.github.io/2025/09/25/%E4%B8%A4%E4%B8%AA%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%9C%80%E8%A6%81%E4%BA%A4%E6%8D%A2%E5%A4%A7%E9%87%8F%E6%95%B0%E6%8D%AE%E6%97%B6%EF%BC%8C%E6%9C%89%E5%93%AA%E4%BA%9B%E5%90%88%E9%80%82%E7%9A%84%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1%E6%89%8B%E6%AE%B5%EF%BC%9F/"/>
      <url>/JasmineRain.github.io/2025/09/25/%E4%B8%A4%E4%B8%AA%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%9C%80%E8%A6%81%E4%BA%A4%E6%8D%A2%E5%A4%A7%E9%87%8F%E6%95%B0%E6%8D%AE%E6%97%B6%EF%BC%8C%E6%9C%89%E5%93%AA%E4%BA%9B%E5%90%88%E9%80%82%E7%9A%84%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1%E6%89%8B%E6%AE%B5%EF%BC%9F/</url>
      
        <content type="html"><![CDATA[<h2 id="共享内存-首选"><a href="#共享内存-首选" class="headerlink" title="共享内存(首选)"></a>共享内存(首选)</h2><p>两个进程通过<code>mmap</code>、<code>shmget/shmat</code>或POSIX<code>shm_open</code>共享一块物理内存。常用于数据库缓冲区、视频播放器编解码和渲染器之间。</p><p>优点：</p><ul><li>直接在同一块内存区读写，不需要内核反复拷贝，最快。</li><li>特别适合<strong>大文件传输、大矩阵&#x2F;图像&#x2F;音视频流</strong></li></ul><p>缺点：</p><ul><li>需要额外同步机制(信号量&#x2F;互斥锁&#x2F;自旋锁)来保证读写有序</li></ul><h2 id="内存映射文件"><a href="#内存映射文件" class="headerlink" title="内存映射文件"></a>内存映射文件</h2><p>两个进程通过<code>mmap</code>将同一文件映射到自己的虚拟地址空间。常用于日志文件共享、大规模只读数据加载</p><p>优点：</p><ul><li>适合<strong>大文件共享</strong>，只在缺页时才加载，减少不必要的拷贝</li><li>在文件系统支持下可实现持久化</li></ul><p>缺点：</p><ul><li>需要磁盘I&#x2F;O(虽然有页缓存优化)</li></ul><h2 id="管道"><a href="#管道" class="headerlink" title="管道"></a>管道</h2><p>数据通过内核缓冲区传输，单向流式通信。常用于命令行进程链<code>ls | grep | sort</code></p><p>优点：</p><ul><li>简单，使用方便</li></ul><p>缺点：</p><ul><li>内核态到用户态有拷贝，<strong>效率远低于共享内存</strong></li><li>缓冲区有限，不适合超大数据</li></ul><h2 id="嵌套字-Socket-本地Unix-Domain-Socket"><a href="#嵌套字-Socket-本地Unix-Domain-Socket" class="headerlink" title="嵌套字(Socket,本地Unix Domain Socket)"></a>嵌套字(Socket,本地Unix Domain Socket)</h2><p>两个进程通过<code>socketpair</code>或<code>AF_UNIX</code>通信。常用于Nginx、数据库客户端与服务端通信</p><p>优点：</p><ul><li>接口统一，可拓展到分布式(TCP&#x2F;UDP)</li><li>本地Unix Scoket支持<strong>零拷贝</strong></li></ul><p>缺点：</p><ul><li>相比共享内存，仍有内核开销</li></ul><h2 id="消息队列"><a href="#消息队列" class="headerlink" title="消息队列"></a>消息队列</h2><p>进程通过内核消息队列传递结构化消息。常用于控制消息(小数据包)，比如RPC通知</p><p>优点：</p><ul><li>支持消息边界，方便管理</li></ul><p>缺点：</p><ul><li><strong>大数据会分块发送</strong>，仍存在内核缓冲区拷贝，不适合大规模数据</li></ul><h2 id="信号"><a href="#信号" class="headerlink" title="信号"></a>信号</h2><p>异步通知。典型场景：告诉另一个进程有新数据了。</p><p>优点：</p><ul><li>轻量级</li></ul><p>缺点：</p><ul><li>仅适合事件通知，不适合传输数据</li></ul><h2 id="对比总结"><a href="#对比总结" class="headerlink" title="对比总结"></a>对比总结</h2><table><thead><tr><th>方式</th><th>是否适合大数据</th><th>速度&#x2F;开销</th><th>是否需要同步机制</th><th>场景举例</th></tr></thead><tbody><tr><td>共享内存</td><td>最适合</td><td>最高效</td><td>需要(锁&#x2F;信号量)</td><td>图像&#x2F;视频&#x2F;矩阵计算</td></tr><tr><td>内存映射文件</td><td>适合</td><td>较快</td><td>部分需要</td><td>大型数据文件共享</td></tr><tr><td>管道&#x2F;FIFO</td><td>小数据为主</td><td>中等</td><td>不需要</td><td>进程链</td></tr><tr><td>消息队列</td><td>小消息为主</td><td>中等</td><td>内置同步</td><td>RPC&#x2F;任务调度</td></tr><tr><td>Uinx Socket</td><td>可用</td><td>中等偏快</td><td>不需要</td><td>客户端-服务端</td></tr><tr><td>信号</td><td>事件通知用</td><td>轻量</td><td>不涉及</td><td>状态变化通知</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 操作系统 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 八股 </tag>
            
            <tag> c++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>质数查找算法</title>
      <link href="/JasmineRain.github.io/2025/09/23/%E8%B4%A8%E6%95%B0%E6%9F%A5%E6%89%BE%E7%AE%97%E6%B3%95/"/>
      <url>/JasmineRain.github.io/2025/09/23/%E8%B4%A8%E6%95%B0%E6%9F%A5%E6%89%BE%E7%AE%97%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h2 id="朴素判断查找"><a href="#朴素判断查找" class="headerlink" title="朴素判断查找"></a>朴素判断查找</h2><p>。。。略</p><h2 id="埃拉托斯特尼筛法-埃式筛-Sieve-of-Eratosthenes"><a href="#埃拉托斯特尼筛法-埃式筛-Sieve-of-Eratosthenes" class="headerlink" title="埃拉托斯特尼筛法(埃式筛,Sieve of Eratosthenes)"></a>埃拉托斯特尼筛法(埃式筛,Sieve of Eratosthenes)</h2><h3 id="核心思想"><a href="#核心思想" class="headerlink" title="核心思想"></a>核心思想</h3><p>从小到大标记合数，未被标记的就是质数</p><h3 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h3><p>竞赛常用范围<code>n&lt;=1e7</code></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e7</span>;</span><br><span class="line"><span class="type">bool</span> isPrime[N<span class="number">+1</span>];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt;primes;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sieve</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="built_in">fill</span>(isPrime,isPrime+n<span class="number">+1</span>,<span class="literal">true</span>);</span><br><span class="line">    isPrime[<span class="number">0</span>]=isPrime[<span class="number">1</span>]=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i*i&lt;=n;++i)&#123;</span><br><span class="line">        <span class="keyword">if</span>(isPrime[i])&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=i*i;j&lt;=n;j+=i)&#123;</span><br><span class="line">                isPrime[j]=<span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i)&#123;</span><br><span class="line">        <span class="keyword">if</span>(isPrime[i])</span><br><span class="line">            primes.<span class="built_in">push_back</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="线性筛-欧拉筛，Linear-Sieve"><a href="#线性筛-欧拉筛，Linear-Sieve" class="headerlink" title="线性筛(欧拉筛，Linear Sieve)"></a>线性筛(欧拉筛，Linear Sieve)</h2><p>优化版筛法，保证每个合数只被<strong>最小质因子</strong>标记一次,比埃式筛快</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e7</span>;</span><br><span class="line"><span class="type">int</span> isPrime[N<span class="number">+1</span>];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt;primes;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">linearSieve</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!isPrime[i])primes.<span class="built_in">push_back</span>(i);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> p:primes)&#123;</span><br><span class="line">            <span class="keyword">if</span>(p*i&gt;n)<span class="keyword">break</span>;</span><br><span class="line">            isPrime[p*i]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i%p==<span class="number">0</span>)<span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="分段筛法-Segmented-Sieve"><a href="#分段筛法-Segmented-Sieve" class="headerlink" title="分段筛法(Segmented Sieve)"></a>分段筛法(Segmented Sieve)</h2><p>用于范围很大(如<code>1e12</code>)但只查某个区间<code>[L,R]</code></p><ol><li>先筛出<code>sqrt(R)</code>以内的质数</li><li>用这些质数去标记<code>[L,R]</code>内的合数</li><li>未被标记的就是质数</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">vector&lt;<span class="type">long</span> <span class="type">long</span>&gt; <span class="title">segmentedSieve</span><span class="params">(<span class="type">long</span> <span class="type">long</span> L, <span class="type">long</span> <span class="type">long</span> R)</span> </span>&#123;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> lim = <span class="built_in">sqrt</span>(R);</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; primes;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">mark</span><span class="params">(lim<span class="number">+1</span>, <span class="literal">true</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= lim; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (mark[i]) &#123;</span><br><span class="line">            primes.<span class="built_in">push_back</span>(i);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = i*i; j &lt;= lim; j += i) mark[j] = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">isPrime</span><span class="params">(R-L<span class="number">+1</span>, <span class="literal">true</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> p : primes) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">long</span> <span class="type">long</span> j = <span class="built_in">max</span>(<span class="number">1LL</span> * p * p, (L+p<span class="number">-1</span>)/p * <span class="number">1LL</span> * p); j &lt;= R; j += p)</span><br><span class="line">            isPrime[j-L] = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    vector&lt;<span class="type">long</span> <span class="type">long</span>&gt; res;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">long</span> <span class="type">long</span> i = <span class="number">0</span>; i &lt;= R-L; i++)</span><br><span class="line">        <span class="keyword">if</span> (isPrime[i] &amp;&amp; i+L &gt; <span class="number">1</span>) res.<span class="built_in">push_back</span>(i+L);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="Miller-Rabin素性测试-大数判质数"><a href="#Miller-Rabin素性测试-大数判质数" class="headerlink" title="Miller-Rabin素性测试(大数判质数)"></a>Miller-Rabin素性测试(大数判质数)</h2><ul><li>用于<code>1e18</code>级别的大数判质数</li><li>是一种<code>随机化/确定性算法</code>,比试除法快得多</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//常见模板，64位确定版</span></span><br><span class="line"><span class="function"><span class="type">long</span> <span class="type">long</span> <span class="title">mulmod</span><span class="params">(<span class="type">long</span> <span class="type">long</span> a, <span class="type">long</span> <span class="type">long</span> b, <span class="type">long</span> <span class="type">long</span> mod)</span> </span>&#123;</span><br><span class="line">    __int128 res = (__int128)a * b % mod;</span><br><span class="line">    <span class="keyword">return</span> (<span class="type">long</span> <span class="type">long</span>)res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">long</span> <span class="type">long</span> <span class="title">powmod</span><span class="params">(<span class="type">long</span> <span class="type">long</span> a, <span class="type">long</span> <span class="type">long</span> e, <span class="type">long</span> <span class="type">long</span> mod)</span> </span>&#123;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (e) &#123;</span><br><span class="line">        <span class="keyword">if</span> (e &amp; <span class="number">1</span>) res = <span class="built_in">mulmod</span>(res, a, mod);</span><br><span class="line">        a = <span class="built_in">mulmod</span>(a, a, mod);</span><br><span class="line">        e &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isPrime</span><span class="params">(<span class="type">long</span> <span class="type">long</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">2</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">long</span> <span class="type">long</span> p : &#123;<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">17</span>,<span class="number">19</span>,<span class="number">23</span>,<span class="number">29</span>,<span class="number">31</span>,<span class="number">37</span>&#125;) &#123;</span><br><span class="line">        <span class="keyword">if</span> (n%p == <span class="number">0</span>) <span class="keyword">return</span> n==p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> d = n<span class="number">-1</span>, s = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> ((d &amp; <span class="number">1</span>) == <span class="number">0</span>) d &gt;&gt;= <span class="number">1</span>, s++;</span><br><span class="line">    <span class="keyword">auto</span> check = [&amp;](<span class="type">long</span> <span class="type">long</span> a) &#123;</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> x = <span class="built_in">powmod</span>(a, d, n);</span><br><span class="line">        <span class="keyword">if</span> (x == <span class="number">1</span> || x == n<span class="number">-1</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> r = <span class="number">1</span>; r &lt; s; r++) &#123;</span><br><span class="line">            x = <span class="built_in">mulmod</span>(x, x, n);</span><br><span class="line">            <span class="keyword">if</span> (x == n<span class="number">-1</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">long</span> <span class="type">long</span> a : &#123;<span class="number">2</span>,<span class="number">325</span>,<span class="number">9375</span>,<span class="number">28178</span>,<span class="number">450775</span>,<span class="number">9780504</span>,<span class="number">1795265022</span>&#125;)</span><br><span class="line">        <span class="keyword">if</span> (a % n &amp;&amp; !<span class="built_in">check</span>(a)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 质数 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>位运算</title>
      <link href="/JasmineRain.github.io/2025/09/23/%E4%BD%8D%E8%BF%90%E7%AE%97/"/>
      <url>/JasmineRain.github.io/2025/09/23/%E4%BD%8D%E8%BF%90%E7%AE%97/</url>
      
        <content type="html"><![CDATA[<h2 id="常见用途"><a href="#常见用途" class="headerlink" title="常见用途"></a>常见用途</h2><ul><li>用整型得每一位表示集合&#x2F;状态(状态压缩&#x2F;子集枚举)</li><li>用异或解决[成对出现]类问题、前缀异或或计数子数组异或</li><li>用<code>lowbit</code>在树状数组、枚举子集优化中快速操作</li><li>用<code>bitset</code>做超快的背包&#x2F;集合操作，常把<code>o(n*S /word)</code>变成非常快的位并行</li><li>用位技巧做常数优化、逻辑判断(奇偶、是否是2的幂等)</li></ul><h2 id="tips"><a href="#tips" class="headerlink" title="tips"></a>tips</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 记得：对于超过 31 位的位运算用 1LL 或 1ULL</span></span><br><span class="line"><span class="type">int</span> test = (mask &amp; (<span class="number">1</span> &lt;&lt; k));    <span class="comment">// 测试第 k 位 (0-indexed)</span></span><br><span class="line">mask |= (<span class="number">1</span> &lt;&lt; k);                <span class="comment">// 将第 k 位置 1</span></span><br><span class="line">mask &amp;= ~(<span class="number">1</span> &lt;&lt; k);               <span class="comment">// 将第 k 位清 0</span></span><br><span class="line">mask ^= (<span class="number">1</span> &lt;&lt; k);                <span class="comment">// 切换（toggle）第 k 位</span></span><br><span class="line"><span class="type">int</span> lowbit = mask &amp; -mask;       <span class="comment">// 取最低位 1（lowbit），mask != 0</span></span><br><span class="line"><span class="type">int</span> cnt = __builtin_popcount(mask);      <span class="comment">// 32-bit 的 1 个数</span></span><br><span class="line"><span class="type">int</span> cnt64 = __builtin_popcountll(x);     <span class="comment">// 64-bit</span></span><br></pre></td></tr></table></figure><ul><li><code>1&lt;&lt;k</code>的类型是<code>int</code>;如果<code>k&gt;=31</code>(在32位int)会出现问题-&gt;用<code>1LL&lt;&lt;k</code>或<code>1ULL&lt;&lt;k</code></li><li>左移超出类型宽度是UB(underfined behavior)</li><li><code>lowbit</code>依赖二补码，C++&#x2F;Java可用</li></ul><h2 id="use"><a href="#use" class="headerlink" title="use"></a>use</h2><h3 id="判断奇偶"><a href="#判断奇偶" class="headerlink" title="判断奇偶"></a>判断奇偶</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(x&amp;<span class="number">1</span>)std::cout&lt;&lt;<span class="string">&quot;奇数&quot;</span>;</span><br><span class="line"><span class="keyword">else</span> std::cout&lt;&lt;<span class="string">&quot;偶数&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="判断是否为2的幂"><a href="#判断是否为2的幂" class="headerlink" title="判断是否为2的幂"></a>判断是否为2的幂</h3><blockquote><p><code>x&gt;0</code>,2的幂必须是正整数(1,2,4,8,…),首先排除<code>x&lt;=0</code>的情况<br>一个2的幂在二进制中只有一个1，其余全是0，<code>x-1</code>会把唯一的<code>1</code>变成<code>0</code>,同时右边的所有位都变成<code>1</code></p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isPowerOfTwo</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&gt;<span class="number">0</span> &amp;&amp; (x&amp;(x<span class="number">-1</span>))==<span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>也可以使用<code>__builtin_popcount(x)</code>统计x中1的个数也可以用来判断是否为2的幂<br><code>__builtin_popcount(x)</code>只适用于<code>unsigned int</code>，<strong><code>long long</code>需要使用<code>__builtin_popcountll(x)</code></strong><br>C++20可以使用<code>std::popcount((unsigned)x)</code></p></blockquote><h3 id="快速乘除"><a href="#快速乘除" class="headerlink" title="快速乘除"></a>快速乘除</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x&lt;&lt;k <span class="comment">//乘2^k</span></span><br><span class="line">x&gt;&gt;k <span class="comment">//除2^k(向下取整)</span></span><br></pre></td></tr></table></figure><h3 id="博弈论"><a href="#博弈论" class="headerlink" title="博弈论"></a>博弈论</h3><ul><li>Nim博弈、石子游戏常用异或：<ul><li>若所有堆的石子数异或和为0-&gt;先手必败</li><li>否则先手必胜</li></ul></li></ul><h3 id="汉明距离"><a href="#汉明距离" class="headerlink" title="汉明距离"></a>汉明距离</h3><p>计算两个整数的汉明距离<br>汉明距离&#x3D;异或后结果的二进制中1的个数</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">hamming</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123; <span class="keyword">return</span> __builtin_popcount(a ^ b); &#125;</span><br></pre></td></tr></table></figure><h3 id="枚举mask的所有非空子集"><a href="#枚举mask的所有非空子集" class="headerlink" title="枚举mask的所有非空子集"></a>枚举<code>mask</code>的所有非空子集</h3><blockquote><p>若要包含<code>0</code>：在循环外单独处理<code>0</code><br>复杂度：对于固定<code>mask</code>，迭代其子集的复杂度是<code>O(2^&#123;popcount(mask)&#125;)</code>。总体常见用于<code>n&lt;=20</code>的 DP&#x2F;枚举场景。<br>应用场景：状压 DP 中转移、枚举某一集合的划分、分块枚举。</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> s = mask; s; s = (s - <span class="number">1</span>) &amp; mask) &#123;</span><br><span class="line">    <span class="comment">// s 遍历 mask 的所有非零子集（包含 mask 本身，不包含 0）</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="状态DP"><a href="#状态DP" class="headerlink" title="状态DP"></a>状态DP</h3><blockquote><p>典型问题：TSP&#x2F;Hamilton 路径&#x2F;集合覆盖（n ≤ 16~20）<br>注意内存：<code>O(n*2^n)</code>，若 n&#x3D;20，约20* 1,048,576 ≈ 20M 状态，整型可行；n&gt;20 则需其他方法。</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//模板（求最短 Hamilton 路）：</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">1e9</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line">vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; dist; <span class="comment">// n x n</span></span><br><span class="line"><span class="type">int</span> N = <span class="number">1</span> &lt;&lt; n;</span><br><span class="line">vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">dp</span>(N, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(n, INF));</span><br><span class="line">dp[<span class="number">1</span> &lt;&lt; start][start] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> mask = <span class="number">0</span>; mask &lt; N; ++mask) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) <span class="keyword">if</span> (dp[mask][i] &lt; INF) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; ++j) <span class="keyword">if</span> (!(mask &amp; (<span class="number">1</span> &lt;&lt; j))) &#123;</span><br><span class="line">            dp[mask | (<span class="number">1</span> &lt;&lt; j)][j] = <span class="built_in">min</span>(dp[mask | (<span class="number">1</span> &lt;&lt; j)][j], dp[mask][i] + dist[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="异或操作"><a href="#异或操作" class="headerlink" title="异或操作"></a>异或操作</h3><blockquote><p>找唯一数（所有数出现两次，只有一个出现一次）</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> x:a)ans^=x;</span><br></pre></td></tr></table></figure><blockquote><p>找两个只出现一次的数（其余出现两次）</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> xorsum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (x : a) xorsum ^= x;</span><br><span class="line"><span class="type">int</span> low = xorsum &amp; -xorsum;</span><br><span class="line"><span class="type">int</span> a1 = <span class="number">0</span>, a2 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (x : a) &#123;</span><br><span class="line">    <span class="keyword">if</span> (x &amp; low) a1 ^= x;</span><br><span class="line">    <span class="keyword">else</span> a2 ^= x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>子数组异或等于 K（前缀 xor + hash）<br>对于计数 pairs<code>ai ^ aj == k</code>（i &lt; j）：用哈希表统计出现次数：<code>ans += cnt[ai ^ k]</code>，然后 <code>cnt[ai]++</code></p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="type">long</span> ans = <span class="number">0</span>;</span><br><span class="line">unordered_map&lt;<span class="type">int</span>,<span class="type">int</span>&gt; cnt;</span><br><span class="line">cnt[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> px = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> x : a) &#123;</span><br><span class="line">    px ^= x;</span><br><span class="line">    ans += cnt[px ^ K];</span><br><span class="line">    cnt[px]++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="SOS-DP"><a href="#SOS-DP" class="headerlink" title="SOS DP"></a>SOS DP</h3><blockquote><p>用途：给 <code>f[mask]</code>，想要对每个 mask 求 <code>g[mask] = sum_&#123;s ⊆ mask&#125; f[s]</code>(或类似的 OR-convolution 预处理)<br>若想枚举超集、或做反向变换，方向和条件稍变。SOS DP 常用于子集卷积、按 OR&#x2F;AND 的快速预处理</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//模板</span></span><br><span class="line"><span class="type">int</span> n; <span class="comment">// bit 数</span></span><br><span class="line"><span class="type">int</span> N = <span class="number">1</span> &lt;&lt; n;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; g = f; <span class="comment">// copy</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> mask = <span class="number">0</span>; mask &lt; N; ++mask) &#123;</span><br><span class="line">        <span class="keyword">if</span> (mask &amp; (<span class="number">1</span> &lt;&lt; i)) g[mask] += g[mask ^ (<span class="number">1</span> &lt;&lt; i)];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="bitset加速，位并行"><a href="#bitset加速，位并行" class="headerlink" title="bitset加速，位并行"></a>bitset加速，位并行</h3><blockquote><p>0&#x2F;1 背包（sum ≤ S），用 <code>bitset</code> 能把复杂度变得非常<br><code>bitset</code> 的宽度必须在编译期固定<code>（bitset&lt;100001&gt;）</code>，或用动态的 <code>vector&lt;unsigned long long&gt;</code> 实现位运算。它能把常数非常降低（机器字并行）<br>应用：多次子集和&#x2F;大范围背包、快速集合运算、用于转移的并行化</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> S = <span class="number">100000</span>;</span><br><span class="line">bitset&lt;S+1&gt; bs;</span><br><span class="line">bs[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> w : weights) bs |= (bs &lt;&lt; w);</span><br><span class="line"><span class="comment">// then bs[s] 表示是否能凑出和 s</span></span><br></pre></td></tr></table></figure><h3 id="lowbit在树状数组与枚举中的应用"><a href="#lowbit在树状数组与枚举中的应用" class="headerlink" title="lowbit在树状数组与枚举中的应用"></a>lowbit在树状数组与枚举中的应用</h3><blockquote><p>树状数组 <code>add/sum</code> 中用 <code>lowbit(x) = x &amp; -x</code><br>把<code>x</code>的最低<code>1</code>位删除：<code>x &amp;= x - 1</code>（常用于统计&#x2F;循环最低位的删除，复杂度按 1 的个数）</p></blockquote><h3 id="Gray-Code-用于增量更新"><a href="#Gray-Code-用于增量更新" class="headerlink" title="Gray Code(用于增量更新)"></a>Gray Code(用于增量更新)</h3><blockquote><p>Gray code 定义：<code>g(i) = i ^ (i &gt;&gt; 1)</code>，两个相邻 Gray 值只差 1 位。用于需要按一位变换来做状态更新的 DP（例如滑窗维护时增量更新集合信息），能把每一步转移变成常数时间修改</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 位运算 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>排序算法有哪些，哪些是稳定的排序算法</title>
      <link href="/JasmineRain.github.io/2025/09/15/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%8C%E5%93%AA%E4%BA%9B%E6%98%AF%E7%A8%B3%E5%AE%9A%E7%9A%84%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/"/>
      <url>/JasmineRain.github.io/2025/09/15/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%8C%E5%93%AA%E4%BA%9B%E6%98%AF%E7%A8%B3%E5%AE%9A%E7%9A%84%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h2 id="常见排序算法及稳定性"><a href="#常见排序算法及稳定性" class="headerlink" title="常见排序算法及稳定性"></a>常见排序算法及稳定性</h2><table><thead><tr><th>排序算法</th><th>平均时间复杂度</th><th>最坏情况</th><th>稳定性</th><th>适用场景</th></tr></thead><tbody><tr><td>冒泡排序</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></td><td>稳定</td><td>小数据量，教学</td></tr><tr><td>选择排序</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></td><td>不稳定</td><td>小数据量</td></tr><tr><td>插入排序</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></td><td>稳定</td><td>小数据量，几乎有序</td></tr><tr><td>希尔排序</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">O(n logn</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">n</span></span></span></span>~<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></td><td>不稳定</td><td>中小规模数据</td></tr><tr><td>归并排序</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n logn)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n logn)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></td><td>稳定</td><td>大数据量，链表排序</td></tr><tr><td>快速排序</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n logn)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></td><td>不稳定</td><td>大数据量，数组排序</td></tr><tr><td>堆排序</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n logn)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n logn)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></td><td>不稳定</td><td>大数据量，数组排序</td></tr><tr><td>计数排序</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n+k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n+k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></td><td>稳定</td><td>小范围整数排序</td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td>桶排序</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n+k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></td><td>稳定</td><td>浮点数排序，均匀分布</td></tr><tr><td>基数排序</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(nk)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">nk</span><span class="mclose">)</span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(nk)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">nk</span><span class="mclose">)</span></span></span></span></td><td>稳定</td><td>大量整数或字符串</td></tr></tbody></table><blockquote><p>k表示数字&#x2F;关键字的位数或范围大小</p></blockquote><h2 id="排序代码"><a href="#排序代码" class="headerlink" title="排序代码"></a>排序代码</h2><p>以数组{5，2，9，1，5，6}为例进行排序</p><h3 id="冒泡排序-稳定"><a href="#冒泡排序-稳定" class="headerlink" title="冒泡排序(稳定)"></a>冒泡排序(稳定)</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> arr[]=&#123;<span class="number">5</span>,<span class="number">2</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">6</span>&#125;;</span><br><span class="line">    <span class="type">int</span> n=<span class="built_in">sizeof</span>(arr)/<span class="built_in">sizeof</span>(arr[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;n-i<span class="number">-1</span>;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(arr[j]&gt;arr[j<span class="number">+1</span>])<span class="built_in">swap</span>(arr[j],arr[j<span class="number">+1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">        std::cout&lt;&lt;arr[i]&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">``</span><span class="string">`</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>java</span><br></pre></td></tr></table></figure><h3 id="冒泡排序-稳定-1"><a href="#冒泡排序-稳定-1" class="headerlink" title="冒泡排序(稳定)"></a>冒泡排序(稳定)</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line">```go</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line">### 选择排序(不稳定)</span><br><span class="line"></span><br><span class="line">```cpp</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">``</span><span class="string">`</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>java</span><br></pre></td></tr></table></figure><h3 id="插入排序-稳定"><a href="#插入排序-稳定" class="headerlink" title="插入排序(稳定)"></a>插入排序(稳定)</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line">```go</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line">### 希尔排序(不稳定)</span><br><span class="line"></span><br><span class="line">```cpp</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">``</span><span class="string">`</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>java</span><br></pre></td></tr></table></figure><h3 id="归并排序-稳定"><a href="#归并排序-稳定" class="headerlink" title="归并排序(稳定)"></a>归并排序(稳定)</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line">```go</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line">### 快速排序(不稳定)</span><br><span class="line"></span><br><span class="line">```cpp</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">``</span><span class="string">`</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>java</span><br></pre></td></tr></table></figure><h3 id="堆排序-不稳定"><a href="#堆排序-不稳定" class="headerlink" title="堆排序(不稳定)"></a>堆排序(不稳定)</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line">```go</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line">### 计数排序(稳定)</span><br><span class="line"></span><br><span class="line">```cpp</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">``</span><span class="string">`</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>java</span><br></pre></td></tr></table></figure><h3 id="桶排序-稳定"><a href="#桶排序-稳定" class="headerlink" title="桶排序(稳定)"></a>桶排序(稳定)</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line">```go</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line">### 基数排序(稳定)</span><br><span class="line"></span><br><span class="line">```cpp</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">``</span><span class="string">`</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>java</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 排序 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> go </tag>
            
            <tag> c++ </tag>
            
            <tag> sort </tag>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>红黑树与AVL树的区别</title>
      <link href="/JasmineRain.github.io/2025/09/15/%E7%BA%A2%E9%BB%91%E6%A0%91%E4%B8%8EAVL%E6%A0%91%E7%9A%84%E5%8C%BA%E5%88%AB/"/>
      <url>/JasmineRain.github.io/2025/09/15/%E7%BA%A2%E9%BB%91%E6%A0%91%E4%B8%8EAVL%E6%A0%91%E7%9A%84%E5%8C%BA%E5%88%AB/</url>
      
        <content type="html"><![CDATA[<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><table><thead><tr><th></th><th>定义</th><th>平衡方法</th></tr></thead><tbody><tr><td>AVL树</td><td>一种严格自平衡二叉搜索树(BST)</td><td>节点的左右子树高度差&lt;&#x3D;1</td></tr><tr><td>红黑树</td><td>一种弱平衡的自平衡BST</td><td>节点染色(红&#x2F;黑)，保证从根到叶子每条路径黑色节点数量相同，并不严格要求高度差&lt;&#x3D;1</td></tr></tbody></table><h2 id="平衡策略"><a href="#平衡策略" class="headerlink" title="平衡策略"></a>平衡策略</h2><ul><li><p>AVL树</p><ul><li>高度严格平衡</li><li>插入&#x2F;删除节点后，如果高度差&gt;1，需要通过单旋转或双旋转来恢复平衡</li><li>优点：查找&#x2F;删除效率非常高，平均复杂度O(logn)</li></ul></li><li><p>红黑树</p><ul><li>高度弱平衡(通过颜色约束维持)</li><li>每条从根到叶子的路径黑色节点数相同(黑高相等)，并不能有两个连续红色节点</li><li>插入&#x2F;删除时通过变色+左右旋转调整</li><li>优点：插入&#x2F;删除效率较稳定，旋转次数少</li></ul></li></ul><h2 id="性能对比"><a href="#性能对比" class="headerlink" title="性能对比"></a>性能对比</h2><table><thead><tr><th>性能指标</th><th>AVL树</th><th>红黑树</th></tr></thead><tbody><tr><td>查找</td><td>高速，平均O(logn)，比红黑树略快</td><td>较快，O(logn)，查找略慢于AVL树</td></tr><tr><td>插入&#x2F;删除</td><td>平衡严格，旋转次数多-&gt;相对慢</td><td>平衡较松，旋转次数少-&gt;插入&#x2F;删除快</td></tr><tr><td>空间开销</td><td>每个节点存储高度信息</td><td>每个节点存储颜色信息(1 bit)</td></tr><tr><td>高度上界</td><td>≈1.44*<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">log_2(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></td><td>&lt;&#x3D;2*<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">log_2(n+1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>-&gt;稍高一些</td></tr></tbody></table><h2 id="使用场景对比"><a href="#使用场景对比" class="headerlink" title="使用场景对比"></a>使用场景对比</h2><table><thead><tr><th>特点</th><th>AVL树适用</th><th>红黑树适用</th></tr></thead><tbody><tr><td>查找频率</td><td>数据查找频繁、少量更新</td><td>不适合更新频繁场景</td></tr><tr><td>更新频率</td><td>不适合，因为旋转多</td><td>更新频繁场景优选，如Java TreeMap、TreeSet</td></tr><tr><td>内存开销</td><td>略大(存高度信息)</td><td>略小(存颜色位)</td></tr><tr><td>实用性</td><td>学术研究居多</td><td>工业级应用广泛(Lunix内核，Java集合、C++STLmap&#x2F;set)</td></tr></tbody></table><blockquote><p>AVL树：严格平衡-&gt;查找快，更新慢<br>红黑树：弱平衡-&gt;查找稍慢，更新快-&gt;工业界应用更广泛</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 红黑树 </tag>
            
            <tag> AVL树 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HashMap是如何解决哈希冲突</title>
      <link href="/JasmineRain.github.io/2025/09/15/HashMap%E6%98%AF%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E5%93%88%E5%B8%8C%E5%86%B2%E7%AA%81/"/>
      <url>/JasmineRain.github.io/2025/09/15/HashMap%E6%98%AF%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E5%93%88%E5%B8%8C%E5%86%B2%E7%AA%81/</url>
      
        <content type="html"><![CDATA[<h2 id="哈希冲突"><a href="#哈希冲突" class="headerlink" title="哈希冲突"></a>哈希冲突</h2><p>HashMap是一种键值对的存储数据结构，通过哈希函数把key映射到数组下标(bucket),哈希冲突就是不同的key经过哈希函数后得到相同的数组下标，因为数组有限，而key无限，所以冲突是不可避免的</p><h2 id="HashMap常见的解决哈希冲突的方法"><a href="#HashMap常见的解决哈希冲突的方法" class="headerlink" title="HashMap常见的解决哈希冲突的方法"></a>HashMap常见的解决哈希冲突的方法</h2><h3 id="拉链法-Separate-chaining-链地址法"><a href="#拉链法-Separate-chaining-链地址法" class="headerlink" title="拉链法(Separate chaining&#x2F;链地址法)"></a>拉链法(Separate chaining&#x2F;链地址法)</h3><p>每个数组下标不直接存储单个元素，而是存储一个链表或链式结构，当key冲突时，放到这个链表中。</p><p>查找时，根据key的哈希值找到数组的下标，遍历链表，比较key是否相等</p><ul><li><p>优点</p><ul><li>简单易实现</li><li>当冲突少时，效率很高</li></ul></li><li><p>缺点</p><ul><li>链表过长时查找效率下降(后续Java8+用红黑树替换链表提升性能)</li></ul></li></ul><h3 id="地址开放法-Open-Addressing"><a href="#地址开放法-Open-Addressing" class="headerlink" title="地址开放法(Open Addressing)"></a>地址开放法(Open Addressing)</h3><p>所有元素都存储在数组中，没有链表。当冲突发生时，寻找数组中下一个空槽位存放元素。常用探查方式：线性探查(下一个空槽依次查找)、二次探查(查找间隔平方递增，减少群聚现象)、双哈希(用第二个哈希函数计算步长)</p><ul><li><p>优点</p><ul><li>节约内存，不需要链表指针</li></ul></li><li><p>缺点</p><ul><li>数组负载因子过高时，插入&#x2F;查找效率下降</li></ul></li></ul><h3 id="再哈希法"><a href="#再哈希法" class="headerlink" title="再哈希法"></a>再哈希法</h3><p>当哈希冲突严重时，通过扩容数组+重新计算哈希值，把元素分散到更大的数组里，Java中的HashMap在达到负载因子0.75时会自动扩容(容量翻倍),并将链表&#x2F;红黑树元素重新哈希到新数组</p><h2 id="Java中HashMap的冲突处理-核心机制"><a href="#Java中HashMap的冲突处理-核心机制" class="headerlink" title="Java中HashMap的冲突处理(核心机制)"></a>Java中HashMap的冲突处理(核心机制)</h2><h3 id="链表-红黑树"><a href="#链表-红黑树" class="headerlink" title="链表+红黑树"></a>链表+红黑树</h3><ul><li>Java8之前：链表存储冲突元素</li><li>Java8之后：当链表长度&gt;8且数组长度&gt;&#x3D;64-&gt;链表转换成红黑树，查找复杂度O(logn)</li></ul><h3 id="负载因子与扩容"><a href="#负载因子与扩容" class="headerlink" title="负载因子与扩容"></a>负载因子与扩容</h3><ul><li>默认负载因子0.75，超过就扩容并重新分布元素</li></ul><h3 id="哈希函数优化"><a href="#哈希函数优化" class="headerlink" title="哈希函数优化"></a>哈希函数优化</h3><ul><li>HashMap内部对key的hashCode做扰动处理，提高冲突分散性</li></ul>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HashMap </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>最优化理论与方法</title>
      <link href="/JasmineRain.github.io/2025/09/12/%E6%9C%80%E4%BC%98%E5%8C%96%E7%90%86%E8%AE%BA%E4%B8%8E%E6%96%B9%E6%B3%95/"/>
      <url>/JasmineRain.github.io/2025/09/12/%E6%9C%80%E4%BC%98%E5%8C%96%E7%90%86%E8%AE%BA%E4%B8%8E%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h2 id="1-线性规划与整数规划"><a href="#1-线性规划与整数规划" class="headerlink" title="1 线性规划与整数规划"></a>1 线性规划与整数规划</h2><h3 id="1-1-最优化基本要素"><a href="#1-1-最优化基本要素" class="headerlink" title="1.1 最优化基本要素"></a>1.1 最优化基本要素</h3><ol><li>将实际问题抽象地用数学模型来描述，包括选择优化变量，确定目标函数，给出约束条件</li><li>对数学模型进行必要的简化，并采用适当的最优化方法来求解数学模型</li></ol><p><strong>目标函数、优化变量、约束条件</strong>是最优化问题数学模型的三个基本要素</p><h4 id="优化变量"><a href="#优化变量" class="headerlink" title="优化变量"></a>优化变量</h4><p>一个实际的优化方案可以用一组参数来表示。在这些参数中，有些根据要求在优化过程中始终保持不变，这类参数为<strong>常量</strong>。另一些参数的取值则需要在优化过程中调优和优选，一直处于变化的状态，这类变量称为<strong>优化变量</strong>。优化变量必须是独立的参数。</p><p>n维空间，n维欧氏空间</p><p>因为优化变量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo separator="true">⋅</mo><mo separator="true">⋅</mo><mo separator="true">⋅</mo><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x_i(i=1,2,···,n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,⋅⋅⋅,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>都是实数，所以这n个独立变量组成的n维向量空间是一个n维实空间，用<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>R</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">R^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span>表示。</p><p>优化变量的个数(优化问题的维数)称为<strong>自由度</strong>，个数越多，自由度越高</p><h4 id="目标函数"><a href="#目标函数" class="headerlink" title="目标函数"></a>目标函数</h4><p>目标函数是用优化变量来表示的优化目标的数学表达式，是方案好坏的评价标准，故又称为<strong>评价函数</strong>。目标函数通常表示为</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><mo separator="true">⋅</mo><mo separator="true">⋅</mo><mo separator="true">⋅</mo><mo separator="true">,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x)=f(x_1,x_2,···,x_n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,⋅⋅⋅,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><h4 id="约束条件"><a href="#约束条件" class="headerlink" title="约束条件"></a>约束条件</h4><h4 id="最优化问题的数学模型及分类"><a href="#最优化问题的数学模型及分类" class="headerlink" title="最优化问题的数学模型及分类"></a>最优化问题的数学模型及分类</h4><h4 id="最优化方法概述"><a href="#最优化方法概述" class="headerlink" title="最优化方法概述"></a>最优化方法概述</h4><h3 id="1-2-线性规划"><a href="#1-2-线性规划" class="headerlink" title="1.2 线性规划"></a>1.2 线性规划</h3><h4 id="线性规划数学模型"><a href="#线性规划数学模型" class="headerlink" title="线性规划数学模型"></a>线性规划数学模型</h4><h4 id="线性规划求解基本原理"><a href="#线性规划求解基本原理" class="headerlink" title="线性规划求解基本原理"></a>线性规划求解基本原理</h4><h4 id="单纯形方法"><a href="#单纯形方法" class="headerlink" title="单纯形方法"></a>单纯形方法</h4><h4 id="初始基本可行解的获取"><a href="#初始基本可行解的获取" class="headerlink" title="初始基本可行解的获取"></a>初始基本可行解的获取</h4><h3 id="1-3-整数规划"><a href="#1-3-整数规划" class="headerlink" title="1.3 整数规划"></a>1.3 整数规划</h3><h4 id="整数规划数学模型及穷举法"><a href="#整数规划数学模型及穷举法" class="headerlink" title="整数规划数学模型及穷举法"></a>整数规划数学模型及穷举法</h4><h4 id="割平面法"><a href="#割平面法" class="headerlink" title="割平面法"></a>割平面法</h4><h4 id="分枝定界法"><a href="#分枝定界法" class="headerlink" title="分枝定界法"></a>分枝定界法</h4><h2 id="2-非线性规划"><a href="#2-非线性规划" class="headerlink" title="2 非线性规划"></a>2 非线性规划</h2><h3 id="2-1-非线性规划数学基础"><a href="#2-1-非线性规划数学基础" class="headerlink" title="2.1 非线性规划数学基础"></a>2.1 非线性规划数学基础</h3><h4 id="多元函数的泰勒展开式"><a href="#多元函数的泰勒展开式" class="headerlink" title="多元函数的泰勒展开式"></a>多元函数的泰勒展开式</h4><h4 id="函数的方向导数与最速下降方式"><a href="#函数的方向导数与最速下降方式" class="headerlink" title="函数的方向导数与最速下降方式"></a>函数的方向导数与最速下降方式</h4><h4 id="函数的二次型与正定矩阵"><a href="#函数的二次型与正定矩阵" class="headerlink" title="函数的二次型与正定矩阵"></a>函数的二次型与正定矩阵</h4><h4 id="无约束优化的极值条件"><a href="#无约束优化的极值条件" class="headerlink" title="无约束优化的极值条件"></a>无约束优化的极值条件</h4><h4 id="凸函数与凸规划"><a href="#凸函数与凸规划" class="headerlink" title="凸函数与凸规划"></a>凸函数与凸规划</h4><h4 id="约束优化的极值条件"><a href="#约束优化的极值条件" class="headerlink" title="约束优化的极值条件"></a>约束优化的极值条件</h4><h3 id="2-2-一维最优化方法"><a href="#2-2-一维最优化方法" class="headerlink" title="2.2 一维最优化方法"></a>2.2 一维最优化方法</h3><h4 id="搜索区间的确定"><a href="#搜索区间的确定" class="headerlink" title="搜索区间的确定"></a>搜索区间的确定</h4><h4 id="黄金分隔法"><a href="#黄金分隔法" class="headerlink" title="黄金分隔法"></a>黄金分隔法</h4><h4 id="二次插值法"><a href="#二次插值法" class="headerlink" title="二次插值法"></a>二次插值法</h4><h4 id="切线法"><a href="#切线法" class="headerlink" title="切线法"></a>切线法</h4><h4 id="格点法"><a href="#格点法" class="headerlink" title="格点法"></a>格点法</h4><h3 id="2-3-无约束多维非线性规划方法"><a href="#2-3-无约束多维非线性规划方法" class="headerlink" title="2.3 无约束多维非线性规划方法"></a>2.3 无约束多维非线性规划方法</h3><h4 id="坐标轮换法"><a href="#坐标轮换法" class="headerlink" title="坐标轮换法"></a>坐标轮换法</h4><h4 id="最速下降法"><a href="#最速下降法" class="headerlink" title="最速下降法"></a>最速下降法</h4><h4 id="牛顿法"><a href="#牛顿法" class="headerlink" title="牛顿法"></a>牛顿法</h4><h4 id="变尺度法"><a href="#变尺度法" class="headerlink" title="变尺度法"></a>变尺度法</h4><h4 id="共轭方向法"><a href="#共轭方向法" class="headerlink" title="共轭方向法"></a>共轭方向法</h4><h4 id="单纯形法"><a href="#单纯形法" class="headerlink" title="单纯形法"></a>单纯形法</h4><h4 id="最小二乘法"><a href="#最小二乘法" class="headerlink" title="最小二乘法"></a>最小二乘法</h4><h3 id="2-4-约束问题的非线性规划方法"><a href="#2-4-约束问题的非线性规划方法" class="headerlink" title="2.4 约束问题的非线性规划方法"></a>2.4 约束问题的非线性规划方法</h3><h4 id="约束最优化问题的间接解法"><a href="#约束最优化问题的间接解法" class="headerlink" title="约束最优化问题的间接解法"></a>约束最优化问题的间接解法</h4><h4 id="约束最优化问题的直接解法"><a href="#约束最优化问题的直接解法" class="headerlink" title="约束最优化问题的直接解法"></a>约束最优化问题的直接解法</h4><h3 id="2-5-非线性规划中的一些其他方法"><a href="#2-5-非线性规划中的一些其他方法" class="headerlink" title="2.5 非线性规划中的一些其他方法"></a>2.5 非线性规划中的一些其他方法</h3><h4 id="多目标优化"><a href="#多目标优化" class="headerlink" title="多目标优化"></a>多目标优化</h4><h4 id="数学模型的尺度变换"><a href="#数学模型的尺度变换" class="headerlink" title="数学模型的尺度变换"></a>数学模型的尺度变换</h4><h4 id="灵敏度分析及可变容差法"><a href="#灵敏度分析及可变容差法" class="headerlink" title="灵敏度分析及可变容差法"></a>灵敏度分析及可变容差法</h4><h2 id="3-智能优化方法"><a href="#3-智能优化方法" class="headerlink" title="3 智能优化方法"></a>3 智能优化方法</h2><h3 id="3-1-启发式搜索方法"><a href="#3-1-启发式搜索方法" class="headerlink" title="3.1 启发式搜索方法"></a>3.1 启发式搜索方法</h3><h4 id="图搜索算法"><a href="#图搜索算法" class="headerlink" title="图搜索算法"></a>图搜索算法</h4><h4 id="启发式评价函数"><a href="#启发式评价函数" class="headerlink" title="启发式评价函数"></a>启发式评价函数</h4><h4 id="A-搜索算法"><a href="#A-搜索算法" class="headerlink" title="A*搜索算法"></a>A*搜索算法</h4><h3 id="3-2-Hopfield神经网络优化方法"><a href="#3-2-Hopfield神经网络优化方法" class="headerlink" title="3.2 Hopfield神经网络优化方法"></a>3.2 Hopfield神经网络优化方法</h3><h4 id="人工神经网络模型"><a href="#人工神经网络模型" class="headerlink" title="人工神经网络模型"></a>人工神经网络模型</h4><h4 id="Hopfield神经网络"><a href="#Hopfield神经网络" class="headerlink" title="Hopfield神经网络"></a>Hopfield神经网络</h4><h4 id="Hopfield网络与最优化问题"><a href="#Hopfield网络与最优化问题" class="headerlink" title="Hopfield网络与最优化问题"></a>Hopfield网络与最优化问题</h4><h3 id="3-3-模拟退火法与均场退火法"><a href="#3-3-模拟退火法与均场退火法" class="headerlink" title="3.3 模拟退火法与均场退火法"></a>3.3 模拟退火法与均场退火法</h3><h4 id="模拟退火法基础"><a href="#模拟退火法基础" class="headerlink" title="模拟退火法基础"></a>模拟退火法基础</h4><h4 id="模拟退火法算法"><a href="#模拟退火法算法" class="headerlink" title="模拟退火法算法"></a>模拟退火法算法</h4><h4 id="随机型神经网络"><a href="#随机型神经网络" class="headerlink" title="随机型神经网络"></a>随机型神经网络</h4><h4 id="均场退火"><a href="#均场退火" class="headerlink" title="均场退火"></a>均场退火</h4><h3 id="3-4-遗传算法"><a href="#3-4-遗传算法" class="headerlink" title="3.4 遗传算法"></a>3.4 遗传算法</h3><h4 id="遗传算法实现"><a href="#遗传算法实现" class="headerlink" title="遗传算法实现"></a>遗传算法实现</h4><h4 id="遗传算法示例"><a href="#遗传算法示例" class="headerlink" title="遗传算法示例"></a>遗传算法示例</h4><h4 id="实数编码的遗传算法"><a href="#实数编码的遗传算法" class="headerlink" title="实数编码的遗传算法"></a>实数编码的遗传算法</h4><h2 id="4-变分法与动态规划"><a href="#4-变分法与动态规划" class="headerlink" title="4 变分法与动态规划"></a>4 变分法与动态规划</h2><h3 id="4-1-变分法"><a href="#4-1-变分法" class="headerlink" title="4.1 变分法"></a>4.1 变分法</h3><h4 id="泛函"><a href="#泛函" class="headerlink" title="泛函"></a>泛函</h4><h4 id="泛函极值条件——欧拉方程"><a href="#泛函极值条件——欧拉方程" class="headerlink" title="泛函极值条件——欧拉方程"></a>泛函极值条件——欧拉方程</h4><h4 id="可动边界泛函的极值"><a href="#可动边界泛函的极值" class="headerlink" title="可动边界泛函的极值"></a>可动边界泛函的极值</h4><h4 id="条件极值问题"><a href="#条件极值问题" class="headerlink" title="条件极值问题"></a>条件极值问题</h4><h4 id="利用变分法求解最优控制问题"><a href="#利用变分法求解最优控制问题" class="headerlink" title="利用变分法求解最优控制问题"></a>利用变分法求解最优控制问题</h4><h3 id="4-2-最大-小-值原理"><a href="#4-2-最大-小-值原理" class="headerlink" title="4.2 最大(小)值原理"></a>4.2 最大(小)值原理</h3><h4 id="连续系统的最大-小-值原理"><a href="#连续系统的最大-小-值原理" class="headerlink" title="连续系统的最大(小)值原理"></a>连续系统的最大(小)值原理</h4><h4 id="应用最大-小-值原理求解最优控制问题"><a href="#应用最大-小-值原理求解最优控制问题" class="headerlink" title="应用最大(小)值原理求解最优控制问题"></a>应用最大(小)值原理求解最优控制问题</h4><h4 id="离散系统的最大-小-值原理"><a href="#离散系统的最大-小-值原理" class="headerlink" title="离散系统的最大(小)值原理"></a>离散系统的最大(小)值原理</h4><h3 id="4-3-动态规划"><a href="#4-3-动态规划" class="headerlink" title="4.3 动态规划"></a>4.3 动态规划</h3><h4 id="动态规划数学模型与算法"><a href="#动态规划数学模型与算法" class="headerlink" title="动态规划数学模型与算法"></a>动态规划数学模型与算法</h4><h4 id="确定性多阶段决策"><a href="#确定性多阶段决策" class="headerlink" title="确定性多阶段决策"></a>确定性多阶段决策</h4><h4 id="动态系统最优控制问题"><a href="#动态系统最优控制问题" class="headerlink" title="动态系统最优控制问题"></a>动态系统最优控制问题</h4>]]></content>
      
      
      <categories>
          
          <category> 专业选修课 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>数据库</title>
      <link href="/JasmineRain.github.io/2025/09/12/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
      <url>/JasmineRain.github.io/2025/09/12/%E6%95%B0%E6%8D%AE%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<h2 id="数据库概念"><a href="#数据库概念" class="headerlink" title="数据库概念"></a>数据库概念</h2><ul><li>数据库：一个<strong>长期存储、有组织的、可共享的</strong>数据集合</li><li>数据库管理系统：用于创建、读取、更新、删除和管理数据库的软件(如MySQL、PostgreSQL、MongoDB、Redis、ClickHouse等)</li><li>两层关系：应用&lt;–&gt;DBMS&lt;–&gt;存储(磁盘&#x2F;SSD、缓存)</li></ul><h2 id="数据库分类与典型场景"><a href="#数据库分类与典型场景" class="headerlink" title="数据库分类与典型场景"></a>数据库分类与典型场景</h2><ul><li>关系型数据库：表、行、列、支持SQL、事务(ACID)。典型：MySQL、PostgreSQL、Oracle。适合OLTP(在线事务处理)</li><li>Key-Value存储:超快速读写，常做缓存&#x2F;会话(Redis、Memcached)</li><li>文档数据库:JSON&#x2F;BSON文档，灵活schema(MongoDB)。适合半结构化数据。</li><li>列式&#x2F;宽式数据库：面向大规模分析、列存储(Cassandra、HBase、ClickHouse)。适合OLAP&#x2F;时序&#x2F;日志分析</li><li>图数据库:关系密集型图查询(Neo4j、JanusGraph)</li><li>时序数据库:时间序列优化(InfluxDB、Prometheus TSDB)</li><li>搜索引擎:全文搜索与倒排索引(Elasticsearch、Solr)</li></ul><h2 id="核心概念与内部机制"><a href="#核心概念与内部机制" class="headerlink" title="核心概念与内部机制"></a>核心概念与内部机制</h2><ul><li>Schema&#x2F;Table&#x2F;Row&#x2F;Column&#x2F;Index&#x2F;View</li><li>主键PK&#x2F;外键FK&#x2F;唯一约束</li><li>事务(Transaction):原子性、一致性、隔离性、持久性——ACID</li><li>WAL(Write-Ahead Log):用于持久化与恢复</li><li>MVCC(多版本并发控制):实现高并发读(Postgres、InnoDB)</li><li>查询优化器&#x2F;施行计划(EXPLAIN):负责选择索引、join顺序、算子等</li><li>Buffer Pool&#x2F;Page Cache:内存缓存命中率影响性能</li></ul><h2 id="事务隔离级别与并发现象"><a href="#事务隔离级别与并发现象" class="headerlink" title="事务隔离级别与并发现象"></a>事务隔离级别与并发现象</h2><ul><li>隔离级别(按强到弱):<code>SERIALIZABLE</code>-&gt;<code>REPEATABLE READ</code>-&gt;<code>READ COMMITTED</code>-&gt;<code>READ UNCOMMITTED</code></li><li>并发异常:Dirty Read(脏读)、Non-repeatable Read(不可重读)-&gt;Phantom(幻读)</li><li>实务：多数OLTP用<code>READ COMMITTED</code>或<code>REPEATABLE READ</code>(MySQL默认是<code>REPEATABLE READ</code>),需要严格一致性时用<code>SERIALIZABLE</code>(代价高)</li></ul><h2 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h2><ul><li><p>类型：B-tree&#x2F;Hash&#x2F;Bitmap&#x2F;Inverted(全文)</p></li><li><p>选用要点:</p><ul><li>高选择性字段适合索引(能过滤大量行)</li><li>复合索引遵循最左前缀原则</li><li>覆盖索引(Index Only Scan)可以避免回表</li><li>索引会增加写入开销和占用磁盘空间</li></ul></li><li><p>常见命令</p></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> INDEX idx_user_email <span class="keyword">ON</span> users(email);</span><br><span class="line">EXPLAIN ANALYZE <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> email <span class="operator">=</span><span class="string">&#x27;a@b.com&#x27;</span>;</span><br></pre></td></tr></table></figure><h2 id="数据建模"><a href="#数据建模" class="headerlink" title="数据建模"></a>数据建模</h2><ul><li>范式化(1NF,2NF,3NF)：减少冗余、保证一致化，适用于事务系统</li><li>反范化&#x2F;物化视图&#x2F;预聚合：用于性能优化，适合读多写少或分析场景(如电商报表)</li><li>数据仓库建模：星型&#x2F;雪花模型(OLAP)</li></ul><h2 id="分区、分片与扩展策略"><a href="#分区、分片与扩展策略" class="headerlink" title="分区、分片与扩展策略"></a>分区、分片与扩展策略</h2><ul><li>垂直扩展：更强的单机(CPU&#x2F;内存&#x2F;SSD)</li><li>水平扩展：分片(sharding)&#x2F;分区，数据按键范围或哈希分布到多节点</li><li>分区(partition)：单库内按范围&#x2F;列表&#x2F;哈希分区，方便管理与查询优化</li><li>分片要谨慎：选择shard key(会影响热点与重分片成本)</li></ul><h2 id="复制与高可用"><a href="#复制与高可用" class="headerlink" title="复制与高可用"></a>复制与高可用</h2><ul><li>模式:主从(主写从读)、主主(双主)、基于一致性协议(Raft&#x2F;Paxos)</li><li>同步复制(强一致性) vs 异步复制(提升可用&#x2F;性能但有副本延迟)</li><li>常见功能：自动故障切换(failover)、复制延迟监控</li></ul><h2 id="备份与恢复"><a href="#备份与恢复" class="headerlink" title="备份与恢复"></a>备份与恢复</h2><ul><li>备份类型：逻辑备份(SQL dump)与物理备份&#x2F;快照(更快，可恢复到某一时点)</li><li>WAL+PITR(Point-in-time recovery)：可恢复到某个时间点</li><li>常见策略：定期全备+增量备份+异地存储+定期恢复演练</li></ul><h2 id="安全与权限"><a href="#安全与权限" class="headerlink" title="安全与权限"></a>安全与权限</h2><ul><li>最小权限原则(Role&#x2F;Grant)</li><li>加密：传输层TLS、静态数据加密(at-rest)</li><li>审计日志、敏感数据脱敏&#x2F;掩码、合规(GDPR&#x2F;HIPAA)考虑</li></ul><h2 id="监控指标与排查方向"><a href="#监控指标与排查方向" class="headerlink" title="监控指标与排查方向"></a>监控指标与排查方向</h2><ul><li>基础指标：QPS、响应时间(p95&#x2F;p99)、慢查询数、连续数、CPU、IOPS、磁盘使用、内存使用、缓存命中率、锁等待、复制延迟</li><li>工具：Prometheus+Grafana、各DB自带统计(pg_stat_statements、MySQL Performance Schema)</li></ul><h2 id="常见数据库与推荐场景"><a href="#常见数据库与推荐场景" class="headerlink" title="常见数据库与推荐场景"></a>常见数据库与推荐场景</h2><ul><li>MySQL&#x2F;PostgreSQL：通用OLTP；Postgres强SQL标准、扩展性好；MySQL社区与生态广</li><li>Redis：会话、缓存、队列(轻量)、限流</li><li>MongoDB：文档存储，schema灵活</li><li>Cassandra&#x2F;Scylla：写密集型、线性扩展，最终一致性</li><li>ClickHouse&#x2F;DWH:实时分析、列存储，超快聚合</li><li>Elasticsearch：全文检索与分析</li></ul><h2 id="实战常用SQL示例"><a href="#实战常用SQL示例" class="headerlink" title="实战常用SQL示例"></a>实战常用SQL示例</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--链表</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> users(</span><br><span class="line">    id SERTAL <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">    name TEXT <span class="keyword">NOT NULL</span>,</span><br><span class="line">    email TEXT <span class="keyword">UNIQUE</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">--事务</span></span><br><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> accounts <span class="keyword">SET</span> balance <span class="operator">=</span>balance <span class="operator">-</span> <span class="number">100</span> <span class="keyword">WHERE</span> id <span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> accounts <span class="keyword">SET</span> balance <span class="operator">=</span>balance <span class="operator">+</span> <span class="number">100</span> <span class="keyword">WHERE</span> id <span class="operator">=</span><span class="number">2</span>;</span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--查看执行计划(Postgres)</span></span><br><span class="line">EXPLAIN ANALYZE <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> email <span class="operator">=</span><span class="string">&#x27;a@b.com&#x27;</span>;</span><br></pre></td></tr></table></figure><p>NoSQL示例(MongoDB)</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="property">users</span>.<span class="title function_">insertOne</span>(&#123;<span class="attr">name</span>:<span class="string">&quot;Alice&quot;</span>,<span class="attr">email</span>:<span class="string">&quot;a@b.com&quot;</span>&#125;);</span><br><span class="line">db.<span class="property">users</span>.<span class="title function_">createIndex</span>(&#123;<span class="attr">email</span>:<span class="number">1</span>&#125;,&#123;<span class="attr">unique</span>:<span class="literal">true</span>&#125;);</span><br><span class="line">db.<span class="property">users</span>.<span class="title function_">find</span>(&#123;<span class="attr">name</span>:<span class="string">&quot;Alice&quot;</span>&#125;);</span><br></pre></td></tr></table></figure><p>Redis示例</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> <span class="keyword">session</span>:<span class="number">123</span> <span class="keyword">user</span>:<span class="number">1</span> EX <span class="number">3600</span></span><br><span class="line">HSET <span class="keyword">user</span>:<span class="number">1</span> <span class="type">name</span> &quot;Alice&quot; age &quot;30&quot;</span><br><span class="line"><span class="keyword">GET</span> <span class="keyword">session</span>:<span class="number">123</span></span><br></pre></td></tr></table></figure><h2 id="性能调优清单-Checklist"><a href="#性能调优清单-Checklist" class="headerlink" title="性能调优清单(Checklist)"></a>性能调优清单(Checklist)</h2><ul><li>检查慢查询并优化SQL&#x2F;加索引</li><li>合理设计索引，避免过多无用索引</li><li>设计连接池、Prepared Statements、批量写入</li><li>利用缓存(Redis)和读写分离</li><li>避免N+1查询、过度JOIN</li><li>对分析场景使用列式存储&#x2F;ETL到数据仓库</li><li>定期重建碎片化索引&#x2F;VACUUM(Postgres)</li></ul><h2 id="常见误区"><a href="#常见误区" class="headerlink" title="常见误区"></a>常见误区</h2><ul><li>加索引并不都是好事，会增加开销与空间成本</li><li>分片不能无限扩容，分片设计复杂、跨分片join&#x2F;事务很难</li><li>主从复制也是有成本的，存在复制延迟、一致性问题</li></ul><h2 id="选型建议-简单决策树"><a href="#选型建议-简单决策树" class="headerlink" title="选型建议(简单决策树)"></a>选型建议(简单决策树)</h2><ul><li>需要强事务&amp;复杂查询-&gt;PostgreSQL&#x2F;MySQL</li><li>需要极低延迟缓存-&gt;Redis</li><li>文档型灵活schema-&gt;MongoDB</li><li>高并发写入、线性拓展-&gt;Cassandra&#x2F;Scylla</li><li>大数据分析&#x2F;实时OLAP-&gt;ClickHouse&#x2F;BigQuery&#x2F;Snowflake</li></ul><p><a href="https://www.nowcoder.com/tutorial/10006/3fbb1dc787f34a9cad2c73be2b21d8d6">牛客MySQL学习文章</a></p>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据库 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>计算机网络基础</title>
      <link href="/JasmineRain.github.io/2025/09/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/"/>
      <url>/JasmineRain.github.io/2025/09/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h2 id="概念与分层模型"><a href="#概念与分层模型" class="headerlink" title="概念与分层模型"></a>概念与分层模型</h2><h3 id="网络的概念"><a href="#网络的概念" class="headerlink" title="网络的概念"></a>网络的概念</h3><p>网络是现代软件系统的基础(分布式系统、微服务系统、云、流媒体、物联网都离不开它)</p><h3 id="两个常见的模型"><a href="#两个常见的模型" class="headerlink" title="两个常见的模型"></a>两个常见的模型</h3><ol><li><p><strong>OSI七层模型</strong>：(物理、数据链路、网络、传输、会话、表示、应用)，便于概念教学所以使用该分层</p></li><li><p><strong>TCP&#x2F;IP(四&#x2F;五层)模型</strong>：(链路&#x2F;网络接口、网络&#x2F;Internet、传输&#x2F;Host-to-Host、应用)，更贴近实际协议栈，(IP&#x2F;TCP&#x2F;UDP&#x2F;HTTP)</p></li></ol><blockquote><p>对照表：<br>1.物理层-&gt;网线&#x2F;光纤&#x2F;无线<br>2.数据链路层-&gt;Ethernet、MAC、ARP、交换机<br>3.网络层-&gt;IP(IPv4&#x2F;IPv6)、路由、ICMP<br>4.传输层-&gt;TCP&#x2F;UDP、端口、流控、拥塞控制<br>5.应用层-&gt;DNS、HTTP、TLS、SMTP、FTP、SSH</p></blockquote><h2 id="物理层与链路层-从线缆到帧"><a href="#物理层与链路层-从线缆到帧" class="headerlink" title="物理层与链路层(从线缆到帧)"></a>物理层与链路层(从线缆到帧)</h2><ul><li><p>物理层：介质(双绞线、光纤、同轴)、信号编码、带宽、噪声、衰减、抖动(jitter)</p></li><li><p>链路层(数据帧):</p><ul><li>MAC地址(48bit,厂商前缀+唯一接口ID)；交换机根据MAC转发</li><li>Ethernet帧结构：目的MAC、源MAC、类型&#x2F;长度、Payload、FCS(CRS)</li><li>ARP(地址解析协议)：把IPv4地址映射到MAC(ARP请求&#x2F;应答)；存在ARP欺骗风险</li><li>交换机vs集线器：集线器广播，交换机基于CAM表转发；交换机隔离碰撞域</li><li>VLAN(虚拟局域网):802.1Q标记帧，使同一物理交换机上存在多个逻辑网络</li><li>生成树协议(STP):防止交换网络环境</li></ul></li></ul><h2 id="网络层：IP、路由、子网"><a href="#网络层：IP、路由、子网" class="headerlink" title="网络层：IP、路由、子网"></a>网络层：IP、路由、子网</h2><ul><li><p>IP地址：</p><ul><li>IPv4(32位)，IPv6(64位)——IPv6没有广播，用邻居发现替代ARP</li><li><strong>子网掩码&#x2F;CIDR</strong>：例如<code>192.168.1.0</code>;<code>/n</code>表示网络位数<br>示例(子网计算)：IP<code>192.168.10.130/26</code>-&gt;mask<code>255.255.255.192</code>(块大小64)-&gt;所在网段<code>192.168.10.128/26</code>，广播<code>192.168.10.191</code>,可用主机<code>192.168.10.129-192.168.10.190</code></li><li><strong>私有地址段</strong>：10.0.0.0&#x2F;8、172.16.0.0&#x2F;12、192.168.0.0&#x2F;16</li></ul></li><li><p>ICMP:用于错误与误诊(ping使用ICMP Echo Request&#x2F;Reply)</p></li><li><p><strong>分片</strong>:当数据包&gt;MTU(最大传输单元)时会分片；建议使用Path MTU Discovery避免分片</p></li><li><p><strong>NAT(网络地址转换)</strong></p><ul><li><strong>SNAT&#x2F;DNAT&#x2F;PAT</strong>：把私有IP映射到公网IP+端口，实现地址复用(家用路由器常见)</li><li>NAT的副作用:对端对端可达性、某些协议(FTP、SIP)需要ALGs或穿透</li></ul></li><li><p><strong>路由与路由表</strong>：每个路由器维护路由表(目标-&gt;下一跳、接口、metric)</p></li></ul><h2 id="路由算法与协议"><a href="#路由算法与协议" class="headerlink" title="路由算法与协议"></a>路由算法与协议</h2><ul><li><p><strong>基本类型</strong>:</p><ul><li><strong>距离向量(Distance Vector)</strong>：如RIP。每个节点只知道到邻居的距离，通过定期交换路由表收敛；易产生环路(计数到无限)</li><li><strong>链路状态</strong>：如OSPF。每个路由器广播链路状态，网络上每个节点构建完整拓扑并运行Dijikstra求最短路径</li><li><strong>路径矢量</strong>:如BGP(自治系统之间路由)，用于互联网主干，具有策略控制(不是简单的最短路径)</li></ul></li><li><p><strong>常见协议</strong>：</p><ul><li>RIP(老、最大跳数15)</li><li>OSPF(内部网关协议，链路状态)</li><li>BGP(自治系统间路由，策略驱动)</li></ul></li><li><p><strong>路由收敛、环路与预防</strong>：split horizon、poison reverse、route dampening、BGP政策等</p></li></ul><h2 id="传输层：TCP与UDP"><a href="#传输层：TCP与UDP" class="headerlink" title="传输层：TCP与UDP"></a>传输层：TCP与UDP</h2><ul><li><p><strong>端口号</strong>:0-65535(0保留)，标准服务端口如HTTP&#x2F;80、HTTPS&#x2F;443、DNS&#x2F;53</p></li><li><p><strong>UDP</strong>(无连接、尽最大努力交付、低延迟、适合实时&#x2F;流媒体&#x2F;DNS)</p></li><li><p><strong>TCP(可靠流)</strong>：</p><ul><li><p><strong>三次握手建立连接</strong>(SYN-&gt;SYN&#x2F;ACK-&gt;ACK)</p></li><li><p><strong>四次挥手断开</strong>(FIN&#x2F;ACK…)</p></li><li><p><strong>序列号(Seq)与确认号(Ack)</strong>、滑动窗口</p></li><li><p><strong>拥塞控制机制</strong>：</p><ul><li><strong>慢启动</strong>：cwnd从1MSS(最大报文段)指数增长到阈值ssthresh</li><li><strong>拥塞避免(AIMD)</strong>:加性增大、乘性减少</li><li><strong>快速重传&#x2F;快速恢复</strong>：三次重复ACK触发快速重传</li><li><strong>SACK(选择性确认)</strong>:减少不必要重传</li></ul></li></ul></li><li><p><strong>TCP状态</strong>：LISTEN-&gt;SYN_RCVD-&gt;ESTABLISHED-&gt;FIN_WAIT等</p></li></ul><h2 id="应用层常见协议"><a href="#应用层常见协议" class="headerlink" title="应用层常见协议"></a>应用层常见协议</h2><ul><li><p><strong>DNS(域名解析)</strong>：</p><ul><li>递归验证vs迭代查询、缓存、TTL、权威&#x2F;递归服务器，DNSSEC提供签名验证</li></ul></li><li><p><strong>HTTP&#x2F;HTTPS</strong></p><ul><li>HTTP1.1(持久连接、管道化有限)、HTTP&#x2F;2(多路复用、头压缩)、HTTP&#x2F;3(基于QUIC、使用UDP)</li><li>HTTPS&#x3D;HTTP+TLS(加密层)，证书链、公钥基础设施(PKI)</li></ul></li><li><p><strong>TLS</strong>：</p><ul><li>握手：协商加密套件、交换密钥(通常用ECDHE做密钥交换以实现前向保密)，交换证书，建立对称密钥</li></ul></li><li><p><strong>其他</strong>：SMTP(邮件)、FTP、SSH、WebSocket(长连接&#x2F;双向)等</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> 计算机网络 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 计算机网络 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数字图像处理</title>
      <link href="/JasmineRain.github.io/2025/09/11/%E6%95%B0%E5%AD%97%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/"/>
      <url>/JasmineRain.github.io/2025/09/11/%E6%95%B0%E5%AD%97%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="1-1图像及其分类"><a href="#1-1图像及其分类" class="headerlink" title="1.1图像及其分类"></a>1.1图像及其分类</h2><h3 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h3><ul><li><p>图：是物体反射或投射<strong>电磁波</strong>的分布</p></li><li><p>像：是人的视觉系统对接受的图信息在大脑中形成的印象</p></li><li><p>图像:是图和像的结合。具体来说，就是用<strong>各种观测系统</strong>以不同形式和手段观测客观世界而获得的、可以直接或间接作用于人的视觉系统而产生的视知觉实体</p></li><li><p>图像处理：是对图形信息进行加工以满足人的视觉或应用需求的行为。处理的方法通常有：模拟图像处理、数字图像处理、光电结合处理。</p><ul><li>模拟图像处理：也称光学图像处理，它是利用光学透镜或光学照相(例如：胶片照相机)方法对模拟图像进行的处理，其实时性强、速度快、处理信息量大、分辨率高，但是处理精度差，难有判断功能</li><li>数字图像处理：利用计算机技术或其他数字技术，对图像信息进行某些数字运算和各种加工处理，以改善图像的视觉效果和提高图像实用性的技术</li><li>光电结合处理：用光学方法完成运算量巨大的处理(如频谱变换等)，再用计算机对光学处理结果(如频谱)进行分析判读等处理。该方法是前两种的有机结合，它集结了两者的优点</li></ul></li><li><p>图像处理的基本特征：系统的输入和输出都是图像。核心是<strong>在不改变图像核心内容结构</strong>的前提下，改善图像质量或提取基础特征</p></li><li><p>计算机中图像的表示：定义为二维函数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>,其中x，y是空间坐标，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>是点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>的幅值；灰度图像是一个二维灰度(或亮度)函数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>;彩色图像由三个(如RGB，HSV)二维灰度(或亮度)函数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>组成</p></li></ul><p>数字图像由二维的元素组成，每一个元素具有一个特定的位置(x,y)和幅值<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>，这些元素称为像素</p><ul><li>计算机中的图像的构成：像素组成的二维排列，可以用矩阵表示；对于单色(灰度)图像而言，每个像素的亮度用一个数值来表示，通常数值范围在0到255之间，0表示黑、255表示白，其他值表示处于黑白之间的灰度；彩色图像可以用红、蓝、绿三元组矩阵来表示，通常，三元组的每一个数值也是在0到255之间，0表示相应的基色在该像素中没有，而255则代表相应的基色在该像素中取得最大值</li></ul><h3 id="图像的特点"><a href="#图像的特点" class="headerlink" title="图像的特点"></a>图像的特点</h3><p>直观形象、易懂、信息量大</p><h3 id="图像的分类"><a href="#图像的分类" class="headerlink" title="图像的分类"></a>图像的分类</h3><p>按灰度分类：二值、多灰度<br>按色彩分类：单色、彩色<br>按运动分类：静态、动态<br>按时空分布分类：二维、三维</p><h2 id="1-2-数字图像处理奇数与应用"><a href="#1-2-数字图像处理奇数与应用" class="headerlink" title="1.2 数字图像处理奇数与应用"></a>1.2 数字图像处理奇数与应用</h2><h3 id="数字图像处理的主要内容"><a href="#数字图像处理的主要内容" class="headerlink" title="数字图像处理的主要内容"></a>数字图像处理的主要内容</h3><ul><li>图像获取：把一幅模拟图像转换成适合计算机或数字设备处理的数字信号。包括：摄取图像、光电转换、数字化。</li><li>图像变换：对原始图像进行某种<strong>正交变换</strong>，将图像的特征在变换域中表现出来，一边对图像进行各种相关处理。</li><li>图像增强：突出图像中感兴趣的信息，衰减或去除不需要的信息，以使图像更清晰地被显示后更适合于人或机器的处理与分析</li><li>图像复原：去除噪声干扰和消除模糊，尽可能恢复图像的本来面目。</li><li>图像编码：利用信息论的思想对图像信号进行高效压缩，从而减少数据存储量，降低数据率以减少传输带宽。</li><li>图像分析：对图像中感兴趣的目标进行检测和测量，以获得所需的客观信息。</li><li>图像识别：对图像加以处理和识别，以解决计算机与外部环境直接通信的问题。</li><li>图像理解：研究图像中各种目标的性子以及相互之间的联系，并得以对图像内容含义的理解以及对原来客观场景的解释，从而知道规划行为。</li></ul><h3 id="数字图像处理的方法"><a href="#数字图像处理的方法" class="headerlink" title="数字图像处理的方法"></a>数字图像处理的方法</h3><ul><li>空域法：把图像看作平面中各个像素组成的集合，直接对图像的像素进行处理；（又分为领域处理的方法、点处理的方法）</li><li>变换域法：将图像进行变换后，在变换域内对图像的变换系数进行处理，处理完毕再进行逆变换，获得处理后的图像</li></ul><h3 id="数字图像处理技术的应用"><a href="#数字图像处理技术的应用" class="headerlink" title="数字图像处理技术的应用"></a>数字图像处理技术的应用</h3><ul><li>计算机图像生成：核心是<strong>从无到有</strong>或<strong>基于需求创造图像</strong></li><li>图像传输与图像通信，数字电视</li><li>机器人视觉及图像测量</li><li>办公自动化</li><li>图像跟踪及光学制导</li><li>医学图像处理与材料分析中的图像分析系统</li><li>遥感图像处理和空间探测</li><li>图像变形技术</li></ul><h2 id="1-3-数字图像处理系统"><a href="#1-3-数字图像处理系统" class="headerlink" title="1.3 数字图像处理系统"></a>1.3 数字图像处理系统</h2><h3 id="图像采集系统"><a href="#图像采集系统" class="headerlink" title="图像采集系统"></a>图像采集系统</h3><p>模拟图像-&gt;图像采集系统-&gt;计算机-&gt;图像输出设备</p><h3 id="计算机"><a href="#计算机" class="headerlink" title="计算机"></a>计算机</h3><h3 id="图像输出设备"><a href="#图像输出设备" class="headerlink" title="图像输出设备"></a>图像输出设备</h3><h2 id="1-4-MATLAB图像处理工具箱"><a href="#1-4-MATLAB图像处理工具箱" class="headerlink" title="1.4 MATLAB图像处理工具箱"></a>1.4 MATLAB图像处理工具箱</h2><p>MATLAB是一种基于向量的高级程序语言，将计算、可视化与程序设计集成在一个易用的环境中</p><p>。。。。。&#x2F;&#x2F;教授使用过程略</p><h2 id="图像获取"><a href="#图像获取" class="headerlink" title="图像获取"></a>图像获取</h2><h3 id="2-1-概述"><a href="#2-1-概述" class="headerlink" title="2.1 概述"></a>2.1 概述</h3><p>图像获取是数字图像处理的第一步，它将模拟图像转换成适合数字计算机处理的数字图像</p><p>图像采样：空间坐标位置<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>的离散化(数字化)</p><p>图像量化：图像像素值f的离散化(数字化)</p><h3 id="2-2-连续图像模型"><a href="#2-2-连续图像模型" class="headerlink" title="2.2 连续图像模型"></a>2.2 连续图像模型</h3><p>用<strong>数学方法</strong>表示图像的特征是设计和分析图像处理系统的必要手段；图像特征的数学表示方法：确定性和统计性</p><p>确定性：图像函数是确定的，可用来分析图像的点性质<br>统计的图像表示方法：用统计的平均参数说明图像特征</p><p>连续图像的表达式(确定性)</p><p>连续图像的随机表征(统计性)<br>图像函数是一种空间变量为(x,y)、时间变量为t的三维<strong>连续随机过程</strong>(对于给定的(x,y,t),图像函数的值是一个随机变量)随机过程可以由它的<strong>联合概率密度</strong>(表示在空间位置(x,y),和时间t处，图像函数取某个值f的概率密度(概率密度用于描述连续性随机变量在某一点附近取值的可能性大小))完全地表示出来</p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">{</mo><mi>f</mi><mo separator="true">;</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">p\{f;x,y,t\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">}</span></span></span></span><ul><li><p>常用的概率密度模型</p><ul><li>均匀密度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">{</mo><mi>f</mi><mo separator="true">;</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">}</mo><mo>=</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">p\{f;x,y,t\}=\alpha </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span></li><li>雷利密度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">{</mo><mi>f</mi><mo separator="true">,</mo><mo separator="true">;</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">}</mo><mo>=</mo><mfrac><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><msup><mi>α</mi><mn>2</mn></msup></mfrac><msup><mi>e</mi><mrow><mo>−</mo><mfrac><mrow><msup><mi>f</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><mrow><mn>2</mn><msup><mi>α</mi><mn>2</mn></msup></mrow></mfrac></mrow></msup></mrow><annotation encoding="application/x-tex">p \{f,;x,y,t\}=\frac{f(x,y,t)}{\alpha^2}e^{-\frac{f^2(x,y,t)}{2\alpha^2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mpunct">,;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.6741em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.3291em;"><span style="top:-3.4534em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.251em;"><span style="top:-2.5062em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9384em;"><span style="top:-2.9384em;margin-right:0.1em;"><span class="pstrut" style="height:2.6444em;"></span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.5021em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0484em;"><span style="top:-3.0484em;margin-right:0.1em;"><span class="pstrut" style="height:2.6444em;"></span><span class="mord mtight">2</span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4938em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span></li><li>指数密度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">{</mo><mi>f</mi><mo separator="true">;</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">}</mo><mo>=</mo><mi>α</mi><msup><mi>e</mi><mrow><mo>−</mo><mi>α</mi><mo stretchy="false">∣</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">∣</mo></mrow></msup></mrow><annotation encoding="application/x-tex">p\{f;x,y,t\}=\alpha e^{-\alpha \lvert f(x,y,t)\lvert}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="mopen mtight">∣</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span><span class="mopen mtight">∣</span></span></span></span></span></span></span></span></span></span></span></span> ,<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>为常数</li><li>高斯密度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">{</mo><mi>f</mi><mo separator="true">;</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">}</mo><mo>=</mo><mo stretchy="false">[</mo><mn>2</mn><mi>π</mi><msubsup><mi>σ</mi><mi>f</mi><mn>2</mn></msubsup><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><msup><mo stretchy="false">]</mo><mrow><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></msup><msup><mi>e</mi><mrow><mo>−</mo><mfrac><mrow><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>−</mo><msub><mi>η</mi><mi>f</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><msup><mo stretchy="false">]</mo><mn>2</mn></msup></mrow><mrow><mn>2</mn><msubsup><mi>σ</mi><mi>f</mi><mn>2</mn></msubsup><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow></msup></mrow><annotation encoding="application/x-tex">p\{f;x,y,t\}=[2\pi \sigma^2_{f}(x,y,t)]^{-\frac{1}{2}}e^{- \frac{[f(x,y,t)-\eta_f(x,y,t)]^2}{2\sigma^2_f(x,y,t)}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2908em;vertical-align:-0.4192em;"></span><span class="mopen">[</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4169em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4192em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.954em;"><span style="top:-3.363em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8443em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.8716em;"><span style="top:-3.8716em;margin-right:0.05em;"><span class="pstrut" style="height:3.0227em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.461em;"><span style="top:-2.4699em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9892em;"><span style="top:-2.1488em;margin-left:-0.0359em;margin-right:0.1em;"><span class="pstrut" style="height:2.6944em;"></span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span><span style="top:-3.0392em;margin-right:0.1em;"><span class="pstrut" style="height:2.6944em;"></span><span class="mord mtight">2</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.7121em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:-0.0359em;margin-right:0.1em;"><span class="pstrut" style="height:2.6944em;"></span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5441em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span><span class="mclose mtight"><span class="mclose mtight">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0484em;"><span style="top:-3.0484em;margin-right:0.1em;"><span class="pstrut" style="height:2.6444em;"></span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0587em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span></li><li>拉普拉斯密度<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">{</mo><mi>f</mi><mo separator="true">;</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">}</mo><mo>=</mo><mfrac><mi>α</mi><mn>2</mn></mfrac><msup><mi>e</mi><mrow><mo>−</mo><mi>α</mi><mo stretchy="false">∣</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">∣</mo></mrow></msup></mrow><annotation encoding="application/x-tex">p\{f;x,y,t\}= \frac{\alpha}{2}e^{-\alpha \lvert f(x,y,t)\lvert}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.233em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="mopen mtight">∣</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span><span class="mopen mtight">∣</span></span></span></span></span></span></span></span></span></span></span></span></li><li>条件概率 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">{</mo><msub><mi>f</mi><mn>1</mn></msub><mo separator="true">;</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="false">∣</mo><msub><mi>f</mi><mn>2</mn></msub><mo separator="true">;</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="false">}</mo><mo>=</mo><mfrac><mrow><mi>p</mi><mo stretchy="false">{</mo><msub><mi>f</mi><mn>1</mn></msub><msub><mi>f</mi><mn>2</mn></msub><mo separator="true">;</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>t</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="false">}</mo></mrow><mrow><mi>p</mi><mo stretchy="false">{</mo><msub><mi>f</mi><mn>2</mn></msub><mo separator="true">;</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="false">}</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">p\{f_1;x_1,y_1,t_1 \lvert f_2;x_2,y_2,t_2\}=\frac{p\{f_1f_2;x_1,x_2,y_1,y_2,t_1,t_2\}}{p\{f_2;x_2,y_2,t_2\}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mopen mtight">{</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.1076em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">;</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">}</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mopen mtight">{</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.1076em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.1076em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">;</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">}</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li></ul></li><li><p>图像随机过程的数字特征(用于描述和分析图像随机过程统计特性的一些量化指标)</p><ul><li>一阶矩或平均值<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>η</mi><mi>f</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>E</mi><mo stretchy="false">{</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo><mo>=</mo><msubsup><mo>∫</mo><mrow><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mrow><mo>+</mo><mi mathvariant="normal">∞</mi></mrow></msubsup><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mi>p</mi><mo stretchy="false">{</mo><mi>f</mi><mo separator="true">;</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">}</mo><mi>d</mi><mi>f</mi></mrow><annotation encoding="application/x-tex">\eta_f(x,y,t)=E\{f(x,y,t)\}=\int_{-\infty}^{+\infty} f(x,y,t)p\{f;x,y,t\}df</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)}</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3804em;vertical-align:-0.4142em;"></span><span class="mop"><span class="mop op-symbol small-op" style="margin-right:0.19445em;position:relative;top:-0.0006em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9662em;"><span style="top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.2579em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">+</span><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4142em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mord mathnormal">p</span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">}</span><span class="mord mathnormal" style="margin-right:0.10764em;">df</span></span></span></span></li><li>二阶矩或相关函数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>t</mi><mn>1</mn></msub><mo separator="true">;</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mi>E</mi><mo stretchy="false">{</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msup><mi>f</mi><mo>∗</mo></msup><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">R(x_1,y_1,t_1;x_2,y_2,t_2)=E\{f(x_1,y_1,t_1)f^*(x_2,y_2,t_2)\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)}</span></span></span></span>&#x3D;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∫</mo><mrow><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mrow><mo>+</mo><mi mathvariant="normal">∞</mi></mrow></msubsup><msubsup><mo>∫</mo><mrow><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mrow><mo>+</mo><mi mathvariant="normal">∞</mi></mrow></msubsup><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><mi>y</mi><msub><mn>1</mn><mo separator="true">,</mo></msub><msub><mi>t</mi><mn>1</mn></msub><msup><mi>f</mi><mo>∗</mo></msup><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mi>p</mi><mo stretchy="false">{</mo><msub><mi>f</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>f</mi><mn>2</mn></msub><mo separator="true">;</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>t</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="false">}</mo><mi>d</mi><msub><mi>f</mi><mn>1</mn></msub><mi>d</mi><msub><mi>f</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\int^{+\infty}_{-\infty}\int_{- \infty}^{+\infty}f(x_1,y1_,t_1f^*(x_2,y_2,t_2)p\{f_1,f_2;x_1,y_1,t_1,x_2,y_2,t_2\}df_1df_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3804em;vertical-align:-0.4142em;"></span><span class="mop"><span class="mop op-symbol small-op" style="margin-right:0.19445em;position:relative;top:-0.0006em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9662em;"><span style="top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.2579em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">+</span><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4142em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="margin-right:0.19445em;position:relative;top:-0.0006em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9662em;"><span style="top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.2579em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">+</span><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4142em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.0761em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mpunct mtight">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal">p</span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li><li>自协方差<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>σ</mi><mi>f</mi><mn>2</mn></msubsup><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>K</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>t</mi><mo separator="true">;</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma^2_f(x,y,t)=K(x,y,t;x,y,t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2333em;vertical-align:-0.4192em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4169em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4192em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></li><li>方差<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mo separator="true">,</mo></msub><msub><mi>t</mi><mn>1</mn></msub><mo separator="true">;</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mi>R</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>t</mi><mn>1</mn></msub><mo separator="true">;</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>−</mo><msub><mi>η</mi><mi>f</mi></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msubsup><mi>η</mi><mi>f</mi><mo>∗</mo></msubsup><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">K(x_1,y_,t_1;x_2,y_2,t_2)=R(x_1,y_1,t_1;x_2,y_2,t_2)-\eta_f(x_1,y_1,t_1)\eta^*_f(x_2,y_2,t_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.0761em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mpunct mtight">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1692em;vertical-align:-0.4192em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-2.4169em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4192em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li></ul></li></ul><h3 id="2-3-连续图像的频谱"><a href="#2-3-连续图像的频谱" class="headerlink" title="2.3 连续图像的频谱"></a>2.3 连续图像的频谱</h3><p>频谱：频率分布信息</p><p>连续图像的表示方法：空域法、变换域法<br>（1）空域法：f(x,y)<br>（2）变换域法：连续图像的频谱表示(即<strong>图像傅里叶变换系数</strong>表示的方法)</p><h4 id="一维连续傅里叶变换"><a href="#一维连续傅里叶变换" class="headerlink" title="一维连续傅里叶变换"></a>一维连续傅里叶变换</h4><p>已知原始图像的一维表示形式为f(x),以及欧拉公示:</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>e</mi><mrow><mi>i</mi><mi>θ</mi></mrow></msup><mo>=</mo><mi>cos</mi><mo>⁡</mo><mi>θ</mi><mo>+</mo><mi>i</mi><mi>sin</mi><mo>⁡</mo><mi>θ</mi></mrow><annotation encoding="application/x-tex">e^{i\theta} = \cos\theta + i\sin\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8991em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mop">cos</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span></span><p>傅里叶变换：</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>∫</mo><mrow><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mrow><mo>+</mo><mi mathvariant="normal">∞</mi></mrow></msubsup><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>j</mi><mn>2</mn><mi>π</mi><mi>u</mi><mi>x</mi></mrow></msup><mi>d</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">F(u)= \int_{-\infty}^{+ \infty}f(x)e^{-j2 \pi ux}dx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4915em;vertical-align:-0.9703em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5212em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">+</span><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9703em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mord mtight">2</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="mord mathnormal mtight">ux</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span></span></span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>∫</mo><mrow><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mrow><mo>+</mo><mi mathvariant="normal">∞</mi></mrow></msubsup><mi>F</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><msup><mi>e</mi><mrow><mi>j</mi><mn>2</mn><mi>π</mi><mi>u</mi><mi>x</mi></mrow></msup><mi>d</mi><mi>u</mi></mrow><annotation encoding="application/x-tex">F(x)=\int_{-\infty}^{+ \infty}F(u)e^{j2 \pi ux}du</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3804em;vertical-align:-0.4142em;"></span><span class="mop"><span class="mop op-symbol small-op" style="margin-right:0.19445em;position:relative;top:-0.0006em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9662em;"><span style="top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.2579em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">+</span><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4142em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mord mtight">2</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="mord mathnormal mtight">ux</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">d</span><span class="mord mathnormal">u</span></span></span></span><p>变换存在的充分条件<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∫</mo><mrow><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mrow><mo>+</mo><mi mathvariant="normal">∞</mi></mrow></msubsup><mo stretchy="false">∣</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">∣</mo><mi>d</mi><mi>x</mi><mo>&lt;</mo><mi mathvariant="normal">∞</mi></mrow><annotation encoding="application/x-tex">\int_{-\infty}^{+ \infty} \lvert f(x) \lvert dx &lt; \infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3804em;vertical-align:-0.4142em;"></span><span class="mop"><span class="mop op-symbol small-op" style="margin-right:0.19445em;position:relative;top:-0.0006em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9662em;"><span style="top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.2579em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">+</span><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4142em;"><span></span></span></span></span></span></span><span class="mopen">∣</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mopen">∣</span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord">∞</span></span></span></span>,无限区间内，函数的绝对值可积</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>=</mo><mi>R</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>+</mo><mi>j</mi><mi>I</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(u)=R(u)+jI(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span></span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">∣</mo><mi>F</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo stretchy="false">∣</mo><msup><mi>e</mi><mrow><mi>j</mi><mi>ϕ</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">F(u)=\lvert F(u) \lvert e^{j\phi(u)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mopen">∣</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mopen">∣</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mord mathnormal mtight">ϕ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">u</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span><p>幅度谱<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">∣</mo><mi>F</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo stretchy="false">∣</mo><mo>=</mo><mo stretchy="false">[</mo><msup><mi>R</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>+</mo><msup><mi>I</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><msup><mo stretchy="false">]</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></msup></mrow><annotation encoding="application/x-tex">\lvert F(u) \lvert=[R^2(u)+I^2(u)]^{\frac{1}{2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">∣</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mopen">∣</span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.204em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.954em;"><span style="top:-3.363em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8443em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span><br>相位谱<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>=</mo><mi>t</mi><mi>a</mi><msup><mi>n</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mfrac><mrow><mi>I</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\phi(u)=tan^{-1}\frac{I(u)}{R(u)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">u</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">u</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><br>能谱<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">∣</mo><mi>F</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><msup><mo stretchy="false">∣</mo><mn>2</mn></msup><mo>=</mo><msup><mi>R</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>+</mo><msup><mi>I</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">E(u)=\lvert F(u)\lvert^2 =R^2(u)+I^2(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">∣</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mopen"><span class="mopen">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span></p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>∫</mo><mrow><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></msubsup><msup><mi>e</mi><mrow><mo>−</mo><mi>j</mi><mn>2</mn><mi>π</mi><mo stretchy="false">(</mo><mi>u</mi><mi>x</mi><mo>+</mo><mi>v</mi><mi>y</mi><mo stretchy="false">)</mo></mrow></msup><mi>d</mi><mi>x</mi><mi>d</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">F(u,v)=\int_{-\infty}^{\infty}e^{-j2\pi(ux+vy)}dxdy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3846em;vertical-align:-0.9703em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4143em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9703em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mord mtight">2</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">ux</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>∫</mo><mrow><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></msubsup><mi>F</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><msup><mi>e</mi><mrow><mi>j</mi><mn>2</mn><mi>π</mi><mo stretchy="false">(</mo><mi>u</mi><mi>x</mi><mo separator="true">,</mo><mi>v</mi><mi>y</mi><mo stretchy="false">)</mo></mrow></msup><mi>d</mi><mi>u</mi><mi>d</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">f(x,y)=\int_{-\infty}^{\infty}F(u,v)e^{j2\pi(ux,vy)}dudv</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3022em;vertical-align:-0.4142em;"></span><span class="mop"><span class="mop op-symbol small-op" style="margin-right:0.19445em;position:relative;top:-0.0006em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8593em;"><span style="top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.2579em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4142em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mord mtight">2</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">ux</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">d</span><span class="mord mathnormal">u</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span><p>变换存在的充分条件<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∫</mo><mrow><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></msubsup><msubsup><mo>∫</mo><mrow><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></msubsup><mo stretchy="false">∣</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo stretchy="false">∣</mo><mi>d</mi><mi>x</mi><mi>d</mi><mi>y</mi><mo>&lt;</mo><mi mathvariant="normal">∞</mi></mrow><annotation encoding="application/x-tex">\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}\lvert f(x,y) \lvert dxdy &lt; \infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2734em;vertical-align:-0.4142em;"></span><span class="mop"><span class="mop op-symbol small-op" style="margin-right:0.19445em;position:relative;top:-0.0006em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8593em;"><span style="top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.2579em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4142em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="margin-right:0.19445em;position:relative;top:-0.0006em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8593em;"><span style="top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.2579em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4142em;"><span></span></span></span></span></span></span><span class="mopen">∣</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mopen">∣</span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord">∞</span></span></span></span></p><h4 id="二维连续傅里叶变换"><a href="#二维连续傅里叶变换" class="headerlink" title="二维连续傅里叶变换"></a>二维连续傅里叶变换</h4><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>∫</mo><mrow><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></msubsup><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>j</mi><mn>2</mn><mi>π</mi><mo stretchy="false">(</mo><mi>u</mi><mi>x</mi><mo separator="true">,</mo><mi>v</mi><mi>y</mi><mo stretchy="false">)</mo></mrow></msup><mi>d</mi><mi>x</mi><mi>d</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">F(u,v)=\int_{-\infty}^{\infty}f(x,y)e^{-j2\pi(ux,vy)}dxdy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3846em;vertical-align:-0.9703em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4143em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9703em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mord mtight">2</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">ux</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mi>R</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>+</mo><mi>j</mi><mi>I</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(u,v)=R(u,v)+jI(u,v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span></span><p>幅度谱</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">∣</mo><mi>F</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">∣</mo><mo>=</mo><mo stretchy="false">[</mo><msup><mi>R</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>+</mo><msup><mi>I</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><msup><mo stretchy="false">]</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></msup></mrow><annotation encoding="application/x-tex">\lvert F(u,v) \lvert=[R^2(u,v)+I^2(u,v)]^{\frac{1}{2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">∣</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mopen">∣</span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.254em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.004em;"><span style="top:-3.413em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8443em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span></span><p>相位谱</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mi>t</mi><mi>a</mi><msup><mi>n</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mfrac><mrow><mi>I</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\phi(u,v)=tan^{-1}\frac{I(u,v)}{R(u,v)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><p>能谱</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>E</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">∣</mo><mi>F</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><msup><mo stretchy="false">∣</mo><mn>2</mn></msup><mo>=</mo><msup><mi>R</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>+</mo><msup><mi>I</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">E(u,v)=\lvert F(u,v) \lvert^2=R^2(u,v)+I^2(u,v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mopen">∣</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mopen"><span class="mopen">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span></span><h3 id="2-4-图像采集"><a href="#2-4-图像采集" class="headerlink" title="2.4 图像采集"></a>2.4 图像采集</h3><p>大多数传感器输出的是连续的电压波形，为了产生数字图像，需要把连续的感知数据转化为数字形式，需要进行采样</p><p>采样：也称取样(抽样)，是指把空间域或时间域的连续量转化成离散量的过程。<br>也指把模拟音频转成数字音频的过程<br>在数字图像处理领域中，定义为<strong>图像空间坐标的数字化</strong>操作</p><p>等距离采样：在空间坐标轴上等间隔的抽取函数的样值</p><h4 id="采样定理"><a href="#采样定理" class="headerlink" title="采样定理"></a>采样定理</h4><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>s</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></munderover><mi>δ</mi><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mi>n</mi><mi>T</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>δ</mi><mi>T</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">s(x)=\sum_{n=-\infty}^{\infty}\delta(x-nT)=\delta_T(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9597em;vertical-align:-1.3083em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.9em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3083em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>f</mi><mi>s</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>s</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f_s(x)=f(x)*s(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>f</mi><mi>s</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></munderover><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>δ</mi><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mi>n</mi><mi>T</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f_s(x)=\sum_{n=-\infty}^{\infty}f(x)\delta(x-nT)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9597em;vertical-align:-1.3083em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.9em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3083em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">)</span></span></span></span></span><p>采样周期：T<br>采样频率：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Ω</mi><mi>s</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>T</mi></mfrac></mrow><annotation encoding="application/x-tex">\Omega_s=\frac{1}{T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>S</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>T</mi></mfrac><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></munderover><mi>δ</mi><mo stretchy="false">(</mo><mi>u</mi><mo>−</mo><mi>k</mi><msub><mi mathvariant="normal">Ω</mi><mi>s</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">S(u)=\frac{1}{T}\sum_{k=-\infty}^{\infty}\delta(u-k\Omega_s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.0118em;vertical-align:-1.3604em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3604em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>F</mi><mi>s</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>S</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>T</mi></mfrac><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></munderover><mi>F</mi><mo stretchy="false">(</mo><mi>u</mi><mo>−</mo><mi>k</mi><msub><mi mathvariant="normal">Ω</mi><mi>s</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F_s(u)=F(u)*S(u)=\frac{1}{T}\sum_{k=-\infty}^{\infty}F(u-k\Omega_s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.0118em;vertical-align:-1.3604em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3604em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>s</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F_s(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span>是频域上的周期函数，它满足<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>s</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>F</mi><mi>s</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo>±</mo><mi>k</mi><msub><mi mathvariant="normal">Ω</mi><mi>s</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F_s(u)=F_s(u\pm k\Omega_s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">±</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>是由一组移位的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span>叠加而成，但在幅度上有1/T的变化<p>函数f(x)经采样后，采样点间的信息就丢失了</p><blockquote><p>假设f(x)为一<strong>带限函数</strong>：即以原点为中心的有限区间(带宽)之外的频率值，其傅里叶变换为0，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Ω</mi><mi>M</mi></msub></mrow><annotation encoding="application/x-tex">\Omega_M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为f(x)的最高频率</p></blockquote><img src="/JasmineRain.github.io/2025/09/11/%E6%95%B0%E5%AD%97%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/%E9%87%87%E6%A0%B7%E5%AE%9A%E7%90%86.png" class="" title="采样定理"> %}<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>F</mi><mi>s</mi></msub><mo separator="true">⋅</mo><mi>H</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">[</mo><mfrac><mn>1</mn><mi>T</mi></mfrac><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></munderover><mi>F</mi><mo stretchy="false">(</mo><mi>u</mi><mo>−</mo><mi>k</mi><msub><mi mathvariant="normal">Ω</mi><mi>s</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo separator="true">⋅</mo><mi>H</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F_s · H(u)=[\frac{1}{T}\sum_{k=-\infty}^{\infty}F(u-k\Omega_s)]·H(u)=F(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.0118em;vertical-align:-1.3604em;"></span><span class="mopen">[</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3604em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)]</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span></span><p>直接对上式取傅里叶反变换，就得到了原函数f(x)</p><p>空间采样函数</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>s</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>m</mi><mo>=</mo><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></munderover><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></munderover><mi>δ</mi><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mi>m</mi><mi mathvariant="normal">Δ</mi><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>−</mo><mi>n</mi><mi mathvariant="normal">Δ</mi><mi>y</mi><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi mathvariant="normal">/</mi><mtext>二维单位对冲函数</mtext></mrow><annotation encoding="application/x-tex">s(x,y)=\sum_{m=-\infty}^{\infty}\sum_{n=-\infty}^{\infty}\delta(x-m\Delta x,y-n\Delta y) //二维单位对冲函数</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9597em;vertical-align:-1.3083em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.9em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3083em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.9em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3083em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">m</span><span class="mord">Δ</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord">//</span><span class="mord cjk_fallback">二维单位对冲函数</span></span></span></span></span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>S</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mi mathvariant="normal">Δ</mi><mi>x</mi><mi mathvariant="normal">Δ</mi><mi>y</mi></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></munderover><mi>δ</mi><mo stretchy="false">(</mo><mi>u</mi><mo>−</mo><mi>i</mi><msub><mi mathvariant="normal">Ω</mi><mi>x</mi></msub><mo separator="true">,</mo><mi>v</mi><mo>−</mo><mi>j</mi><msub><mi mathvariant="normal">Ω</mi><mi>y</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">S(u,v)=\frac{1}{\Delta x \Delta y}\sum_{i=-\infty}^{\infty}\sum_{j=-\infty}^{\infty}\delta(u-i\Omega_x,v-j\Omega_y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.0652em;vertical-align:-1.4138em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">Δ</span><span class="mord mathnormal">x</span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.336em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">i</span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><p>空间采样频率</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="normal">Ω</mi><mi>x</mi></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mi mathvariant="normal">Δ</mi><mi>x</mi></mrow></mfrac><mo separator="true">,</mo><msub><mi mathvariant="normal">Ω</mi><mi>y</mi></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mi mathvariant="normal">Δ</mi><mi>y</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\Omega_x=\frac{1}{\Delta x},\Omega_y=\frac{1}{\Delta y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">Δ</span><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2019em;vertical-align:-0.8804em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><p>采集后图像</p><p>空间域</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>g</mi><mi>s</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo separator="true">⋅</mo><mi>s</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>m</mi><mo>=</mo><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></munderover><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></munderover><mi>f</mi><mo stretchy="false">(</mo><mi>m</mi><mi mathvariant="normal">Δ</mi><mi>x</mi><mo separator="true">,</mo><mi>n</mi><mi mathvariant="normal">Δ</mi><mi>y</mi><mo stretchy="false">)</mo><mo separator="true">⋅</mo><mi>δ</mi><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mi>m</mi><mi mathvariant="normal">Δ</mi><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>−</mo><mi>n</mi><mi mathvariant="normal">Δ</mi><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g_s(x,y)=f(x,y)·s(x,y)=\sum_{m=-\infty}^{\infty}\sum_{n=-\infty}^{\infty}f(m\Delta x,n\Delta y)·\delta(x-m\Delta x,y-n\Delta y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9597em;vertical-align:-1.3083em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.9em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3083em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.9em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3083em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord">Δ</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">m</span><span class="mord">Δ</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span></span><p>频域</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>G</mi><mi>s</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>S</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G_s(u,v)=F(u,v)*S(u,v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span></span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>G</mi><mi>s</mi></msub><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mi mathvariant="normal">Δ</mi><mi>x</mi><mi mathvariant="normal">Δ</mi><mi>y</mi></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></munderover><mi>F</mi><mo stretchy="false">(</mo><mi>u</mi><mo>−</mo><mi>i</mi><msub><mi mathvariant="normal">Ω</mi><mi>x</mi></msub><mo separator="true">,</mo><mi>v</mi><mo>−</mo><mi>j</mi><msub><mi mathvariant="normal">Ω</mi><mi>y</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G_s(u,v)=\frac{1}{\Delta x \Delta y}\sum_{i=-\infty}^{\infty}\sum_{j=-\infty}^{\infty}F(u-i\Omega_x,v-j\Omega_y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.0652em;vertical-align:-1.4138em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">Δ</span><span class="mord mathnormal">x</span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.336em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">i</span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><h5 id="奈奎斯特准则"><a href="#奈奎斯特准则" class="headerlink" title="奈奎斯特准则"></a>奈奎斯特准则</h5><p>设二维(图像)函数f(x,y)的频谱是有限带宽的，即当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">∣</mo><mi>u</mi><mo stretchy="false">∣</mo><mo>&gt;</mo><msub><mi mathvariant="normal">Ω</mi><mrow><mi>x</mi><mi>f</mi></mrow></msub><mo separator="true">,</mo><mo stretchy="false">∣</mo><mi>v</mi><mo stretchy="false">∣</mo><mo>&gt;</mo><msub><mi mathvariant="normal">Ω</mi><mrow><mi>y</mi><mi>f</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\lvert u \lvert &gt; \Omega_{xf},\lvert v \lvert &gt; \Omega_{yf}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">∣</span><span class="mord mathnormal">u</span><span class="mopen">∣</span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">∣</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mopen">∣</span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>时，F(u,v)&#x3D;0,如果采样频率满足</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="normal">Ω</mi><mi>x</mi></msub><mo>&gt;</mo><mn>2</mn><msub><mi mathvariant="normal">Ω</mi><mrow><mi>x</mi><mi>f</mi></mrow></msub><mo separator="true">,</mo><msub><mi mathvariant="normal">Ω</mi><mi>y</mi></msub><mo>&gt;</mo><mn>2</mn><msub><mi mathvariant="normal">Ω</mi><mrow><mi>y</mi><mi>f</mi></mrow></msub><mo stretchy="false">(</mo><mtext>奈奎斯特准则</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Omega_x &gt; 2\Omega_{xf},\Omega_y&gt;2\Omega_{yf}  (奈奎斯特准则)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord">2</span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord">2</span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord cjk_fallback">奈奎斯特准则</span><span class="mclose">)</span></span></span></span></span><p>或者采样周期满足</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="normal">Δ</mi><mi>x</mi></msub><mo>&lt;</mo><mfrac><mn>1</mn><mrow><mn>2</mn><msub><mi mathvariant="normal">Ω</mi><mrow><mi>x</mi><mi>f</mi></mrow></msub></mrow></mfrac><mo separator="true">,</mo><msub><mi mathvariant="normal">Δ</mi><mi>y</mi></msub><mo>&lt;</mo><mfrac><mn>1</mn><mrow><mn>2</mn><msub><mi mathvariant="normal">Ω</mi><mrow><mi>y</mi><mi>f</mi></mrow></msub></mrow></mfrac><mo stretchy="false">(</mo><mtext>奈奎斯特准则</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Delta_x&lt;\frac{1}{2\Omega_{xf}},\Delta_y&lt;\frac{1}{2\Omega_{yf}}  (奈奎斯特准则)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2935em;vertical-align:-0.9721em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2935em;vertical-align:-0.9721em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord cjk_fallback">奈奎斯特准则</span><span class="mclose">)</span></span></span></span></span><h5 id="均匀采样"><a href="#均匀采样" class="headerlink" title="均匀采样"></a>均匀采样</h5><p>上述讨论的等间隔采样。当对采样点数目有所限制时，比如说N*N各采样点，此时可以根据图像的特征采用自适应采样方案，有可能获得更好的效果</p><p>自适应采样方案的基本思想是：在图像函数值变化较大的区域采用精细的采样，在相对平滑的区域采用粗糙的采样。这种自适应采样方案又称为非均匀采样</p><blockquote><p>采样点越多，分辨率越高，图像质量越好。当分辨率低到一定程度时，图像会出现<strong>马赛克效应(棋盘格效应)</strong></p></blockquote><h6 id="非统一的图像的采样"><a href="#非统一的图像的采样" class="headerlink" title="非统一的图像的采样"></a>非统一的图像的采样</h6><p>在灰度级变化尖锐的区域，用细腻的采样，在灰度级比较平滑的区域，采用粗糙的采样</p><h3 id="2-5-图像量化"><a href="#2-5-图像量化" class="headerlink" title="2.5 图像量化"></a>2.5 图像量化</h3><ol><li><p>为什么要量化？<br>  连续图像经过采样后得到的样本图像是定义在离散空间域上的二维离散图像(仅X,Y的数字化)，但样本图像的每个点的灰度值(f仍为连续空间取值)仍然是一个连续量</p></li><li><p>量化，将离散图像的值表示为与其幅度成比例的整数</p></li><li><p>量化过程：预先设定一组判决电平，降采样点的灰度值域判决电平进行比较，若在区间内，则取该区间对应的代表值</p></li></ol><h4 id="量化器模型"><a href="#量化器模型" class="headerlink" title="量化器模型"></a>量化器模型</h4><h4 id="标准量化"><a href="#标准量化" class="headerlink" title="标准量化"></a>标准量化</h4><p>量化误差：</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>e</mi><mo>=</mo><mi>x</mi><mo>−</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e=x-Q(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span><p>均方误差:</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>σ</mi><mi>e</mi><mn>2</mn></msubsup><mo>=</mo><mi>E</mi><mo stretchy="false">{</mo><mo stretchy="false">[</mo><mi>x</mi><mo>−</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><msup><mo stretchy="false">]</mo><mn>2</mn></msup><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\sigma^2_e = E\{[x-Q(x)]^2\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1111em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">{[</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>σ</mi><mi>e</mi><mn>2</mn></msubsup><mo>=</mo><msubsup><mo>∫</mo><mrow><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></msubsup><mo stretchy="false">[</mo><mi>x</mi><mo>−</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><msup><mo stretchy="false">]</mo><mn>2</mn></msup><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>d</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">\sigma^2_e =\int_{-\infty}^{\infty}[x-Q(x)]^2p(x)dx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1111em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3846em;vertical-align:-0.9703em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4143em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9703em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span></span></span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>σ</mi><mi>e</mi><mn>2</mn></msubsup><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msubsup><mo>∫</mo><msub><mi>a</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><msub><mi>a</mi><mi>i</mi></msub></msubsup><mo stretchy="false">[</mo><mi>x</mi><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><msup><mo stretchy="false">]</mo><mn>2</mn></msup><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>d</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">\sigma^2_e =\sum_{i=1}^N \int_{a_{i-1}}^{a_i}[x-y_i]^2p(x)dx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1111em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.106em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4143em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2025em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0537em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span></span></span><p>信噪比：</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>S</mi><mi>N</mi><mi>R</mi><mo>=</mo><mn>10</mn><mi>l</mi><mi>g</mi><mfrac><msup><mi>σ</mi><mn>2</mn></msup><msubsup><mi>σ</mi><mi>e</mi><mn>2</mn></msubsup></mfrac></mrow><annotation encoding="application/x-tex">SNR=10lg\frac{\sigma^2}{\sigma^2_e}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">SNR</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4241em;vertical-align:-0.933em;"></span><span class="mord">10</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.933em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup><mo>=</mo><mi>E</mi><msup><mi>x</mi><mn>2</mn></msup><mo>=</mo><msubsup><mo>∫</mo><mrow><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></msubsup><msup><mi>x</mi><mn>2</mn></msup><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>d</mi><mi>x</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msubsup><mo>∫</mo><msub><mi>a</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><msub><mi>a</mi><mi>i</mi></msub></msubsup><msup><mi>x</mi><mn>2</mn></msup><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>d</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">\sigma^2=E{x^2}=\int_{-\infty}^{\infty}x^2p(x)dx=\sum_{i=1}^{N}\int_{a_{i-1}}^{a_i}x^2p(x)dx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8641em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8641em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3846em;vertical-align:-0.9703em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4143em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9703em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.106em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4143em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2025em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0537em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span></span></span><blockquote><p>最优量化器设计就是取均方差最小或信噪比最大的量化</p></blockquote><p><strong>压扩量化</strong>——与非均匀量化器等效的均匀量化方法</p><p>压扩量化变换表</p><table><thead><tr><th></th><th>概率密度</th><th>正变换</th><th>逆变换</th></tr></thead><tbody><tr><td>高斯</td><td><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><msup><mi>σ</mi><mn>2</mn></msup><msup><mo stretchy="false">)</mo><mrow><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></msup><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">{</mo><mo>−</mo><mfrac><msup><mi>f</mi><mn>2</mn></msup><mrow><mn>2</mn><msup><mi>σ</mi><mn>2</mn></msup></mrow></mfrac><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">p(f)=(2\pi\sigma^2)^{-\frac{1}{2}}exp\{-\frac{f^2}{2\sigma^2}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1771em;vertical-align:-0.686em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.004em;"><span style="top:-3.413em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8443em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mopen">{</span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">}</span></span></span></span></span></td><td><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>g</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>e</mi><mi>r</mi><mi>f</mi><mfrac><mi>f</mi><mrow><msqrt><mn>2</mn></msqrt><mi>σ</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">g=\frac{1}{2}erf{\frac{f}{\sqrt{2}\sigma}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3014em;vertical-align:-0.93em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.2028em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9072em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span></span></span><span style="top:-2.8672em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1328em;"><span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></td><td><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi>f</mi><mo>^</mo></mover><mo>=</mo><msqrt><mn>2</mn></msqrt><mi>σ</mi><msup><mrow><mi>e</mi><mi>r</mi><mi>f</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">{</mo><mn>2</mn><mover accent="true"><mi>g</mi><mo>^</mo></mover><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\hat{f}=\sqrt{2}\sigma {erf}^{-1}\{2\hat{g}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1523em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.0833em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2061em;vertical-align:-0.25em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9561em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span></span></span><span style="top:-2.9161em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.0839em;"><span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8984em;"><span style="top:-3.1473em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">{</span><span class="mord">2</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span></td></tr><tr><td>雷斯</td><td><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mi>f</mi><msup><mi>σ</mi><mn>2</mn></msup></mfrac><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">{</mo><mo>−</mo><mfrac><msup><mi>f</mi><mn>2</mn></msup><mrow><mn>2</mn><msup><mi>σ</mi><mn>2</mn></msup></mrow></mfrac><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">p(f)=\frac{f}{\sigma^2}exp\{- \frac{f^2}{2\sigma^2}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1771em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mopen">{</span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">}</span></span></span></span></span></td><td><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>g</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>−</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">{</mo><mo>−</mo><mfrac><msup><mi>f</mi><mn>2</mn></msup><mrow><mn>2</mn><msup><mi>σ</mi><mn>2</mn></msup></mrow></mfrac><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">g=\frac{1}{2}-exp\{- \frac{f^2}{2\sigma^2}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.1771em;vertical-align:-0.686em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mopen">{</span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">}</span></span></span></span></span></td><td><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi>f</mi><mo>^</mo></mover><mo>=</mo><mo stretchy="false">{</mo><msqrt><mn>2</mn></msqrt><mi>σ</mi><mi>l</mi><mi>n</mi><mo stretchy="false">[</mo><mfrac><mn>1</mn><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>−</mo><mover accent="true"><mi>g</mi><mo>^</mo></mover></mrow></mfrac><mo stretchy="false">]</mo><msup><mo stretchy="false">}</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></msup></mrow><annotation encoding="application/x-tex">\hat{f}=\{\sqrt{2}\sigma ln[\frac{1}{\frac{1}{2}-\hat{g}}]\}^{\frac{1}{2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1523em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.0833em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4015em;vertical-align:-1.0801em;"></span><span class="mopen">{</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9561em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span></span></span><span style="top:-2.9161em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.0839em;"><span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">n</span><span class="mopen">[</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.2649em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0801em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">]</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.004em;"><span style="top:-3.413em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8443em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></td></tr><tr><td>拉普拉斯</td><td><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mi>α</mi><mn>2</mn></mfrac><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">{</mo><mo>−</mo><mi>α</mi><mo stretchy="false">∣</mo><mi>f</mi><mo stretchy="false">∣</mo><mo stretchy="false">}</mo><mo separator="true">,</mo><mi>α</mi><mo>=</mo><mfrac><msqrt><mn>2</mn></msqrt><mi>σ</mi></mfrac></mrow><annotation encoding="application/x-tex">p(f)=\frac{\alpha}{2}exp\{-\alpha\lvert f\lvert\},\alpha=\frac{\sqrt{2}}{\sigma}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.7936em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mopen">{</span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mopen">∣</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">∣</span><span class="mclose">}</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2702em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5842em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9072em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span></span></span><span style="top:-2.8672em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1328em;"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></td><td><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>g</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">[</mo><mn>1</mn><mo>−</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">{</mo><mo>−</mo><mi>α</mi><mi>f</mi><mo stretchy="false">}</mo><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>f</mi><mo>≥</mo><mn>0</mn><mo separator="true">;</mo><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">[</mo><mn>1</mn><mo>−</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">{</mo><mi>α</mi><mi>f</mi><mo stretchy="false">}</mo><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>f</mi><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">g=\frac{1}{2}[1-exp\{-\alpha f\}],f\geq0;-\frac{1}{2}[1-exp\{\alpha f\}],f&lt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">[</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mopen">{</span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mclose">}]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord">0</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">[</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mclose">}]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span></td><td><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi>f</mi><mo>^</mo></mover><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mi>α</mi></mfrac><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mn>2</mn><mover accent="true"><mi>g</mi><mo>^</mo></mover><mo stretchy="false">)</mo><mo separator="true">,</mo><mover accent="true"><mi>g</mi><mo>^</mo></mover><mo>≥</mo><mn>0</mn><mo separator="true">;</mo><mfrac><mn>1</mn><mi>α</mi></mfrac><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mn>2</mn><mover accent="true"><mi>g</mi><mo>^</mo></mover><mo stretchy="false">)</mo><mo separator="true">,</mo><mover accent="true"><mi>g</mi><mo>^</mo></mover><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\hat{f}=-\frac{1}{\alpha}ln(1-2\hat{g}),\hat{g}\geq 0;\frac{1}{\alpha}ln(1+2\hat{g}),\hat{g}&lt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1523em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.0833em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord">0</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span></td></tr><tr><td>其中<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>e</mi><mi>r</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>2</mn><msqrt><mi>π</mi></msqrt></mfrac><msubsup><mo>∫</mo><mn>0</mn><mi>x</mi></msubsup><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mo>−</mo><msup><mi>y</mi><mn>2</mn></msup><mo stretchy="false">)</mo><mi>d</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">erf(x)=\frac{2}{\sqrt{\pi}}\int_{0}^{x}exp(-y^2)dy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3443em;vertical-align:-0.93em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.3097em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8003em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span><span style="top:-2.7603em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2397em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4143em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span></td><td></td><td></td><td></td></tr></tbody></table><blockquote><p>标准量化的缺点：仅孤立地考虑一个模拟样本值并量化，没有考虑样本值之间的相关性，如果考虑相关性，就要用到向量量化的方法</p></blockquote><p>在实际量化编码时，只需在发送端记录代表向量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的下标i，所以编码过程就是将输入向量映射到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mo>=</mo><mo stretchy="false">{</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo separator="true">⋅</mo><mo separator="true">⋅</mo><mo separator="true">⋅</mo><mo separator="true">,</mo><mi>J</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">I=\{1,2,···,J\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,⋅⋅⋅,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mclose">}</span></span></span></span>；而译码过程则是在接受端根据收到的I代码查找码书，获得对应的码字</p><h4 id="向量量化的特点"><a href="#向量量化的特点" class="headerlink" title="向量量化的特点"></a>向量量化的特点</h4><ol><li><p><strong>压缩能力强</strong>:由于码书长度J一般远小于总的输入信号样本数，适当选取码书长度和码字维数，可以获得很大的压缩比</p></li><li><p><strong>码书控制着量化失真量的大小</strong>：向量量化中码书的码字越多，失真就越小。只要适当选取码字数量，就能控制失真量在容许的范围内。因此，码书设计是向量量化的关键环节之一</p></li><li><p><strong>计算量大</strong>：向量量化每输入一个向量f，都要和J个码字逐一比较，搜索出最接近的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，所以工作量很大。因此，寻求一种很是的快速码书搜索算法是实现向量量化的第二个关键</p></li><li><p><strong>向量量化是定长码，容易处理</strong></p></li></ol><h4 id="LBG算法"><a href="#LBG算法" class="headerlink" title="LBG算法"></a>LBG算法</h4><p>设计向量量化器码书的算法</p><h4 id="码书搜索"><a href="#码书搜索" class="headerlink" title="码书搜索"></a>码书搜索</h4><h4 id="一个向量量化的例子"><a href="#一个向量量化的例子" class="headerlink" title="一个向量量化的例子"></a>一个向量量化的例子</h4><p>学生的(身高，体重，年龄)这三个信息：<br>身高：160-175和175-190，代表值取167.5cm和182.5cm<br>体重：60-75kg和75-90kg，代表值取67.5kg和82.5kg<br>年龄：16-18岁和18-20岁，代表值取17岁和19岁</p><p>学生A为(172,70,17,5),量化结果为(167.5，67.5，17)<br>学生B为(168,68,17,8),量化结果为(167.5,67.5,17)</p><blockquote><p>一般的量化值用整数来表示。充分考虑到人眼的识别能力之后，目前非特殊用途的图像均为8bits量化，即用0<del>255描述“黑</del>白”</p></blockquote><p>量化等级越高，图像质量越好。当量化等级低到一定的程度，图像会出现虚假轮廓(或称木刻效果)</p><h5 id="非统一的图像的量化"><a href="#非统一的图像的量化" class="headerlink" title="非统一的图像的量化"></a>非统一的图像的量化</h5><p>在边界附近使用较少的灰度级。剩余的灰度级可用于灰度级变化比较平滑的区域<br>避免或减少由于量化的太粗糙，在灰度级变化比较平滑的区域出现假轮廓的现象</p><h3 id="2-6-数字图像的基本概念"><a href="#2-6-数字图像的基本概念" class="headerlink" title="2.6 数字图像的基本概念"></a>2.6 数字图像的基本概念</h3><p>[<br>\begin{pmatrix}<br>f(0,0) &amp; f(0,1) &amp; … &amp; f(0,N-1)\<br>f(1,0) &amp; f(1,1) &amp; … &amp; f(1,N-1)\<br>. &amp; . &amp;.&amp;.\<br>. &amp; .&amp;..&amp;.\<br>.&amp;.&amp;…&amp;.\<br>f(M-1,0)&amp;f(M-1,1)&amp;…&amp;f(M-1,N-1)<br>\end{pmatrix}<br>]</p><p>M和N为正整数<br>矩阵中的每个元素称为图像单元，又称为图像元素，或简称<strong>像素</strong></p><h4 id="数字图像的表示"><a href="#数字图像的表示" class="headerlink" title="数字图像的表示"></a>数字图像的表示</h4><p>（1）<strong>二进制图像</strong><br>在一幅二进制图像中，每一个像素将取两个离散数值(0或1)中的一个。二进制图像使用uint8或双精度类型的数组来存储</p><p>（2）<strong>索引图像</strong><br>索引图像是一种把像素直接作为RGB调色板下标的图像。</p><p>（3）<strong>灰度图像</strong><br>灰度图像通常由一个unit8、unit16或双精度类型的数组来描述，其实质是一个数据矩阵I。该矩阵中的数据均代表了在一定范围内的灰度级，每一个元素对应于图像的一个像素点，通常0代表黑色，1、255或65535(针对不同的存储信息)代表白色</p><p>（4）<strong>多帧图像</strong><br>多帧图像是一种包含多幅图像或帧的图像文件，又称为多页图像或图像序列，主要用于需要对时间或空间场景上相关图像集合进行操作的场合。</p><p>（5）<strong>RGB图像</strong><br>RGB图像又称为真彩图像，它是利用R、G、B三个分量表示一个像素的颜色，R、G、B分别代表红、绿、蓝三种不同的基本颜色，通过三基色可以合成出任意颜色。</p><h4 id="空间分辨率对图像质量的影响"><a href="#空间分辨率对图像质量的影响" class="headerlink" title="空间分辨率对图像质量的影响"></a>空间分辨率对图像质量的影响</h4><p>随着空间分辨率的降低，图中各区域边缘处的棋盘模式越来越明显，并且全图的像素颗粒变得越来越粗，当空间分辨率低到一定的程度，会出现棋盘格效应，或马赛克效果</p><blockquote><p>由此可见，图像的空间分辨率越低，图像的质量越差</p></blockquote><h4 id="灰度分辨率变化对图像视觉效果的影响"><a href="#灰度分辨率变化对图像视觉效果的影响" class="headerlink" title="灰度分辨率变化对图像视觉效果的影响"></a>灰度分辨率变化对图像视觉效果的影响</h4><p>随着灰度分辨率的降低，图像的细节信息在逐渐损失，伪轮廓信息在逐渐增加。由于伪轮廓信息的积累，图像已显现出了木刻的效果。由此说明：灰度分辨率越低，图像的视觉效果越差。</p><h4 id="像素间的基本关系"><a href="#像素间的基本关系" class="headerlink" title="像素间的基本关系"></a>像素间的基本关系</h4><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mn>4</mn></msub><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N_4(p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span>——像素(x,y)的4邻域<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x+1,y),(x-1,y),(x,y+1),(x,y-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>D</mi></msub><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N_D(p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span>——像素(x,y)的对角邻域<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>y</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mi>y</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mi>y</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x+1,y+1),(x+1,y),(x-1,y+1),(x-1,y-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mn>8</mn></msub><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N_8(p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span>——像素(x,y)的8邻域<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mn>4</mn></msub><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>N</mi><mi>D</mi></msub><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N_4(p)+N_D(p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span><p>V是用于定义连接性的灰度值集合</p><p>p和q之间的<strong>欧氏距离</strong>定义为：</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>D</mi><mi>e</mi></msub><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mi>s</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy="false">(</mo><mi>y</mi><mo>−</mo><mi>t</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><msup><mo stretchy="false">]</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></msup></mrow><annotation encoding="application/x-tex">D_e(p,q)=[(x-s)^2+(y-t)^2]^{\frac{1}{2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.254em;vertical-align:-0.25em;"></span><span class="mord mathnormal">t</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.004em;"><span style="top:-3.413em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8443em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span></span><p>根据这个距离度量，与点（x，y）的距离小于或等于某一值d的像素组成以（x，y）为中心，以d为半径的圆</p>]]></content>
      
      
      <categories>
          
          <category> 专业选修课 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数字图像处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>一些关于Redis</title>
      <link href="/JasmineRain.github.io/2025/09/10/%E4%B8%80%E4%BA%9B%E5%85%B3%E4%BA%8ERedis/"/>
      <url>/JasmineRain.github.io/2025/09/10/%E4%B8%80%E4%BA%9B%E5%85%B3%E4%BA%8ERedis/</url>
      
        <content type="html"><![CDATA[<h2 id="Redis简单介绍"><a href="#Redis简单介绍" class="headerlink" title="Redis简单介绍"></a>Redis简单介绍</h2><p>Redis是基于内存的高性能key-value存储(支持多种数据结构:string、Hash、List、Set、Sorted Set、Bitmap、HyperLogLog、Stream等)</p><p>内存读写极快，支持持久化(RDB&#x2F;AOF)、单线程处理命令(命令执行是原子性的)、支持复制、哨兵高可用和Cluster分片</p><p>常用场景:缓存、会话、限流、计数器、排行榜、消息队列、分布式锁等</p><p>持久化：RDB(快照):低开销，可能丢数据点(适合备份);AOF(命令追加):更耐久但文件更大、更慢些(可配置fsync策略)</p><p>内存管理&#x2F;驱逐策略：</p><ul><li><code>maxmemory</code>用来限制内存；当满时按<code>maxmemory-policy</code>决定如何驱逐:<code>noeviction</code>、<code>allkeys-lru</code>、<code>volatile-lru</code>、<code>volatile-ttl</code>、<code>allkeys-random</code>等，选<code>allkeys-lru</code>常用于缓存场景</li></ul><p>原子性&#x2F;事务&#x2F;脚本:单命令原子:<code>MULTI/EXEC</code>是事务队列(不保证隔离);Lua脚本在Redis内部执行，整体原子且性能好(常用于实现安全释放锁等)</p><p>集群:RedisCluster按16384个hash slots分片，跨分片的多键操作有限制(需要在同一slot才能多键操作)</p><p>监控与调优:关注<code>INFO</code>、<code>slowlog</code>、内存使用、evictions、命中率(hit ratio)、客户端阻塞等</p><h2 id="分布式锁"><a href="#分布式锁" class="headerlink" title="分布式锁"></a>分布式锁</h2><h3 id="为什么需要分布式锁"><a href="#为什么需要分布式锁" class="headerlink" title="为什么需要分布式锁"></a>为什么需要分布式锁</h3><p>当多个进程&#x2F;机器并发的访问同一共享资源时，需要分布式锁保证互斥</p><h3 id="分布式锁的必要属性"><a href="#分布式锁的必要属性" class="headerlink" title="分布式锁的必要属性"></a>分布式锁的必要属性</h3><ul><li>互斥性：同一时刻只有一个持有者</li><li>安全释放：只有锁的持有者能释放该锁</li><li>可用性&#x2F;死锁防止：如果持有者崩溃，锁应当在TTL后自动释放，或可被续租</li><li>性能：加&#x2F;释放开销要小</li></ul><h3 id="用Redis实现分布式锁"><a href="#用Redis实现分布式锁" class="headerlink" title="用Redis实现分布式锁"></a>用Redis实现分布式锁</h3><h4 id="获取锁-核心命令"><a href="#获取锁-核心命令" class="headerlink" title="获取锁(核心命令)"></a>获取锁(核心命令)</h4><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET key value NX PX &lt;ttl&gt;</span><br></pre></td></tr></table></figure><ul><li><code>NX</code>：只在key不存在时设置，相当于SETNX</li><li><code>PX &lt;ttl&gt;</code>:设置过期时间，毫秒</li><li><code>value</code>:必须是唯一标识，例如UUID，用来标记谁是锁的拥有者</li></ul><p>伪代码示例:</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">clientId=UUID()</span><br><span class="line">ok==redis.set(&quot;lock:order:123&quot;,clientId,NX,PX,10000)</span><br><span class="line">if ok == &quot;OK&quot;:</span><br><span class="line">    //获取资源</span><br><span class="line">else:</span><br><span class="line">    //失败，稍后重试或返回错误</span><br></pre></td></tr></table></figure><h4 id="安全释放-绝对不要用DEL-key直接释放"><a href="#安全释放-绝对不要用DEL-key直接释放" class="headerlink" title="安全释放(绝对不要用DEL key直接释放)"></a>安全释放(绝对不要用<code>DEL key</code>直接释放)</h4><p>必须先检查自己是持有者(vlaue匹配)再删除，最安全的方法用Lua脚本在Redis端原子执行:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- release.lua</span></span><br><span class="line"><span class="keyword">if</span> redis.call(<span class="string">&quot;GET&quot;</span>,KEYS[<span class="number">1</span>])==ARGV[<span class="number">1</span>] <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">return</span> redis.call(<span class="string">&quot;DEL&quot;</span>,KEYS[<span class="number">1</span>])</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>在客户端：<code>EVAL</code>或<code>EVALSHA</code>执行上述脚本，传参<code>KEYS[1]=lock_key</code>,<code>ARGV[1]=clientId</code></p><h4 id="重试与超时策略-获取锁"><a href="#重试与超时策略-获取锁" class="headerlink" title="重试与超时策略(获取锁)"></a>重试与超时策略(获取锁)</h4><ul><li>避免忙等(spin)；使用指数退避(exponential backoff)或固定短间隔重试直到总超时时间耗尽</li><li>设计合理的lock TTL:<code>ttl=expected_work_time+safety_margin</code>不要设得太短(可能任务还没做完锁就过期)，也不要太长(若持有者挂了，会长时间阻塞别人)</li></ul><h4 id="端续租-续期"><a href="#端续租-续期" class="headerlink" title="端续租(续期)"></a>端续租(续期)</h4><p>如果任务可能比最初预计长，需要一个续租&#x2F;自动刷新机制：</p><ul><li>客户端在锁到期前周期性延长TTL(但要确保只有持有者能延长，检查value)</li><li>风险：客户端暂停&#x2F;GC导致错续，需谨慎；续期一定要有失败回退逻辑</li></ul><p>示例伪代码，获取+释放</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function tryLock(key,clientId,ttl,waitTimeout):</span><br><span class="line">    endTime=now()+waitTimeout</span><br><span class="line">    while now()&lt;endTime:</span><br><span class="line">        if redis.SET(key,clientId,NX,PX,ttl)==OK:</span><br><span class="line">            return true</span><br><span class="line">        sleep(small_backoff)</span><br><span class="line">    return false</span><br><span class="line"></span><br><span class="line">function releaseLock(key,clientId):</span><br><span class="line">    -- call Lua script shown above</span><br></pre></td></tr></table></figure><h3 id="Redlock-多节点Redis-和争议"><a href="#Redlock-多节点Redis-和争议" class="headerlink" title="Redlock(多节点Redis)和争议"></a>Redlock(多节点Redis)和争议</h3><ul><li><p>Redlock是Antirez(Redis作者)提出的一个算法：在多个独立Redis节点上尝试拿锁，超过半数即认为获得锁，解锁从所有节点删除。目的是提高可用性&#x2F;容错</p></li><li><p>争议：一些研究&#x2F;文章认为Redlock在网络分区下并不能完全实现强一致性(特别是时钟漂移、网络延迟等)。因此在强一致性要求极高的场景，推荐使用基于<strong>一致性算法</strong>(Paxos&#x2F;Raft)的系统(etcd、Zookeeper、Consul)来做分布式锁</p></li><li><p>工程实践：若场景读写频繁且对性能要求极高，Redis-based lock(单实例或哨兵保证高可用)足够；若需要严格一致性，优先选择etcd&#x2F;sookeeper</p></li></ul><h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ul><li>不要把锁用于长时间操作，锁持有时间应短</li><li>锁的TTL要比操作预期时间长，但不能过长：若短可能导致自动释放后另一个客户端获得锁并同时有前一个客户端继续执行(重复执行问题)</li><li>释放锁时必须检查owner(Lua)</li><li>不要在锁中做大量I&#x2F;O或阻塞操作(会增加失败概率)</li><li>考虑时钟与网络延迟：不要假设绝对精确的时钟或零延迟</li></ul><h2 id="缓存"><a href="#缓存" class="headerlink" title="缓存"></a>缓存</h2><h3 id="常见缓存模式"><a href="#常见缓存模式" class="headerlink" title="常见缓存模式"></a>常见缓存模式</h3><ul><li><p>Cache-Aside(旁路缓存&#x2F;应用控制缓存)：流程：应用先查缓存-&gt;缓存未命中则查数据库-&gt;将结果写入缓存-&gt;返回.写操作：先写DB-&gt;删除&#x2F;更新缓存(或同时更新)。优点：灵活，常用。缺点：需要处理并发写入&#x2F;缓存失效引发的不一致</p></li><li><p>Read-Through&#x2F;Write-Through&#x2F;Write-Behind:</p><ul><li>Read-Through:缓存自己去加载DB(缓存库&#x2F;中间件实现)</li><li>Write-through:写缓存同时写DB(同步)</li><li>Write-behind:写缓存先返回，由后台把缓存写入DB(异步)。这些模式适合不同一致性&#x2F;性能权衡。</li></ul></li><li><p>Stale-While-Revalidate(容忍旧数据，后台刷新)，缓存过期时仍返回旧值给用户，同时后台刷新缓存(减少击穿)</p></li></ul><h3 id="缓存失效问题"><a href="#缓存失效问题" class="headerlink" title="缓存失效问题"></a>缓存失效问题</h3><ul><li><p>缓存穿透:请求大量不存在的数据(或恶意请求)，每次都会落到DB，绕过缓存，造成DB压力</p></li><li><p>缓存击穿&#x2F;缓存穿透(有些文献称”击穿”为热点key失效导致的高并发打到DB)，指某个(热点)key在某一瞬间过期，大量并发请求同时去DB重建缓存，DB瞬时被打垮</p></li><li><p>缓存雪崩(cache avalanche)<br>多个key在同一时间过期&#x2F;缓存服务宕机&#x2F;网络波动导致大面积缓存失效，从而大量请求直接打DB，引发连锁故障</p></li></ul><h2 id="各类问题的解决方法"><a href="#各类问题的解决方法" class="headerlink" title="各类问题的解决方法"></a>各类问题的解决方法</h2><h3 id="缓存穿透的常见策略"><a href="#缓存穿透的常见策略" class="headerlink" title="缓存穿透的常见策略"></a>缓存穿透的常见策略</h3><ul><li>参数校验：对请求参数(ID格式、范围)做校验，直接拒掉明显非法请求</li><li>布隆过滤器(Bloom filter)：把所有合法key(或大概率合法)放入Bloom Filter，查询前先校验(Bloom有误判但不漏报，可能拒绝掉一些合法键，但不会把不存在的当存在)。优点内存占用小，查询快；但需要维护(新增&#x2F;删除)和误判处理</li><li>缓存空结果：对于DB确认不存在的key，缓存一个空对象(或特殊值)但TTL设短(比如1-5分钟)，避免短时间内重复打DB。注意防止空值被缓存太长造成的错漏。</li><li>限流&#x2F;反爬虫：对频繁访问不存在key的请求进行限流或封禁IP</li></ul><h3 id="缓存击穿-单个key失效-解决"><a href="#缓存击穿-单个key失效-解决" class="headerlink" title="缓存击穿(单个key失效)解决"></a>缓存击穿(单个key失效)解决</h3><ul><li><p>互斥锁：当缓存miss时，只有一个请求去DB获取并重建缓存，其他请求等待&#x2F;返回旧值或轮询重试。实现方法：</p><ul><li>应用内singlefight(Go的singlefight包)——在单机实例内合并并发请求。</li><li>分布式情况下，用Redis的锁(SET NX)让单个实例去重建缓存</li></ul></li><li><p>永不过期&#x2F;极长TTL+后台异步刷新：把热点数据设置长TTL，并用后台任务周期刷新(适用于热点且变化不频繁的数据)</p></li><li><p>Stale-while-revalidate:返回过期前的旧值并异步刷新(对用户体验友好)</p></li></ul><p>伪代码(互斥锁重建)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">value=redis.get(key)</span><br><span class="line">if value!=nil:</span><br><span class="line">    return value</span><br><span class="line"></span><br><span class="line">if acquire_lock(&quot;lock:&quot;+key):</span><br><span class="line">    //double check,别重复查库</span><br><span class="line">    value = redis.get(key)</span><br><span class="line">    if value !=nil:</span><br><span class="line">        release_lock(...)</span><br><span class="line">        return value</span><br><span class="line">    value=db.get(key)</span><br><span class="line">    redis.set(key,value,ttl)</span><br><span class="line">    release_lock(...)</span><br><span class="line">    return value</span><br><span class="line">else:</span><br><span class="line">    //其他请求等待或短轮询，或直接返回适当错误</span><br><span class="line">    sleep(short)</span><br><span class="line">    goto try again</span><br></pre></td></tr></table></figure><h3 id="缓存雪崩-大面积失效-解决"><a href="#缓存雪崩-大面积失效-解决" class="headerlink" title="缓存雪崩(大面积失效)解决"></a>缓存雪崩(大面积失效)解决</h3><ul><li>TTL随机化：给不同key设置随机的TTL(例如base_ttl * (0.8~1.2))，避免同一时刻大量过期</li><li>缓存预热(Warm-up):上线&#x2F;重启&#x2F;版本切换后，主动把热点数据预先填入缓存。</li><li>多级缓存：第一层内存缓存(应用进程本地)，第二层Redis，减少瞬时Redis压力。若Redis宕机，第一层还能缓解短时间内压力。</li><li>降级与限流:流量激增时，服务降级(返回默认值&#x2F;静态页面)，或对DB进行限流保护。</li><li>扩容&#x2F;冗余：保证Redis集群有足够容量和高可用部署，避免单点故障。</li></ul><h2 id="实用示例"><a href="#实用示例" class="headerlink" title="实用示例"></a>实用示例</h2><h3 id="安全释放锁-必须用"><a href="#安全释放锁-必须用" class="headerlink" title="安全释放锁(必须用)"></a>安全释放锁(必须用)</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- release.Lua</span></span><br><span class="line"><span class="keyword">if</span> redis.call(<span class="string">&quot;GET&quot;</span>,KEYS[<span class="number">1</span>])==ARGV[<span class="number">1</span>] <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">return</span> redis.call(<span class="string">&quot;DEL&quot;</span>,KEYS[<span class="number">1</span>])</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>使用(伪)</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EVALSHA &lt;sha1&gt; 1 lock:key &lt;clientId&gt;</span><br></pre></td></tr></table></figure><h3 id="获取锁带重试-伪Java"><a href="#获取锁带重试-伪Java" class="headerlink" title="获取锁带重试(伪Java)"></a>获取锁带重试(伪Java)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">lockKey</span> <span class="operator">=</span> <span class="string">&quot;lock:order:123&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">clientId</span> <span class="operator">=</span> UUID.randomUUID().toString();</span><br><span class="line"><span class="type">long</span> ttl=<span class="number">10000</span>;<span class="comment">//ms</span></span><br><span class="line"><span class="type">long</span> waitTimeout=<span class="number">5000</span>;<span class="comment">//ms</span></span><br><span class="line"></span><br><span class="line"><span class="type">long</span> end=System.currentTimeMillis()+waitTimeout;</span><br><span class="line"><span class="keyword">while</span>(System.currentTimeMillis()&lt;end)&#123;</span><br><span class="line">    String ok=jedis.set(lockKey,clientId,<span class="string">&quot;NX&quot;</span>,<span class="string">&quot;PX&quot;</span>,ttl);</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">&quot;OK&quot;</span>.equals(ok))&#123;</span><br><span class="line">        <span class="comment">//got Lock</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Thread.sleep(<span class="number">50</span>);<span class="comment">//backoff</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>释放用上面的Lua脚本(执行EVAL)</p><h3 id="缓存旁路-伪代码"><a href="#缓存旁路-伪代码" class="headerlink" title="缓存旁路(伪代码)"></a>缓存旁路(伪代码)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">function getUser(id):</span><br><span class="line">    key = &quot;user:&quot;+id</span><br><span class="line">    value = redis.get(key)</span><br><span class="line">    if value != null:</span><br><span class="line">        return value</span><br><span class="line">    //miss</span><br><span class="line">    user = do.query(id)</span><br><span class="line">    if user == null:</span><br><span class="line">        redis.set(key,NULL_PLACEHOLDER,short_ttl)</span><br><span class="line">        return null</span><br><span class="line">    redis.set(key,serialize(user),normal_ttl)</span><br><span class="line">    return user</span><br></pre></td></tr></table></figure><h2 id="最佳实践清单"><a href="#最佳实践清单" class="headerlink" title="最佳实践清单"></a>最佳实践清单</h2><ul><li><p>缓存:</p><ul><li>使用<code>cache-aside</code>模式常见且灵活</li><li>对不存在的值缓存短期空值，避免穿透</li><li>热点key使用长TTL+异步刷新或<code>stale-while-revalidate</code></li><li>给TTL添加随机抖动，避免同化失效</li><li>监控命中率、evictions、内存、慢查询</li></ul></li><li><p>锁</p><ul><li>锁value必须唯一(UUID);释放时要校验value再DEL(Lua)</li><li>锁TTL选取合理；若需要更长，做安全续租</li><li>避免在锁中做长时间阻塞或外部调用</li><li>对强一致性需求高的场景，考虑etcd&#x2F;zookeeper</li></ul></li><li><p>Redis选型&#x2F;运维</p><ul><li>选择合适持久化(RDB&#x2F;AOF)与持久化策略</li><li>生产环境用Cluster&#x2F;哨兵&#x2F;Replica做高可用与扩容</li><li>设置<code>maxmemory</code>和合适<code>eviction policy</code></li><li>定期运行内存分析，避免大value(如把大对象拆成hash)</li></ul></li></ul><h2 id="常见问答"><a href="#常见问答" class="headerlink" title="常见问答"></a>常见问答</h2><h3 id="Redis锁能保证绝对安全吗？"><a href="#Redis锁能保证绝对安全吗？" class="headerlink" title="Redis锁能保证绝对安全吗？"></a>Redis锁能保证绝对安全吗？</h3><p>单实例+SET NX PX +Lua脚本能解决大部分问题，但在网络分区、客户端挂起(GC)或多实例复杂失败场景下仍有edge-case。需要严格一致性时选用Raft&#x2F;Paxos系统(etcd&#x2F;zookeeper)</p><h3 id="布隆过滤器会占用内存吗？误判怎么办？"><a href="#布隆过滤器会占用内存吗？误判怎么办？" class="headerlink" title="布隆过滤器会占用内存吗？误判怎么办？"></a>布隆过滤器会占用内存吗？误判怎么办？</h3><p>布隆滤器用很少表示海量key，误判率可通过位数组大小和hash函数数目调节。误判会把某些合法key误判为”可能存在”,需设计容错(短TTL)</p><h3 id="Redis单线程是不是性能瓶颈？"><a href="#Redis单线程是不是性能瓶颈？" class="headerlink" title="Redis单线程是不是性能瓶颈？"></a>Redis单线程是不是性能瓶颈？</h3><p>Redis单线程是命令处理单线程，I&#x2F;O使用multiplexing，单命令执行速度极快。瓶颈通常在网络、内存或慢命令(如复杂的<code>KEYS</code>)上</p>]]></content>
      
      
      <categories>
          
          <category> Redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>一些关于MySQL</title>
      <link href="/JasmineRain.github.io/2025/09/09/%E4%B8%80%E4%BA%9B%E5%85%B3%E4%BA%8EMySQL/"/>
      <url>/JasmineRain.github.io/2025/09/09/%E4%B8%80%E4%BA%9B%E5%85%B3%E4%BA%8EMySQL/</url>
      
        <content type="html"><![CDATA[<h2 id="MySQL基础概念"><a href="#MySQL基础概念" class="headerlink" title="MySQL基础概念"></a>MySQL基础概念</h2><p>MySQL是一个关系型数据库管理系统(RDBMS)，它存储的数据是结构化的，使用表来存储信息，支持SQL(机构化查询语言)来操作数据</p><table><thead><tr><th>概念</th><th>说明</th></tr></thead><tbody><tr><td>数据库</td><td>数据的集合</td></tr><tr><td>表</td><td>数据库中的具体存储机构</td></tr><tr><td>行</td><td>表中的一条记录</td></tr><tr><td>列</td><td>表的字段</td></tr><tr><td>主键</td><td>唯一标识一行记录</td></tr><tr><td>外键</td><td>关联另一张表的字段</td></tr><tr><td>索引</td><td>加速数据查询的工具</td></tr></tbody></table><h2 id="MySQL数据类型"><a href="#MySQL数据类型" class="headerlink" title="MySQL数据类型"></a>MySQL数据类型</h2><p>数值类型</p><table><thead><tr><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>INT</td><td>整数</td></tr><tr><td>BIGINT</td><td>大整数</td></tr><tr><td>DECIMAL</td><td>精确小数</td></tr><tr><td>FLOAT&#x2F;DOUBLE</td><td>浮点数</td></tr></tbody></table><p>字符串类型</p><table><thead><tr><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>CHAR(n)</td><td>固定长度</td></tr><tr><td>VARCHAR(n)</td><td>可变长度</td></tr><tr><td>TEXT</td><td>长文本</td></tr></tbody></table><p>日期时间类型</p><table><thead><tr><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>DATE</td><td>日期(YYYY-MM-DD)</td></tr><tr><td>DATETIME</td><td>日期时间</td></tr><tr><td>TIMESTAMP</td><td>时间戳，自动记录修改时间</td></tr></tbody></table><h2 id="基本SQL操作"><a href="#基本SQL操作" class="headerlink" title="基本SQL操作"></a>基本SQL操作</h2><h3 id="创建表"><a href="#创建表" class="headerlink" title="创建表"></a>创建表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> users(</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT,</span><br><span class="line">    username <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">UNIQUE</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">    password <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">    created_at <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="插入数据"><a href="#插入数据" class="headerlink" title="插入数据"></a>插入数据</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT INTO</span> users (username,email,password)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;Alice&#x27;</span>,<span class="string">&#x27;alice@example.com&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>);</span><br></pre></td></tr></table></figure><h3 id="查询数据"><a href="#查询数据" class="headerlink" title="查询数据"></a>查询数据</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询所有列</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span><span class="keyword">FROM</span> users;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询指定列</span></span><br><span class="line"><span class="keyword">SELECT</span> username,email <span class="keyword">FROM</span> users;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 条件查询</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span><span class="keyword">FROM</span> users <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 模糊查询</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span><span class="keyword">FROM</span> users <span class="keyword">WHERE</span> username <span class="keyword">LIKE</span> <span class="string">&#x27;A%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 排序</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span><span class="keyword">FROM</span> users <span class="keyword">ORDER</span> <span class="keyword">BY</span> created_at <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure><h3 id="更新数据"><a href="#更新数据" class="headerlink" title="更新数据"></a>更新数据</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> users <span class="keyword">SET</span> email<span class="operator">=</span><span class="string">&#x27;alice_new@example.com&#x27;</span> <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">1</span>;</span><br></pre></td></tr></table></figure><h3 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">1</span>;</span><br></pre></td></tr></table></figure><h2 id="高级查询"><a href="#高级查询" class="headerlink" title="高级查询"></a>高级查询</h2><h3 id="聚合函数"><a href="#聚合函数" class="headerlink" title="聚合函数"></a>聚合函数</h3><table><thead><tr><th>函数</th><th>说明</th></tr></thead><tbody><tr><td>COUNT(*)</td><td>统计数量</td></tr><tr><td>SUM(column)</td><td>求和</td></tr><tr><td>AVG(column)</td><td>平均值</td></tr><tr><td>MAX(column)</td><td>最大值</td></tr><tr><td>MIN(column)</td><td>最小值</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> users;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(id) <span class="keyword">FROM</span> users;</span><br></pre></td></tr></table></figure><h3 id="分组查询"><a href="#分组查询" class="headerlink" title="分组查询"></a>分组查询</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> role,<span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">as</span> count</span><br><span class="line"><span class="keyword">FROM</span> users</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> role</span><br><span class="line"><span class="keyword">HAVING</span> count <span class="operator">&gt;</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure><h3 id="多表查询"><a href="#多表查询" class="headerlink" title="多表查询"></a>多表查询</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 假设有orders表</span></span><br><span class="line"><span class="keyword">SELECT</span> users.username,order.amount</span><br><span class="line"><span class="keyword">FROM</span> users</span><br><span class="line"><span class="keyword">JOIN</span> orders <span class="keyword">ON</span> users.id <span class="operator">=</span>order.user_id;</span><br></pre></td></tr></table></figure><h3 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> username <span class="keyword">FROM</span> users</span><br><span class="line"><span class="keyword">WHERE</span> id <span class="keyword">IN</span> (<span class="keyword">SELECT</span> user_id FORM orders <span class="keyword">WHERE</span> amount <span class="operator">&gt;</span><span class="number">100</span>);</span><br></pre></td></tr></table></figure><h2 id="索引和优化"><a href="#索引和优化" class="headerlink" title="索引和优化"></a>索引和优化</h2><h3 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h3><p>加快查询速度，但会占用额外空间</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> INDEX idx_username <span class="keyword">ON</span> users(username);</span><br></pre></td></tr></table></figure><h3 id="优化查询"><a href="#优化查询" class="headerlink" title="优化查询"></a>优化查询</h3><ul><li>使用<code>WHERE</code>条件避免全表扫描</li><li>使用<code>LIMIT</code>限制查询数量</li><li>避免SELECT*,只选需要的列</li><li>定期<strong>优化表</strong></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OPTIMIZE <span class="keyword">TABLE</span> users;</span><br></pre></td></tr></table></figure><h2 id="事务和锁"><a href="#事务和锁" class="headerlink" title="事务和锁"></a>事务和锁</h2><h3 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h3><p>事务确保操作的<strong>原子性、一致性、隔离性、持久性(ACID)</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">START</span> TRANSACTION;</span><br><span class="line"></span><br><span class="line"><span class="keyword">UPDATE</span> users <span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">-</span> <span class="number">100</span> <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> users <span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">+</span> <span class="number">100</span> <span class="keyword">WHERE</span> id <span class="operator">=</span><span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">COMMIT</span>;<span class="comment">-- 提交事务</span></span><br><span class="line"><span class="comment">-- ROLLBACK; --回滚事务</span></span><br></pre></td></tr></table></figure><h3 id="锁"><a href="#锁" class="headerlink" title="锁"></a>锁</h3><ul><li>行锁：InnoDB支持，锁单行，适合高并发</li><li>表锁：MyISAM默认，锁整个表</li></ul><h2 id="存储引擎"><a href="#存储引擎" class="headerlink" title="存储引擎"></a>存储引擎</h2><table><thead><tr><th>引擎</th><th>特点</th></tr></thead><tbody><tr><td>InnoDB</td><td>支持事务、行锁、外键</td></tr><tr><td>MyISAM</td><td>不支持事务、速度快，表锁</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> test(</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">    neme <span class="type">VARCHAR</span>(<span class="number">50</span>)</span><br><span class="line">)ENGINE<span class="operator">=</span>InnoDB;</span><br></pre></td></tr></table></figure><h2 id="备份与恢复"><a href="#备份与恢复" class="headerlink" title="备份与恢复"></a>备份与恢复</h2><h3 id="备份数据库"><a href="#备份数据库" class="headerlink" title="备份数据库"></a>备份数据库</h3><blockquote><p>mysqldump -u root -p mudb &gt; mydb_backup.sql</p></blockquote><h3 id="恢复数据库"><a href="#恢复数据库" class="headerlink" title="恢复数据库"></a>恢复数据库</h3><blockquote><p>mysql -u root -p mydb &lt; mydb_backup.sql</p></blockquote><h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><p>创建一个简单的博客系统，用户表、文章表、评论表</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> posts(</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT,</span><br><span class="line">    user_id <span class="type">INT</span>,</span><br><span class="line">    title VERCHAR(<span class="number">100</span>),</span><br><span class="line">    content TEXT,</span><br><span class="line">    created_at <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">    <span class="keyword">FOREIGN KEY</span> (user_id) <span class="keyword">REFERENCES</span> users(id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> comments(</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT,</span><br><span class="line">    post_id <span class="type">INT</span>,</span><br><span class="line">    user_id <span class="type">INT</span>,</span><br><span class="line">    content TEXT,</span><br><span class="line">    created_at <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">    <span class="keyword">FOREIGN KEY</span> (post_id) <span class="keyword">REFERENCES</span> posts(id),</span><br><span class="line">    <span class="keyword">FOREIGN KEY</span> (user_id) <span class="keyword">REFERENCES</span> users(id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="获取文章及评价"><a href="#获取文章及评价" class="headerlink" title="获取文章及评价"></a>获取文章及评价</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> posts.title,users.username,comments.content</span><br><span class="line"><span class="keyword">FROM</span> posts</span><br><span class="line"><span class="keyword">JOIN</span> comments <span class="keyword">ON</span> posts.id <span class="operator">=</span>comments.post_id</span><br><span class="line"><span class="keyword">JOIN</span> users <span class="keyword">ON</span> comments.user_id <span class="operator">=</span> users.id;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> MySQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Gin-Echo</title>
      <link href="/JasmineRain.github.io/2025/09/08/Gin-Echo/"/>
      <url>/JasmineRain.github.io/2025/09/08/Gin-Echo/</url>
      
        <content type="html"><![CDATA[<h2 id="它们是什么"><a href="#它们是什么" class="headerlink" title="它们是什么"></a>它们是什么</h2><ul><li><p>Gin:轻量、性能导向、API风格接近Martini，但实现上更高性能(使用高效路由&#x2F;最小分配等)。适合需要高吞吐与中等复杂度的服务。以最少的开销+开发效率取胜</p></li><li><p>Echo:语言简洁、功能齐全、可拓展性好，内置很多中间件(CORS、JWT、静态、日志等)，上手快，适合快速构建REST服务。以完整性+可拓展性取胜</p></li></ul><h2 id="框架核心对比-要点"><a href="#框架核心对比-要点" class="headerlink" title="框架核心对比(要点)"></a>框架核心对比(要点)</h2><ul><li><p>路由:Gin使用高效的redix&#x2F;tree路由实现(零分配&#x2F;fast)，Echo也有高性能路由实现。两者在典型场景差异很小。</p></li><li><p>中间件链:两者都采用链式中间件(Request-&gt;中间件1-&gt;中间件2-&gt;Handler-&gt;返回)。中间件顺序很重要(认证放在路由前面、错误恢复放最外层等)</p></li><li><p>绑定与验证:Gin原生支持binding标签并在Bind时触发验证(内部使用go-playground&#x2F;validator);Echo通常配合go-playground&#x2F;validator，通过实现echo.Validator把验证接入。推荐统一使用github.com&#x2F;go-playground&#x2F;validator&#x2F;v10</p></li><li><p>模板、静态、文件上传、WebSocket:两者都支持模板渲染与静态文件;WebSocket通常用第三方(gorilla&#x2F;websocket)集成。</p></li><li><p>中小型服务最重要的点:错误处理和一致的JSON返回、鉴权&#x2F;权限、日志&#x2F;追踪、优雅关机。</p></li></ul><h2 id="简短代码示例对比"><a href="#简短代码示例对比" class="headerlink" title="简短代码示例对比"></a>简短代码示例对比</h2><p>Gin最常见的&#x2F;ping示例:</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;net/http&quot;</span></span><br><span class="line">    <span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    r:=gin.Default()<span class="comment">//内置Logger+Recovery</span></span><br><span class="line">    r.Get(<span class="string">&quot;/ping&quot;</span>,<span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span>&#123;</span><br><span class="line">        c.JSON(http.StatusOK,gin.H&#123;<span class="string">&quot;message&quot;</span>:<span class="string">&quot;pong&quot;</span>&#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">    r.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Echo等价的&#x2F;ping示例:</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span>(</span><br><span class="line">    <span class="string">&quot;net/http&quot;</span></span><br><span class="line">    <span class="string">&quot;github.com/labstack/echo/v4&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    e:=echo.New()<span class="comment">//默认Logger+Recovery可选</span></span><br><span class="line">    e.Get(<span class="string">&quot;/ping&quot;</span>,<span class="function"><span class="keyword">func</span><span class="params">(c echo.Context)</span></span><span class="type">error</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> c.JSON(http.StatusOK,<span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>&#123;<span class="string">&quot;message&quot;</span>:<span class="string">&quot;pong&quot;</span>&#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">    e.Start(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Go </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Gin </tag>
            
            <tag> Echo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Dijkstra算法</title>
      <link href="/JasmineRain.github.io/2025/09/08/Dijkstra%E7%AE%97%E6%B3%95/"/>
      <url>/JasmineRain.github.io/2025/09/08/Dijkstra%E7%AE%97%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h2 id="它解决了什么问题"><a href="#它解决了什么问题" class="headerlink" title="它解决了什么问题"></a>它解决了什么问题</h2><p>在大多数最短路径问题中，Dijkstra算法是最常用的、效率最高的。它是一种“单源”最短路径的算法，一次计算能够得到从<strong>一个起点到其他所有点</strong>的最短距离长度、最短路径的途径点</p><p>输入为带权图G&#x3D;(V,E),边权非负(有负权边考虑Bellman-Ford&#x2F;SPFA&#x2F;Johnson)，给定起点，适用于有向图和无向图(无向图就加双向边)</p><h2 id="核心思想-贪心-松弛"><a href="#核心思想-贪心-松弛" class="headerlink" title="核心思想(贪心+松弛)"></a>核心思想(贪心+松弛)</h2><p>维护每个点的“目前已知最短距离”<code>dist[]</code>,反复从<strong>未确定</strong>的点里选出dist最小者u(用最小堆加速)，将它<strong>永久确定</strong>;然后用u去尝试”放松”所有出边(u,v,w):<br>如果<code>dist[v]&gt;dist[u]+w</code>，就更新之，并记录<code>parent[v]=u</code>以便还原路径</p><p>因为所有边权非负，当前dist最小的未确定点u再走任何边其代价只会增加，不可能通过未确定的其他点得到更短的代替路径，故一旦选出就最优(贪心选择性质)</p><h2 id="实现细节-邻接表-最小堆"><a href="#实现细节-邻接表-最小堆" class="headerlink" title="实现细节(邻接表+最小堆)"></a>实现细节(邻接表+最小堆)</h2><ul><li>数据结构:<code>adj[u]</code>存(v,w),<code>priority_queue</code>堆按<code>(dist,node)</code>升序</li><li>常量:<code>INF</code>取很大(如<code>4e18</code>),避免溢出</li><li>复杂度:用二叉堆:<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>V</mi><mo>+</mo><mi>E</mi><mo stretchy="false">)</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>V</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O((V+E)logV)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">((</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mclose">)</span></span></span></span>、用Fibonacci堆(理论):<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>E</mi><mo>+</mo><mi>V</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>V</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(E+VlogV)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mclose">)</span></span></span></span>、稠密图用<strong>邻接矩阵+线性扫描</strong>:<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>V</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(V^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>更简单</li></ul><h2 id="步骤示例"><a href="#步骤示例" class="headerlink" title="步骤示例"></a>步骤示例</h2><table><thead><tr><th>步骤</th><th>做法</th><th>具体操作</th><th>结果</th></tr></thead><tbody><tr><td>1</td><td>从起点s出发，用BFS扩展它的邻居节点</td><td>把这些邻居点放到一个集合A中，并记录这些点到s的距离</td><td></td></tr><tr><td>2</td><td>选择距离s最近的邻居v，继续用BFS扩展v的邻居</td><td>1. 在A中找到距离s最小的点v，把v的邻居点放到A中 2. 如果v的邻居经过v中转，到s的距离更短，则更新这些邻居到s的距离 3.从集合A中移走v，后面不再处理v</td><td>1.得到了从s到v的最短路径 2.v的邻居更新了到s的距离</td></tr><tr><td>3</td><td>重复步骤2，直到所有点都扩展到并计算完毕</td><td></td><td>集合A为空，计算出所有点到s的最短距离</td></tr></tbody></table><h2 id="C-模板-邻接表-最小堆，含路径还原"><a href="#C-模板-邻接表-最小堆，含路径还原" class="headerlink" title="C++模板(邻接表+最小堆，含路径还原)"></a>C++模板(邻接表+最小堆，含路径还原)</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span>&#123;</span><br><span class="line">    <span class="type">int</span> to;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> w;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">const</span> <span class="type">long</span> <span class="type">long</span> INF=(<span class="type">long</span> <span class="type">long</span>)<span class="number">4e18</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="built_in">main</span>()&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="type">int</span> n,m,s;<span class="comment">//顶点数n，边数m，起点s</span></span><br><span class="line">    <span class="keyword">if</span>(!(cin&gt;&gt;n&gt;&gt;m&gt;&gt;s))<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    vector&lt;vector&lt;Edge&gt;&gt;<span class="built_in">adj</span>(n<span class="number">+1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;++i)&#123;</span><br><span class="line">        <span class="type">int</span> u,v;</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> w;</span><br><span class="line">        cin&gt;&gt;u&gt;&gt;v&gt;&gt;w;</span><br><span class="line">        adj[u].<span class="built_in">push_back</span>(&#123;v,w&#125;);<span class="comment">//无向图则再adj[v].push_back(&#123;u,w&#125;);</span></span><br><span class="line">    &#125;</span><br><span class="line">    vector&lt;<span class="type">long</span> <span class="type">long</span>&gt;<span class="built_in">dist</span>(n<span class="number">+1</span>,INF);</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt;<span class="built_in">parent</span>(n<span class="number">+1</span>,<span class="number">-1</span>);</span><br><span class="line">    priority_queue&lt;pair&lt;<span class="type">long</span> <span class="type">long</span>,<span class="type">int</span>&gt;,vector&lt;pair&lt;<span class="type">long</span> <span class="type">long</span>,<span class="type">int</span>&gt;&gt;,greater&lt;pair&lt;<span class="type">long</span> <span class="type">long</span>,<span class="type">int</span>&gt;&gt;&gt;pq;</span><br><span class="line"></span><br><span class="line">    dist[s]=<span class="number">0</span>;</span><br><span class="line">    pq.<span class="built_in">push</span>(&#123;<span class="number">0</span>,s&#125;);</span><br><span class="line">    <span class="keyword">while</span>(!pq.<span class="built_in">empty</span>())&#123;</span><br><span class="line">        <span class="keyword">auto</span> [du,u]=pq.<span class="built_in">top</span>();pq.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">if</span>(du!=dist[u])<span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;e:adj[u])&#123;</span><br><span class="line">            <span class="type">int</span> v=e.to;<span class="type">long</span> <span class="type">long</span> nd=du+e.w;</span><br><span class="line">            <span class="keyword">if</span>(nd&lt;dist[v])&#123;</span><br><span class="line">                dist[v]=nd;</span><br><span class="line">                parent[v]=u;</span><br><span class="line">                pq.<span class="built_in">push</span>(&#123;nd.v&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//输出距离 不可达为-1</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> v=<span class="number">1</span>;v&lt;=n;v++&#123;</span><br><span class="line">        cout&lt;&lt;(dist[v]&gt;=INF/<span class="number">2</span>?<span class="number">-1</span>:dist[v])&lt;&lt;(v==n?<span class="string">&#x27;\n&#x27;</span>:<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//还原s-&gt;t的路径</span></span><br><span class="line">    <span class="type">int</span> t=n;</span><br><span class="line">    <span class="keyword">if</span>(dist[t]&gt;=INF/<span class="number">2</span>)&#123;</span><br><span class="line">        cerr&lt;&lt;<span class="string">&quot;No path\n&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt;path;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> cur=t;cur!=<span class="number">-1</span>;cur=parent[cur])</span><br><span class="line">            path.<span class="built_in">push_back</span>(cur);</span><br><span class="line">        <span class="built_in">reverse</span>(path.<span class="built_in">begin</span>(),path.<span class="built_in">end</span>());</span><br><span class="line">        cerr&lt;&lt;<span class="string">&quot;Path:&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> x:path)cerr&lt;&lt;<span class="string">&#x27; &#x27;</span>&lt;&lt;x;</span><br><span class="line">        cerr&lt;&lt;<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>用<code>long long</code>存边权与距离;<code>du!=dist[u]</code>过滤过期项<br>多组数据时记得清空容器与重置<code>dist/Parent</code><br>无向图要加双向边，有多条边时正常处理(选择更优)</p></blockquote><h2 id="Go模板-最小堆-路径还原"><a href="#Go模板-最小堆-路径还原" class="headerlink" title="Go模板(最小堆+路径还原)"></a>Go模板(最小堆+路径还原)</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span>(</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;container/heap&quot;</span></span><br><span class="line">    <span class="string">&quot;bufio&quot;</span></span><br><span class="line">    <span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Edge <span class="keyword">struct</span>&#123;</span><br><span class="line">    to <span class="type">int</span></span><br><span class="line">    w <span class="type">int64</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> INF <span class="type">int64</span>=<span class="number">4e18</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Item <span class="keyword">struct</span>&#123;</span><br><span class="line">    d <span class="type">int64</span> </span><br><span class="line">    v <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> MinHeap []Item</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(h MinHeap)</span></span> Len() <span class="type">int</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">len</span>(h)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(h MinHeap)</span></span> Less(i,j <span class="type">int</span>) <span class="type">bool</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> h[i].d&lt;h[j].d</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(h MinHeap)</span></span> Swap(i,j <span class="type">int</span>)&#123;</span><br><span class="line">    h[i],h[j]=h[j],h[i]</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(h MinHeap)</span></span> Push(x <span class="keyword">interface</span>&#123;&#125;)&#123;</span><br><span class="line">    *h=<span class="built_in">append</span>(*h,x.(Item))</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(h MinHeap)</span></span> Pop() <span class="keyword">interface</span>&#123;&#125;&#123;</span><br><span class="line">    old:=*h</span><br><span class="line">    x:=old[<span class="built_in">len</span>(old)<span class="number">-1</span>]</span><br><span class="line">    *h=old[:<span class="built_in">len</span>(old)<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    in:=bufio.NewReader(os.Stdin)</span><br><span class="line">    out:=bufio.NewReader(os.Stdout)</span><br><span class="line">    <span class="keyword">defer</span> out.Flush()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> n,m,s <span class="type">int</span></span><br><span class="line">    <span class="keyword">if</span> _,err:=fmt.Fscan(in,&amp;n,&amp;m,&amp;s);err!=<span class="literal">nil</span>&#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    adj:=<span class="built_in">make</span>([][]Edge,n+<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i:=<span class="number">0</span>;i&lt;m;i++&#123;</span><br><span class="line">        <span class="keyword">var</span> u,v <span class="type">int</span></span><br><span class="line">        <span class="keyword">var</span> w <span class="type">int64</span></span><br><span class="line">        fmt.Fscan(in,&amp;u,&amp;v,&amp;w)</span><br><span class="line">        adj[u]=<span class="built_in">append</span>(adj[u],Edge&#123;v,w&#125;)</span><br><span class="line">        <span class="comment">//无向图:adj[v]=append(adj[v],Edge&#123;u,w&#125;)</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    dist:=<span class="built_in">make</span>([]<span class="type">int64</span>,n+<span class="number">1</span>)</span><br><span class="line">    parent:=<span class="built_in">make</span>([]<span class="type">int</span>,n+<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i:=<span class="number">1</span>;i&lt;=n;i++&#123;</span><br><span class="line">        dist[i]=INF</span><br><span class="line">        parent[i]=<span class="number">-1</span></span><br><span class="line">    &#125;</span><br><span class="line">    dist[s]=<span class="number">0</span></span><br><span class="line"></span><br><span class="line">    h:=&amp;MinHeap&#123;&#125;</span><br><span class="line">    heap.Init(h)</span><br><span class="line">    heap.Push(h,Item&#123;<span class="number">0</span>,s&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> h.Len()&gt;<span class="number">0</span>&#123;</span><br><span class="line">        it:=heap.Pop(h).(Item)</span><br><span class="line">        du,u:=it.d,it.v</span><br><span class="line">        <span class="keyword">if</span> du!=dist[u]&#123;<span class="comment">//过期项</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> _,e:=<span class="keyword">range</span> adj[u]&#123;</span><br><span class="line">            v:=e.to</span><br><span class="line">            nd:=du+e.w</span><br><span class="line">            <span class="keyword">if</span> nd&lt;dist[v]&#123;</span><br><span class="line">                dist[v]=nd</span><br><span class="line">                parent[v]=u</span><br><span class="line">                heap.Push(h,Item&#123;nd,v&#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> v:=<span class="number">1</span>;v&lt;=n;v++&#123;</span><br><span class="line">        <span class="keyword">if</span> dist[v]&gt;INF/<span class="number">2</span>&#123;</span><br><span class="line">            fmt.FPrint(out,<span class="number">-1</span>)</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            fmt.Fprint(out,dist[v])</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> v&lt;n&#123;</span><br><span class="line">            fmt.Fprint(out,<span class="string">&quot; &quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Fprint(out)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//还原路径</span></span><br><span class="line">    <span class="keyword">if</span> dist[n]&lt;INF/<span class="number">2</span>&#123;</span><br><span class="line">        path:=[]<span class="type">int</span>&#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> cur:=n;cur!=<span class="number">-1</span>:cur=parent[cur]&#123;</span><br><span class="line">            path=<span class="built_in">append</span>(path,cur)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//反转</span></span><br><span class="line">        <span class="keyword">for</span> i,j:=<span class="number">0</span>,<span class="built_in">len</span>(path)<span class="number">-1</span>;i&lt;j;i,j=i+<span class="number">1</span>,j<span class="number">-1</span>&#123;</span><br><span class="line">            path[i],path[j]=path[j],path[i]</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//打印到标准错误 避免干扰测评输出</span></span><br><span class="line">        fmt.Fprint(os.Stderr,<span class="string">&quot;Path:&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> _,x:=<span class="keyword">range</span> path&#123;</span><br><span class="line">            fmt.Fprint(os.Stderr,<span class="string">&quot; &quot;</span>,x)</span><br><span class="line">        &#125;</span><br><span class="line">        fmt.Fprintln(os.Stderr)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="稠密图的O-写法"><a href="#稠密图的O-写法" class="headerlink" title="稠密图的O()写法"></a>稠密图的O(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>n</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">n^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>)写法</h2><p>适合<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>≈</mo><msup><mi>V</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">E \approx V^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></p><ol><li><p><code>dist[s]=0</code>，其余<code>INF</code>全<code>false</code></p></li><li><p>循环<code>n</code>次：</p><ul><li>在线性扫描访问点中找<code>dist</code>最小的u，标记<code>vis[u]=true</code></li><li>用u松弛所有<code>v</code>:<code>dist[v]=min(dist[v],dist[u]+w[u][v])</code>复杂度<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li></ul></li></ol><h2 id="常见坑"><a href="#常见坑" class="headerlink" title="常见坑"></a>常见坑</h2><ul><li>负权&#x2F;负环：dijkstra不适用，哪怕只有一条负边也不行</li><li>整型溢出:总全值可能很大，统一用64位整型</li><li>多组数据：注意初始化</li><li>不可达：输出-1等条件</li><li>双向边别忘了加两次：并行多边&#x2F;自环无序特判，不会影响正确性</li></ul><h2 id="进阶与变体"><a href="#进阶与变体" class="headerlink" title="进阶与变体"></a>进阶与变体</h2><ul><li>0-1 BFS：边权只取0&#x2F;1，用双端队列<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>V</mi><mo>+</mo><mi>E</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(V+E)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mclose">)</span></span></span></span></li><li>Dial’s Algorithm:非负小整数权(最大权C不大)可用桶实现<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>V</mi><mo>+</mo><mi>E</mi><mo>+</mo><mi>V</mi><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(V+E+VC)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span></li><li>多源最短路:把所有源点<code>dist=0</code>同时入堆</li><li>A*：有启发式的单源单目标更快，需要一致，可采纳的启发函数</li><li>K次最短路：在Dijkstra框架上记录到达次数</li></ul>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Dijkstra </tag>
            
            <tag> cpp </tag>
            
            <tag> go </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Go的并发</title>
      <link href="/JasmineRain.github.io/2025/09/06/Go%E7%9A%84%E5%B9%B6%E5%8F%91/"/>
      <url>/JasmineRain.github.io/2025/09/06/Go%E7%9A%84%E5%B9%B6%E5%8F%91/</url>
      
        <content type="html"><![CDATA[<h2 id="Goroutine"><a href="#Goroutine" class="headerlink" title="Goroutine"></a>Goroutine</h2><p>轻量级线程，goroutine是Go运行时(runtime)管理的协程，比操作系统线程更轻量</p><p>初始栈空间只有几kb，会按需自动增长</p><p>Go runtime提供M:N调度模型，N个Goroutine映射到M个操作系统线程</p><p>在函数调用前加<code>go</code>关键词启动</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">work</span><span class="params">(id <span class="type">int</span>)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> i:=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++&#123;</span><br><span class="line">        fmt.Printf(<span class="string">&quot;Worker %d: %d\n&quot;</span>,id,i)</span><br><span class="line">        time.Sleep(time.Millisecond*<span class="number">500</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">go</span> work(<span class="number">1</span>) <span class="comment">//开启一个Goroutine</span></span><br><span class="line">    <span class="keyword">go</span> work(<span class="number">2</span>) <span class="comment">//再开一个Goroutine</span></span><br><span class="line">    time.Sleep(<span class="number">2</span>*time.Second)<span class="comment">//主协程等待</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="Channel"><a href="#Channel" class="headerlink" title="Channel"></a>Channel</h2><p>Channel是Go提供的”通信管道”，用于在多个Goroutine之间传递数据</p><ul><li><p>安全:多Goroutine并发访问channel不需要额外加锁</p></li><li><p>阻塞:</p><ul><li>发送数据时，如果没有Goroutine接收，会阻塞</li><li>接收数据时，如果没有Goroutine发送，也会阻塞</li></ul></li></ul><p>声明与使用如下</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ch:=<span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>,<span class="number">2</span>)<span class="comment">//带缓冲区的channel，容量为2</span></span><br><span class="line">    ch&lt;<span class="number">-10</span></span><br><span class="line">    ch&lt;<span class="number">-20</span></span><br><span class="line">    fmt.Println(&lt;-ch)<span class="comment">//10</span></span><br><span class="line">    fmt.Println(&lt;-ch)<span class="comment">//20</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>常见模式:<br>1.生产者-消费者模型<br>2.任务发布<br>3.同步信号</p></blockquote><hr><h2 id="Select"><a href="#Select" class="headerlink" title="Select"></a>Select</h2><p>多路复用，<code>select</code>语句用来同时监听多个channel的操作，哪一个先准备好就执行哪一个分支</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ch1:=<span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">string</span>)</span><br><span class="line">    ch2:=<span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">string</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span>&#123;</span><br><span class="line">        time.Sleep(<span class="number">1</span>*time.Second)</span><br><span class="line">        ch1&lt;-<span class="string">&quot;Hello from ch1&quot;</span></span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span>&#123;</span><br><span class="line">        time.Sleep(<span class="number">2</span>*time.Second)</span><br><span class="line">        ch2&lt;-<span class="string">&quot;Hello from ch2&quot;</span></span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i:=<span class="number">0</span>;i&lt;<span class="number">2</span>;i++&#123;</span><br><span class="line">        <span class="keyword">select</span>&#123;</span><br><span class="line">            <span class="keyword">case</span> msg1:=&lt;-ch1:</span><br><span class="line">                fmt.Println(msg1)</span><br><span class="line">            <span class="keyword">case</span> msg2:&lt;-ch2:</span><br><span class="line">                fmt.Println(msg2)</span><br><span class="line">            <span class="keyword">case</span> &lt;-time.After(<span class="number">1500</span>*time.Millisecond):<span class="comment">//超时控制</span></span><br><span class="line">                fmt.Println(<span class="string">&quot;timeout&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="Context"><a href="#Context" class="headerlink" title="Context"></a>Context</h2><p>context是Go1.7引入的，用来在Goroutine之间传递取消信号、超时控制、元数据</p><p>常见函数:</p><ol><li><code>context.Background()</code>:根Context</li><li><code>context.WithCancel()</code>:手动取消</li><li><code>context.WithTimeout()</code>:超时自动取消</li><li><code>context.WithDeadline()</code>:设定截止时间</li><li><code>ctx.Done()</code>:返回一个channel，收到信号表示被取消</li></ol><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span>(</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;time&quot;</span></span><br><span class="line">    <span class="string">&quot;context&quot;</span></span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">worker</span><span class="params">(ctx context.Context)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>&#123;</span><br><span class="line">        <span class="keyword">select</span>&#123;</span><br><span class="line">            <span class="keyword">case</span> &lt;-ctx.Done():</span><br><span class="line">                fmt.Println(<span class="string">&quot;worker stopped&quot;</span>,ctx.Err())</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                fmt.Println(<span class="string">&quot;working...&quot;</span>)</span><br><span class="line">                time.Sleep(<span class="number">500</span>*time.Millisecond)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ctx,cancel:=context.WithTimeout(context.Background(),<span class="number">2</span>*time.Second)</span><br><span class="line">    <span class="keyword">defer</span> cancel()</span><br><span class="line">    <span class="keyword">go</span> worker(ctx)</span><br><span class="line">    time.Sleep(<span class="number">3</span>*time.Second)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2秒后ctx自动取消,Goroutine停止</p><hr><h2 id="sync-Mutex"><a href="#sync-Mutex" class="headerlink" title="sync.Mutex"></a>sync.Mutex</h2><p>互斥锁用于保证同一时间只有一个Goroutine能访问共享资源</p><p>并发写共享资源会产生数据竞争，需要加锁</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;sync&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">    counter <span class="type">int</span></span><br><span class="line">    mu sync.Mutex</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">fun add(wg *sync.WaitGroup)&#123;</span><br><span class="line">    <span class="keyword">defer</span> wg.Done()</span><br><span class="line">    <span class="keyword">for</span> i:=<span class="number">0</span>;i&lt;<span class="number">1000</span>;i++&#123;</span><br><span class="line">        mu.Lock()</span><br><span class="line">        counter++</span><br><span class="line">        mu.Unlock()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> wg sync.WaitGroup</span><br><span class="line">    wg.Add(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">go</span> add(&amp;wg)</span><br><span class="line">    <span class="keyword">go</span> add(&amp;wg)</span><br><span class="line">    wg.Wait()</span><br><span class="line">    fmt.Println(<span class="string">&quot;Final counter:&quot;</span>,counter)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Go </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 并发 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GO基础语法</title>
      <link href="/JasmineRain.github.io/2025/09/05/GO%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/"/>
      <url>/JasmineRain.github.io/2025/09/05/GO%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h2 id="基本结构"><a href="#基本结构" class="headerlink" title="基本结构"></a>基本结构</h2><p>一个简单的helloworld程序的展示：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;HelloWorld&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>package main</code>定义程序包,main包可独立运行</li><li><code>import</code>导入包</li><li><code>func main()</code>程序入口</li><li><code>fmt.Println()</code>打印输出</li></ul><h2 id="变量与常量"><a href="#变量与常量" class="headerlink" title="变量与常量"></a>变量与常量</h2><h3 id="变量声明"><a href="#变量声明" class="headerlink" title="变量声明"></a>变量声明</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a <span class="type">int</span> =<span class="number">10</span></span><br><span class="line"><span class="keyword">var</span> b=<span class="number">10</span></span><br><span class="line">c:=<span class="number">10</span></span><br></pre></td></tr></table></figure><h3 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Pi=<span class="number">3.14</span></span><br><span class="line"><span class="keyword">const</span>(</span><br><span class="line">    Monday=<span class="number">1</span></span><br><span class="line">    Tuesday=<span class="number">2</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><h2 id="基本数据类型"><a href="#基本数据类型" class="headerlink" title="基本数据类型"></a>基本数据类型</h2><table><thead><tr><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>int&#x2F;int8&#x2F;int16&#x2F;int32&#x2F;int64</td><td>整型</td></tr><tr><td>uint&#x2F;uint8&#x2F;uint16&#x2F;uint32&#x2F;uint64</td><td>无符号整型</td></tr><tr><td>float32&#x2F;float64</td><td>浮点型</td></tr><tr><td>bool</td><td>布尔值</td></tr><tr><td>string</td><td>字符串</td></tr><tr><td>rune</td><td>Unicode字符(等价int32)</td></tr><tr><td>byte</td><td>uint8,常用于二进制处理</td></tr></tbody></table><h2 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h2><ul><li>算术运算:+ - * &#x2F; %</li><li>赋值运算:&#x3D; +&#x3D; -&#x3D; *&#x3D; &#x2F;&#x3D; %&#x3D;</li><li>比较运算:&#x3D;&#x3D; !&#x3D; &gt; &lt; &gt;&#x3D; &lt;&#x3D;</li><li>逻辑运算:&amp;&amp; || !</li></ul><h2 id="控制结构"><a href="#控制结构" class="headerlink" title="控制结构"></a>控制结构</h2><ul><li>if&#x2F;else</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> a&gt;b&#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;a&gt;b&quot;</span>)</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;a&lt;=b&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>switch</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> day&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        fmt.Println(<span class="string">&quot;Monday&quot;</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        fmt.Println(<span class="string">&quot;Tuesday&quot;</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        fmt.Println(<span class="string">&quot;Other&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>for循环</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//基本形式</span></span><br><span class="line"><span class="keyword">for</span> i:=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++&#123;</span><br><span class="line">    fmt.Println(i)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//类似while</span></span><br><span class="line">i:=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i&lt;<span class="number">5</span>&#123;</span><br><span class="line">    fmt.Println(i)</span><br><span class="line">    i++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//无限循环</span></span><br><span class="line"><span class="keyword">for</span>&#123;</span><br><span class="line">    <span class="comment">//do...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>数组与切片</p></li><li><p>数组</p></li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr [<span class="number">3</span>]<span class="type">int</span>=[<span class="number">3</span>]<span class="type">int</span>&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;</span><br><span class="line">fmt.Println(arr[<span class="number">0</span>])</span><br></pre></td></tr></table></figure><ul><li>切片(可动态扩容)</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">s:=[]<span class="type">int</span>&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;</span><br><span class="line">s=<span class="built_in">append</span>(s,<span class="number">4</span>)<span class="comment">//添加元素</span></span><br><span class="line">fmt.Println(<span class="built_in">len</span>(s))<span class="comment">//长度</span></span><br><span class="line">fmt.Println(<span class="built_in">cap</span>(s))<span class="comment">//容量</span></span><br></pre></td></tr></table></figure><h2 id="map"><a href="#map" class="headerlink" title="map"></a>map</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">m:=<span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]<span class="type">int</span>)</span><br><span class="line">m[<span class="string">&quot;Alice&quot;</span>]=<span class="number">10</span></span><br><span class="line">m[<span class="string">&quot;Bob&quot;</span>]=<span class="number">20</span></span><br><span class="line"></span><br><span class="line">fmt.Println(m[<span class="string">&quot;Alice&quot;</span>])<span class="comment">//10</span></span><br><span class="line"><span class="built_in">delete</span>(m,<span class="string">&quot;Bob&quot;</span>)<span class="comment">//删除键</span></span><br></pre></td></tr></table></figure><h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">add</span><span class="params">(a <span class="type">int</span>,b <span class="type">int</span>)</span></span><span class="type">int</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a+b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">swap</span><span class="params">(a,b <span class="type">int</span>)</span></span>(<span class="type">int</span>,<span class="type">int</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> b,a</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">x,y:=swap(<span class="number">1</span>,<span class="number">2</span>)</span><br></pre></td></tr></table></figure><h2 id="指针"><a href="#指针" class="headerlink" title="指针"></a>指针</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a:=<span class="number">10</span></span><br><span class="line"><span class="keyword">var</span> p *<span class="type">int</span>=&amp;a <span class="comment">//取地址</span></span><br><span class="line">fmt.Println(*p) <span class="comment">//解引用</span></span><br><span class="line">*p=<span class="number">20</span></span><br><span class="line">fmt.Println(a)<span class="comment">//20</span></span><br></pre></td></tr></table></figure><blockquote><p>Go支持指针，但不支持指针运算</p></blockquote><h2 id="Struct"><a href="#Struct" class="headerlink" title="Struct"></a>Struct</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span>&#123;</span><br><span class="line">    Name <span class="type">string</span></span><br><span class="line">    Age <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">u:=User&#123;Name:<span class="string">&quot;Alice&quot;</span>,Age:<span class="number">20</span>&#125;</span><br><span class="line">fmt.Println(u.Name)</span><br></pre></td></tr></table></figure><ul><li>可定义方法</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(u User)</span></span>SayHello()&#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;Hello&quot;</span>,u.Name)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="interface"><a href="#interface" class="headerlink" title="interface"></a>interface</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Animal <span class="keyword">interface</span>&#123;</span><br><span class="line">    speak() <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Dog <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(d Dog)</span></span> Speak() <span class="type">string</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Woof!&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a Animal=Dog&#123;&#125;</span><br><span class="line">fmt.Println(a.Speak())<span class="comment">//Wool!</span></span><br></pre></td></tr></table></figure><blockquote><p>Go接口是隐式实现，不需要显示继承</p></blockquote><h2 id="goroutine-channel-并发"><a href="#goroutine-channel-并发" class="headerlink" title="goroutine+channel 并发"></a>goroutine+channel 并发</h2><p>goroutine</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span>&#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;Hello from goroutine&quot;</span>)</span><br><span class="line">&#125;()</span><br></pre></td></tr></table></figure><p>channel</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ch:=<span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ch&lt;<span class="number">-10</span> <span class="comment">//发送数据</span></span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line">val :=&lt;-ch <span class="comment">//接收数据</span></span><br><span class="line">fmt.Println(val) <span class="comment">//10</span></span><br></pre></td></tr></table></figure><p>select</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>&#123;</span><br><span class="line">    <span class="keyword">case</span> mag:=&lt;-ch1:</span><br><span class="line">        fmt.Println(msg)</span><br><span class="line">    <span class="keyword">case</span> ch2&lt;<span class="number">-20</span>:</span><br><span class="line">        fmt.Println(<span class="string">&quot;Sent 20&quot;</span>)</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        fmt.Println(<span class="string">&quot;No communication&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>goroutine+channel是go的核心并发模型，适合做高并发服务</p></blockquote><h2 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">div</span><span class="params">(a,b <span class="type">int</span>)</span></span>(<span class="type">int</span>,<span class="type">error</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span> b==<span class="number">0</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>,fmt.Println(<span class="string">&quot;division by zero&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a/b,<span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">res,err:=div(<span class="number">10</span>,<span class="number">0</span>)</span><br><span class="line"><span class="keyword">if</span> err!=<span class="literal">nil</span>&#123;</span><br><span class="line">    fmt.Println(err)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>go不用try&#x2F;catch，而是返回error</p></blockquote><h2 id="包管理"><a href="#包管理" class="headerlink" title="包管理"></a>包管理</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">go</span> mod init myproject</span><br><span class="line"><span class="keyword">go</span> mod tidy <span class="comment">//自动下载依赖</span></span><br></pre></td></tr></table></figure><blockquote><p>每个项目独立模块，方便依赖管理</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Go </category>
          
      </categories>
      
      
        <tags>
            
            <tag> go </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Segment tree</title>
      <link href="/JasmineRain.github.io/2025/08/19/Segment-tree/"/>
      <url>/JasmineRain.github.io/2025/08/19/Segment-tree/</url>
      
        <content type="html"><![CDATA[<h2 id="主要作用"><a href="#主要作用" class="headerlink" title="主要作用"></a>主要作用</h2><p>线段树是主要用来维护<strong>区间信息</strong>的数据结构<br>线段树可以在O(logN)的时间复杂度内实现单点修改、区间修改、区间查询(区间求和、求区间最大值、求区间最小值)等操作</p><h2 id="基本结构"><a href="#基本结构" class="headerlink" title="基本结构"></a>基本结构</h2><p>将数组<code>a=&#123;10,11,12,13,14&#125;</code>转化为线段树:设线段树的根节点编号为1，用数组d来保存我们的线段树,<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">d_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>用来保存线段树上编号为i的节点的值，这里每个节点所维护的值就是这个节点所表示的区间总和。</p><img src="/JasmineRain.github.io/2025/08/19/Segment-tree/SegmentTree001.png" class="" title="线段树的形态"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">d_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的左儿子节点就是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mn>2</mn><mo>∗</mo><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{2*i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mbin mtight">∗</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>,<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">d_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的右儿子节点就是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mn>2</mn><mo>∗</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">d_{2*i+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mbin mtight">∗</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>.如果<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">d_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>表示的是区间[s,t](即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">d_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>=<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">a_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>+<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mi>s</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">a_{s+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>+...+<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">a_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)的话，那么<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">d_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的左儿子节点表示的是区间[s,<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>s</mi><mo>+</mo><mi>t</mi></mrow><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{s+t}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1696em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8246em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>],<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">d_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的右儿子表示的区间为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>s</mi><mo>+</mo><mi>t</mi></mrow><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{s+t}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1696em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8246em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>+1到t的闭区间<h2 id="建树"><a href="#建树" class="headerlink" title="建树"></a>建树</h2><p>在实现时，我们考虑递归建树。设当前的根节点为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>,如果根节点管辖的区间长度已经是1,则可以直接根据<code>a</code>数组上相应位置的值初始化该节点。否则我们将该区间从中点处分割为两个子区间，分别进入左右子节点递归建树，最后合并两个子节点的信息。</p><ul><li>c++</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t, <span class="type">int</span> p)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 对 [s,t] 区间建立线段树,当前根的编号为 p</span></span><br><span class="line">  <span class="keyword">if</span> (s == t) &#123;</span><br><span class="line">    d[p] = a[s];</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> m = s + ((t - s) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">  <span class="comment">// 移位运算符的优先级小于加减法，所以加上括号</span></span><br><span class="line">  <span class="comment">// 如果写成 (s + t) &gt;&gt; 1 可能会超出 int 范围</span></span><br><span class="line">  <span class="built_in">build</span>(s, m, p * <span class="number">2</span>), <span class="built_in">build</span>(m + <span class="number">1</span>, t, p * <span class="number">2</span> + <span class="number">1</span>);</span><br><span class="line">  <span class="comment">// 递归对左右区间建树</span></span><br><span class="line">  d[p] = d[p * <span class="number">2</span>] + d[(p * <span class="number">2</span>) + <span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>python</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">build</span>(<span class="params">s, t, p</span>):</span><br><span class="line">    <span class="comment"># 对 [s,t] 区间建立线段树,当前根的编号为 p</span></span><br><span class="line">    <span class="keyword">if</span> s == t:</span><br><span class="line">        d[p] = a[s]</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    m = s + ((t - s) &gt;&gt; <span class="number">1</span>)</span><br><span class="line">    <span class="comment"># 移位运算符的优先级小于加减法，所以加上括号</span></span><br><span class="line">    <span class="comment"># 如果写成 (s + t) &gt;&gt; 1 可能会超出 int 范围</span></span><br><span class="line">    build(s, m, p * <span class="number">2</span>)</span><br><span class="line">    build(m + <span class="number">1</span>, t, p * <span class="number">2</span> + <span class="number">1</span>)</span><br><span class="line">    <span class="comment"># 递归对左右区间建树</span></span><br><span class="line">    d[p] = d[p * <span class="number">2</span>] + d[(p * <span class="number">2</span>) + <span class="number">1</span>]</span><br></pre></td></tr></table></figure><ul><li>golang</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 假设数组 a 和线段树数组 d 已经定义</span></span><br><span class="line"><span class="keyword">var</span> a []<span class="type">int</span></span><br><span class="line"><span class="keyword">var</span> d []<span class="type">int</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">build</span><span class="params">(s, t, p <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">    <span class="comment">// 对 [s,t] 区间建立线段树，当前根的编号为 p</span></span><br><span class="line">    <span class="keyword">if</span> s == t &#123;</span><br><span class="line">        d[p] = a[s]</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    m := s + ((t - s) &gt;&gt; <span class="number">1</span>)</span><br><span class="line">    <span class="comment">// 递归对左右区间建树</span></span><br><span class="line">    build(s, m, p*<span class="number">2</span>)</span><br><span class="line">    build(m+<span class="number">1</span>, t, p*<span class="number">2</span>+<span class="number">1</span>)</span><br><span class="line">    d[p] = d[p*<span class="number">2</span>] + d[p*<span class="number">2</span>+<span class="number">1</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// 示例</span></span><br><span class="line">    a = []<span class="type">int</span>&#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125; <span class="comment">// 下标从 1 开始</span></span><br><span class="line">    d = <span class="built_in">make</span>([]<span class="type">int</span>, <span class="number">4</span>*<span class="built_in">len</span>(a))</span><br><span class="line">    build(<span class="number">1</span>, <span class="built_in">len</span>(a)<span class="number">-1</span>, <span class="number">1</span>)</span><br><span class="line">    fmt.Println(d)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>java</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SegmentTree</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] a; <span class="comment">// 原数组，下标从 1 开始</span></span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] d; <span class="comment">// 线段树数组</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">build</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t, <span class="type">int</span> p)</span> &#123;</span><br><span class="line">        <span class="comment">// 对 [s,t] 区间建立线段树，当前根的编号为 p</span></span><br><span class="line">        <span class="keyword">if</span> (s == t) &#123;</span><br><span class="line">            d[p] = a[s];</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> s + ((t - s) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">        <span class="comment">// 递归对左右区间建树</span></span><br><span class="line">        build(s, m, p * <span class="number">2</span>);</span><br><span class="line">        build(m + <span class="number">1</span>, t, p * <span class="number">2</span> + <span class="number">1</span>);</span><br><span class="line">        d[p] = d[p * <span class="number">2</span>] + d[p * <span class="number">2</span> + <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        a = <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;; <span class="comment">// 下标从 1 开始</span></span><br><span class="line">        d = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">4</span> * a.length];</span><br><span class="line">        build(<span class="number">1</span>, a.length - <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> val : d) &#123;</span><br><span class="line">            <span class="keyword">if</span> (val != <span class="number">0</span>) System.out.print(val + <span class="string">&quot; &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>关于线段树的空间:如果采用堆式存储,<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>p</mi></mrow><annotation encoding="application/x-tex">2p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">2</span><span class="mord mathnormal">p</span></span></span></span>是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>的左儿子,<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>p</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2p+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">2</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>的右儿子,若有<code>n</code>个叶子节点,则<code>d</code>数组的范围最大为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mo stretchy="false">⌈</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mi>n</mi></msub><mo stretchy="false">⌉</mo><mo>+</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">2^{\lceil log_n \rceil +1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">⌈</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">o</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">⌉</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></p><blockquote><p>容易知道线段树的深度是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌈</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mi>n</mi></msub><mo stretchy="false">⌉</mo></mrow><annotation encoding="application/x-tex">\lceil log_n \rceil</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌈</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">⌉</span></span></span></span>的，则在堆式存储情况下叶子节点(包括无用的叶子节点)数量为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mo fence="true">⌈</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo fence="true">⌉</mo></mrow></msup></mrow><annotation encoding="application/x-tex">2^{\left\lceil\log{n}\right\rceil}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">⌈</span></span><span class="mop mtight"><span class="mtight">l</span><span class="mtight">o</span><span class="mtight" style="margin-right:0.01389em;">g</span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">⌉</span></span></span></span></span></span></span></span></span></span></span></span></span></span>个，又由于其为一棵完全二叉树，则其总节点个<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mrow><mo fence="true">⌈</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo fence="true">⌉</mo></mrow><mo>+</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">2^{\left\lceil\log{n}\right\rceil+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">⌈</span></span><span class="mop mtight"><span class="mtight">l</span><span class="mtight">o</span><span class="mtight" style="margin-right:0.01389em;">g</span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">⌉</span></span></span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>-1。当然如果你懒得计算的话可以直接把数组长度设为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mi>n</mi></mrow><annotation encoding="application/x-tex">4n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span><span class="mord mathnormal">n</span></span></span></span>，因为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><msup><mn>2</mn><mrow><mrow><mo fence="true">⌈</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo fence="true">⌉</mo></mrow><mo>+</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mi>n</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac{2^{\left\lceil\log{n}\right\rceil+1}-1}{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4157em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0707em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9667em;"><span style="top:-2.9667em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">⌈</span></span><span class="mop mtight"><span class="mtight">l</span><span class="mtight">o</span><span class="mtight" style="margin-right:0.01389em;">g</span></span><span class="mspace mtight" style="margin-right:0.2453em;"></span><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">⌉</span></span></span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>的最大值在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><msup><mn>2</mn><mi>x</mi></msup><mo>+</mo><mn>1</mn><mo stretchy="false">(</mo><mi>x</mi><mo>∈</mo><msub><mi>N</mi><mo lspace="0em" rspace="0em">+</mo></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">n=2^{x}+1(x\in N_{+})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7477em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2583em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">+</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>时取到，此时节点数为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mrow><mo fence="true">⌈</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo fence="true">⌉</mo></mrow><mo>+</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn><mo>=</mo><msup><mn>2</mn><mrow><mi>x</mi><mo>+</mo><mn>2</mn></mrow></msup><mo>−</mo><mn>1</mn><mo>=</mo><mn>4</mn><mi>n</mi><mo>−</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">2^{\left\lceil\log{n}\right\rceil+1}-1=2^{x+2}-1=4n-5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9713em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">⌈</span></span><span class="mop mtight"><span class="mtight">l</span><span class="mtight">o</span><span class="mtight" style="margin-right:0.01389em;">g</span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">⌉</span></span></span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">4</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span></span></span></span></p></blockquote><p>而堆式存储存在无用的叶子节点，可以考虑使用内存池管理线段树节点，每当需要新建节点时从池中获取。自底向上考虑，必有每两个底层节点合并为一个上层节点，因此可以类似哈夫曼树地证明，如果有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>个叶子节点，这样的线段树总共有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2n-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>个节点。其空间效率优于堆式存储，并且是可能的最优情况</p><p>这样的线段树可以自底向上维护</p><h2 id="线段树的区间查询"><a href="#线段树的区间查询" class="headerlink" title="线段树的区间查询"></a>线段树的区间查询</h2><p>区间查询，比如求区间[l,r]的总和(即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>l</mi></msub></mrow><annotation encoding="application/x-tex">a_l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>+<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">a_{l+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>+…+<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">a_r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)、求区间最大值&#x2F;最小值等操作</p><ul><li>cpp</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">getsum</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> s, <span class="type">int</span> t, <span class="type">int</span> p)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// [l, r] 为查询区间, [s, t] 为当前节点包含的区间, p 为当前节点的编号</span></span><br><span class="line">  <span class="keyword">if</span> (l &lt;= s &amp;&amp; t &lt;= r)</span><br><span class="line">    <span class="keyword">return</span> d[p];  <span class="comment">// 当前区间为询问区间的子集时直接返回当前区间的和</span></span><br><span class="line">  <span class="type">int</span> m = s + ((t - s) &gt;&gt; <span class="number">1</span>), sum = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> (l &lt;= m) sum += <span class="built_in">getsum</span>(l, r, s, m, p * <span class="number">2</span>);</span><br><span class="line">  <span class="comment">// 如果左儿子代表的区间 [s, m] 与询问区间有交集, 则递归查询左儿子</span></span><br><span class="line">  <span class="keyword">if</span> (r &gt; m) sum += <span class="built_in">getsum</span>(l, r, m + <span class="number">1</span>, t, p * <span class="number">2</span> + <span class="number">1</span>);</span><br><span class="line">  <span class="comment">// 如果右儿子代表的区间 [m + 1, t] 与询问区间有交集, 则递归查询右儿子</span></span><br><span class="line">  <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>python</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">getsum</span>(<span class="params">l, r, s, t, p</span>):</span><br><span class="line">    <span class="comment"># [l, r] 为查询区间, [s, t] 为当前节点包含的区间, p 为当前节点的编号</span></span><br><span class="line">    <span class="keyword">if</span> l &lt;= s <span class="keyword">and</span> t &lt;= r:</span><br><span class="line">        <span class="keyword">return</span> d[p]  <span class="comment"># 当前区间为询问区间的子集时直接返回当前区间的和</span></span><br><span class="line">    m = s + ((t - s) &gt;&gt; <span class="number">1</span>)</span><br><span class="line">    <span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> l &lt;= m:</span><br><span class="line">        <span class="built_in">sum</span> = <span class="built_in">sum</span> + getsum(l, r, s, m, p * <span class="number">2</span>)</span><br><span class="line">    <span class="comment"># 如果左儿子代表的区间 [s, m] 与询问区间有交集, 则递归查询左儿子</span></span><br><span class="line">    <span class="keyword">if</span> r &gt; m:</span><br><span class="line">        <span class="built_in">sum</span> = <span class="built_in">sum</span> + getsum(l, r, m + <span class="number">1</span>, t, p * <span class="number">2</span> + <span class="number">1</span>)</span><br><span class="line">    <span class="comment"># 如果右儿子代表的区间 [m + 1, t] 与询问区间有交集, 则递归查询右儿子</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span></span><br></pre></td></tr></table></figure><ul><li>golang</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// d 是全局数组，存储线段树节点的值</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getsum</span><span class="params">(l, r, s, t, p <span class="type">int</span>, d []<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">    <span class="comment">// [l, r] 为查询区间, [s, t] 为当前节点包含的区间, p 为当前节点的编号</span></span><br><span class="line">    <span class="keyword">if</span> l &lt;= s &amp;&amp; t &lt;= r &#123;</span><br><span class="line">        <span class="keyword">return</span> d[p] <span class="comment">// 当前区间为询问区间的子集时直接返回</span></span><br><span class="line">    &#125;</span><br><span class="line">    m := s + ((t - s) &gt;&gt; <span class="number">1</span>)</span><br><span class="line">    sum := <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> l &lt;= m &#123;</span><br><span class="line">        sum += getsum(l, r, s, m, p*<span class="number">2</span>, d)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> r &gt; m &#123;</span><br><span class="line">        sum += getsum(l, r, m+<span class="number">1</span>, t, p*<span class="number">2</span>+<span class="number">1</span>, d)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>java</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SegmentTree</span> &#123;</span><br><span class="line">    <span class="type">int</span>[] d; <span class="comment">// 存储线段树节点的数组</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">SegmentTree</span><span class="params">(<span class="type">int</span> size)</span> &#123;</span><br><span class="line">        d = <span class="keyword">new</span> <span class="title class_">int</span>[size * <span class="number">4</span>]; <span class="comment">// 足够容纳线段树节点</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getsum</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> s, <span class="type">int</span> t, <span class="type">int</span> p)</span> &#123;</span><br><span class="line">        <span class="comment">// [l, r] 为查询区间, [s, t] 为当前节点包含的区间, p 为当前节点的编号</span></span><br><span class="line">        <span class="keyword">if</span> (l &lt;= s &amp;&amp; t &lt;= r) &#123;</span><br><span class="line">            <span class="keyword">return</span> d[p]; <span class="comment">// 当前区间为询问区间的子集时直接返回</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> s + ((t - s) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (l &lt;= m) &#123;</span><br><span class="line">            sum += getsum(l, r, s, m, p * <span class="number">2</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (r &gt; m) &#123;</span><br><span class="line">            sum += getsum(l, r, m + <span class="number">1</span>, t, p * <span class="number">2</span> + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> DataStruct </category>
          
      </categories>
      
      
        <tags>
            
            <tag> segment tree </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux common commands</title>
      <link href="/JasmineRain.github.io/2025/08/19/Linux-common-commands/"/>
      <url>/JasmineRain.github.io/2025/08/19/Linux-common-commands/</url>
      
        <content type="html"><![CDATA[<h2 id="文件与目录操作"><a href="#文件与目录操作" class="headerlink" title="文件与目录操作"></a>文件与目录操作</h2><p>ls -lh<br>以人类可读方式显示文件大小</p><p>ls -ltr<br>按时间排序</p><p>cd -<br>返回上一个目录</p><p>tree<br>树型结构显示目录，需要安装</p><p>stat file<br>查看文件详细信息</p><p>basename &#x2F;path&#x2F;file.txt<br>获取文件名</p><p>dirname &#x2F;path&#x2F;file.txt<br>获取文件路径</p><h2 id="文件查看与处理"><a href="#文件查看与处理" class="headerlink" title="文件查看与处理"></a>文件查看与处理</h2><p>cat -n file<br>显示行号</p><p>tac file<br>反向输出文件</p><p>less -N file<br>分页并显示行号</p><p>strings file<br>提取二进制文件中的字符串</p><p>split -l 1000 big.txt part_<br>按行切割文件</p><p>sort file<br>排序</p><p>uniq file<br>去重</p><p>diff file1 file2<br>比较两个文件</p><p>cmp file1 file2<br>比较两个文件是否相同</p><h2 id="权限与用户管理"><a href="#权限与用户管理" class="headerlink" title="权限与用户管理"></a>权限与用户管理</h2><p>chmod 644 file<br>rw-r–r–</p><p>chmod u+x file<br>给用户添加执行权限</p><p>umask<br>查看默认权限掩码</p><p>chgrp group file<br>修改文件所属组</p><p>groups user<br>查看用户所属组</p><p>useradd newuser<br>添加用户</p><p>usermod -aG sudo u<br>将用户加入sudo组</p><p>userdel -r user<br>删除用户及家目录</p><p>groupadd dev<br>新建用户组</p><h2 id="系统信息与硬件"><a href="#系统信息与硬件" class="headerlink" title="系统信息与硬件"></a>系统信息与硬件</h2><p>uname -r<br>查看内核版本</p><p>cat &#x2F;etc&#x2F;os-release<br>系统版本信息</p><p>hostnamectl<br>查看主机信息</p><p>uptime -p<br>只显示运行时长</p><p>lsblk<br>显示磁盘挂载</p><p>blkid<br>查看磁盘 UUID</p><p>mount &#x2F;dev&#x2F;sdb1 &#x2F;mnt<br>挂载磁盘</p><p>umount &#x2F;mnt<br>卸载磁盘</p><p>lscpu<br>CPU 信息</p><p>lsusb<br>USB 设备</p><p>lspci<br>PCI 设备</p><h2 id="进程与任务管理"><a href="#进程与任务管理" class="headerlink" title="进程与任务管理"></a>进程与任务管理</h2><p>ps -ef | grep ssh<br>查找进程</p><p>pgrep -u user<br>查看用户进程 PID</p><p>kill -15 1234<br>优雅终止进程</p><p>kill -9 1234<br>强制终止</p><p>pkill nginx<br>杀死 nginx 进程</p><p>top -u user<br>查看用户进程</p><p>htop<br>更友好的进程监控</p><p>jobs<br>后台任务</p><p>fg %1<br>任务恢复前台</p><p>bg %1<br>后台继续运行</p><h2 id="磁盘与文件系统"><a href="#磁盘与文件系统" class="headerlink" title="磁盘与文件系统"></a>磁盘与文件系统</h2><p>df -Th<br>查看磁盘文件系统类型</p><p>du -sh *<br>查看当前目录下文件大小</p><p>ls -lh &#x2F;var&#x2F;log<br>查看日志大小</p><p>ncdu<br>图形化磁盘分析工具（需安装）</p><p>fsck &#x2F;dev&#x2F;sdb1<br>检查文件系统</p><p>mount -o remount,rw &#x2F;<br>重新挂载为可写</p><h2 id="压缩与解压"><a href="#压缩与解压" class="headerlink" title="压缩与解压"></a>压缩与解压</h2><p>tar -cvf a.tar dir&#x2F;<br>打包</p><p>tar -xvf a.tar<br>解包</p><p>tar -czvf a.tar.gz dir<br>打包并压缩</p><p>tar -xzvf a.tar.gz<br>解压缩</p><p>zip -r a.zip dir&#x2F;<br>压缩 zip</p><p>unzip a.zip -d dir&#x2F;<br>解压到目录</p><p>xz -z file<br>压缩为 .xz</p><p>xz -d file.xz<br>解压</p><h2 id="网络与传输"><a href="#网络与传输" class="headerlink" title="网络与传输"></a>网络与传输</h2><p>ping -c 4 baidu.com<br>ping 4 次</p><p>curl -I <a href="http://url/">http://url</a><br>查看响应头</p><p>curl -O <a href="http://url/file">http://url/file</a><br>下载文件</p><p>wget -c <a href="http://url/file">http://url/file</a><br>断点续传下载</p><p>scp file user@ip:&#x2F;dir&#x2F;<br>上传文件</p><p>scp user@ip:&#x2F;dir&#x2F;file .&#x2F;<br>下载文件</p><p>rsync -avz src&#x2F; dest&#x2F;<br>高效同步文件</p><p>ssh user@ip<br>远程登录</p><p>ssh -p 2222 user@ip<br>指定端口</p><h2 id="网络管理与排错"><a href="#网络管理与排错" class="headerlink" title="网络管理与排错"></a>网络管理与排错</h2><p>ifconfig<br>查看网卡信息（旧）</p><p>ip addr show<br>查看网卡信息（推荐）</p><p>ip route<br>查看路由表</p><p>netstat -tulnp<br>查看端口</p><p>ss -lntp<br>新版端口查看</p><p>traceroute baidu.com<br>路由跟踪</p><p>dig baidu.com<br>DNS 解析</p><p>nslookup baidu.com<br>DNS 查询</p><p>telnet ip port<br>测试端口连通性</p><h2 id="软件包管理"><a href="#软件包管理" class="headerlink" title="软件包管理"></a>软件包管理</h2><h3 id="Ubuntu-Debian系"><a href="#Ubuntu-Debian系" class="headerlink" title="Ubuntu&#x2F;Debian系"></a>Ubuntu&#x2F;Debian系</h3><p>apt update<br>apt upgrade<br>apt install pkg<br>apt remove pkg<br>dpkg -i file.deb<br>安装本地包</p><h3 id="CentOS-RedHat系"><a href="#CentOS-RedHat系" class="headerlink" title="CentOS&#x2F;RedHat系"></a>CentOS&#x2F;RedHat系</h3><p>yum install pkg<br>yum remove pkg<br>yum update<br>rpm -ivh file.rpm<br>安装本地包</p><h2 id="日志与系统监控"><a href="#日志与系统监控" class="headerlink" title="日志与系统监控"></a>日志与系统监控</h2><p>journalctl -xe<br>查看系统日志</p><p>tail -f &#x2F;var&#x2F;log&#x2F;syslog<br>实时日志</p><p>tail -f &#x2F;var&#x2F;log&#x2F;messages<br>last<br>登录历史</p><p>w<br>登录用户及进程</p><p>uptime<br>系统负载</p><p>vmstat 2<br>每 2 秒显示内存&#x2F;CPU</p><p>iostat -x 1<br>磁盘 IO</p><p>sar -u 1 10<br>CPU 性能监控</p><h2 id="Shell快捷与工具"><a href="#Shell快捷与工具" class="headerlink" title="Shell快捷与工具"></a>Shell快捷与工具</h2><p>!!<br>执行上一条命令</p><p>!ls<br>执行最近的 ls 命令</p><p>history | grep xx<br>搜索历史命令</p><p>alias ll&#x3D;’ls -l’<br>设置别名</p><p>unalias ll<br>删除别名</p><p>echo <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>A</mi><mi>T</mi><mi>H</mi></mrow><annotation encoding="application/x-tex">PATH</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span>查看环境变量</p><p>export VAR&#x3D;123<br>设置环境变量</p><hr><ul><li><p>新建普通文件的默认权限为666(rw-rw-rw-).umask值027指定屏蔽的权限：所有者部分（0）无屏蔽，组部分（2）屏蔽写权限（w），其他部分（7）屏蔽所有权限（rwx）。计算实际权限：默认权限666&amp;~umask&#x3D;640（二进制110110110 AND 111101000&#x3D;110100000，即rw-r—–）。因此，权限为rw-r—–（640）</p></li><li><p>在linux文件系统中，硬链接不能指向目录（只能指向文件），以防止文件系统循环等问题；而软链接可以指向文件或目录。硬链接共享inode，软连接独立inode。删除原始文件后硬链接可访问数据，软链接失效。硬链接不能跨文件系统，软链接可以。</p></li><li><p><code>shutdown -r now</code>，<code>-r</code>表示重启(<code>reboot</code>),<code>now</code>表示立即执行。标准的重启指令</p></li><li><p><code>reboot</code>，直接调用系统重启功能，等同于<code>shutdown -r now</code></p></li><li><p><code>init 6</code>，通过切换系统运行级别（runlevel）到6，表示重启，是传统的SysV初始化系统的重启方式，在大多数Linux发行版本中仍兼容</p></li><li><p><code>halt</code>,停止系统运行并关闭电源（相当于关机），不会触发重启</p></li><li><p>通过文件目录可以实现从文件名到文件物理地址的转化</p></li><li><p><code>SIGTERM</code>是用于优雅终止进程的标准信号，它允许进程捕获该信号、执行清理操作（如释放资源）并正常退出</p></li><li><p><code>SIGKILL</code>是强制终止，不可被进程捕获或忽略</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> commands </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>How to use git</title>
      <link href="/JasmineRain.github.io/2025/08/18/How-to-use-git/"/>
      <url>/JasmineRain.github.io/2025/08/18/How-to-use-git/</url>
      
        <content type="html"><![CDATA[<h2 id="本地开发阶段"><a href="#本地开发阶段" class="headerlink" title="本地开发阶段"></a>本地开发阶段</h2><h3 id="仓库操作"><a href="#仓库操作" class="headerlink" title="仓库操作"></a>仓库操作</h3><ul><li><p>git init<br>初始化本地仓库</p></li><li><p>git clone &lt; repo &gt;<br>克隆远程仓库</p></li><li><p>git remote -v<br>查看远程仓库地址</p></li><li><p>git remote add origin &lt; url &gt;<br>添加远程仓库地址</p></li></ul><h3 id="分支管理"><a href="#分支管理" class="headerlink" title="分支管理"></a>分支管理</h3><ul><li><p>git branch<br>查看分支</p></li><li><p>git branch dev<br>创建分支</p></li><li><p>git checkout dev&#x2F;git switch dev<br>切换分支</p></li><li><p>git checkout -b feature-x<br>新建并切换分支</p></li><li><p>git branch -d branch-name<br>删除本地分支</p></li><li><p>git branch -vv<br>查看本地分支与远程分支的关系</p></li></ul><h3 id="代码修改"><a href="#代码修改" class="headerlink" title="代码修改"></a>代码修改</h3><ul><li><p>git status<br>查看修改状态</p></li><li><p>git diff<br>查看改动内容</p></li><li><p>git add file<br>添加到暂存区</p></li><li><p>git add .<br>添加全部修改</p></li><li><p>git commit -m “feat:xxx”<br>提交代码</p></li><li><p>git commit –amend<br>修改最近一次commit</p></li><li><p>git restore file<br>撤销修改</p></li><li><p>git reset –hard HEAD<br>撤销到最后一次提交</p></li></ul><h2 id="与远程仓库交互"><a href="#与远程仓库交互" class="headerlink" title="与远程仓库交互"></a>与远程仓库交互</h2><h3 id="拉取更新"><a href="#拉取更新" class="headerlink" title="拉取更新"></a>拉取更新</h3><ul><li><p>git fetch<br>获取远程更新但不合并</p></li><li><p>git pull<br>获取远程更新并合并</p></li><li><p>git pull –rebase<br>获取远程更新并rebase</p></li></ul><h3 id="推送代码"><a href="#推送代码" class="headerlink" title="推送代码"></a>推送代码</h3><ul><li><p>git push origin dev<br>推送分支</p></li><li><p>git push -u origin dev<br>第一次推送并建立跟踪关系</p></li><li><p>git push –force<br>强制推送</p></li></ul><h3 id="远程分支管理"><a href="#远程分支管理" class="headerlink" title="远程分支管理"></a>远程分支管理</h3><ul><li><p>git branch -r<br>查看远程分支</p></li><li><p>git push origin –delete branch_name<br>删除远程分支</p></li><li><p>git fetch -p<br>清理本地已删除的远程分支</p></li></ul><h2 id="协作开发"><a href="#协作开发" class="headerlink" title="协作开发"></a>协作开发</h2><h3 id="合并分支"><a href="#合并分支" class="headerlink" title="合并分支"></a>合并分支</h3><ul><li><p>git merge dev<br>合并分支</p></li><li><p>gti merge –no-ff dev<br>保留分支记录</p></li><li><p>git merge –squash dev<br>合并为一个commit</p></li></ul><h3 id="解决冲突"><a href="#解决冲突" class="headerlink" title="解决冲突"></a>解决冲突</h3><p>发生冲突时git会标记&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD … &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; … &gt;&gt;&gt;&gt;&gt;&gt;&gt;<br>修改后git add file &amp;&amp; gti commit</p><h3 id="变基rebase"><a href="#变基rebase" class="headerlink" title="变基rebase"></a>变基rebase</h3><ul><li><p>git rebase main<br>把当前分支基于main更新</p></li><li><p>git rebase -i HEAD~3<br>交互式rebase(压缩、修改commit)</p></li></ul><h3 id="临时保存"><a href="#临时保存" class="headerlink" title="临时保存"></a>临时保存</h3><ul><li><p>git stash<br>存储未提交的修改</p></li><li><p>git stash pop<br>恢复修改</p></li><li><p>git stash list<br>查看存储列表</p></li></ul><h2 id="提交规范与历史管理"><a href="#提交规范与历史管理" class="headerlink" title="提交规范与历史管理"></a>提交规范与历史管理</h2><h3 id="查看提交记录"><a href="#查看提交记录" class="headerlink" title="查看提交记录"></a>查看提交记录</h3><ul><li><p>git log<br>查看提交日志</p></li><li><p>git log –oneline  –graph<br>简洁图形化日志</p></li><li><p>git blame file<br>查看文件每一行的修改者</p></li></ul><h3 id="撤销-恢复"><a href="#撤销-恢复" class="headerlink" title="撤销&#x2F;恢复"></a>撤销&#x2F;恢复</h3><ul><li><p>git revert commit_id<br>回滚某个提交(生成新提交)</p></li><li><p>git reset –hard commit_id<br>回退到某个提交(破坏性)</p></li><li><p>git checkout commit_id file<br>恢复某个文件到历史版本</p></li></ul><h3 id="标签管理"><a href="#标签管理" class="headerlink" title="标签管理"></a>标签管理</h3><ul><li><p>git tag v1.0.0<br>打标签</p></li><li><p>gti push origin v1.0.0<br>推送标签</p></li><li><p>git tag  -d v1.0.0<br>删除本地标签</p></li><li><p>git push origin –delete v1.0.0<br>删除远程标签</p></li></ul><h2 id="团队协作中的高级用法"><a href="#团队协作中的高级用法" class="headerlink" title="团队协作中的高级用法"></a>团队协作中的高级用法</h2><h3 id="代码评审"><a href="#代码评审" class="headerlink" title="代码评审"></a>代码评审</h3><ul><li><p>在 GitHub&#x2F;GitLab 上提交 Pull Request (PR) &#x2F; Merge Request (MR)</p></li><li><p>代码合并前需要 Review</p></li></ul><h3 id="子模块"><a href="#子模块" class="headerlink" title="子模块"></a>子模块</h3><ul><li><p>git submodule add &lt; repo &gt;<br>引入子模块</p></li><li><p>git submodule update –init –recursive<br>更新子模块</p></li></ul><h3 id="多远程仓库"><a href="#多远程仓库" class="headerlink" title="多远程仓库"></a>多远程仓库</h3><ul><li><p>git remote add upstream &lt; url &gt;<br>添加上游仓库</p></li><li><p>git fetch upstream<br>获取上游更新</p></li><li><p>git rebase upstream&#x2F;main<br>同步上游改动</p></li></ul><h3 id="钩子"><a href="#钩子" class="headerlink" title="钩子"></a>钩子</h3><ul><li><p>pre-commit<br>提交前检查代码格式</p></li><li><p>pre-push<br>推送前运行测试</p></li><li><p>commit-msg<br>检查 commit message 格式</p></li></ul><h2 id="常见场景总结"><a href="#常见场景总结" class="headerlink" title="常见场景总结"></a>常见场景总结</h2><p>拉代码<code>git pull</code><br>开新分支开发<code>git checkout -b feature-xxx</code><br>开发中提交<code>git add . &amp;&amp; git commit -m &quot;feat:xxx&quot;</code><br>推送分支<code>git push origin feature-xxx</code><br>合并代码提交PR&#x2F;MR，由leader审核<br>解决冲突，手动修改后<code>git add &amp;&amp; git commit</code><br>回退代码<code>git revert</code><br>多人协作,每天先<code>git pull --rebase</code>避免冲突</p>]]></content>
      
      
      <categories>
          
          <category> git </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Redis&#39;s data type</title>
      <link href="/JasmineRain.github.io/2025/08/18/Redis-s-data-type/"/>
      <url>/JasmineRain.github.io/2025/08/18/Redis-s-data-type/</url>
      
        <content type="html"><![CDATA[<h2 id="字符串String"><a href="#字符串String" class="headerlink" title="字符串String"></a>字符串String</h2><p>基本的数据存储单元，可以存储字符串、整数或者浮点数<br>string类型是二进制安全的。redis的string可以包含任何数据，比如jpg图片或者序列化的对象<br>string类型是redis最基本的数据类型，string类型的值最大能存储512mb</p><h3 id="string常用命令"><a href="#string常用命令" class="headerlink" title="string常用命令"></a>string常用命令</h3><ul><li>SET key value:设置键的值</li><li>GET key:获取键的值</li><li>INCR key:将键的值加1</li><li>DECR key:将键的值减1</li><li>APPEND key value:将值追加到键的值之后</li></ul><h2 id="哈希hash"><a href="#哈希hash" class="headerlink" title="哈希hash"></a>哈希hash</h2><p>一个键值对集合，可以存储多个字段<br>redis hash是一个键值对集合，类似于一个小型的noSQL数据库<br>redis hash是一个string类型的field和value的映射表，hash特别适合用于存储对象<br>每个哈希最多可以存储2^32-1个键值对</p><h3 id="hash常用命令"><a href="#hash常用命令" class="headerlink" title="hash常用命令"></a>hash常用命令</h3><ul><li>HSET key field value:设置哈希表中字段的值</li><li>HGET key field:获取哈希表中字段的值</li><li>HGETALL key:获取哈希表中所有字段和值</li><li>HDEL key field:删除哈希表中的一个或多个字段</li></ul><h2 id="列表list"><a href="#列表list" class="headerlink" title="列表list"></a>列表list</h2><p>一个简单的列表，可以存储一系列的字符串元素<br>redis列表是最简单的字符串列表，按照插入顺序排序<br>列表最多可以存储2^32-1个元素</p><h3 id="list常用命令"><a href="#list常用命令" class="headerlink" title="list常用命令"></a>list常用命令</h3><ul><li>LPUSH key value:将值插入到列表头部</li><li>RPUSH key value:将值插入到列表尾部</li><li>LPOP key:移出并获取列表的第一个元素</li><li>RPOP key:移出并获取列表的最后一个元素</li><li>LRANGE key start stop:获取列表在指定范围(start-stop)内的元素</li></ul><h2 id="集合set"><a href="#集合set" class="headerlink" title="集合set"></a>集合set</h2><p>一个无序集合，可以存储不重复的字符串元素<br>redis的set是string类型的无序集合<br>集合是通过哈希表实现的，所以添加、删除、查找的复杂度都是O(1)</p><h3 id="set常用命令"><a href="#set常用命令" class="headerlink" title="set常用命令"></a>set常用命令</h3><ul><li>SADD key value:向集合添加一个或多个成员</li><li>SREM key value:移除集合中的一个或多个成员</li><li>SMEMBERS key:返回集合中的所有成员</li><li>SISMEMBER key value:判断是否是集合的成员</li></ul><h2 id="有序集合sorted-set"><a href="#有序集合sorted-set" class="headerlink" title="有序集合sorted set"></a>有序集合sorted set</h2><p>类似于集合，但是每个元素都有一个分数score与之关联<br>redis zset和set一样也是string类型元素的集合，且不允许重复的成员<br>不同的是每个元素都会关联一个double类型的分数，redis正是通过分数来为集合中的成员进行从小到大的排序<br>zset的成员是唯一的，但分数却可以重复</p><h3 id="sorted-zset常用命令"><a href="#sorted-zset常用命令" class="headerlink" title="sorted zset常用命令"></a>sorted zset常用命令</h3><ul><li>ZADD key score value:向有序集合添加一个或多个成员，或更新已存在成员的分数</li><li>ZRANGE key start stop [WITHSCORES]:返回指定范围内的成员</li><li>ZREM key value:移除有序集合中的一个或多个成员</li><li>ZSCORE key value:返回有序集合中，成员的分数值</li></ul><h2 id="位图-Bitmaps"><a href="#位图-Bitmaps" class="headerlink" title="位图 Bitmaps"></a>位图 Bitmaps</h2><p>基于字符串类型，可以对每个位进行操作<br>位数组，可以对字符串进行位操作<br>常用于实现布隆过滤器等位操作</p><h2 id="超日志-HyperLogLogs"><a href="#超日志-HyperLogLogs" class="headerlink" title="超日志 HyperLogLogs"></a>超日志 HyperLogLogs</h2><p>用于基数统计，可以估算集合中的唯一元素数量</p><h2 id="地理空间Geospatial"><a href="#地理空间Geospatial" class="headerlink" title="地理空间Geospatial"></a>地理空间Geospatial</h2><p>用于存储地理位置信息<br>支持地理空间索引和半径查询</p><h2 id="发布-订阅Pub-Sub"><a href="#发布-订阅Pub-Sub" class="headerlink" title="发布&#x2F;订阅Pub&#x2F;Sub"></a>发布&#x2F;订阅Pub&#x2F;Sub</h2><p>一种消息通信模式，允许客户端订阅消息通道，并接收发布到该通道的消息</p><h2 id="流Streams"><a href="#流Streams" class="headerlink" title="流Streams"></a>流Streams</h2><p>用于消息队列和日志存储，支持消息的持久化和时间排序</p><h2 id="模块Modules"><a href="#模块Modules" class="headerlink" title="模块Modules"></a>模块Modules</h2><p>redis支持动态加载模块，可以拓展redis的功能</p>]]></content>
      
      
      <categories>
          
          <category> Redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> data type </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Merge sort</title>
      <link href="/JasmineRain.github.io/2025/08/18/Merge-sort/"/>
      <url>/JasmineRain.github.io/2025/08/18/Merge-sort/</url>
      
        <content type="html"><![CDATA[<p>归并排序适合处理大规模数据排序，尤其是当需要稳定排序时非常有用</p><h2 id="归并排序原理"><a href="#归并排序原理" class="headerlink" title="归并排序原理"></a>归并排序原理</h2><ol><li>分治Divide，将数组从中间分成两半</li><li>解决conquer，递归地对左右两半分别进行归并排序</li><li>合并combine，将两个已排序的子数组合并成一个有序数组</li></ol><ul><li>时间复杂度：O(n logn)</li><li>空间复杂度：O(n)，需要额外数组用于合并</li><li>稳定排序，相同元素的相对顺序保持不变</li></ul><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">mergeSort</span><span class="params">(arr []<span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(arr) &lt;= <span class="number">1</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> arr</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    mid := <span class="built_in">len</span>(arr) / <span class="number">2</span></span><br><span class="line">    left := mergeSort(arr[:mid])</span><br><span class="line">    right := mergeSort(arr[mid:])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> merge(left, right)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">merge</span><span class="params">(left, right []<span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">    result := []<span class="type">int</span>&#123;&#125;</span><br><span class="line">    i, j := <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i &lt; <span class="built_in">len</span>(left) &amp;&amp; j &lt; <span class="built_in">len</span>(right) &#123;</span><br><span class="line">        <span class="keyword">if</span> left[i] &lt;= right[j] &#123;</span><br><span class="line">            result = <span class="built_in">append</span>(result, left[i])</span><br><span class="line">            i++</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            result = <span class="built_in">append</span>(result, right[j])</span><br><span class="line">            j++</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    result = <span class="built_in">append</span>(result, left[i:]...)</span><br><span class="line">    result = <span class="built_in">append</span>(result, right[j:]...)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    arr := []<span class="type">int</span>&#123;<span class="number">5</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">3</span>&#125;</span><br><span class="line">    sorted := mergeSort(arr)</span><br><span class="line">    fmt.Println(sorted) <span class="comment">// [1 2 3 4 5 6]</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MergeSort</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">mergeSort</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (arr.length &lt;= <span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line">        mergeSortHelper(arr, <span class="number">0</span>, arr.length - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">mergeSortHelper</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> left, <span class="type">int</span> right)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (left &gt;= right) <span class="keyword">return</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> left + (right - left) / <span class="number">2</span>;</span><br><span class="line">        mergeSortHelper(arr, left, mid);</span><br><span class="line">        mergeSortHelper(arr, mid + <span class="number">1</span>, right);</span><br><span class="line">        merge(arr, left, mid, right);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">merge</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> left, <span class="type">int</span> mid, <span class="type">int</span> right)</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] temp = <span class="keyword">new</span> <span class="title class_">int</span>[right - left + <span class="number">1</span>];</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> left, j = mid + <span class="number">1</span>, k = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (i &lt;= mid &amp;&amp; j &lt;= right) &#123;</span><br><span class="line">            <span class="keyword">if</span> (arr[i] &lt;= arr[j]) temp[k++] = arr[i++];</span><br><span class="line">            <span class="keyword">else</span> temp[k++] = arr[j++];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (i &lt;= mid) temp[k++] = arr[i++];</span><br><span class="line">        <span class="keyword">while</span> (j &lt;= right) temp[k++] = arr[j++];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">p</span> <span class="operator">=</span> <span class="number">0</span>; p &lt; temp.length; p++) arr[left + p] = temp[p];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] arr = &#123;<span class="number">5</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">3</span>&#125;;</span><br><span class="line">        mergeSort(arr);</span><br><span class="line">        System.out.println(Arrays.toString(arr)); <span class="comment">// [1, 2, 3, 4, 5, 6]</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Sort </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Merge sort </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>How is data sorting implemented in MySQL?</title>
      <link href="/JasmineRain.github.io/2025/08/18/How-is-data-sorting-implemented-in-MySQL/"/>
      <url>/JasmineRain.github.io/2025/08/18/How-is-data-sorting-implemented-in-MySQL/</url>
      
        <content type="html"><![CDATA[<h2 id="Answer"><a href="#Answer" class="headerlink" title="Answer"></a>Answer</h2><p>排序过程中，如果排序字段命中索引，则利用<strong>索引排序</strong><br>反之，使用<strong>文件排序</strong><br>文件排序中，如果数据量少则在内存中排序，具体是使用单路排序或者双路排序<br>如果数据大则利用磁盘文件进行外部排序，一般使用归并排序</p><h2 id="拓展知识"><a href="#拓展知识" class="headerlink" title="拓展知识"></a>拓展知识</h2><p>MySQL可以分为索引排序和filesort</p><h3 id="索引排序"><a href="#索引排序" class="headerlink" title="索引排序"></a>索引排序</h3><p>如果查询中的ORDER BY子句包含的字段已经在索引中，并且索引的排列顺序和ORDER BY子句一致，则可直接利用索引进行排序。这种方式效率高，因为索引有序。</p><h3 id="filesort"><a href="#filesort" class="headerlink" title="filesort"></a>filesort</h3><p>当使用explain分析SQL发现执行计划的extra中包含using filesort的时候，说明它无法应用索引的顺序，而主动排序了。</p><p>如果需要<strong>排序的数据比较少</strong>，则直接在内存中通过<code>sort_buffer</code>就能排了。具体是通过<code>sort_buffer_size</code>参数来控制<code>sort_buffer</code>的大小，如果需要排序的数据量小于<code>sort_buffer</code>则直接在内存中排序，反之需要利用磁盘临时文件排序，性能就比较差了。</p><h4 id="内存排序"><a href="#内存排序" class="headerlink" title="内存排序"></a>内存排序</h4><h5 id="双路排序"><a href="#双路排序" class="headerlink" title="双路排序"></a>双路排序</h5><p>有一个叫<code>max_length_for_sort_data</code>参数，默认是4096字节，如果select列的数据长度超过它，则MySQl采用<strong>row_id排序</strong>，即把row_id(有主键就是主键)+排序字段放置到<code>sort_buffer</code>中排序。</p>]]></content>
      
      
      <categories>
          
          <category> MySQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
            <tag> Sort </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Array</title>
      <link href="/JasmineRain.github.io/2025/08/18/Array/"/>
      <url>/JasmineRain.github.io/2025/08/18/Array/</url>
      
        <content type="html"><![CDATA[<h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p>数组是一种<strong>线性数据结构</strong>，用于存储<strong>相同类型的元素</strong>，在内存中是<strong>连续分配</strong>的</p><h2 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h2><ol><li><p><strong>固定长度</strong>:声明时需要确定大小(静态数组)，或者动态数组可以扩展长度(for example:Go’s slice,Java’s ArrayList)</p></li><li><p><strong>随机访问</strong>:通过下标在O(1)的时间内访问任意元素</p></li><li><p><strong>连续存储</strong>:方便计算元素的地址，但插入和删除中间元素可能需要移动大量数据</p></li></ol><h2 id="数组操作"><a href="#数组操作" class="headerlink" title="数组操作"></a>数组操作</h2><h3 id="创建数组"><a href="#创建数组" class="headerlink" title="创建数组"></a>创建数组</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定长数组</span></span><br><span class="line"><span class="keyword">var</span> arr [<span class="number">5</span>]<span class="type">int</span></span><br><span class="line">arr[<span class="number">0</span>]=<span class="number">1</span></span><br><span class="line">arr[<span class="number">2</span>]=<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//动态数组 slice</span></span><br><span class="line">s:=[]<span class="type">int</span>&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定长数组</span></span><br><span class="line"><span class="type">int</span>[] arr=<span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">5</span>];</span><br><span class="line">arr[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">arr[<span class="number">1</span>]=<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//初始化数组</span></span><br><span class="line"><span class="type">int</span>[] arr2=&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;</span><br></pre></td></tr></table></figure><h3 id="访问数组"><a href="#访问数组" class="headerlink" title="访问数组"></a>访问数组</h3><p>按下标访问，注意下标从0开始</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fmt.Println(arr[<span class="number">0</span>])</span><br><span class="line">fmt.Println(s[<span class="built_in">len</span>(s)<span class="number">-1</span>])</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">System.out.Println(arr[<span class="number">0</span>]);</span><br><span class="line">System.out.Println(arr[arr.length-<span class="number">1</span>]);</span><br></pre></td></tr></table></figure><h3 id="遍历数组"><a href="#遍历数组" class="headerlink" title="遍历数组"></a>遍历数组</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i:=<span class="number">0</span>;i&lt;<span class="built_in">len</span>(s);i++&#123;</span><br><span class="line">    fmt.Println(s[i])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i,v:=<span class="keyword">range</span> s&#123;</span><br><span class="line">    fmt.Println(i,v)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;arr.length;i++)&#123;</span><br><span class="line">    System.out.println(arr[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> v:arr)&#123;</span><br><span class="line">    System.out.println(v);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="插入和删除"><a href="#插入和删除" class="headerlink" title="插入和删除"></a>插入和删除</h3><p>数组固定长度时中间插入&#x2F;删除效率低，需要移动元素</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">s:=[]<span class="type">int</span>&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;</span><br><span class="line">index:=<span class="number">2</span></span><br><span class="line">val:=<span class="number">99</span></span><br><span class="line">s=<span class="built_in">append</span>(s[:index],<span class="built_in">append</span>([]<span class="type">int</span>&#123;val&#125;,s[index:]...)...)</span><br><span class="line">fmt.Println(s)<span class="comment">// [1 2 99 3 4]</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ArrayList&lt;Integer&gt; list=<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(Arrays.asList(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>));</span><br><span class="line">list.add(<span class="number">2</span>,<span class="number">99</span>);</span><br><span class="line">System.out.Println(list);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> DataStruct </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Array </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Dynamic Programming</title>
      <link href="/JasmineRain.github.io/2025/08/16/Dynamic-Programming/"/>
      <url>/JasmineRain.github.io/2025/08/16/Dynamic-Programming/</url>
      
        <content type="html"><![CDATA[<p>DP is a way that making the question become the more easy little questions to solve.</p><h2 id="basic-dp"><a href="#basic-dp" class="headerlink" title="basic dp"></a>basic dp</h2>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> dp </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
